2025-11-15 21:50:25,054 INFO: อ่านไฟล์: data\staging\formatted_air.csv
2025-11-15 21:50:25,064 INFO: อ่านข้อมูล: 2 แถว
2025-11-15 21:50:25,070 INFO: หลังแปลงตัวเลข - missing:
PM10 (µg/m³)     0
PM2.5 (µg/m³)    0
WS (m/s)         0
Temp (°C)        0
RH (%)           0
BP (mBar)        0
dtype: int64
2025-11-15 21:50:25,075 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (2 แถว)
2025-11-15 21:50:25,077 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)  Temp (°C)  RH (%)  BP (mBar)
2025-11-15 21:00:00          52.4           16.9       0.3       27.7    43.7     1014.2
2025-11-15 20:00:00          44.1           13.4       0.4       28.3    41.2     1013.5
2025-11-15 22:08:42,332 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:08:42,333 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:08:42,333 INFO: Scheduler started
2025-11-15 22:08:42,333 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:08:42,333 INFO: === PIPELINE START ===
2025-11-15 22:08:43,022 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:08:43,029 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:08:43,030 INFO: สำเร็จ: เพิ่ม 1 แถว
2025-11-15 22:08:43,030 INFO: Fetch สำเร็จ
2025-11-15 22:08:43,041 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:08:43,042 INFO: เลือกคอลัมน์: 7 คอลัมน์
2025-11-15 22:08:43,045 INFO: รวมเก่า 2 + ใหม่ 3 → 3 (เพิ่ม 1)
2025-11-15 22:08:43,045 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:08:43,046 INFO: Format สำเร็จ: เพิ่ม 1 แถว
2025-11-15 22:08:43,055 INFO: เริ่ม clean ข้อมูล: 3 แถว
2025-11-15 22:08:43,065 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (3 แถว)
2025-11-15 22:08:43,067 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)  Temp (°C)  RH (%)  BP (mBar)
2025-11-15 22:00:00          53.0           22.0       0.4       27.8    45.2     1014.5
2025-11-15 21:00:00          52.4           16.9       0.3       27.7    43.7     1014.2
2025-11-15 20:00:00          44.1           13.4       0.4       28.3    41.2     1013.5
2025-11-15 22:08:43,067 INFO: Clean สำเร็จ
2025-11-15 22:08:43,093 INFO: เตรียมโหลด 3 แถว
2025-11-15 22:08:43,096 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:08:42.330146+07:00)
2025-11-15 22:08:43,097 INFO: === PIPELINE START ===
2025-11-15 22:08:43,792 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:08:43,794 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:08:43,795 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:08:43,795 INFO: Fetch สำเร็จ
2025-11-15 22:08:43,796 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:08:43,797 INFO: เลือกคอลัมน์: 7 คอลัมน์
2025-11-15 22:08:43,799 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:08:43,800 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:08:43,800 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:08:43,800 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:08:43,851 ERROR: Load ล้มเหลว: [WinError 1314] A required privilege is not held by the client: '2025-11-15.csv' -> 'data\\backups\\latest.csv'
2025-11-15 22:08:56,770 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:08:56,771 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:08:56,772 INFO: Scheduler started
2025-11-15 22:08:56,772 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:08:56,772 INFO: === PIPELINE START ===
2025-11-15 22:08:57,472 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:08:57,478 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:08:57,479 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:08:57,479 INFO: Fetch สำเร็จ
2025-11-15 22:08:57,480 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:08:57,481 INFO: เลือกคอลัมน์: 7 คอลัมน์
2025-11-15 22:08:57,484 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:08:57,486 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:08:57,487 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:08:57,487 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:08:56.768037+07:00)
2025-11-15 22:08:57,487 INFO: === PIPELINE START ===
2025-11-15 22:08:58,180 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:08:58,182 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:08:58,183 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:08:58,183 INFO: Fetch สำเร็จ
2025-11-15 22:08:58,184 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:08:58,185 INFO: เลือกคอลัมน์: 7 คอลัมน์
2025-11-15 22:08:58,187 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:08:58,188 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:08:58,188 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:08:58,188 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:10:43,362 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:10:43,363 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:10:43,363 INFO: Scheduler started
2025-11-15 22:10:43,364 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:10:43,364 INFO: === PIPELINE START ===
2025-11-15 22:10:44,090 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:10:44,096 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:10:44,096 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:10:44,096 INFO: Fetch สำเร็จ
2025-11-15 22:10:44,098 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:10:44,098 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:10:44,102 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:10:44,104 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:10:44,104 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:10:44,104 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:10:43.359727+07:00)
2025-11-15 22:10:44,104 INFO: === PIPELINE START ===
2025-11-15 22:10:44,827 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:10:44,830 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:10:44,830 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:10:44,830 INFO: Fetch สำเร็จ
2025-11-15 22:10:44,832 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:10:44,832 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:10:44,845 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:10:44,846 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:10:44,846 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:10:44,846 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:12:03,723 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:12:03,726 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:12:03,726 INFO: Scheduler started
2025-11-15 22:12:03,726 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:12:03,726 INFO: === PIPELINE START ===
2025-11-15 22:12:04,465 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:12:04,470 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:12:04,471 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:12:04,471 INFO: Fetch สำเร็จ
2025-11-15 22:12:04,472 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:12:04,473 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:12:04,477 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:12:04,479 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:12:04,479 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:12:04,479 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:12:03.721516+07:00)
2025-11-15 22:12:04,479 INFO: === PIPELINE START ===
2025-11-15 22:12:05,202 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:12:05,205 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:12:05,205 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:12:05,206 INFO: Fetch สำเร็จ
2025-11-15 22:12:05,207 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:12:05,207 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:12:05,211 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:12:05,212 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:12:05,212 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:12:05,212 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:12:33,646 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:12:33,649 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:12:33,649 INFO: Scheduler started
2025-11-15 22:12:33,649 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:12:33,649 INFO: === PIPELINE START ===
2025-11-15 22:12:34,449 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:12:34,454 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:12:34,455 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:12:34,455 INFO: Fetch สำเร็จ
2025-11-15 22:12:34,456 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:12:34,457 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:12:34,460 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:12:34,462 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:12:34,462 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:12:34,462 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:12:33.644933+07:00)
2025-11-15 22:12:34,462 INFO: === PIPELINE START ===
2025-11-15 22:12:35,173 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:12:35,180 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:12:35,180 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:12:35,181 INFO: Fetch สำเร็จ
2025-11-15 22:12:35,182 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:12:35,183 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:12:35,186 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:12:35,187 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:12:35,188 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:12:35,188 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:15:11,220 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:15:11,221 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:15:11,221 INFO: Scheduler started
2025-11-15 22:15:11,223 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:15:11,223 INFO: === PIPELINE START ===
2025-11-15 22:15:11,891 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:15:11,901 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:15:11,901 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:15:11,902 INFO: Fetch สำเร็จ
2025-11-15 22:15:11,902 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:15:11,903 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:15:11,907 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:15:11,909 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:15:11,909 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:15:11,909 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:15:11.218672+07:00)
2025-11-15 22:15:11,910 INFO: === PIPELINE START ===
2025-11-15 22:15:12,576 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:15:12,583 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:15:12,583 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:15:12,583 INFO: Fetch สำเร็จ
2025-11-15 22:15:12,585 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:15:12,585 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:15:12,588 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:15:12,589 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:15:12,589 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:15:12,589 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:18:04,801 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:18:04,802 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:18:04,802 INFO: Scheduler started
2025-11-15 22:18:04,802 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:18:04,803 INFO: === PIPELINE START ===
2025-11-15 22:18:08,317 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:18:08,323 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:18:08,323 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:18:08,323 INFO: Fetch สำเร็จ
2025-11-15 22:18:08,324 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:18:08,325 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:18:08,328 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:18:08,331 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:18:08,331 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:18:08,331 WARNING: Run time of job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" was missed by 0:00:03.532946
2025-11-15 22:24:19,655 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:24:19,656 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:24:19,656 INFO: Scheduler started
2025-11-15 22:24:19,656 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:24:19,657 INFO: === PIPELINE START ===
2025-11-15 22:24:20,370 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:24:20,376 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:24:20,377 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:24:20,377 INFO: Fetch สำเร็จ
2025-11-15 22:24:20,378 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:24:20,379 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:24:20,382 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:24:20,384 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:24:20,384 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:24:20,385 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:24:19.652625+07:00)
2025-11-15 22:24:20,385 INFO: === PIPELINE START ===
2025-11-15 22:24:21,111 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:24:21,114 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:24:21,114 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:24:21,114 INFO: Fetch สำเร็จ
2025-11-15 22:24:21,115 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:24:21,115 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:24:21,119 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:24:21,121 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:24:21,121 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:24:21,121 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:29:35,352 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:29:35,354 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:29:35,354 INFO: Scheduler started
2025-11-15 22:29:35,354 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:29:35,354 INFO: === PIPELINE START ===
2025-11-15 22:29:36,061 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:29:36,065 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:29:36,065 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:29:36,065 INFO: Fetch สำเร็จ
2025-11-15 22:29:36,069 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:29:36,069 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:29:36,072 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:29:36,074 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:29:36,074 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:29:36,074 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:29:35.350473+07:00)
2025-11-15 22:29:36,075 INFO: === PIPELINE START ===
2025-11-15 22:29:36,751 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:29:36,755 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:29:36,756 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:29:36,756 INFO: Fetch สำเร็จ
2025-11-15 22:29:36,758 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:29:36,758 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:29:36,760 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:29:36,761 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:29:36,761 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:29:36,762 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:30:45,882 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:30:45,884 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:30:45,884 INFO: Scheduler started
2025-11-15 22:30:45,884 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:30:45,884 INFO: === PIPELINE START ===
2025-11-15 22:30:46,621 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:30:46,627 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:46,630 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:46,631 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:30:46,631 INFO: Fetch สำเร็จ
2025-11-15 22:30:46,632 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:30:46,633 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:30:46,635 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:30:46,638 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:30:46,638 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:30:46,638 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:30:45.878542+07:00)
2025-11-15 22:30:46,639 INFO: === PIPELINE START ===
2025-11-15 22:30:47,359 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:30:47,363 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:47,365 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:47,366 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:30:47,366 INFO: Fetch สำเร็จ
2025-11-15 22:30:47,367 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:30:47,368 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:30:47,370 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:30:47,371 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:30:47,372 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:30:47,372 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:30:48,751 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:30:48,752 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:30:48,752 INFO: Scheduler started
2025-11-15 22:30:48,754 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:30:48,754 INFO: === PIPELINE START ===
2025-11-15 22:30:49,450 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:30:49,457 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:49,460 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:49,460 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:30:49,460 INFO: Fetch สำเร็จ
2025-11-15 22:30:49,461 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:30:49,462 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:30:49,464 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:30:49,466 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:30:49,466 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:30:49,467 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:30:48.750834+07:00)
2025-11-15 22:30:49,467 INFO: === PIPELINE START ===
2025-11-15 22:30:50,180 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:30:50,182 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:50,187 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:50,187 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:30:50,188 INFO: Fetch สำเร็จ
2025-11-15 22:30:50,189 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:30:50,189 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:30:50,191 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:30:50,192 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:30:50,193 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:30:50,193 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:31:20,344 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:31:20,346 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:31:20,346 INFO: Scheduler started
2025-11-15 22:31:20,346 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:31:20,347 INFO: === PIPELINE START ===
2025-11-15 22:31:21,056 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:31:21,061 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:31:21,065 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:31:21,066 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:31:21,066 INFO: Fetch สำเร็จ
2025-11-15 22:31:21,067 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:31:21,068 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:31:21,070 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:31:21,072 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:31:21,072 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:31:21,072 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:31:20.342781+07:00)
2025-11-15 22:31:21,072 INFO: === PIPELINE START ===
2025-11-15 22:31:21,746 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:31:21,752 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:31:21,756 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:31:21,757 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:31:21,757 INFO: Fetch สำเร็จ
2025-11-15 22:31:21,759 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:31:21,759 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:31:21,762 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:31:21,763 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:31:21,763 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:31:21,763 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:32:46,631 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:32:46,633 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:32:46,633 INFO: Scheduler started
2025-11-15 22:32:46,633 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:32:46,633 INFO: === PIPELINE START ===
2025-11-15 22:32:47,359 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:32:47,374 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:32:47,375 INFO: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-15 22:32:47,385 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:32:47,385 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:32:47,386 INFO: Fetch สำเร็จ
2025-11-15 22:32:47,386 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:32:47,388 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:32:47,391 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:32:47,392 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:32:47,392 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:32:47,393 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:32:46.629310+07:00)
2025-11-15 22:32:47,393 INFO: === PIPELINE START ===
2025-11-15 22:32:48,108 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:32:48,113 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:32:48,116 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:32:48,116 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:32:48,116 INFO: Fetch สำเร็จ
2025-11-15 22:32:48,117 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:32:48,118 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:32:48,120 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:32:48,121 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:32:48,121 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:32:48,121 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:45:37,078 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:45:37,080 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:45:37,080 INFO: Scheduler started
2025-11-15 22:45:37,080 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:45:37,081 INFO: === PIPELINE START ===
2025-11-15 22:45:37,814 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:45:37,827 ERROR: ดึงข้อมูลล้มเหลว
Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 206, in main
    added = append_to_master_no_dup(df_new)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 102, in append_to_master_no_dup
    df_master = pd.read_csv(master_file, dtype=str, encoding="utf-8-sig")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
2025-11-15 22:45:37,852 ERROR: Error running job run_pipeline
Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 206, in main
    added = append_to_master_no_dup(df_new)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 102, in append_to_master_no_dup
    df_master = pd.read_csv(master_file, dtype=str, encoding="utf-8-sig")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 216, in main
    sys.exit(1)
SystemExit: 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\asyncio.py", line 35, in callback
    events = f.result()
             ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 161, in run_coroutine_job
    async def run_coroutine_job(job, jobstore_alias, run_times, logger_name):
asyncio.exceptions.CancelledError
2025-11-15 22:45:37,877 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:22> exception=SystemExit(1)>
Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 206, in main
    added = append_to_master_no_dup(df_new)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 102, in append_to_master_no_dup
    df_master = pd.read_csv(master_file, dtype=str, encoding="utf-8-sig")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 216, in main
    sys.exit(1)
SystemExit: 1
2025-11-15 22:48:38,832 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:48:38,834 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:48:38,834 INFO: Scheduler started
2025-11-15 22:48:38,834 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:48:38,834 INFO: === PIPELINE START ===
2025-11-15 22:48:39,577 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:48:39,581 WARNING: ไฟล์ data\staging\raw_airbkk.csv ว่าง → เขียนทับ
2025-11-15 22:48:39,584 INFO: สำเร็จ: เพิ่ม 2 แถว
2025-11-15 22:48:39,599 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 22:48:39,599 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 22:00:00+07:00 → 2025-11-15 22:00:00+07:00
2025-11-15 22:48:50,279 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:48:50,280 INFO: เติม 2025-11-13 22:00 → +0
2025-11-15 22:49:01,993 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:49:01,993 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 22:49:13,668 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:49:13,668 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 22:49:25,410 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:49:25,411 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 22:49:37,132 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:49:37,133 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 22:49:48,852 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:49:48,852 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 22:50:00,551 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:50:00,551 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 22:50:12,265 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:50:12,265 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 22:50:23,988 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:50:23,989 INFO: เติม 2025-11-14 06:00 → +0
2025-11-15 22:50:35,700 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:50:35,700 INFO: เติม 2025-11-14 07:00 → +0
2025-11-15 22:50:47,489 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:50:47,489 INFO: เติม 2025-11-14 08:00 → +0
2025-11-15 22:50:59,318 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:50:59,318 INFO: เติม 2025-11-14 09:00 → +0
2025-11-15 22:51:11,037 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:51:11,037 INFO: เติม 2025-11-14 10:00 → +0
2025-11-15 22:51:22,853 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:51:22,853 INFO: เติม 2025-11-14 11:00 → +0
2025-11-15 22:51:34,597 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:51:34,597 INFO: เติม 2025-11-14 12:00 → +0
2025-11-15 22:51:46,320 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:51:46,321 INFO: เติม 2025-11-14 13:00 → +0
2025-11-15 22:51:58,070 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:51:58,071 INFO: เติม 2025-11-14 14:00 → +0
2025-11-15 22:52:09,749 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:52:09,749 INFO: เติม 2025-11-14 15:00 → +0
2025-11-15 22:52:21,521 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:52:21,521 INFO: เติม 2025-11-14 16:00 → +0
2025-11-15 22:52:33,261 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:52:33,262 INFO: เติม 2025-11-14 17:00 → +0
2025-11-15 22:52:44,949 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:52:44,949 INFO: เติม 2025-11-14 18:00 → +0
2025-11-15 22:52:56,672 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:52:56,672 INFO: เติม 2025-11-14 19:00 → +0
2025-11-15 22:53:08,394 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:53:08,395 INFO: เติม 2025-11-14 20:00 → +0
2025-11-15 22:53:20,129 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:53:20,130 INFO: เติม 2025-11-14 21:00 → +0
2025-11-15 22:53:49,827 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:53:49,828 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:53:49,829 INFO: Scheduler started
2025-11-15 22:53:49,829 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:53:49,829 INFO: === PIPELINE START ===
2025-11-15 22:53:50,552 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:53:50,564 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:53:50,564 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 22:53:50,567 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 22:53:50,567 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 22:00:00+07:00 → 2025-11-15 22:00:00+07:00
2025-11-15 22:53:51,267 INFO: เพิ่ม 2 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:53:51,268 INFO: เติม 2025-11-13 22:00 → +2
2025-11-15 22:53:52,999 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:53:52,999 INFO: เติม 2025-11-13 23:00 → +1
2025-11-15 22:53:54,719 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:53:54,719 INFO: เติม 2025-11-14 00:00 → +1
2025-11-15 22:53:56,404 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:53:56,404 INFO: เติม 2025-11-14 01:00 → +1
2025-11-15 22:53:58,120 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:53:58,121 INFO: เติม 2025-11-14 02:00 → +1
2025-11-15 22:53:59,827 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:53:59,828 INFO: เติม 2025-11-14 03:00 → +1
2025-11-15 22:54:01,522 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:01,522 INFO: เติม 2025-11-14 04:00 → +1
2025-11-15 22:54:03,263 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:03,264 INFO: เติม 2025-11-14 05:00 → +1
2025-11-15 22:54:04,958 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:04,958 INFO: เติม 2025-11-14 06:00 → +1
2025-11-15 22:54:06,658 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:06,658 INFO: เติม 2025-11-14 07:00 → +1
2025-11-15 22:54:08,388 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:08,388 INFO: เติม 2025-11-14 08:00 → +1
2025-11-15 22:54:10,094 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:10,094 INFO: เติม 2025-11-14 09:00 → +1
2025-11-15 22:54:11,777 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:11,778 INFO: เติม 2025-11-14 10:00 → +1
2025-11-15 22:54:13,540 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:13,540 INFO: เติม 2025-11-14 11:00 → +1
2025-11-15 22:54:15,225 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:15,226 INFO: เติม 2025-11-14 12:00 → +1
2025-11-15 22:54:16,911 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:16,912 INFO: เติม 2025-11-14 13:00 → +1
2025-11-15 22:54:18,580 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:18,580 INFO: เติม 2025-11-14 14:00 → +1
2025-11-15 22:54:20,266 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:20,266 INFO: เติม 2025-11-14 15:00 → +1
2025-11-15 22:54:21,979 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:21,980 INFO: เติม 2025-11-14 16:00 → +1
2025-11-15 22:54:23,680 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:23,680 INFO: เติม 2025-11-14 17:00 → +1
2025-11-15 22:54:25,394 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:25,395 INFO: เติม 2025-11-14 18:00 → +1
2025-11-15 22:54:27,089 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:27,090 INFO: เติม 2025-11-14 19:00 → +1
2025-11-15 22:54:28,785 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:28,785 INFO: เติม 2025-11-14 20:00 → +1
2025-11-15 22:54:30,508 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:30,508 INFO: เติม 2025-11-14 21:00 → +1
2025-11-15 22:54:32,259 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:32,260 INFO: เติม 2025-11-14 22:00 → +1
2025-11-15 22:54:33,960 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:33,960 INFO: เติม 2025-11-14 23:00 → +1
2025-11-15 22:54:35,691 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:35,691 INFO: เติม 2025-11-15 00:00 → +1
2025-11-15 22:54:37,384 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:37,386 INFO: เติม 2025-11-15 01:00 → +1
2025-11-15 22:54:39,073 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:39,073 INFO: เติม 2025-11-15 02:00 → +1
2025-11-15 22:54:40,756 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:40,756 INFO: เติม 2025-11-15 03:00 → +1
2025-11-15 22:54:42,461 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:42,462 INFO: เติม 2025-11-15 04:00 → +1
2025-11-15 22:54:44,152 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:44,153 INFO: เติม 2025-11-15 05:00 → +1
2025-11-15 22:54:45,843 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:45,844 INFO: เติม 2025-11-15 06:00 → +1
2025-11-15 22:54:47,524 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:47,524 INFO: เติม 2025-11-15 07:00 → +1
2025-11-15 22:54:49,257 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:49,258 INFO: เติม 2025-11-15 08:00 → +1
2025-11-15 22:54:50,941 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:50,942 INFO: เติม 2025-11-15 09:00 → +1
2025-11-15 22:54:52,708 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:52,709 INFO: เติม 2025-11-15 10:00 → +1
2025-11-15 22:54:54,418 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:54,419 INFO: เติม 2025-11-15 11:00 → +1
2025-11-15 22:54:56,164 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:56,164 INFO: เติม 2025-11-15 12:00 → +1
2025-11-15 22:54:57,905 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:57,906 INFO: เติม 2025-11-15 13:00 → +1
2025-11-15 22:54:59,646 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:59,646 INFO: เติม 2025-11-15 14:00 → +1
2025-11-15 22:55:01,375 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:55:01,376 INFO: เติม 2025-11-15 15:00 → +1
2025-11-15 22:55:03,104 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:55:03,105 INFO: เติม 2025-11-15 16:00 → +1
2025-11-15 22:55:05,468 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:55:05,469 INFO: เติม 2025-11-15 17:00 → +1
2025-11-15 22:55:07,201 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:55:07,202 INFO: เติม 2025-11-15 18:00 → +1
2025-11-15 22:55:08,948 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:55:08,948 INFO: เติม 2025-11-15 19:00 → +1
2025-11-15 22:55:10,678 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:55:10,679 INFO: เติม 2025-11-15 20:00 → +0
2025-11-15 22:55:12,546 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:55:12,546 INFO: เติม 2025-11-15 21:00 → +0
2025-11-15 22:55:13,547 INFO: เติมข้อมูลย้อนหลังเสร็จ: +47 แถว
2025-11-15 22:55:13,547 INFO: Fetch สำเร็จ
2025-11-15 22:55:13,549 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 49 แถว
2025-11-15 22:55:13,550 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:55:13,550 INFO: สร้างไฟล์ formatted ใหม่
2025-11-15 22:55:13,552 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:55:13,552 INFO: Format สำเร็จ: เพิ่ม 49 แถว
2025-11-15 22:55:13,567 INFO: เริ่ม clean ข้อมูล: 49 แถว
2025-11-15 22:55:13,578 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (49 แถว)
2025-11-15 22:55:13,583 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-15 22:00:00          53.0           22.0       0.4 162.5       27.8    45.2     1014.5
2025-11-15 21:00:00          52.4           16.9       0.3 134.5       27.7    43.7     1014.2
2025-11-15 20:00:00          44.1           13.4       0.4 135.4       28.3    41.2     1013.5
2025-11-15 19:00:00          45.4           16.8       0.5 168.3       29.2    36.9     1012.7
2025-11-15 18:00:00          37.2           14.4       1.0 177.0       29.9    33.7     1012.1
2025-11-15 17:00:00          40.1            9.8       1.0 179.4       30.6    31.5     1011.5
2025-11-15 16:00:00          42.3           12.0       1.5 186.1       31.0    30.5     1011.5
2025-11-15 15:00:00          47.1           12.4       1.1 171.7       31.4    29.0     1011.8
2025-11-15 14:00:00          48.2           17.8       1.3 155.1       30.9    32.3     1012.5
2025-11-15 13:00:00          50.7           16.0       0.9 133.9       30.1    38.0     1013.5
2025-11-15 22:55:13,583 INFO: Clean สำเร็จ
2025-11-15 22:55:13,611 INFO: เตรียมโหลด 49 แถว
2025-11-15 22:55:13,617 WARNING: Run time of job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" was missed by 0:01:23.793007
2025-11-15 22:55:13,725 ERROR: Load ล้มเหลว: [WinError 1314] A required privilege is not held by the client: '2025-11-15.csv' -> 'data\\backups\\latest.csv'
2025-11-15 22:58:09,676 INFO: หยุดด้วย Ctrl+C
2025-11-15 22:58:10,827 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:58:10,829 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:58:10,829 INFO: Scheduler started
2025-11-15 22:58:10,829 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:58:10,830 INFO: === PIPELINE START ===
2025-11-15 22:58:11,525 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:58:11,531 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:11,531 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 22:58:11,535 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 22:58:11,535 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 22:00:00+07:00 → 2025-11-15 22:00:00+07:00
2025-11-15 22:58:12,252 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:12,252 INFO: เติม 2025-11-13 22:00 → +0
2025-11-15 22:58:13,976 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:13,977 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 22:58:15,854 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:15,855 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 22:58:17,594 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:17,594 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 22:58:19,334 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:19,334 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 22:58:21,052 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:21,053 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 22:58:22,812 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:22,813 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 22:58:24,508 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:24,509 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 22:58:26,204 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:26,205 INFO: เติม 2025-11-14 06:00 → +0
2025-11-15 22:58:27,937 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:27,938 INFO: เติม 2025-11-14 07:00 → +0
2025-11-15 22:58:29,412 INFO: หยุดด้วย Ctrl+C
2025-11-15 22:58:29,470 ERROR: Error running job run_pipeline
Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in send
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in <listcomp>
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 265, in resolve_redirects
    resp = self.send(
           ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 565, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1378, in getresponse
    response.begin()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1311, in recv_into
    return self.read(nbytes, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1167, in read
    return self._sslobj.read(len, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\asyncio.py", line 35, in callback
    events = f.result()
             ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 161, in run_coroutine_job
    async def run_coroutine_job(job, jobstore_alias, run_times, logger_name):
asyncio.exceptions.CancelledError
2025-11-15 22:58:29,501 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:22> exception=SystemExit(0)>
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in send
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in <listcomp>
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 265, in resolve_redirects
    resp = self.send(
           ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 565, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1378, in getresponse
    response.begin()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1311, in recv_into
    return self.read(nbytes, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1167, in read
    return self._sslobj.read(len, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0
2025-11-15 22:58:30,701 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:58:30,703 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:58:30,703 INFO: Scheduler started
2025-11-15 22:58:30,703 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:58:30,703 INFO: === PIPELINE START ===
2025-11-15 22:58:31,397 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:58:31,404 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:31,404 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 22:58:31,407 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 22:58:31,407 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 22:00:00+07:00 → 2025-11-15 22:00:00+07:00
2025-11-15 22:58:32,146 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:32,147 INFO: เติม 2025-11-13 22:00 → +0
2025-11-15 22:58:33,869 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:33,870 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 22:58:35,598 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:35,599 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 22:58:35,683 INFO: หยุดด้วย Ctrl+C
2025-11-15 22:58:35,695 ERROR: Error running job run_pipeline
Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 224, in fill_missing_hours
    time.sleep(1)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\asyncio.py", line 35, in callback
    events = f.result()
             ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 161, in run_coroutine_job
    async def run_coroutine_job(job, jobstore_alias, run_times, logger_name):
asyncio.exceptions.CancelledError
2025-11-15 22:58:35,725 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:22> exception=SystemExit(0)>
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 224, in fill_missing_hours
    time.sleep(1)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0
2025-11-15 22:58:36,833 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:58:36,834 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:58:36,835 INFO: Scheduler started
2025-11-15 22:58:36,835 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:58:36,835 INFO: === PIPELINE START ===
2025-11-15 22:58:37,513 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:58:37,521 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:37,522 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 22:58:37,525 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 22:58:37,525 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 22:00:00+07:00 → 2025-11-15 22:00:00+07:00
2025-11-15 22:58:38,247 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:38,247 INFO: เติม 2025-11-13 22:00 → +0
2025-11-15 22:58:39,971 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:39,971 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 22:58:41,691 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:41,691 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 22:58:43,450 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:43,451 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 22:58:45,180 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:45,181 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 22:58:46,929 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:46,929 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 22:58:48,641 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:48,641 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 22:58:50,367 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:50,367 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 22:58:52,145 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:52,145 INFO: เติม 2025-11-14 06:00 → +0
2025-11-15 22:58:53,854 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:53,855 INFO: เติม 2025-11-14 07:00 → +0
2025-11-15 22:58:55,551 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:55,552 INFO: เติม 2025-11-14 08:00 → +0
2025-11-15 22:58:57,264 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:57,264 INFO: เติม 2025-11-14 09:00 → +0
2025-11-15 22:58:58,958 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:58,958 INFO: เติม 2025-11-14 10:00 → +0
2025-11-15 22:59:00,664 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:00,664 INFO: เติม 2025-11-14 11:00 → +0
2025-11-15 22:59:02,376 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:02,376 INFO: เติม 2025-11-14 12:00 → +0
2025-11-15 22:59:04,075 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:04,076 INFO: เติม 2025-11-14 13:00 → +0
2025-11-15 22:59:05,804 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:05,805 INFO: เติม 2025-11-14 14:00 → +0
2025-11-15 22:59:07,476 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:07,477 INFO: เติม 2025-11-14 15:00 → +0
2025-11-15 22:59:09,190 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:09,190 INFO: เติม 2025-11-14 16:00 → +0
2025-11-15 22:59:10,887 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:10,888 INFO: เติม 2025-11-14 17:00 → +0
2025-11-15 22:59:12,625 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:12,625 INFO: เติม 2025-11-14 18:00 → +0
2025-11-15 22:59:14,415 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:14,415 INFO: เติม 2025-11-14 19:00 → +0
2025-11-15 22:59:16,111 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:16,111 INFO: เติม 2025-11-14 20:00 → +0
2025-11-15 22:59:17,797 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:17,797 INFO: เติม 2025-11-14 21:00 → +0
2025-11-15 22:59:19,504 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:19,504 INFO: เติม 2025-11-14 22:00 → +0
2025-11-15 22:59:21,193 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:21,193 INFO: เติม 2025-11-14 23:00 → +0
2025-11-15 22:59:22,879 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:22,880 INFO: เติม 2025-11-15 00:00 → +0
2025-11-15 22:59:24,689 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:24,690 INFO: เติม 2025-11-15 01:00 → +0
2025-11-15 22:59:26,440 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:26,440 INFO: เติม 2025-11-15 02:00 → +0
2025-11-15 22:59:28,630 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:28,631 INFO: เติม 2025-11-15 03:00 → +0
2025-11-15 22:59:30,405 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:30,405 INFO: เติม 2025-11-15 04:00 → +0
2025-11-15 22:59:32,127 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:32,128 INFO: เติม 2025-11-15 05:00 → +0
2025-11-15 22:59:33,915 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:33,916 INFO: เติม 2025-11-15 06:00 → +0
2025-11-15 22:59:35,724 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:35,725 INFO: เติม 2025-11-15 07:00 → +0
2025-11-15 22:59:37,462 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:37,463 INFO: เติม 2025-11-15 08:00 → +0
2025-11-15 22:59:39,161 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:39,161 INFO: เติม 2025-11-15 09:00 → +0
2025-11-15 22:59:40,948 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:40,948 INFO: เติม 2025-11-15 10:00 → +0
2025-11-15 22:59:42,667 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:42,669 INFO: เติม 2025-11-15 11:00 → +0
2025-11-15 22:59:44,559 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:44,560 INFO: เติม 2025-11-15 12:00 → +0
2025-11-15 22:59:46,489 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:46,489 INFO: เติม 2025-11-15 13:00 → +0
2025-11-15 22:59:48,223 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:48,223 INFO: เติม 2025-11-15 14:00 → +0
2025-11-15 22:59:49,924 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:49,924 INFO: เติม 2025-11-15 15:00 → +0
2025-11-15 22:59:51,635 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:51,636 INFO: เติม 2025-11-15 16:00 → +0
2025-11-15 22:59:53,339 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:53,340 INFO: เติม 2025-11-15 17:00 → +0
2025-11-15 22:59:55,071 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:55,071 INFO: เติม 2025-11-15 18:00 → +0
2025-11-15 22:59:56,790 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:56,797 INFO: เติม 2025-11-15 19:00 → +0
2025-11-15 22:59:58,588 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:58,589 INFO: เติม 2025-11-15 20:00 → +0
2025-11-15 23:00:00,290 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:00,290 INFO: เติม 2025-11-15 21:00 → +0
2025-11-15 23:00:01,296 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-15 23:00:01,296 INFO: Fetch สำเร็จ
2025-11-15 23:00:01,300 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:00:01,301 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:00:02,001 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:02,002 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 23:00:03,685 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:03,686 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 23:00:05,415 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:05,417 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 23:00:07,155 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:07,156 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 23:00:08,875 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:08,875 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 23:00:10,605 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:10,605 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 23:00:12,368 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:12,368 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 23:00:14,082 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:14,083 INFO: เติม 2025-11-14 06:00 → +0
2025-11-15 23:00:15,782 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:15,783 INFO: เติม 2025-11-14 07:00 → +0
2025-11-15 23:00:17,493 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:17,494 INFO: เติม 2025-11-14 08:00 → +0
2025-11-15 23:00:19,234 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:19,234 INFO: เติม 2025-11-14 09:00 → +0
2025-11-15 23:00:20,967 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:20,967 INFO: เติม 2025-11-14 10:00 → +0
2025-11-15 23:00:22,744 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:22,744 INFO: เติม 2025-11-14 11:00 → +0
2025-11-15 23:00:24,446 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:24,446 INFO: เติม 2025-11-14 12:00 → +0
2025-11-15 23:00:26,220 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:26,221 INFO: เติม 2025-11-14 13:00 → +0
2025-11-15 23:00:27,934 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:27,935 INFO: เติม 2025-11-14 14:00 → +0
2025-11-15 23:00:29,657 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:29,657 INFO: เติม 2025-11-14 15:00 → +0
2025-11-15 23:00:31,409 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:31,409 INFO: เติม 2025-11-14 16:00 → +0
2025-11-15 23:00:33,161 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:33,161 INFO: เติม 2025-11-14 17:00 → +0
2025-11-15 23:00:34,967 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:34,967 INFO: เติม 2025-11-14 18:00 → +0
2025-11-15 23:00:36,679 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:36,679 INFO: เติม 2025-11-14 19:00 → +0
2025-11-15 23:00:38,419 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:38,419 INFO: เติม 2025-11-14 20:00 → +0
2025-11-15 23:00:40,130 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:40,131 INFO: เติม 2025-11-14 21:00 → +0
2025-11-15 23:00:41,875 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:41,875 INFO: เติม 2025-11-14 22:00 → +0
2025-11-15 23:00:43,605 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:43,605 INFO: เติม 2025-11-14 23:00 → +0
2025-11-15 23:00:45,326 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:45,326 INFO: เติม 2025-11-15 00:00 → +0
2025-11-15 23:00:47,094 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:47,094 INFO: เติม 2025-11-15 01:00 → +0
2025-11-15 23:00:48,906 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:48,907 INFO: เติม 2025-11-15 02:00 → +0
2025-11-15 23:00:50,621 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:50,621 INFO: เติม 2025-11-15 03:00 → +0
2025-11-15 23:00:52,380 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:52,380 INFO: เติม 2025-11-15 04:00 → +0
2025-11-15 23:00:54,145 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:54,145 INFO: เติม 2025-11-15 05:00 → +0
2025-11-15 23:00:55,840 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:55,842 INFO: เติม 2025-11-15 06:00 → +0
2025-11-15 23:00:57,571 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:57,571 INFO: เติม 2025-11-15 07:00 → +0
2025-11-15 23:00:59,271 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:59,271 INFO: เติม 2025-11-15 08:00 → +0
2025-11-15 23:01:00,977 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:00,977 INFO: เติม 2025-11-15 09:00 → +0
2025-11-15 23:01:02,694 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:02,694 INFO: เติม 2025-11-15 10:00 → +0
2025-11-15 23:01:04,440 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:04,440 INFO: เติม 2025-11-15 11:00 → +0
2025-11-15 23:01:06,228 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:06,229 INFO: เติม 2025-11-15 12:00 → +0
2025-11-15 23:01:07,930 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:07,931 INFO: เติม 2025-11-15 13:00 → +0
2025-11-15 23:01:09,637 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:09,637 INFO: เติม 2025-11-15 14:00 → +0
2025-11-15 23:01:11,350 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:11,351 INFO: เติม 2025-11-15 15:00 → +0
2025-11-15 23:01:13,058 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:13,058 INFO: เติม 2025-11-15 16:00 → +0
2025-11-15 23:01:14,778 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:14,778 INFO: เติม 2025-11-15 17:00 → +0
2025-11-15 23:01:16,500 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:16,500 INFO: เติม 2025-11-15 18:00 → +0
2025-11-15 23:01:18,213 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:18,214 INFO: เติม 2025-11-15 19:00 → +0
2025-11-15 23:01:19,948 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:19,948 INFO: เติม 2025-11-15 20:00 → +0
2025-11-15 23:01:21,661 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:21,662 INFO: เติม 2025-11-15 21:00 → +0
2025-11-15 23:01:23,380 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 23:01:23,381 INFO: เติม 2025-11-15 22:00 → +1
2025-11-15 23:01:24,381 INFO: เติมข้อมูลย้อนหลังเสร็จ: +1 แถว
2025-11-15 23:01:24,381 INFO: เติมข้อมูลย้อนหลัง: +1 แถว
2025-11-15 23:01:24,385 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 50 แถว
2025-11-15 23:01:24,387 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 23:01:24,390 INFO: รวมเก่า 49 + ใหม่ 50 → 50 (เพิ่ม 1)
2025-11-15 23:01:24,391 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 23:01:24,391 INFO: Format สำเร็จ: เพิ่ม 1 แถว
2025-11-15 23:01:24,403 INFO: เริ่ม clean ข้อมูล: 50 แถว
2025-11-15 23:01:24,414 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (50 แถว)
2025-11-15 23:01:24,418 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-15 23:00:00          56.7           22.0       0.5 180.5       27.4    48.0     1014.7
2025-11-15 22:00:00          53.0           22.0       0.4 162.5       27.8    45.2     1014.5
2025-11-15 21:00:00          52.4           16.9       0.3 134.5       27.7    43.7     1014.2
2025-11-15 20:00:00          44.1           13.4       0.4 135.4       28.3    41.2     1013.5
2025-11-15 19:00:00          45.4           16.8       0.5 168.3       29.2    36.9     1012.7
2025-11-15 18:00:00          37.2           14.4       1.0 177.0       29.9    33.7     1012.1
2025-11-15 17:00:00          40.1            9.8       1.0 179.4       30.6    31.5     1011.5
2025-11-15 16:00:00          42.3           12.0       1.5 186.1       31.0    30.5     1011.5
2025-11-15 15:00:00          47.1           12.4       1.1 171.7       31.4    29.0     1011.8
2025-11-15 14:00:00          48.2           17.8       1.3 155.1       30.9    32.3     1012.5
2025-11-15 23:01:24,419 INFO: Clean สำเร็จ
2025-11-15 23:01:24,445 INFO: เตรียมโหลด 50 แถว
2025-11-15 23:01:24,450 WARNING: Run time of job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" was missed by 0:02:47.619987
2025-11-15 23:01:24,543 ERROR: Load ล้มเหลว: [WinError 1314] A required privilege is not held by the client: '2025-11-15.csv' -> 'data\\backups\\latest.csv'
2025-11-15 23:03:35,225 INFO: หยุดด้วย Ctrl+C
2025-11-15 23:03:36,444 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:03:36,446 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:03:36,447 INFO: Scheduler started
2025-11-15 23:03:36,447 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:03:36,447 INFO: === PIPELINE START ===
2025-11-15 23:03:37,218 INFO: ดึง 2025-11-15 22:00:00+07:00 - 2025-11-15 23:00:00+07:00 → 2 แถว
2025-11-15 23:03:37,224 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:37,224 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 23:03:37,227 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:03:37,228 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:03:37,974 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:37,974 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 23:03:39,680 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:39,681 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 23:03:41,378 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:41,378 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 23:03:43,083 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:43,084 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 23:03:44,769 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:44,770 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 23:03:46,487 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:46,488 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 23:03:48,219 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:48,220 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 23:03:49,456 INFO: หยุดด้วย Ctrl+C
2025-11-15 23:03:49,469 ERROR: Error running job run_pipeline
Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
               ^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\util\ssl_.py", line 458, in ssl_wrap_socket
    context.load_verify_locations(ca_certs, ca_cert_dir, ca_cert_data)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\asyncio.py", line 35, in callback
    events = f.result()
             ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 161, in run_coroutine_job
    async def run_coroutine_job(job, jobstore_alias, run_times, logger_name):
asyncio.exceptions.CancelledError
2025-11-15 23:03:49,498 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:22> exception=SystemExit(0)>
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
               ^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\util\ssl_.py", line 458, in ssl_wrap_socket
    context.load_verify_locations(ca_certs, ca_cert_dir, ca_cert_data)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0
2025-11-15 23:03:55,713 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:03:55,715 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:03:55,715 INFO: Scheduler started
2025-11-15 23:03:55,715 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:03:55,716 INFO: === PIPELINE START ===
2025-11-15 23:03:56,413 INFO: ดึง 2025-11-15 22:00:00+07:00 - 2025-11-15 23:00:00+07:00 → 2 แถว
2025-11-15 23:03:56,422 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:56,422 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 23:03:56,427 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:03:56,427 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:03:56,653 INFO: หยุดด้วย Ctrl+C
2025-11-15 23:03:56,665 ERROR: Error running job run_pipeline
Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
               ^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\util\ssl_.py", line 458, in ssl_wrap_socket
    context.load_verify_locations(ca_certs, ca_cert_dir, ca_cert_data)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\asyncio.py", line 35, in callback
    events = f.result()
             ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 161, in run_coroutine_job
    async def run_coroutine_job(job, jobstore_alias, run_times, logger_name):
asyncio.exceptions.CancelledError
2025-11-15 23:03:56,689 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:22> exception=SystemExit(0)>
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
               ^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\util\ssl_.py", line 458, in ssl_wrap_socket
    context.load_verify_locations(ca_certs, ca_cert_dir, ca_cert_data)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0
2025-11-15 23:04:00,552 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:04:00,554 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:04:00,554 INFO: Scheduler started
2025-11-15 23:04:00,555 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:04:00,555 INFO: === PIPELINE START ===
2025-11-15 23:04:01,275 INFO: ดึง 2025-11-15 22:00:00+07:00 - 2025-11-15 23:00:00+07:00 → 2 แถว
2025-11-15 23:04:01,280 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:01,281 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 23:04:01,285 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:04:01,285 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:04:01,985 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:01,986 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 23:04:03,665 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:03,665 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 23:04:05,349 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:05,350 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 23:04:07,055 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:07,056 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 23:04:08,765 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:08,765 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 23:04:10,646 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:10,646 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 23:04:12,339 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:12,340 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 23:04:14,065 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:14,065 INFO: เติม 2025-11-14 06:00 → +0
2025-11-15 23:04:15,797 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:15,797 INFO: เติม 2025-11-14 07:00 → +0
2025-11-15 23:04:17,621 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:17,622 INFO: เติม 2025-11-14 08:00 → +0
2025-11-15 23:04:19,359 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:19,360 INFO: เติม 2025-11-14 09:00 → +0
2025-11-15 23:04:21,100 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:21,101 INFO: เติม 2025-11-14 10:00 → +0
2025-11-15 23:04:22,837 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:22,838 INFO: เติม 2025-11-14 11:00 → +0
2025-11-15 23:04:24,552 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:24,552 INFO: เติม 2025-11-14 12:00 → +0
2025-11-15 23:04:26,263 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:26,263 INFO: เติม 2025-11-14 13:00 → +0
2025-11-15 23:04:27,991 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:27,991 INFO: เติม 2025-11-14 14:00 → +0
2025-11-15 23:04:29,723 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:29,724 INFO: เติม 2025-11-14 15:00 → +0
2025-11-15 23:04:31,425 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:31,425 INFO: เติม 2025-11-14 16:00 → +0
2025-11-15 23:04:33,114 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:33,114 INFO: เติม 2025-11-14 17:00 → +0
2025-11-15 23:04:34,838 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:34,839 INFO: เติม 2025-11-14 18:00 → +0
2025-11-15 23:04:36,518 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:36,518 INFO: เติม 2025-11-14 19:00 → +0
2025-11-15 23:04:38,212 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:38,212 INFO: เติม 2025-11-14 20:00 → +0
2025-11-15 23:04:39,907 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:39,908 INFO: เติม 2025-11-14 21:00 → +0
2025-11-15 23:04:41,600 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:41,601 INFO: เติม 2025-11-14 22:00 → +0
2025-11-15 23:04:43,584 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:43,584 INFO: เติม 2025-11-14 23:00 → +0
2025-11-15 23:04:45,337 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:45,337 INFO: เติม 2025-11-15 00:00 → +0
2025-11-15 23:04:47,121 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:47,122 INFO: เติม 2025-11-15 01:00 → +0
2025-11-15 23:04:48,963 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:48,963 INFO: เติม 2025-11-15 02:00 → +0
2025-11-15 23:04:50,711 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:50,712 INFO: เติม 2025-11-15 03:00 → +0
2025-11-15 23:04:52,465 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:52,466 INFO: เติม 2025-11-15 04:00 → +0
2025-11-15 23:04:54,239 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:54,241 INFO: เติม 2025-11-15 05:00 → +0
2025-11-15 23:04:55,935 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:55,936 INFO: เติม 2025-11-15 06:00 → +0
2025-11-15 23:04:57,615 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:57,617 INFO: เติม 2025-11-15 07:00 → +0
2025-11-15 23:04:59,343 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:59,344 INFO: เติม 2025-11-15 08:00 → +0
2025-11-15 23:05:01,092 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:01,092 INFO: เติม 2025-11-15 09:00 → +0
2025-11-15 23:05:02,909 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:02,909 INFO: เติม 2025-11-15 10:00 → +0
2025-11-15 23:05:04,892 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:04,894 INFO: เติม 2025-11-15 11:00 → +0
2025-11-15 23:05:06,832 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:06,832 INFO: เติม 2025-11-15 12:00 → +0
2025-11-15 23:05:08,919 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:08,920 INFO: เติม 2025-11-15 13:00 → +0
2025-11-15 23:05:11,253 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:11,253 INFO: เติม 2025-11-15 14:00 → +0
2025-11-15 23:05:13,009 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:13,009 INFO: เติม 2025-11-15 15:00 → +0
2025-11-15 23:05:15,313 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:15,314 INFO: เติม 2025-11-15 16:00 → +0
2025-11-15 23:05:17,455 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:17,456 INFO: เติม 2025-11-15 17:00 → +0
2025-11-15 23:05:19,900 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:19,900 INFO: เติม 2025-11-15 18:00 → +0
2025-11-15 23:05:22,484 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:22,485 INFO: เติม 2025-11-15 19:00 → +0
2025-11-15 23:05:25,042 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:25,043 INFO: เติม 2025-11-15 20:00 → +0
2025-11-15 23:05:27,383 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:27,383 INFO: เติม 2025-11-15 21:00 → +0
2025-11-15 23:05:29,847 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:29,847 INFO: เติม 2025-11-15 22:00 → +0
2025-11-15 23:05:30,848 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-15 23:05:30,848 INFO: Fetch สำเร็จ
2025-11-15 23:05:30,852 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:05:30,852 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:05:32,220 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:32,221 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 23:05:35,404 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:35,405 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 23:05:40,992 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:40,993 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 23:05:43,149 INFO: หยุดด้วย Ctrl+C
2025-11-15 23:05:43,177 ERROR: Error running job run_pipeline
Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 30, in run_pipeline
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in send
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in <listcomp>
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 265, in resolve_redirects
    resp = self.send(
           ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 565, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1378, in getresponse
    response.begin()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1311, in recv_into
    return self.read(nbytes, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1167, in read
    return self._sslobj.read(len, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\asyncio.py", line 35, in callback
    events = f.result()
             ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 161, in run_coroutine_job
    async def run_coroutine_job(job, jobstore_alias, run_times, logger_name):
asyncio.exceptions.CancelledError
2025-11-15 23:05:43,181 WARNING: Run time of job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-16 00:05:00 +07)" was missed by 0:00:43.181800
2025-11-15 23:05:43,241 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:22> exception=SystemExit(0)>
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 30, in run_pipeline
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in send
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in <listcomp>
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 265, in resolve_redirects
    resp = self.send(
           ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 565, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1378, in getresponse
    response.begin()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1311, in recv_into
    return self.read(nbytes, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1167, in read
    return self._sslobj.read(len, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0
2025-11-15 23:05:46,351 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:05:46,355 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:05:46,355 INFO: Scheduler started
2025-11-15 23:05:46,355 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:05:46,355 INFO: === PIPELINE START ===
2025-11-15 23:05:48,049 INFO: ดึง 2025-11-15 22:00:00+07:00 - 2025-11-15 23:00:00+07:00 → 2 แถว
2025-11-15 23:05:48,059 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:48,060 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 23:05:48,068 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:05:48,068 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:05:49,895 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:49,895 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 23:05:52,674 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:52,674 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 23:05:55,133 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:55,134 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 23:05:57,722 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:57,723 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 23:06:01,062 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:01,062 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 23:06:03,325 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:03,327 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 23:06:06,780 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:06,781 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 23:06:09,351 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:09,352 INFO: เติม 2025-11-14 06:00 → +0
2025-11-15 23:06:11,910 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:11,911 INFO: เติม 2025-11-14 07:00 → +0
2025-11-15 23:06:13,859 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:13,859 INFO: เติม 2025-11-14 08:00 → +0
2025-11-15 23:06:16,115 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:16,116 INFO: เติม 2025-11-14 09:00 → +0
2025-11-15 23:06:18,851 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:18,851 INFO: เติม 2025-11-14 10:00 → +0
2025-11-15 23:06:21,760 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:21,761 INFO: เติม 2025-11-14 11:00 → +0
2025-11-15 23:06:23,865 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:23,865 INFO: เติม 2025-11-14 12:00 → +0
2025-11-15 23:06:26,225 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:26,226 INFO: เติม 2025-11-14 13:00 → +0
2025-11-15 23:06:28,174 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:28,174 INFO: เติม 2025-11-14 14:00 → +0
2025-11-15 23:06:30,411 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:30,412 INFO: เติม 2025-11-14 15:00 → +0
2025-11-15 23:06:32,413 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:32,414 INFO: เติม 2025-11-14 16:00 → +0
2025-11-15 23:06:34,385 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:34,386 INFO: เติม 2025-11-14 17:00 → +0
2025-11-15 23:06:36,614 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:36,614 INFO: เติม 2025-11-14 18:00 → +0
2025-11-15 23:06:38,760 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:38,761 INFO: เติม 2025-11-14 19:00 → +0
2025-11-15 23:06:40,725 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:40,725 INFO: เติม 2025-11-14 20:00 → +0
2025-11-15 23:06:42,866 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:42,867 INFO: เติม 2025-11-14 21:00 → +0
2025-11-15 23:06:45,073 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:45,073 INFO: เติม 2025-11-14 22:00 → +0
2025-11-15 23:06:46,929 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:46,930 INFO: เติม 2025-11-14 23:00 → +0
2025-11-15 23:06:48,782 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:48,782 INFO: เติม 2025-11-15 00:00 → +0
2025-11-15 23:06:50,756 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:50,757 INFO: เติม 2025-11-15 01:00 → +0
2025-11-15 23:06:52,934 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:52,935 INFO: เติม 2025-11-15 02:00 → +0
2025-11-15 23:06:54,685 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:54,685 INFO: เติม 2025-11-15 03:00 → +0
2025-11-15 23:06:56,570 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:56,570 INFO: เติม 2025-11-15 04:00 → +0
2025-11-15 23:06:58,388 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:58,388 INFO: เติม 2025-11-15 05:00 → +0
2025-11-15 23:07:00,523 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:00,524 INFO: เติม 2025-11-15 06:00 → +0
2025-11-15 23:07:02,243 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:02,244 INFO: เติม 2025-11-15 07:00 → +0
2025-11-15 23:07:04,039 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:04,039 INFO: เติม 2025-11-15 08:00 → +0
2025-11-15 23:07:05,773 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:05,773 INFO: เติม 2025-11-15 09:00 → +0
2025-11-15 23:07:07,458 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:07,458 INFO: เติม 2025-11-15 10:00 → +0
2025-11-15 23:07:09,187 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:09,188 INFO: เติม 2025-11-15 11:00 → +0
2025-11-15 23:07:10,893 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:10,893 INFO: เติม 2025-11-15 12:00 → +0
2025-11-15 23:07:12,632 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:12,633 INFO: เติม 2025-11-15 13:00 → +0
2025-11-15 23:07:14,389 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:14,389 INFO: เติม 2025-11-15 14:00 → +0
2025-11-15 23:07:16,232 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:16,232 INFO: เติม 2025-11-15 15:00 → +0
2025-11-15 23:07:17,949 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:17,949 INFO: เติม 2025-11-15 16:00 → +0
2025-11-15 23:07:19,656 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:19,656 INFO: เติม 2025-11-15 17:00 → +0
2025-11-15 23:07:21,375 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:21,375 INFO: เติม 2025-11-15 18:00 → +0
2025-11-15 23:07:23,068 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:23,069 INFO: เติม 2025-11-15 19:00 → +0
2025-11-15 23:07:24,832 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:24,832 INFO: เติม 2025-11-15 20:00 → +0
2025-11-15 23:07:26,547 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:26,548 INFO: เติม 2025-11-15 21:00 → +0
2025-11-15 23:07:28,304 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:28,304 INFO: เติม 2025-11-15 22:00 → +0
2025-11-15 23:07:29,305 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-15 23:07:29,305 INFO: Fetch สำเร็จ
2025-11-15 23:07:29,307 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:07:29,307 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:07:30,021 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:30,021 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 23:07:31,787 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:31,788 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 23:07:33,629 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:33,630 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 23:07:35,451 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:35,451 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 23:07:37,183 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:37,184 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 23:07:37,489 INFO: หยุดด้วย Ctrl+C
2025-11-15 23:07:37,521 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:32> exception=SystemExit(0)>
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 41, in run_pipeline
    added = fill_missing_hours(lookback_hours=48)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 224, in fill_missing_hours
    time.sleep(1)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0
2025-11-15 23:22:29,297 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:22:29,299 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:22:29,299 INFO: Scheduler started
2025-11-15 23:22:29,299 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:22:29,299 INFO: === PIPELINE START ===
2025-11-15 23:22:29,299 ERROR: Fetch/Fill ล้มเหลว: 
2025-11-15 23:25:19,629 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:25:19,630 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:25:19,630 INFO: Scheduler started
2025-11-15 23:25:19,631 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:25:19,631 INFO: === PIPELINE START ===
2025-11-15 23:25:19,631 ERROR: Fetch/Fill ล้มเหลว: 
2025-11-15 23:30:12,122 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:30:12,123 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:30:12,123 INFO: Scheduler started
2025-11-15 23:30:12,124 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:30:12,124 INFO: === PIPELINE START ===
2025-11-15 23:30:12,124 ERROR: Fetch/Fill ล้มเหลว: NotImplementedError: 
2025-11-15 23:30:12,124 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:32> exception=NameError("name 'traceback' is not defined")>
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 39, in run_pipeline
    setup_signal_handlers()
  File "C:\Pm2_5\tasks\fetch_api.py", line 26, in setup_signal_handlers
    loop.add_signal_handler(sig, lambda: shutdown_event.set())
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 574, in add_signal_handler
    raise NotImplementedError
NotImplementedError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 51, in run_pipeline
    logging.error(f"Traceback:\n{traceback.format_exc()}")
                                 ^^^^^^^^^
NameError: name 'traceback' is not defined
2025-11-15 23:30:43,309 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:30:43,311 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:30:43,311 INFO: Scheduler started
2025-11-15 23:30:43,312 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:30:43,312 INFO: === PIPELINE START ===
2025-11-15 23:30:43,312 ERROR: Fetch/Fill ล้มเหลว: NotImplementedError: 
2025-11-15 23:30:43,314 ERROR: Traceback:
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 40, in run_pipeline
    setup_signal_handlers()
  File "C:\Pm2_5\tasks\fetch_api.py", line 26, in setup_signal_handlers
    loop.add_signal_handler(sig, lambda: shutdown_event.set())
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 574, in add_signal_handler
    raise NotImplementedError
NotImplementedError

2025-11-15 23:48:09,012 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:48:09,013 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:48:09,014 INFO: Scheduler started
2025-11-15 23:48:09,014 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:48:09,014 INFO: === PIPELINE START ===
2025-11-15 23:48:09,014 INFO: ตั้งค่า signal handler สำเร็จ (Windows/Linux)
2025-11-15 23:48:09,014 INFO: ตั้งค่า signal handler สำเร็จ (Windows/Linux)
2025-11-15 23:48:10,243 INFO: ดึง 2025-11-15 22:00:00+07:00 - 2025-11-15 23:00:00+07:00 → 2 แถว
2025-11-15 23:48:10,249 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:48:10,249 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 23:48:10,249 ERROR: ดึงข้อมูลล้มเหลว
Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 262, in main
    asyncio.run(fill_missing_hours(lookback_hours=48))
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 186, in run
    raise RuntimeError(
RuntimeError: asyncio.run() cannot be called from a running event loop
2025-11-15 23:48:10,250 ERROR: Fetch/Fill ล้มเหลว: RuntimeError: asyncio.run() cannot be called from a running event loop
2025-11-15 23:48:10,250 ERROR: Traceback:
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 43, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 262, in main
    asyncio.run(fill_missing_hours(lookback_hours=48))
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 186, in run
    raise RuntimeError(
RuntimeError: asyncio.run() cannot be called from a running event loop

2025-11-15 23:55:22,306 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:58:57,980 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:00,372 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:01,459 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:01,567 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:01,785 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:01,893 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,002 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,220 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,328 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,437 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,546 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,764 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,872 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,980 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:03,199 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:03,308 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:03,416 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:05:00,014 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-16 01:05:00 +07)" (scheduled at 2025-11-16 00:05:00+07:00)
2025-11-16 00:05:00,016 INFO: === PIPELINE START ===
2025-11-16 00:05:00,016 INFO: ตั้งค่า signal handler สำเร็จ (Windows/Linux)
2025-11-16 00:05:00,016 INFO: ตั้งค่า signal handler สำเร็จ (Windows/Linux)
2025-11-16 00:05:01,125 INFO: ดึง 2025-11-15 23:00:00+07:00 - 2025-11-16 00:00:00+07:00 → 2 แถว
2025-11-16 00:05:01,133 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 00:05:01,133 INFO: สำเร็จ: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-16 00:05:01,133 ERROR: ดึงข้อมูลล้มเหลว
Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 262, in main
    # ห้าม asyncio.run() ที่นี่!
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 186, in run
    raise RuntimeError(
RuntimeError: asyncio.run() cannot be called from a running event loop
2025-11-16 00:05:01,148 ERROR: Fetch/Fill ล้มเหลว: RuntimeError: asyncio.run() cannot be called from a running event loop
2025-11-16 00:05:01,150 ERROR: Traceback:
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 43, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 262, in main
    # ห้าม asyncio.run() ที่นี่!
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 186, in run
    raise RuntimeError(
RuntimeError: asyncio.run() cannot be called from a running event loop

2025-11-16 00:05:01,151 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-16 01:05:00 +07)" executed successfully
2025-11-16 00:22:02,312 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:05,683 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:05,898 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:06,877 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:07,096 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:07,204 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:07,312 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:07,418 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:12,007 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:12,658 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:12,877 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:12,987 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,206 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,315 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,423 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,642 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,751 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,859 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,968 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:54,304 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:54,851 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:54,959 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:55,178 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:55,287 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:55,396 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:55,942 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:56,051 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:56,160 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:56,270 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:56,379 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:56,487 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:56,596 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:41,219 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:41,652 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:41,760 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:41,869 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:42,087 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:42,196 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:42,303 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:42,522 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:42,631 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,175 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,285 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,393 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,501 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,612 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,721 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,828 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,938 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:44,046 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:44,155 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:44,265 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:44,374 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:44,483 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:44,592 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:07:20,226 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:07:20,227 INFO: ตั้งค่า signal handler สำเร็จ (Windows/Linux)
2025-11-16 01:07:20,228 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:07:20,228 INFO: Scheduler started
2025-11-16 01:07:20,228 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:07:20,228 INFO: === PIPELINE START ===
2025-11-16 01:07:20,229 INFO: ตั้งค่า signal handler สำเร็จ (Windows/Linux)
2025-11-16 01:07:20,984 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:07:20,994 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 01:07:20,994 INFO: สำเร็จ: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-16 01:07:20,994 INFO: Fetch สำเร็จ
2025-11-16 01:07:21,018 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:07:21,739 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:21,740 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:07:23,457 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:23,458 INFO: เติม 2025-11-14 02:00 → +0
2025-11-16 01:07:25,166 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:25,166 INFO: เติม 2025-11-14 03:00 → +0
2025-11-16 01:07:26,927 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:26,927 INFO: เติม 2025-11-14 04:00 → +0
2025-11-16 01:07:28,678 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:28,678 INFO: เติม 2025-11-14 05:00 → +0
2025-11-16 01:07:30,396 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:30,396 INFO: เติม 2025-11-14 06:00 → +0
2025-11-16 01:07:32,095 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:32,096 INFO: เติม 2025-11-14 07:00 → +0
2025-11-16 01:07:33,906 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:07:33,911 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:33,911 INFO: เติม 2025-11-14 08:00 → +0
2025-11-16 01:07:33,911 INFO: หยุด fill_missing_hours เนื่องจาก Ctrl+C
2025-11-16 01:07:33,911 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-16 01:07:33,911 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-16 01:07:33,912 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 52 แถว
2025-11-16 01:07:33,913 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-16 01:07:33,915 INFO: รวมเก่า 50 + ใหม่ 52 → 52 (เพิ่ม 2)
2025-11-16 01:07:33,916 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-16 01:07:33,916 INFO: Format สำเร็จ: +2 แถว
2025-11-16 01:07:33,932 INFO: อ่าน formatted: 52 แถว
2025-11-16 01:07:33,932 INFO: เริ่ม clean ข้อมูล: 52 แถว
2025-11-16 01:07:33,942 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (52 แถว)
2025-11-16 01:07:33,945 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-16 01:00:00          49.5      22.500000       0.2  90.4       25.6    58.4     1013.9
2025-11-16 00:00:00          56.1      22.333333       0.3 172.8       26.7    51.8     1014.6
2025-11-15 23:00:00          56.7      22.166667       0.5 180.5       27.4    48.0     1014.7
2025-11-15 22:00:00          53.0      22.000000       0.4 162.5       27.8    45.2     1014.5
2025-11-15 21:00:00          52.4      16.900000       0.3 134.5       27.7    43.7     1014.2
2025-11-15 20:00:00          44.1      13.400000       0.4 135.4       28.3    41.2     1013.5
2025-11-15 19:00:00          45.4      16.800000       0.5 168.3       29.2    36.9     1012.7
2025-11-15 18:00:00          37.2      14.400000       1.0 177.0       29.9    33.7     1012.1
2025-11-15 17:00:00          40.1       9.800000       1.0 179.4       30.6    31.5     1011.5
2025-11-15 16:00:00          42.3      12.000000       1.5 186.1       31.0    30.5     1011.5
2025-11-16 01:07:33,946 INFO: Clean สำเร็จ: 52 แถว
2025-11-16 01:07:33,976 INFO: เตรียมโหลด 52 แถว
2025-11-16 01:07:34,084 INFO: โหลด DB สำเร็จ
2025-11-16 01:07:34,086 INFO: Backup สำเร็จ: data\backups\2025-11-16.csv
2025-11-16 01:07:34,088 INFO: อัพเดท latest.csv สำเร็จ
2025-11-16 01:07:34,088 INFO: Load to DB + Backup สำเร็จ
2025-11-16 01:07:34,088 INFO: === PIPELINE END ===
2025-11-16 01:07:54,975 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:08:01,069 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:10,914 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:11,569 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:11,672 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:11,895 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:11,999 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:12,108 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:12,327 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:12,429 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:12,536 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:12,749 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:12,857 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:19:01,859 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:19:01,860 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:19:01,861 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:19:01,861 INFO: Scheduler started
2025-11-16 01:19:01,861 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:19:01,861 INFO: === PIPELINE START ===
2025-11-16 01:19:01,862 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:19:02,573 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:19:02,575 ERROR: ดึงข้อมูลล้มเหลว
Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 289, in main
    added = append_to_master_no_dup(df_new)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 125, in append_to_master_no_dup
    lock = FileLock(LOCK_FILE)
           ^^^^^^^^
NameError: name 'FileLock' is not defined
2025-11-16 01:19:02,575 ERROR: Fetch/Fill ล้มเหลว: NameError: name 'FileLock' is not defined
2025-11-16 01:19:02,576 ERROR: Traceback:
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 39, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 289, in main
    added = append_to_master_no_dup(df_new)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 125, in append_to_master_no_dup
    lock = FileLock(LOCK_FILE)
           ^^^^^^^^
NameError: name 'FileLock' is not defined

2025-11-16 01:19:30,664 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:19:30,665 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:19:30,665 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:19:30,665 INFO: Scheduler started
2025-11-16 01:19:30,665 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:19:30,665 INFO: === PIPELINE START ===
2025-11-16 01:19:30,665 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:19:31,348 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:19:31,355 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:31,355 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-16 01:19:31,355 INFO: Fetch สำเร็จ
2025-11-16 01:19:31,364 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:19:32,026 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:32,027 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:19:33,693 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:33,693 INFO: เติม 2025-11-14 02:00 → +0
2025-11-16 01:19:35,411 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:35,411 INFO: เติม 2025-11-14 03:00 → +0
2025-11-16 01:19:37,113 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:37,114 INFO: เติม 2025-11-14 04:00 → +0
2025-11-16 01:19:38,789 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:38,790 INFO: เติม 2025-11-14 05:00 → +0
2025-11-16 01:19:40,489 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:40,489 INFO: เติม 2025-11-14 06:00 → +0
2025-11-16 01:19:42,180 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:42,180 INFO: เติม 2025-11-14 07:00 → +0
2025-11-16 01:19:43,905 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:43,906 INFO: เติม 2025-11-14 08:00 → +0
2025-11-16 01:19:45,572 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:45,572 INFO: เติม 2025-11-14 09:00 → +0
2025-11-16 01:19:47,260 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:47,260 INFO: เติม 2025-11-14 10:00 → +0
2025-11-16 01:19:48,992 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:48,992 INFO: เติม 2025-11-14 11:00 → +0
2025-11-16 01:19:50,696 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:50,698 INFO: เติม 2025-11-14 12:00 → +0
2025-11-16 01:19:52,481 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:52,481 INFO: เติม 2025-11-14 13:00 → +0
2025-11-16 01:19:54,187 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:54,187 INFO: เติม 2025-11-14 14:00 → +0
2025-11-16 01:19:55,864 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:55,864 INFO: เติม 2025-11-14 15:00 → +0
2025-11-16 01:19:57,566 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:57,567 INFO: เติม 2025-11-14 16:00 → +0
2025-11-16 01:19:59,262 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:59,263 INFO: เติม 2025-11-14 17:00 → +0
2025-11-16 01:20:00,985 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:00,987 INFO: เติม 2025-11-14 18:00 → +0
2025-11-16 01:20:02,692 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:02,692 INFO: เติม 2025-11-14 19:00 → +0
2025-11-16 01:20:04,380 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:04,380 INFO: เติม 2025-11-14 20:00 → +0
2025-11-16 01:20:06,053 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:06,054 INFO: เติม 2025-11-14 21:00 → +0
2025-11-16 01:20:07,762 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:07,762 INFO: เติม 2025-11-14 22:00 → +0
2025-11-16 01:20:09,426 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:09,427 INFO: เติม 2025-11-14 23:00 → +0
2025-11-16 01:20:11,146 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:11,146 INFO: เติม 2025-11-15 00:00 → +0
2025-11-16 01:20:12,825 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:12,826 INFO: เติม 2025-11-15 01:00 → +0
2025-11-16 01:20:14,556 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:14,556 INFO: เติม 2025-11-15 02:00 → +0
2025-11-16 01:20:16,226 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:16,227 INFO: เติม 2025-11-15 03:00 → +0
2025-11-16 01:20:17,922 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:17,922 INFO: เติม 2025-11-15 04:00 → +0
2025-11-16 01:20:19,657 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:19,658 INFO: เติม 2025-11-15 05:00 → +0
2025-11-16 01:20:21,337 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:21,337 INFO: เติม 2025-11-15 06:00 → +0
2025-11-16 01:27:33,992 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:27:33,992 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:27:33,996 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:27:33,996 INFO: Scheduler started
2025-11-16 01:27:33,996 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:27:33,996 INFO: === PIPELINE START ===
2025-11-16 01:27:33,996 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:27:34,718 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:27:34,729 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:34,730 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-16 01:27:34,730 INFO: Fetch สำเร็จ
2025-11-16 01:27:34,740 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:27:35,561 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:35,563 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:27:37,325 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:37,326 INFO: เติม 2025-11-14 02:00 → +0
2025-11-16 01:27:39,064 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:39,065 INFO: เติม 2025-11-14 03:00 → +0
2025-11-16 01:27:40,824 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:40,824 INFO: เติม 2025-11-14 04:00 → +0
2025-11-16 01:27:42,544 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:42,544 INFO: เติม 2025-11-14 05:00 → +0
2025-11-16 01:27:44,277 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:44,277 INFO: เติม 2025-11-14 06:00 → +0
2025-11-16 01:27:46,012 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:46,012 INFO: เติม 2025-11-14 07:00 → +0
2025-11-16 01:27:47,748 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:47,748 INFO: เติม 2025-11-14 08:00 → +0
2025-11-16 01:27:49,510 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:49,512 INFO: เติม 2025-11-14 09:00 → +0
2025-11-16 01:27:51,289 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:51,290 INFO: เติม 2025-11-14 10:00 → +0
2025-11-16 01:27:53,000 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:53,002 INFO: เติม 2025-11-14 11:00 → +0
2025-11-16 01:27:54,738 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:54,739 INFO: เติม 2025-11-14 12:00 → +0
2025-11-16 01:27:56,482 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:56,482 INFO: เติม 2025-11-14 13:00 → +0
2025-11-16 01:27:58,214 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:58,215 INFO: เติม 2025-11-14 14:00 → +0
2025-11-16 01:27:59,935 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:59,935 INFO: เติม 2025-11-14 15:00 → +0
2025-11-16 01:28:01,629 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:01,630 INFO: เติม 2025-11-14 16:00 → +0
2025-11-16 01:28:03,347 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:03,347 INFO: เติม 2025-11-14 17:00 → +0
2025-11-16 01:28:05,034 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:05,034 INFO: เติม 2025-11-14 18:00 → +0
2025-11-16 01:28:06,759 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:06,760 INFO: เติม 2025-11-14 19:00 → +0
2025-11-16 01:28:08,500 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:08,500 INFO: เติม 2025-11-14 20:00 → +0
2025-11-16 01:28:10,195 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:10,195 INFO: เติม 2025-11-14 21:00 → +0
2025-11-16 01:28:11,890 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:11,891 INFO: เติม 2025-11-14 22:00 → +0
2025-11-16 01:28:13,592 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:13,593 INFO: เติม 2025-11-14 23:00 → +0
2025-11-16 01:28:15,303 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:15,304 INFO: เติม 2025-11-15 00:00 → +0
2025-11-16 01:28:17,099 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:17,099 INFO: เติม 2025-11-15 01:00 → +0
2025-11-16 01:28:18,804 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:18,805 INFO: เติม 2025-11-15 02:00 → +0
2025-11-16 01:28:20,555 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:20,555 INFO: เติม 2025-11-15 03:00 → +0
2025-11-16 01:28:22,264 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:22,264 INFO: เติม 2025-11-15 04:00 → +0
2025-11-16 01:28:23,966 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:23,967 INFO: เติม 2025-11-15 05:00 → +0
2025-11-16 01:28:25,715 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:25,716 INFO: เติม 2025-11-15 06:00 → +0
2025-11-16 01:28:27,443 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:27,444 INFO: เติม 2025-11-15 07:00 → +0
2025-11-16 01:28:29,104 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:29,105 INFO: เติม 2025-11-15 08:00 → +0
2025-11-16 01:28:30,784 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:30,785 INFO: เติม 2025-11-15 09:00 → +0
2025-11-16 01:28:32,504 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:32,505 INFO: เติม 2025-11-15 10:00 → +0
2025-11-16 01:28:34,218 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:34,219 INFO: เติม 2025-11-15 11:00 → +0
2025-11-16 01:28:35,900 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:35,902 INFO: เติม 2025-11-15 12:00 → +0
2025-11-16 01:28:37,588 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:37,589 INFO: เติม 2025-11-15 13:00 → +0
2025-11-16 01:28:39,317 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:39,317 INFO: เติม 2025-11-15 14:00 → +0
2025-11-16 01:28:40,995 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:40,995 INFO: เติม 2025-11-15 15:00 → +0
2025-11-16 01:28:42,678 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:42,678 INFO: เติม 2025-11-15 16:00 → +0
2025-11-16 01:28:44,705 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:28:44,706 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:44,706 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:28:44,707 INFO: Scheduler started
2025-11-16 01:28:44,707 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:28:44,707 INFO: === PIPELINE START ===
2025-11-16 01:28:44,707 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:45,403 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:28:45,409 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:45,410 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-16 01:28:45,410 INFO: Fetch สำเร็จ
2025-11-16 01:28:45,417 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:28:46,091 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:46,091 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:28:47,088 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:28:47,089 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:47,090 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:28:47,090 INFO: Scheduler started
2025-11-16 01:28:47,090 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:28:47,090 INFO: === PIPELINE START ===
2025-11-16 01:28:47,090 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:47,777 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:28:47,784 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:47,785 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-16 01:28:47,785 INFO: Fetch สำเร็จ
2025-11-16 01:28:47,792 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:28:48,486 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:48,487 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:28:49,580 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:28:49,582 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:49,582 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:28:49,583 INFO: Scheduler started
2025-11-16 01:28:49,583 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:28:49,583 INFO: === PIPELINE START ===
2025-11-16 01:28:49,583 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:50,287 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:28:50,295 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:50,296 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-16 01:28:50,296 INFO: Fetch สำเร็จ
2025-11-16 01:28:50,301 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:28:51,042 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:51,042 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:28:52,023 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:28:52,024 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:52,025 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:28:52,025 INFO: Scheduler started
2025-11-16 01:28:52,025 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:28:52,025 INFO: === PIPELINE START ===
2025-11-16 01:28:52,026 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:52,695 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:28:52,704 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:52,704 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-16 01:28:52,705 INFO: Fetch สำเร็จ
2025-11-16 01:28:52,711 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:28:53,388 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:53,388 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:28:55,126 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:55,127 INFO: เติม 2025-11-14 02:00 → +0
2025-11-16 01:28:56,830 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:56,830 INFO: เติม 2025-11-14 03:00 → +0
2025-11-16 01:28:58,548 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:58,549 INFO: เติม 2025-11-14 04:00 → +0
2025-11-16 01:29:00,226 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:00,227 INFO: เติม 2025-11-14 05:00 → +0
2025-11-16 01:29:01,922 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:01,923 INFO: เติม 2025-11-14 06:00 → +0
2025-11-16 01:29:03,684 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:03,685 INFO: เติม 2025-11-14 07:00 → +0
2025-11-16 01:29:05,352 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:05,353 INFO: เติม 2025-11-14 08:00 → +0
2025-11-16 01:29:07,038 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:07,038 INFO: เติม 2025-11-14 09:00 → +0
2025-11-16 01:29:08,709 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:08,709 INFO: เติม 2025-11-14 10:00 → +0
2025-11-16 01:29:10,359 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:10,360 INFO: เติม 2025-11-14 11:00 → +0
2025-11-16 01:29:12,062 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:12,062 INFO: เติม 2025-11-14 12:00 → +0
2025-11-16 01:29:13,730 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:13,732 INFO: เติม 2025-11-14 13:00 → +0
2025-11-16 01:29:15,396 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:15,397 INFO: เติม 2025-11-14 14:00 → +0
2025-11-16 01:29:17,080 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:17,080 INFO: เติม 2025-11-14 15:00 → +0
2025-11-16 01:29:18,781 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:18,781 INFO: เติม 2025-11-14 16:00 → +0
2025-11-16 01:29:20,538 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:20,538 INFO: เติม 2025-11-14 17:00 → +0
2025-11-16 01:29:22,213 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:22,214 INFO: เติม 2025-11-14 18:00 → +0
2025-11-16 01:29:23,917 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:23,918 INFO: เติม 2025-11-14 19:00 → +0
2025-11-16 01:29:25,620 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:25,622 INFO: เติม 2025-11-14 20:00 → +0
2025-11-16 01:29:27,280 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:27,281 INFO: เติม 2025-11-14 21:00 → +0
2025-11-16 01:29:29,014 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:29,014 INFO: เติม 2025-11-14 22:00 → +0
2025-11-16 01:29:30,725 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:30,725 INFO: เติม 2025-11-14 23:00 → +0
2025-11-16 01:29:32,414 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:32,414 INFO: เติม 2025-11-15 00:00 → +0
2025-11-16 01:29:34,126 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:34,126 INFO: เติม 2025-11-15 01:00 → +0
2025-11-16 01:29:35,859 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:35,860 INFO: เติม 2025-11-15 02:00 → +0
2025-11-16 01:29:37,599 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:37,599 INFO: เติม 2025-11-15 03:00 → +0
2025-11-16 01:29:39,327 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:39,328 INFO: เติม 2025-11-15 04:00 → +0
2025-11-16 01:29:41,159 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:41,160 INFO: เติม 2025-11-15 05:00 → +0
2025-11-16 01:29:42,855 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:42,856 INFO: เติม 2025-11-15 06:00 → +0
2025-11-16 01:29:44,570 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:44,570 INFO: เติม 2025-11-15 07:00 → +0
2025-11-16 01:29:46,245 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:46,245 INFO: เติม 2025-11-15 08:00 → +0
2025-11-16 01:29:47,933 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:47,933 INFO: เติม 2025-11-15 09:00 → +0
2025-11-16 01:29:49,646 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:49,646 INFO: เติม 2025-11-15 10:00 → +0
2025-11-16 01:29:51,358 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:51,359 INFO: เติม 2025-11-15 11:00 → +0
2025-11-16 01:29:53,089 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:53,090 INFO: เติม 2025-11-15 12:00 → +0
2025-11-16 01:29:54,831 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:54,831 INFO: เติม 2025-11-15 13:00 → +0
2025-11-16 01:29:56,528 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:56,529 INFO: เติม 2025-11-15 14:00 → +0
2025-11-16 01:29:58,257 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:58,257 INFO: เติม 2025-11-15 15:00 → +0
2025-11-16 01:29:59,989 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:59,990 INFO: เติม 2025-11-15 16:00 → +0
2025-11-16 01:30:01,757 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:01,758 INFO: เติม 2025-11-15 17:00 → +0
2025-11-16 01:30:03,461 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:03,461 INFO: เติม 2025-11-15 18:00 → +0
2025-11-16 01:30:05,208 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:05,209 INFO: เติม 2025-11-15 19:00 → +0
2025-11-16 01:30:06,907 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:06,907 INFO: เติม 2025-11-15 20:00 → +0
2025-11-16 01:30:08,621 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:08,622 INFO: เติม 2025-11-15 21:00 → +0
2025-11-16 01:30:10,353 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:10,353 INFO: เติม 2025-11-15 22:00 → +0
2025-11-16 01:30:12,044 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:12,044 INFO: เติม 2025-11-15 23:00 → +0
2025-11-16 01:30:13,786 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:13,787 INFO: เติม 2025-11-16 00:00 → +0
2025-11-16 01:30:15,514 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:15,514 INFO: เติม 2025-11-16 01:00 → +0
2025-11-16 01:30:16,522 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-16 01:30:16,524 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-16 01:30:16,530 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 52 แถว
2025-11-16 01:30:16,532 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-16 01:30:16,535 INFO: รวมเก่า 52 + ใหม่ 52 → 52 (เพิ่ม 0)
2025-11-16 01:30:16,538 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-16 01:30:16,539 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-16 21:24:21,822 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 21:24:21,824 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 21:24:21,826 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 21:24:21,826 INFO: Scheduler started
2025-11-16 21:24:21,826 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 21:24:21,826 INFO: === PIPELINE START ===
2025-11-16 21:24:21,826 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 21:24:22,605 INFO: ดึง 2025-11-16 20:00:00+07:00 - 2025-11-16 21:00:00+07:00 → 2 แถว
2025-11-16 21:24:22,634 INFO: เพิ่ม 2 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:24:22,634 INFO: สำเร็จ: เพิ่ม 2 แถว (ปัจจุบัน)
2025-11-16 21:24:22,634 INFO: Fetch สำเร็จ
2025-11-16 21:24:22,663 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 21:24:23,384 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:23,385 INFO: เติม 2025-11-14 21:00 → +0
2025-11-16 21:24:25,065 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:25,065 INFO: เติม 2025-11-14 22:00 → +0
2025-11-16 21:24:26,750 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:26,750 INFO: เติม 2025-11-14 23:00 → +0
2025-11-16 21:24:28,450 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:28,451 INFO: เติม 2025-11-15 00:00 → +0
2025-11-16 21:24:30,216 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:30,217 INFO: เติม 2025-11-15 01:00 → +0
2025-11-16 21:24:31,938 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:31,939 INFO: เติม 2025-11-15 02:00 → +0
2025-11-16 21:24:33,612 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:33,613 INFO: เติม 2025-11-15 03:00 → +0
2025-11-16 21:24:35,376 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:35,376 INFO: เติม 2025-11-15 04:00 → +0
2025-11-16 21:24:37,116 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:37,116 INFO: เติม 2025-11-15 05:00 → +0
2025-11-16 21:24:38,884 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:38,884 INFO: เติม 2025-11-15 06:00 → +0
2025-11-16 21:24:40,580 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:40,580 INFO: เติม 2025-11-15 07:00 → +0
2025-11-16 21:24:42,313 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:42,314 INFO: เติม 2025-11-15 08:00 → +0
2025-11-16 21:24:43,983 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:43,983 INFO: เติม 2025-11-15 09:00 → +0
2025-11-16 21:24:45,769 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:45,769 INFO: เติม 2025-11-15 10:00 → +0
2025-11-16 21:24:47,482 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:47,482 INFO: เติม 2025-11-15 11:00 → +0
2025-11-16 21:24:49,181 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:49,181 INFO: เติม 2025-11-15 12:00 → +0
2025-11-16 21:24:50,917 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:50,917 INFO: เติม 2025-11-15 13:00 → +0
2025-11-16 21:24:52,657 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:52,657 INFO: เติม 2025-11-15 14:00 → +0
2025-11-16 21:24:54,376 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:54,376 INFO: เติม 2025-11-15 15:00 → +0
2025-11-16 21:24:56,103 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:56,104 INFO: เติม 2025-11-15 16:00 → +0
2025-11-16 21:24:57,846 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:57,846 INFO: เติม 2025-11-15 17:00 → +0
2025-11-16 21:24:59,538 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:59,538 INFO: เติม 2025-11-15 18:00 → +0
2025-11-16 21:25:01,283 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:01,284 INFO: เติม 2025-11-15 19:00 → +0
2025-11-16 21:25:03,013 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:03,013 INFO: เติม 2025-11-15 20:00 → +0
2025-11-16 21:25:04,757 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:04,759 INFO: เติม 2025-11-15 21:00 → +0
2025-11-16 21:25:06,467 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:06,469 INFO: เติม 2025-11-15 22:00 → +0
2025-11-16 21:25:08,217 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:08,217 INFO: เติม 2025-11-15 23:00 → +0
2025-11-16 21:25:09,880 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:09,880 INFO: เติม 2025-11-16 00:00 → +0
2025-11-16 21:25:11,550 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:11,551 INFO: เติม 2025-11-16 01:00 → +1
2025-11-16 21:25:13,250 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:13,251 INFO: เติม 2025-11-16 02:00 → +1
2025-11-16 21:25:15,006 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:15,006 INFO: เติม 2025-11-16 03:00 → +1
2025-11-16 21:25:16,728 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:16,729 INFO: เติม 2025-11-16 04:00 → +1
2025-11-16 21:25:18,483 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:18,483 INFO: เติม 2025-11-16 05:00 → +1
2025-11-16 21:25:20,309 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:20,309 INFO: เติม 2025-11-16 06:00 → +1
2025-11-16 21:25:22,021 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:22,022 INFO: เติม 2025-11-16 07:00 → +1
2025-11-16 21:25:23,757 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:23,757 INFO: เติม 2025-11-16 08:00 → +1
2025-11-16 21:25:25,475 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:25,476 INFO: เติม 2025-11-16 09:00 → +1
2025-11-16 21:25:27,219 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:27,219 INFO: เติม 2025-11-16 10:00 → +1
2025-11-16 21:25:28,932 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:28,933 INFO: เติม 2025-11-16 11:00 → +1
2025-11-16 21:25:30,686 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:30,686 INFO: เติม 2025-11-16 12:00 → +1
2025-11-16 21:25:32,429 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:32,429 INFO: เติม 2025-11-16 13:00 → +1
2025-11-16 21:25:34,164 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:34,165 INFO: เติม 2025-11-16 14:00 → +1
2025-11-16 21:25:35,917 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:35,918 INFO: เติม 2025-11-16 15:00 → +1
2025-11-16 21:25:37,642 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:37,643 INFO: เติม 2025-11-16 16:00 → +1
2025-11-16 21:25:39,375 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:39,375 INFO: เติม 2025-11-16 17:00 → +1
2025-11-16 21:25:41,104 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:41,105 INFO: เติม 2025-11-16 18:00 → +1
2025-11-16 21:25:42,857 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:42,857 INFO: เติม 2025-11-16 19:00 → +0
2025-11-16 21:25:44,584 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:44,585 INFO: เติม 2025-11-16 20:00 → +0
2025-11-16 21:25:46,272 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:46,272 INFO: เติม 2025-11-16 21:00 → +0
2025-11-16 21:25:47,284 INFO: เติมข้อมูลย้อนหลังเสร็จ: +18 แถว
2025-11-16 21:25:47,284 INFO: เติมข้อมูลย้อนหลัง: +18 แถว
2025-11-16 21:25:47,286 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 72 แถว
2025-11-16 21:25:47,287 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-16 21:25:47,304 INFO: รวมเก่า 52 + ใหม่ 72 → 72 (เพิ่ม 20)
2025-11-16 21:25:47,306 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-16 21:25:47,306 INFO: Format สำเร็จ: +20 แถว
2025-11-16 21:25:47,317 INFO: อ่าน formatted: 72 แถว
2025-11-16 21:25:47,317 INFO: เริ่ม clean ข้อมูล: 72 แถว
2025-11-16 21:25:47,329 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (72 แถว)
2025-11-16 21:25:47,333 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-16 21:00:00          43.7           10.1       1.1 191.5       29.1    53.4     1013.9
2025-11-16 20:00:00          38.7           15.5       0.6 194.1       29.9    50.3     1013.1
2025-11-16 19:00:00          35.1           13.1       0.9 192.1       30.5    47.6     1012.4
2025-11-16 18:00:00          36.0            9.4       0.9 188.1       30.9    46.3     1011.8
2025-11-16 17:00:00          35.9           10.9       1.1 177.7       31.6    42.8     1011.2
2025-11-16 16:00:00          34.9           12.6       0.8 160.1       32.2    40.3     1011.2
2025-11-16 15:00:00          32.7           12.3       0.9 175.1       32.3    40.1     1011.6
2025-11-16 14:00:00          28.5            4.4       1.0 172.7       31.9    41.3     1012.5
2025-11-16 13:00:00          36.1            6.6       1.0 170.4       31.3    42.5     1013.7
2025-11-16 12:00:00          37.1            6.1       1.0 169.6       30.5    44.0     1014.8
2025-11-16 21:25:47,333 INFO: Clean สำเร็จ: 72 แถว
2025-11-16 21:25:49,152 INFO: เตรียมโหลด 72 แถว
2025-11-16 21:25:49,336 INFO: โหลด DB สำเร็จ
2025-11-16 21:25:49,338 INFO: Backup สำเร็จ: data\backups\2025-11-16.csv
2025-11-16 21:25:49,340 INFO: อัพเดท latest.csv สำเร็จ
2025-11-16 21:25:49,341 INFO: Load to DB + Backup สำเร็จ
2025-11-16 21:25:49,341 INFO: === PIPELINE END ===
2025-11-16 22:05:00,008 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-16 23:05:00 +07)" (scheduled at 2025-11-16 22:05:00+07:00)
2025-11-16 22:05:00,009 INFO: === PIPELINE START ===
2025-11-16 22:05:00,009 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 22:05:00,765 INFO: ดึง 2025-11-16 21:00:00+07:00 - 2025-11-16 22:00:00+07:00 → 2 แถว
2025-11-16 22:05:00,769 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 22:05:00,769 INFO: สำเร็จ: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-16 22:05:00,770 INFO: Fetch สำเร็จ
2025-11-16 22:05:00,785 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 22:05:01,473 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:01,474 INFO: เติม 2025-11-14 22:00 → +0
2025-11-16 22:05:03,173 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:03,174 INFO: เติม 2025-11-14 23:00 → +0
2025-11-16 22:05:04,845 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:04,846 INFO: เติม 2025-11-15 00:00 → +0
2025-11-16 22:05:06,539 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:06,540 INFO: เติม 2025-11-15 01:00 → +0
2025-11-16 22:05:08,235 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:08,236 INFO: เติม 2025-11-15 02:00 → +0
2025-11-16 22:05:10,161 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:10,161 INFO: เติม 2025-11-15 03:00 → +0
2025-11-16 22:05:11,883 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:11,883 INFO: เติม 2025-11-15 04:00 → +0
2025-11-16 22:05:13,577 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:13,578 INFO: เติม 2025-11-15 05:00 → +0
2025-11-16 22:05:15,279 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:15,279 INFO: เติม 2025-11-15 06:00 → +0
2025-11-16 22:05:17,015 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:17,015 INFO: เติม 2025-11-15 07:00 → +0
2025-11-16 22:05:18,700 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:18,700 INFO: เติม 2025-11-15 08:00 → +0
2025-11-16 22:05:20,417 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:20,418 INFO: เติม 2025-11-15 09:00 → +0
2025-11-16 22:05:22,150 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:22,150 INFO: เติม 2025-11-15 10:00 → +0
2025-11-16 22:05:23,841 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:23,841 INFO: เติม 2025-11-15 11:00 → +0
2025-11-16 22:05:25,505 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:25,506 INFO: เติม 2025-11-15 12:00 → +0
2025-11-16 22:05:27,215 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:27,215 INFO: เติม 2025-11-15 13:00 → +0
2025-11-16 22:05:28,898 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:28,898 INFO: เติม 2025-11-15 14:00 → +0
2025-11-16 22:05:30,618 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:30,619 INFO: เติม 2025-11-15 15:00 → +0
2025-11-16 22:05:32,341 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:32,342 INFO: เติม 2025-11-15 16:00 → +0
2025-11-16 22:05:34,030 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:34,031 INFO: เติม 2025-11-15 17:00 → +0
2025-11-16 22:05:35,719 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:35,719 INFO: เติม 2025-11-15 18:00 → +0
2025-11-16 22:05:37,417 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:37,418 INFO: เติม 2025-11-15 19:00 → +0
2025-11-16 22:05:39,146 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:39,147 INFO: เติม 2025-11-15 20:00 → +0
2025-11-16 22:05:40,858 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:40,859 INFO: เติม 2025-11-15 21:00 → +0
2025-11-16 22:05:42,597 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:42,597 INFO: เติม 2025-11-15 22:00 → +0
2025-11-16 22:05:44,409 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:44,409 INFO: เติม 2025-11-15 23:00 → +0
2025-11-16 22:05:46,139 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:46,139 INFO: เติม 2025-11-16 00:00 → +0
2025-11-16 22:05:47,869 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:47,869 INFO: เติม 2025-11-16 01:00 → +0
2025-11-16 22:05:49,560 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:49,561 INFO: เติม 2025-11-16 02:00 → +0
2025-11-16 22:05:51,231 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:51,231 INFO: เติม 2025-11-16 03:00 → +0
2025-11-16 22:05:52,911 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:52,912 INFO: เติม 2025-11-16 04:00 → +0
2025-11-16 22:05:54,626 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:54,626 INFO: เติม 2025-11-16 05:00 → +0
2025-11-16 22:05:56,327 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:56,327 INFO: เติม 2025-11-16 06:00 → +0
2025-11-16 22:05:58,024 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:58,025 INFO: เติม 2025-11-16 07:00 → +0
2025-11-16 22:05:59,734 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:59,735 INFO: เติม 2025-11-16 08:00 → +0
2025-11-16 22:06:01,485 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:01,485 INFO: เติม 2025-11-16 09:00 → +0
2025-11-16 22:06:03,249 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:03,249 INFO: เติม 2025-11-16 10:00 → +0
2025-11-16 22:06:04,954 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:04,955 INFO: เติม 2025-11-16 11:00 → +0
2025-11-16 22:06:06,665 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:06,666 INFO: เติม 2025-11-16 12:00 → +0
2025-11-16 22:06:08,387 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:08,387 INFO: เติม 2025-11-16 13:00 → +0
2025-11-16 22:06:10,152 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:10,153 INFO: เติม 2025-11-16 14:00 → +0
2025-11-16 22:06:11,857 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:11,858 INFO: เติม 2025-11-16 15:00 → +0
2025-11-16 22:06:13,563 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:13,564 INFO: เติม 2025-11-16 16:00 → +0
2025-11-16 22:06:15,285 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:15,286 INFO: เติม 2025-11-16 17:00 → +0
2025-11-16 22:06:16,977 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:16,978 INFO: เติม 2025-11-16 18:00 → +0
2025-11-16 22:06:18,734 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:18,734 INFO: เติม 2025-11-16 19:00 → +0
2025-11-16 22:06:20,435 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:20,435 INFO: เติม 2025-11-16 20:00 → +0
2025-11-16 22:06:22,120 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:22,121 INFO: เติม 2025-11-16 21:00 → +0
2025-11-16 22:06:23,829 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:23,830 INFO: เติม 2025-11-16 22:00 → +0
2025-11-16 22:06:24,836 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-16 22:06:24,836 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-16 22:06:24,838 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 73 แถว
2025-11-16 22:06:24,838 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-16 22:06:24,840 INFO: รวมเก่า 72 + ใหม่ 73 → 73 (เพิ่ม 1)
2025-11-16 22:06:24,841 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-16 22:06:24,842 INFO: Format สำเร็จ: +1 แถว
2025-11-16 22:06:24,853 INFO: อ่าน formatted: 73 แถว
2025-11-16 22:06:24,854 INFO: เริ่ม clean ข้อมูล: 73 แถว
2025-11-16 22:06:24,863 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (73 แถว)
2025-11-16 22:06:24,865 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-16 22:00:00          40.3           10.1       1.3 187.4       27.9    59.6     1014.3
2025-11-16 21:00:00          43.7           10.1       1.1 191.5       29.1    53.4     1013.9
2025-11-16 20:00:00          38.7           15.5       0.6 194.1       29.9    50.3     1013.1
2025-11-16 19:00:00          35.1           13.1       0.9 192.1       30.5    47.6     1012.4
2025-11-16 18:00:00          36.0            9.4       0.9 188.1       30.9    46.3     1011.8
2025-11-16 17:00:00          35.9           10.9       1.1 177.7       31.6    42.8     1011.2
2025-11-16 16:00:00          34.9           12.6       0.8 160.1       32.2    40.3     1011.2
2025-11-16 15:00:00          32.7           12.3       0.9 175.1       32.3    40.1     1011.6
2025-11-16 14:00:00          28.5            4.4       1.0 172.7       31.9    41.3     1012.5
2025-11-16 13:00:00          36.1            6.6       1.0 170.4       31.3    42.5     1013.7
2025-11-16 22:06:24,866 INFO: Clean สำเร็จ: 73 แถว
2025-11-16 22:06:24,868 INFO: เตรียมโหลด 73 แถว
2025-11-16 22:06:24,942 INFO: โหลด DB สำเร็จ
2025-11-16 22:06:24,943 INFO: Backup สำเร็จ: data\backups\2025-11-16.csv
2025-11-16 22:06:24,945 INFO: อัพเดท latest.csv สำเร็จ
2025-11-16 22:06:24,945 INFO: Load to DB + Backup สำเร็จ
2025-11-16 22:06:24,945 INFO: === PIPELINE END ===
2025-11-16 22:06:24,945 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-16 23:05:00 +07)" executed successfully
2025-11-20 13:37:11,514 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 13:37:11,516 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 13:37:11,517 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 13:37:11,517 INFO: Scheduler started
2025-11-20 13:37:11,517 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-20 13:37:11,517 INFO: === PIPELINE START ===
2025-11-20 13:37:11,517 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 13:37:12,327 INFO: ดึง 2025-11-20 12:00:00+07:00 - 2025-11-20 13:00:00+07:00 → 2 แถว
2025-11-20 13:37:12,363 INFO: เพิ่ม 2 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:12,364 INFO: สำเร็จ: เพิ่ม 2 แถว (ปัจจุบัน)
2025-11-20 13:37:12,364 INFO: Fetch สำเร็จ
2025-11-20 13:37:12,392 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 13:37:13,123 INFO: เพิ่ม 2 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:13,124 INFO: เติม 2025-11-18 13:00 → +2
2025-11-20 13:37:14,857 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:14,857 INFO: เติม 2025-11-18 14:00 → +1
2025-11-20 13:37:16,527 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:16,527 INFO: เติม 2025-11-18 15:00 → +1
2025-11-20 13:37:18,257 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:18,258 INFO: เติม 2025-11-18 16:00 → +1
2025-11-20 13:37:19,967 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:19,967 INFO: เติม 2025-11-18 17:00 → +1
2025-11-20 13:37:21,679 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:21,679 INFO: เติม 2025-11-18 18:00 → +1
2025-11-20 13:37:23,386 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:23,387 INFO: เติม 2025-11-18 19:00 → +1
2025-11-20 13:37:25,115 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:25,115 INFO: เติม 2025-11-18 20:00 → +1
2025-11-20 13:37:26,758 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:26,758 INFO: เติม 2025-11-18 21:00 → +1
2025-11-20 13:37:28,483 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:28,483 INFO: เติม 2025-11-18 22:00 → +1
2025-11-20 13:37:30,210 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:30,211 INFO: เติม 2025-11-18 23:00 → +1
2025-11-20 13:37:31,869 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:31,869 INFO: เติม 2025-11-19 00:00 → +1
2025-11-20 13:37:33,622 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:33,622 INFO: เติม 2025-11-19 01:00 → +1
2025-11-20 13:37:35,338 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:35,338 INFO: เติม 2025-11-19 02:00 → +1
2025-11-20 13:37:37,020 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:37,020 INFO: เติม 2025-11-19 03:00 → +1
2025-11-20 13:37:38,725 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:38,725 INFO: เติม 2025-11-19 04:00 → +1
2025-11-20 13:37:40,413 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:40,413 INFO: เติม 2025-11-19 05:00 → +1
2025-11-20 13:37:42,090 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:42,090 INFO: เติม 2025-11-19 06:00 → +1
2025-11-20 13:37:43,816 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:43,817 INFO: เติม 2025-11-19 07:00 → +1
2025-11-20 13:37:45,505 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:45,505 INFO: เติม 2025-11-19 08:00 → +1
2025-11-20 13:37:47,191 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:47,191 INFO: เติม 2025-11-19 09:00 → +1
2025-11-20 13:37:49,288 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:49,288 INFO: เติม 2025-11-19 10:00 → +1
2025-11-20 13:37:51,026 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:51,027 INFO: เติม 2025-11-19 11:00 → +1
2025-11-20 13:37:52,756 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:52,756 INFO: เติม 2025-11-19 12:00 → +1
2025-11-20 13:37:54,466 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:54,467 INFO: เติม 2025-11-19 13:00 → +1
2025-11-20 13:37:56,177 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:56,179 INFO: เติม 2025-11-19 14:00 → +1
2025-11-20 13:37:57,908 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:57,910 INFO: เติม 2025-11-19 15:00 → +1
2025-11-20 13:37:59,661 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:59,661 INFO: เติม 2025-11-19 16:00 → +1
2025-11-20 13:38:01,351 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:01,352 INFO: เติม 2025-11-19 17:00 → +1
2025-11-20 13:38:03,082 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:03,083 INFO: เติม 2025-11-19 18:00 → +1
2025-11-20 13:38:04,769 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:04,770 INFO: เติม 2025-11-19 19:00 → +1
2025-11-20 13:38:06,473 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:06,474 INFO: เติม 2025-11-19 20:00 → +1
2025-11-20 13:38:08,189 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:08,189 INFO: เติม 2025-11-19 21:00 → +1
2025-11-20 13:38:09,896 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:09,896 INFO: เติม 2025-11-19 22:00 → +1
2025-11-20 13:38:11,587 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:11,588 INFO: เติม 2025-11-19 23:00 → +1
2025-11-20 13:38:13,300 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:13,300 INFO: เติม 2025-11-20 00:00 → +1
2025-11-20 13:38:15,039 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:15,040 INFO: เติม 2025-11-20 01:00 → +1
2025-11-20 13:38:16,697 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:16,698 INFO: เติม 2025-11-20 02:00 → +1
2025-11-20 13:38:18,405 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:18,405 INFO: เติม 2025-11-20 03:00 → +1
2025-11-20 13:38:20,124 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:20,125 INFO: เติม 2025-11-20 04:00 → +1
2025-11-20 13:38:21,835 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:21,836 INFO: เติม 2025-11-20 05:00 → +1
2025-11-20 13:38:23,535 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:23,536 INFO: เติม 2025-11-20 06:00 → +1
2025-11-20 13:38:25,265 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:25,265 INFO: เติม 2025-11-20 07:00 → +1
2025-11-20 13:38:26,992 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:26,993 INFO: เติม 2025-11-20 08:00 → +1
2025-11-20 13:38:28,682 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:28,683 INFO: เติม 2025-11-20 09:00 → +1
2025-11-20 13:38:30,398 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:30,398 INFO: เติม 2025-11-20 10:00 → +1
2025-11-20 13:38:32,062 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:38:32,062 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 13:38:33,750 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:38:33,750 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 13:38:35,469 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:38:35,470 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 13:38:36,493 INFO: เติมข้อมูลย้อนหลังเสร็จ: +47 แถว
2025-11-20 13:38:36,493 INFO: เติมข้อมูลย้อนหลัง: +47 แถว
2025-11-20 13:38:36,495 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 122 แถว
2025-11-20 13:38:36,495 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 13:38:36,513 INFO: รวมเก่า 73 + ใหม่ 122 → 122 (เพิ่ม 49)
2025-11-20 13:38:36,515 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 13:38:36,515 INFO: Format สำเร็จ: +49 แถว
2025-11-20 13:38:36,525 INFO: อ่าน formatted: 122 แถว
2025-11-20 13:38:36,526 INFO: เริ่ม clean ข้อมูล: 122 แถว
2025-11-20 13:38:36,539 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (122 แถว)
2025-11-20 13:38:36,544 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 04:00:00          28.9            3.1       0.7 138.8       23.8    51.0     1013.5
2025-11-20 13:38:36,544 INFO: Clean สำเร็จ: 122 แถว
2025-11-20 13:38:37,890 INFO: เตรียมโหลด 122 แถว
2025-11-20 13:38:38,276 INFO: โหลด DB สำเร็จ
2025-11-20 13:38:38,279 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 13:38:38,282 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 13:38:38,283 INFO: Load to DB + Backup สำเร็จ
2025-11-20 13:38:38,283 INFO: === PIPELINE END ===
2025-11-20 13:52:33,858 ERROR: โหลดโมเดลล้มเหลว: No module named 'xgboost'
2025-11-20 13:52:33,862 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 13:52:33,864 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 13:52:33,865 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 13:52:33,865 INFO: Scheduler started
2025-11-20 13:52:33,866 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 13:52:33,866 INFO: === PIPELINE START ===
2025-11-20 13:52:33,866 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 13:52:34,641 INFO: ดึง 2025-11-20 12:00:00+07:00 - 2025-11-20 13:00:00+07:00 → 2 แถว
2025-11-20 13:52:34,646 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:34,646 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 13:52:34,647 INFO: Fetch สำเร็จ
2025-11-20 13:52:34,653 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 13:52:35,317 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:35,317 INFO: เติม 2025-11-18 13:00 → +0
2025-11-20 13:52:36,995 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:36,995 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 13:52:39,643 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:39,644 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 13:52:41,358 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:41,360 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 13:52:43,067 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:43,067 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 13:52:44,696 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:44,697 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 13:52:46,417 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:46,417 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 13:52:48,107 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:48,108 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 13:52:49,857 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:49,858 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 13:52:51,563 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:51,564 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 13:52:53,241 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:53,242 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 13:52:54,891 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:54,891 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 13:52:56,597 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:56,599 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 13:52:58,332 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:58,334 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 13:53:00,056 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:00,057 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 13:53:01,764 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:01,765 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 13:53:03,521 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:03,522 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 13:53:05,244 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:05,245 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 13:53:06,937 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:06,937 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 13:53:08,713 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:08,713 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 13:53:10,402 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:10,402 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 13:53:12,067 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:12,068 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 13:53:13,743 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:13,743 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 13:53:15,482 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:15,483 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 13:53:17,216 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:17,216 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 13:53:18,954 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:18,955 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 13:53:20,707 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:20,707 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 13:53:22,625 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:22,627 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 13:53:24,366 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:24,367 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 13:53:26,093 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:26,093 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 13:53:27,838 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:27,838 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 13:53:29,573 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:29,574 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 13:53:31,289 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:31,290 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 13:53:33,097 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:33,098 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 13:53:34,825 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:34,827 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 13:53:36,561 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:36,561 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 13:53:38,272 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:38,272 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 13:53:39,999 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:40,000 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 13:53:41,780 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:41,781 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 13:53:43,542 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:43,543 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 13:53:45,274 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:45,275 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 13:53:47,015 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:47,016 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 13:53:48,708 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:48,708 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 13:53:50,450 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:50,450 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 13:53:52,167 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:52,167 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 13:53:53,890 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:53,890 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 13:53:55,629 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:55,630 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 13:53:57,345 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:57,345 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 13:53:59,093 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:59,093 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 13:54:00,092 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 13:54:00,092 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 13:54:00,094 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 122 แถว
2025-11-20 13:54:00,094 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 13:54:00,096 INFO: รวมเก่า 122 + ใหม่ 122 → 122 (เพิ่ม 0)
2025-11-20 13:54:00,099 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 13:54:00,099 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 13:54:00,101 INFO: เริ่ม clean ข้อมูล: 122 แถว
2025-11-20 13:54:00,113 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (122 แถว)
2025-11-20 13:54:00,117 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 04:00:00          28.9            3.1       0.7 138.8       23.8    51.0     1013.5
2025-11-20 13:54:00,147 INFO: เตรียมโหลด 122 แถว
2025-11-20 13:54:00,322 INFO: โหลด DB สำเร็จ
2025-11-20 13:54:00,324 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 13:54:00,327 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 13:54:00,328 INFO: Load to DB + Backup สำเร็จ
2025-11-20 13:54:00,328 INFO: === PIPELINE END ===

2025-11-20 13:59:04,027 ERROR: โหลดโมเดลล้มเหลว: No module named 'xgboost'
2025-11-20 13:59:04,031 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 13:59:04,032 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 13:59:04,033 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 13:59:04,033 INFO: Scheduler started
2025-11-20 13:59:04,033 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 13:59:04,033 INFO: === PIPELINE START ===
2025-11-20 13:59:04,034 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 13:59:04,753 INFO: ดึง 2025-11-20 12:00:00+07:00 - 2025-11-20 13:00:00+07:00 → 2 แถว
2025-11-20 13:59:04,765 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:04,766 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 13:59:04,766 INFO: Fetch สำเร็จ
2025-11-20 13:59:04,779 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 13:59:05,449 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:05,449 INFO: เติม 2025-11-18 13:00 → +0
2025-11-20 13:59:07,173 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:07,174 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 13:59:08,898 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:08,898 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 13:59:10,621 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:10,622 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 13:59:12,310 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:12,311 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 13:59:14,012 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:14,013 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 13:59:15,769 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:15,770 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 13:59:17,534 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:17,535 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 13:59:19,206 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:19,207 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 13:59:20,895 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:20,895 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 13:59:22,585 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:22,585 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 13:59:24,247 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:24,248 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 13:59:25,968 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:25,969 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 13:59:27,723 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:27,724 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 13:59:29,416 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:29,416 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 13:59:31,120 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:31,120 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 13:59:32,850 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:32,850 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 13:59:34,508 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:34,509 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 13:59:36,252 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:36,253 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 13:59:37,957 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:37,957 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 13:59:39,639 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:39,640 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 13:59:41,348 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:41,348 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 13:59:43,033 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:43,034 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 13:59:44,689 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:44,689 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 13:59:46,374 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:46,374 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 13:59:48,109 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:48,110 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 13:59:49,779 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:49,779 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 13:59:51,475 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:51,475 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 13:59:53,190 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:53,190 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 13:59:54,894 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:54,895 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 13:59:56,602 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:56,603 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 13:59:58,306 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:58,306 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:00:00,059 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:00,060 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:00:01,766 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:01,766 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:00:03,485 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:03,485 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:00:05,179 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:05,180 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:00:06,845 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:06,845 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:00:08,585 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:08,585 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:00:10,382 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:10,383 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:00:12,120 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:12,121 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:00:13,871 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:13,871 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:00:15,634 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:15,634 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:00:17,372 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:17,372 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:00:19,115 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:19,115 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:00:20,837 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:20,837 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:00:22,650 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:22,651 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:00:24,360 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:24,360 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:00:26,114 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:26,115 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:00:27,823 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 14:00:27,824 INFO: เติม 2025-11-20 13:00 → +1
2025-11-20 14:00:28,838 INFO: เติมข้อมูลย้อนหลังเสร็จ: +1 แถว
2025-11-20 14:00:28,838 INFO: เติมข้อมูลย้อนหลัง: +1 แถว
2025-11-20 14:00:28,840 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:00:28,841 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:00:28,843 INFO: รวมเก่า 122 + ใหม่ 123 → 123 (เพิ่ม 1)
2025-11-20 14:00:28,844 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:00:28,844 INFO: Format สำเร็จ: +1 แถว
2025-11-20 14:00:28,860 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:00:28,878 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:00:28,882 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:00:28,915 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:00:29,135 INFO: โหลด DB สำเร็จ
2025-11-20 14:00:29,137 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:00:29,140 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:00:29,140 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:00:29,140 INFO: === PIPELINE END ===

2025-11-20 14:02:34,312 ERROR: โหลดโมเดลล้มเหลว: No module named 'xgboost'
2025-11-20 14:02:34,316 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:02:34,317 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:02:34,318 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:02:34,318 INFO: Scheduler started
2025-11-20 14:02:34,318 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:02:34,318 INFO: === PIPELINE START ===
2025-11-20 14:02:34,318 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:02:35,029 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:02:35,035 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:35,035 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:02:35,035 INFO: Fetch สำเร็จ
2025-11-20 14:02:35,044 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:02:35,731 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:35,732 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:02:37,534 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:37,535 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:02:39,412 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:39,412 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:02:41,108 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:41,108 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:02:42,862 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:42,863 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:02:45,059 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:45,059 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:02:46,762 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:46,762 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:02:48,494 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:48,494 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:02:51,394 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:51,395 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:02:53,101 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:53,102 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:02:54,845 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:54,846 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:02:56,571 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:56,572 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:02:58,435 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:58,436 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:03:00,132 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:00,132 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:03:01,946 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:01,946 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:03:03,717 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:03,717 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:03:05,502 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:05,503 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:03:07,235 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:07,236 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:03:08,903 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:08,903 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:03:10,582 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:10,582 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:03:12,264 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:12,264 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:03:14,005 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:14,005 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:03:15,682 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:15,682 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:03:17,440 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:17,440 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:03:19,132 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:19,132 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:03:20,854 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:20,855 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:03:22,553 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:22,555 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:03:24,241 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:24,242 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:03:25,891 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:25,892 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:03:27,602 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:27,603 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:03:29,342 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:29,343 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:03:31,515 ERROR: โหลดโมเดลล้มเหลว: No module named 'xgboost'
2025-11-20 14:03:31,520 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:03:31,522 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:03:31,522 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:03:31,523 INFO: Scheduler started
2025-11-20 14:03:31,523 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:03:31,523 INFO: === PIPELINE START ===
2025-11-20 14:03:31,523 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:03:32,223 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:03:32,228 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:32,229 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:03:32,229 INFO: Fetch สำเร็จ
2025-11-20 14:03:32,236 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:03:32,884 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:32,884 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:03:34,588 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:34,589 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:03:36,532 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:36,532 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:03:38,230 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:38,231 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:03:39,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:39,929 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:03:41,715 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:41,716 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:03:43,431 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:43,431 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:03:45,084 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:45,084 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:03:46,762 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:46,762 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:03:48,473 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:48,474 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:03:50,213 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:50,213 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:03:51,990 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:51,990 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:03:53,654 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:53,655 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:03:55,352 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:55,353 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:03:57,087 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:57,088 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:03:58,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:58,821 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:04:00,506 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:00,508 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:04:02,262 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:02,263 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:04:03,996 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:03,996 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:04:05,730 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:05,730 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:04:07,422 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:07,422 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:04:09,294 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:09,295 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:04:11,046 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:11,047 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:04:12,761 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:12,762 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:04:14,490 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:14,490 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:04:38,169 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:04:38,175 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:04:38,176 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:04:38,178 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:04:38,178 INFO: Scheduler started
2025-11-20 14:04:38,178 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:04:38,179 INFO: === PIPELINE START ===
2025-11-20 14:04:38,179 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:04:38,912 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:04:38,918 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:38,919 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:04:38,919 INFO: Fetch สำเร็จ
2025-11-20 14:04:38,926 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:04:40,031 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:40,031 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:04:41,736 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:41,736 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:04:43,474 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:43,475 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:04:45,141 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:45,141 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:04:46,851 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:46,851 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:04:48,563 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:48,563 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:04:48,579 ERROR: /predict error: 500: คอลัมน์หาย: ['PM2.5', 'Temp', 'RH', 'WS']
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 180, in predict_next_24h
    raise HTTPException(status_code=500, detail=f"คอลัมน์หาย: {missing}")
fastapi.exceptions.HTTPException: 500: คอลัมน์หาย: ['PM2.5', 'Temp', 'RH', 'WS']

2025-11-20 14:04:50,223 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:50,224 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:04:51,916 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:51,917 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:04:53,644 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:53,645 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:04:55,320 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:55,320 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:04:56,999 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:57,000 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:04:58,692 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:58,693 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:05:00,367 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:00,367 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:05:00,368 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 15:05:00 +07)" (scheduled at 2025-11-20 14:05:00+07:00)
2025-11-20 14:05:00,368 INFO: === PIPELINE START ===
2025-11-20 14:05:00,368 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:05:01,044 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:05:01,047 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:01,047 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:05:01,047 INFO: Fetch สำเร็จ
2025-11-20 14:05:01,052 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:05:01,713 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:01,714 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:05:02,405 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:02,405 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:05:03,400 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:03,401 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:05:04,090 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:04,091 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:05:05,113 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:05,114 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:05:05,788 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:05,789 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:05:06,948 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:06,948 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:05:07,612 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:07,613 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:05:08,648 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:08,649 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:05:09,320 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:09,320 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:05:10,332 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:10,333 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:05:11,016 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:11,016 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:05:12,025 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:12,025 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:05:12,722 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:12,723 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:05:13,754 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:13,754 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:05:14,484 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:14,485 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:05:15,441 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:15,441 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:05:16,181 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:16,181 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:05:17,169 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:17,170 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:05:17,869 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:17,870 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:05:18,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:18,928 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:05:19,628 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:19,628 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:05:20,649 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:20,650 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:05:21,375 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:21,376 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:05:22,376 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:22,376 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:05:23,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:23,080 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:05:24,112 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:24,112 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:05:24,776 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:24,778 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:05:25,813 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:25,814 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:05:26,577 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:26,577 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:05:27,537 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:27,538 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:05:28,327 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:28,328 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:05:29,262 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:29,262 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:05:30,048 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:30,048 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:05:31,001 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:31,001 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:05:31,770 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:31,770 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:05:32,782 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:32,783 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:05:33,502 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:33,503 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:05:34,485 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:34,486 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:05:35,198 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:35,198 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:05:36,200 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:36,201 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:05:36,922 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:36,922 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:05:37,913 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:37,914 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:05:38,646 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:38,647 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:05:39,700 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:39,701 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:05:40,436 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:40,437 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:05:41,503 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:41,504 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:05:42,198 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:42,199 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:05:43,273 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:43,274 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:05:44,032 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:44,032 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:05:45,017 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:45,017 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:05:45,696 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:45,697 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:05:46,726 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:46,727 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:05:47,438 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:47,439 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:05:48,467 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:48,468 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:05:49,425 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:49,425 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:05:50,229 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:50,229 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:05:51,192 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:51,193 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:05:51,954 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:51,954 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:05:52,883 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:52,884 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:05:53,677 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:53,678 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:05:54,639 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:54,640 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:05:55,432 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:55,432 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:05:56,436 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:56,438 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:05:57,153 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:57,154 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:05:58,179 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:58,180 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:05:58,927 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:58,928 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:05:59,924 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:59,924 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:06:00,646 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:00,647 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:06:01,648 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:01,648 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:06:02,345 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:02,345 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:06:03,369 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:03,369 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:06:04,066 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:04,067 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:06:04,384 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:06:04,384 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:06:04,389 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:06:04,389 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:06:04,392 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:06:04,394 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:06:04,395 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:06:04,396 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:06:04,408 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:06:04,412 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:06:04,439 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:06:04,597 INFO: โหลด DB สำเร็จ
2025-11-20 14:06:04,599 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:06:04,601 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:06:04,601 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:06:04,601 INFO: === PIPELINE END ===

2025-11-20 14:06:05,831 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:05,832 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:06:07,545 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:07,545 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:06:09,275 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:09,276 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:06:10,997 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:10,997 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:06:12,725 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:12,726 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:06:14,445 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:14,446 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:06:16,203 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:16,203 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:06:17,922 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:17,922 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:06:19,684 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:19,685 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:06:21,431 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:21,431 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:06:23,120 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:23,120 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:06:24,872 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:24,873 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:06:25,876 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:06:25,876 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:06:25,879 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:06:25,880 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:06:25,882 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:06:25,884 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:06:25,884 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:06:25,886 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:06:25,898 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:06:25,901 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:06:25,903 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:06:26,070 INFO: โหลด DB สำเร็จ
2025-11-20 14:06:26,073 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:06:26,076 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:06:26,076 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:06:26,076 INFO: === PIPELINE END ===

2025-11-20 14:06:26,076 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 15:05:00 +07)" executed successfully
2025-11-20 14:08:59,753 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:08:59,759 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:08:59,761 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:08:59,762 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:08:59,762 INFO: Scheduler started
2025-11-20 14:08:59,762 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:08:59,762 INFO: === PIPELINE START ===
2025-11-20 14:08:59,762 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:09:00,480 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:09:00,485 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:00,485 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:09:00,486 INFO: Fetch สำเร็จ
2025-11-20 14:09:00,495 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:09:01,168 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:01,168 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:09:02,949 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:02,949 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:09:04,666 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:04,666 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:09:06,412 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:06,413 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:09:08,088 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:08,088 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:09:09,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:09,822 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:09:11,542 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:11,542 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:09:13,310 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:13,311 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:09:14,151 ERROR: /predict error: Feature shape mismatch, expected: 168, got 5
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 187, in predict_next_24h
    pred = MODEL.predict(current_input.reshape(1, -1))[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 2865, in inplace_predict
    raise ValueError(
ValueError: Feature shape mismatch, expected: 168, got 5

2025-11-20 14:09:15,035 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:15,036 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:09:16,712 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:16,712 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:09:18,453 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:18,454 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:09:20,247 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:20,248 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:09:21,955 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:21,955 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:09:23,663 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:23,664 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:09:25,309 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:25,309 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:09:27,037 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:27,037 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:09:28,785 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:28,785 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:09:30,485 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:30,486 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:09:32,231 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:32,232 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:09:33,941 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:33,941 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:09:35,635 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:35,636 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:09:37,396 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:37,396 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:09:39,103 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:39,104 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:09:40,799 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:40,800 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:09:42,519 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:42,519 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:09:44,243 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:44,244 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:09:46,024 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:46,024 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:09:47,736 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:47,736 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:09:49,441 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:49,442 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:09:51,139 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:51,139 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:09:52,896 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:52,896 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:09:54,588 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:54,588 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:09:56,294 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:56,295 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:09:58,037 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:58,037 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:09:59,692 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:59,692 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:10:01,364 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:01,364 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:10:03,105 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:03,107 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:10:04,909 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:04,910 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:10:06,600 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:06,601 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:10:09,156 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:09,157 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:10:10,806 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:10,806 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:10:12,582 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:12,582 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:10:14,308 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:14,309 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:10:16,063 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:16,063 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:10:17,840 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:17,841 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:10:19,558 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:19,559 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:10:21,248 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:21,248 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:10:22,962 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:22,963 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:10:24,695 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:24,696 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:10:25,670 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:10:25,670 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:10:25,672 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:10:25,673 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:10:25,675 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:10:25,677 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:10:25,677 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:10:25,679 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:10:25,690 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:10:25,694 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:10:25,731 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:10:25,896 INFO: โหลด DB สำเร็จ
2025-11-20 14:10:25,899 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:10:25,901 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:10:25,901 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:10:25,901 INFO: === PIPELINE END ===

2025-11-20 14:13:44,635 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:13:44,641 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:13:44,642 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:13:44,643 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:13:44,643 INFO: Scheduler started
2025-11-20 14:13:44,644 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:13:44,644 INFO: === PIPELINE START ===
2025-11-20 14:13:44,644 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:13:45,355 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:13:45,361 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:45,361 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:13:45,361 INFO: Fetch สำเร็จ
2025-11-20 14:13:45,372 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:13:46,074 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:46,074 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:13:47,765 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:47,766 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:13:49,680 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:49,681 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:13:51,461 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:51,462 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:13:53,225 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:53,226 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:13:53,755 ERROR: /predict error: name 'text' is not defined
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 171, in predict_next_24h
    query = text("""
            ^^^^
NameError: name 'text' is not defined

2025-11-20 14:13:54,934 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:54,935 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:13:56,644 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:56,645 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:13:58,402 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:58,402 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:14:00,136 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:00,136 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:14:01,872 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:01,873 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:14:03,556 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:03,556 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:14:05,274 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:05,274 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:14:07,092 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:07,092 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:14:08,828 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:08,828 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:14:10,571 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:10,572 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:14:12,291 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:12,292 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:14:14,025 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:14,025 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:14:15,622 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:14:15,627 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:14:15,628 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:14:15,630 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:14:15,630 INFO: Scheduler started
2025-11-20 14:14:15,630 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:14:15,630 INFO: === PIPELINE START ===
2025-11-20 14:14:15,630 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:14:16,368 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:14:16,374 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:16,374 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:14:16,374 INFO: Fetch สำเร็จ
2025-11-20 14:14:16,385 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:14:17,135 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:17,136 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:14:17,240 ERROR: /predict error: 500: Feature mismatch: ได้ 62, ต้องการ 168
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 241, in predict_next_24h
    raise HTTPException(status_code=500,
fastapi.exceptions.HTTPException: 500: Feature mismatch: ได้ 62, ต้องการ 168

2025-11-20 14:14:18,943 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:18,943 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:14:20,653 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:20,653 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:14:22,424 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:22,424 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:14:24,166 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:24,166 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:14:25,914 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:25,914 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:14:27,562 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:27,562 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:14:29,309 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:29,310 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:14:31,013 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:31,013 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:14:32,707 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:32,708 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:14:34,428 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:34,429 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:14:36,167 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:36,168 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:14:37,893 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:37,894 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:14:39,659 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:39,660 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:14:41,393 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:41,394 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:14:43,134 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:43,135 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:14:44,903 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:44,903 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:14:46,633 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:46,634 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:14:48,389 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:48,389 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:14:50,158 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:50,159 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:14:51,945 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:51,945 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:14:53,664 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:53,665 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:14:55,386 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:55,387 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:14:57,105 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:57,105 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:14:58,803 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:58,803 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:15:00,508 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:00,508 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:15:02,238 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:02,238 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:15:04,063 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:04,064 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:15:05,761 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:05,762 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:15:07,481 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:07,482 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:15:09,300 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:09,300 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:15:11,062 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:11,063 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:15:12,795 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:12,796 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:15:14,537 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:14,537 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:15:16,323 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:16,323 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:15:18,048 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:18,048 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:15:19,825 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:19,825 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:15:21,614 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:21,615 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:15:23,356 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:23,357 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:15:25,037 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:25,037 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:15:26,701 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:26,702 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:15:28,454 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:28,454 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:15:30,156 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:30,158 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:15:31,884 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:31,884 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:15:33,657 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:33,658 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:15:35,401 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:35,401 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:15:37,189 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:37,190 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:15:38,881 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:38,882 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:15:40,602 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:40,603 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:15:41,625 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:15:41,625 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:15:41,626 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:15:41,628 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:15:41,630 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:15:41,632 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:15:41,632 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:15:41,634 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:15:41,647 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:15:41,651 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:15:41,682 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:15:41,819 INFO: โหลด DB สำเร็จ
2025-11-20 14:15:41,821 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:15:41,823 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:15:41,823 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:15:41,823 INFO: === PIPELINE END ===

2025-11-20 14:16:43,366 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:16:43,372 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:16:43,374 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:16:43,375 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:16:43,375 INFO: Scheduler started
2025-11-20 14:16:43,376 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:16:43,376 INFO: === PIPELINE START ===
2025-11-20 14:16:43,376 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:16:44,132 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:16:44,155 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:44,155 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:16:44,156 INFO: Fetch สำเร็จ
2025-11-20 14:16:44,169 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:16:44,872 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:44,873 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:16:46,635 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:46,636 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:16:48,401 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:48,401 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:16:50,136 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:50,136 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:16:52,095 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:52,095 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:16:53,853 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:53,853 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:16:55,641 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:55,642 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:16:57,376 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:57,378 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:16:59,240 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:59,241 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:17:00,940 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:00,941 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:17:02,679 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:02,680 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:17:04,480 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:04,480 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:17:06,291 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:06,292 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:17:08,020 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:08,021 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:17:09,752 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:09,753 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:17:11,531 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:11,532 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:17:13,249 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:13,249 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:17:14,979 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:14,981 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:17:16,711 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:16,711 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:17:18,428 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:18,428 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:17:20,158 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:20,158 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:17:21,869 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:21,869 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:17:23,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:23,821 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:17:25,562 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:25,563 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:17:27,258 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:27,258 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:17:29,046 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:29,048 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:17:30,898 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:30,898 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:17:32,657 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:32,657 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:17:34,348 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:34,349 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:17:36,070 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:36,071 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:17:37,826 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:37,827 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:17:39,548 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:39,548 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:17:41,279 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:41,279 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:17:42,950 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:42,950 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:17:44,675 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:44,675 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:17:46,390 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:46,391 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:17:48,175 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:48,176 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:17:49,876 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:49,876 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:17:51,632 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:51,633 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:17:53,370 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:53,371 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:17:55,113 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:55,114 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:17:56,830 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:56,831 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:17:58,573 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:58,574 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:18:00,302 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:18:00,303 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:18:02,077 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:18:02,077 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:18:03,807 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:18:03,807 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:18:05,507 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:18:05,507 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:18:07,241 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:18:07,242 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:18:08,959 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:18:08,959 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:18:09,967 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:18:09,969 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:18:09,971 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:18:09,971 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:18:09,986 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:18:09,989 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:18:09,989 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:18:09,991 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:18:10,005 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:18:10,013 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:18:11,980 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:18:12,111 INFO: โหลด DB สำเร็จ
2025-11-20 14:18:12,113 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:18:12,115 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:18:12,115 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:18:12,115 INFO: === PIPELINE END ===

2025-11-20 14:21:01,819 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:21:01,832 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:21:01,833 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:21:01,834 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:21:01,835 INFO: Scheduler started
2025-11-20 14:21:01,835 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:21:01,835 INFO: === PIPELINE START ===
2025-11-20 14:21:01,835 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:21:02,532 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:21:02,538 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:02,539 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:21:02,539 INFO: Fetch สำเร็จ
2025-11-20 14:21:02,547 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:21:03,243 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:03,244 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:21:03,400 ERROR: /predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 217, in predict_next_24h
    raise HTTPException(500, f"Feature ไม่ครบ: ได้ {X.shape[1]}, ต้องการ 168")
fastapi.exceptions.HTTPException: 500: Feature ไม่ครบ: ได้ 160, ต้องการ 168

2025-11-20 14:21:04,980 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:04,980 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:21:06,696 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:06,698 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:21:08,429 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:08,429 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:21:10,146 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:10,146 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:21:11,868 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:11,868 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:21:13,571 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:13,572 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:21:15,308 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:15,309 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:21:17,052 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:17,053 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:21:18,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:18,822 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:21:20,625 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:20,626 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:21:22,463 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:22,464 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:21:24,200 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:24,202 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:21:26,212 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:26,213 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:21:27,924 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:27,925 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:21:29,645 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:29,645 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:21:31,452 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:31,453 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:21:33,152 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:33,153 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:21:35,339 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:35,340 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:21:37,070 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:37,071 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:21:38,854 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:38,854 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:21:40,578 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:40,579 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:21:42,288 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:42,289 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:21:44,120 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:44,121 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:21:45,840 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:45,841 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:21:47,602 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:47,603 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:21:49,338 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:49,338 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:21:51,088 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:51,088 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:21:52,800 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:52,800 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:21:54,506 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:54,506 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:21:56,303 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:56,303 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:21:57,996 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:58,002 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:21:59,772 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:59,773 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:22:01,493 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:01,493 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:22:03,169 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:03,169 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:22:04,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:04,929 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:22:06,619 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:06,620 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:22:08,306 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:08,306 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:22:10,015 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:10,016 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:22:11,754 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:11,754 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:22:13,511 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:13,511 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:22:15,232 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:15,232 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:22:17,034 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:17,035 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:22:18,829 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:18,830 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:22:20,705 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:20,705 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:22:22,445 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:22,446 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:22:24,219 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:24,220 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:22:26,009 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:26,009 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:22:27,760 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:27,760 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:22:28,780 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:22:28,780 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:22:28,782 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:22:28,783 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:22:28,785 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:22:28,787 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:22:28,787 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:22:28,789 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:22:28,800 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:22:28,803 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:22:28,831 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:22:28,956 INFO: โหลด DB สำเร็จ
2025-11-20 14:22:28,958 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:22:28,961 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:22:28,961 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:22:28,961 INFO: === PIPELINE END ===

2025-11-20 14:26:20,763 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:26:20,768 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:26:20,769 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:26:20,771 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:26:20,776 INFO: Scheduler started
2025-11-20 14:26:20,778 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:26:20,779 INFO: === PIPELINE START ===
2025-11-20 14:26:20,779 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:26:21,562 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:26:21,569 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:21,570 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:26:21,570 INFO: Fetch สำเร็จ
2025-11-20 14:26:21,578 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:26:22,374 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:22,374 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:26:22,471 ERROR: /predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 195, in predict_next_24h
    pred = max(0, float(MODEL.predict(current)[0]))
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 2865, in inplace_predict
    raise ValueError(
ValueError: Feature shape mismatch, expected: 168, got 34

2025-11-20 14:26:24,104 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:24,105 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:26:25,856 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:25,858 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:26:27,587 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:27,589 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:26:29,333 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:29,333 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:26:31,085 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:31,086 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:26:32,843 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:32,844 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:26:34,627 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:34,628 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:26:36,428 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:36,428 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:26:38,205 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:38,206 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:26:39,991 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:39,992 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:26:41,701 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:41,701 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:26:43,490 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:43,490 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:26:45,193 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:45,194 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:26:46,977 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:46,978 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:26:48,715 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:48,715 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:26:50,437 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:50,437 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:26:52,139 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:52,140 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:26:53,981 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:53,982 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:26:55,727 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:55,727 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:26:57,503 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:57,504 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:26:59,244 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:59,245 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:27:01,043 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:01,043 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:27:02,871 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:02,872 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:27:04,618 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:04,618 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:27:06,421 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:06,421 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:27:08,175 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:08,175 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:27:09,932 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:09,933 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:27:11,697 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:11,698 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:27:13,430 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:13,430 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:27:15,165 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:15,165 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:27:16,952 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:16,952 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:27:18,699 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:27:18,704 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:27:18,706 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:27:18,708 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:27:18,708 INFO: Scheduler started
2025-11-20 14:27:18,709 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:27:18,709 INFO: === PIPELINE START ===
2025-11-20 14:27:18,709 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:27:19,476 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:27:19,482 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:19,482 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:27:19,482 INFO: Fetch สำเร็จ
2025-11-20 14:27:19,495 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:27:20,234 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:20,235 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:27:20,358 ERROR: /predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 202, in predict_next_24h
    raise HTTPException(500, f"Feature mismatch: ได้ {len(latest)-2}, ต้องการ {expected_features}")
fastapi.exceptions.HTTPException: 500: Feature mismatch: ได้ 159, ต้องการ 168

2025-11-20 14:27:21,940 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:21,941 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:27:23,704 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:23,704 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:27:25,422 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:25,422 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:27:27,168 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:27,168 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:27:28,856 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:28,857 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:27:30,614 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:30,615 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:27:32,322 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:32,323 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:27:34,060 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:34,061 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:27:35,800 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:35,800 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:27:37,486 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:37,487 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:27:39,172 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:39,173 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:27:40,868 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:40,868 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:27:42,505 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:42,506 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:27:44,241 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:44,241 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:27:45,931 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:45,931 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:27:47,676 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:47,677 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:27:49,496 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:49,498 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:27:51,312 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:51,312 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:27:52,988 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:52,989 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:27:54,643 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:54,644 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:27:56,382 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:56,383 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:27:58,092 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:58,093 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:27:59,805 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:59,806 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:28:01,569 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:01,570 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:28:03,260 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:03,261 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:28:05,009 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:05,009 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:28:06,794 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:06,795 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:28:08,492 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:08,492 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:28:10,189 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:10,189 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:28:11,881 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:11,882 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:28:13,565 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:13,565 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:28:15,245 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:15,245 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:28:16,952 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:16,953 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:28:18,636 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:18,636 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:28:20,356 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:20,356 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:28:22,034 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:22,034 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:28:23,865 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:23,865 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:28:25,574 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:25,575 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:28:27,312 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:27,312 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:28:28,982 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:28,984 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:28:30,691 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:30,691 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:28:32,483 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:32,483 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:28:34,146 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:34,147 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:28:35,833 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:35,833 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:28:37,568 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:37,568 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:28:39,241 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:39,242 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:28:40,911 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:40,911 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:28:42,615 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:42,616 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:28:43,598 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:28:43,598 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:28:43,600 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:28:43,601 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:28:43,604 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:28:43,606 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:28:43,606 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:28:43,611 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:28:43,623 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:28:43,628 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:28:43,656 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:28:43,790 INFO: โหลด DB สำเร็จ
2025-11-20 14:28:43,792 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:28:43,794 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:28:43,794 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:28:43,794 INFO: === PIPELINE END ===

2025-11-20 14:30:03,522 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:30:03,527 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:30:03,529 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:30:03,530 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:30:03,530 INFO: Scheduler started
2025-11-20 14:30:03,530 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:30:03,530 INFO: === PIPELINE START ===
2025-11-20 14:30:03,530 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:30:04,289 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:30:04,298 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:04,298 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:30:04,298 INFO: Fetch สำเร็จ
2025-11-20 14:30:04,306 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:30:05,022 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:05,023 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:30:06,784 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:06,785 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:30:08,453 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:08,454 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:30:10,197 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:10,197 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:30:11,987 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:11,987 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:30:13,700 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:13,700 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:30:15,473 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:15,474 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:30:17,220 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:17,220 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:30:19,015 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:19,015 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:30:20,865 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:20,865 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:30:22,551 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:22,552 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:30:24,274 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:24,274 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:30:26,012 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:26,013 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:30:27,775 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:27,776 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:30:27,894 ERROR: Predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 212, in predict_next_24h
    raise HTTPException(500, f"Feature ยังขาดอีก {missing} ตัว (ตอนนี้ได้ {actual_features}/168)")
fastapi.exceptions.HTTPException: 500: Feature ยังขาดอีก 2 ตัว (ตอนนี้ได้ 166/168)

2025-11-20 14:30:29,449 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:29,450 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:30:31,225 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:31,226 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:30:32,955 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:32,955 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:30:34,631 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:34,631 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:30:36,409 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:36,410 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:30:38,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:38,080 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:30:39,814 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:39,814 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:30:41,907 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:41,909 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:30:43,597 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:43,598 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:30:45,301 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:45,302 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:30:47,235 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:47,236 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:30:48,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:48,929 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:30:50,626 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:50,626 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:30:52,346 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:52,346 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:30:54,052 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:54,052 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:30:55,726 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:55,727 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:30:57,451 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:57,452 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:30:59,232 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:59,233 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:31:00,884 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:00,885 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:31:02,705 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:02,706 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:31:04,403 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:04,403 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:31:06,102 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:06,103 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:31:07,836 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:07,837 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:31:09,544 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:09,545 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:31:11,254 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:11,254 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:31:13,054 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:13,055 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:31:14,773 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:14,773 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:31:16,484 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:16,485 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:31:18,144 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:18,144 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:31:19,888 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:19,888 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:31:21,597 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:21,598 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:31:23,340 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:23,341 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:31:25,165 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:25,166 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:31:26,882 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:26,883 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:31:28,653 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:28,654 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:31:29,635 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:31:29,635 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:31:29,638 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:31:29,639 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:31:29,641 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:31:29,644 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:31:29,645 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:31:29,647 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:31:29,660 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:31:29,666 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:31:29,710 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:31:29,925 INFO: โหลด DB สำเร็จ
2025-11-20 14:31:29,927 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:31:29,929 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:31:29,929 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:31:29,929 INFO: === PIPELINE END ===

2025-11-20 14:35:55,815 ERROR: Predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 212, in predict_next_24h
    raise HTTPException(500, f"Feature ยังขาดอีก {missing} ตัว (ตอนนี้ได้ {actual_features}/168)")
fastapi.exceptions.HTTPException: 500: Feature ยังขาดอีก 2 ตัว (ตอนนี้ได้ 166/168)

2025-11-20 14:36:46,340 WARNING: ไม่พบโมเดลที่ models/xgboost_pm25_best.pkl → /predict จะไม่ทำงาน
2025-11-20 14:36:46,345 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:36:46,346 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:36:46,347 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:36:46,347 INFO: Scheduler started
2025-11-20 14:36:46,347 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:36:46,348 INFO: === PIPELINE START ===
2025-11-20 14:36:46,348 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:36:47,164 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:36:47,170 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:47,170 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:36:47,171 INFO: Fetch สำเร็จ
2025-11-20 14:36:47,185 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:36:47,932 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:47,933 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:36:49,610 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:49,610 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:36:51,340 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:51,340 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:36:53,036 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:53,037 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:36:54,710 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:54,711 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:36:56,448 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:56,449 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:36:58,243 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:58,244 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:36:59,985 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:59,985 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:37:01,666 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:01,666 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:37:03,454 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:03,455 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:37:05,182 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:05,182 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:37:06,921 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:06,922 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:37:08,673 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:08,674 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:37:10,434 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:10,434 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:37:12,253 WARNING: ไม่พบโมเดลที่ models/xgboost_pm25_best.pkl → /predict จะไม่ทำงาน
2025-11-20 14:37:12,258 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:37:12,259 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:37:12,261 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:37:12,261 INFO: Scheduler started
2025-11-20 14:37:12,261 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:37:12,261 INFO: === PIPELINE START ===
2025-11-20 14:37:12,261 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:37:12,951 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:37:12,956 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:12,957 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:37:12,957 INFO: Fetch สำเร็จ
2025-11-20 14:37:12,966 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:37:13,654 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:13,655 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:37:15,351 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:15,352 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:37:17,027 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:17,027 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:37:18,786 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:18,786 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:37:20,483 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:20,483 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:37:22,216 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:22,216 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:37:23,952 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:23,953 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:37:25,663 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:25,664 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:37:27,313 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:27,314 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:37:28,988 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:28,988 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:37:30,719 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:30,720 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:37:32,447 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:32,448 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:37:34,231 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:34,232 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:37:35,993 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:35,994 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:37:37,752 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:37,752 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:37:39,496 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:39,497 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:37:41,265 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:41,265 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:37:42,969 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:42,970 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:37:44,695 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:44,696 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:37:46,376 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:46,376 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:37:48,139 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:48,140 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:37:49,890 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:49,891 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:37:51,609 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:51,610 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:37:53,286 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:53,286 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:37:54,981 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:54,982 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:37:56,675 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:56,675 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:38:06,756 WARNING: ไม่พบโมเดลที่ models/xgboost_pm25_best.pkl → /predict จะไม่ทำงาน
2025-11-20 14:38:06,759 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:38:06,760 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:38:06,761 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:38:06,761 INFO: Scheduler started
2025-11-20 14:38:06,761 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:38:06,761 INFO: === PIPELINE START ===
2025-11-20 14:38:06,761 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:38:07,437 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:38:07,444 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:07,445 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:38:07,446 INFO: Fetch สำเร็จ
2025-11-20 14:38:07,456 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:38:08,128 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:08,129 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:38:09,831 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:09,831 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:38:11,520 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:11,520 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:38:13,250 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:13,251 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:38:14,905 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:14,905 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:38:16,606 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:16,608 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:38:18,368 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:18,369 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:38:20,073 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:20,074 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:38:21,786 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:21,787 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:38:23,483 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:23,484 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:38:25,167 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:25,169 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:38:26,880 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:26,881 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:38:28,588 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:28,588 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:38:30,281 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:30,282 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:38:31,935 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:31,936 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:38:33,619 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:33,620 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:38:35,320 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:35,322 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:38:37,019 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:37,020 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:38:38,720 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:38,721 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:38:40,425 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:40,425 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:38:42,103 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:42,104 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:38:43,784 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:43,784 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:38:45,427 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:45,428 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:38:47,141 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:47,141 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:38:48,854 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:48,855 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:38:50,608 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:50,608 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:38:52,279 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:52,279 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:38:54,076 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:54,077 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:38:55,789 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:55,789 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:38:57,470 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:57,470 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:38:59,199 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:59,200 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:39:00,970 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:00,970 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:39:02,708 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:02,709 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:39:04,443 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:04,443 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:39:06,110 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:06,111 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:39:07,847 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:07,847 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:39:09,606 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:09,608 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:39:11,310 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:11,311 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:39:13,037 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:13,040 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:39:14,787 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:14,787 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:39:16,434 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:16,435 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:39:18,163 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:18,164 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:39:19,863 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:19,864 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:39:21,586 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:21,586 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:39:23,308 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:23,309 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:39:25,025 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:25,026 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:39:26,758 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:26,759 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:39:28,433 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:28,434 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:39:30,103 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:30,104 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:39:31,088 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:39:31,088 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:39:31,091 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:39:31,092 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:39:31,094 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:39:31,096 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:39:31,096 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:39:31,098 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:39:31,110 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:39:31,114 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:39:31,144 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:39:31,316 INFO: โหลด DB สำเร็จ
2025-11-20 14:39:31,318 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:39:31,320 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:39:31,320 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:39:31,321 INFO: === PIPELINE END ===

2025-11-20 14:39:49,882 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:39:49,883 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:39:49,884 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:39:49,884 INFO: Scheduler started
2025-11-20 14:39:49,885 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:39:49,885 INFO: === PIPELINE START ===
2025-11-20 14:39:49,885 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:39:50,614 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:39:50,622 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:50,622 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:39:50,623 INFO: Fetch สำเร็จ
2025-11-20 14:39:50,629 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:39:51,356 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:51,356 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:39:53,022 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:53,023 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:39:54,692 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:54,692 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:39:56,421 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:56,421 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:39:58,149 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:58,149 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:39:59,809 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:59,809 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:40:01,553 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:01,553 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:40:03,284 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:03,285 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:40:04,944 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:04,944 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:40:06,644 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:06,644 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:40:08,360 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:08,360 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:40:10,052 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:10,052 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:40:11,742 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:11,742 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:40:13,415 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:13,416 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:40:15,110 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:15,110 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:40:16,948 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:16,948 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:40:18,654 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:18,654 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:40:20,394 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:20,396 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:40:22,138 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:22,139 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:40:23,940 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:23,941 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:40:25,663 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:25,663 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:40:27,334 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:27,335 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:40:29,033 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:29,034 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:40:30,748 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:30,748 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:40:32,533 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:32,534 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:40:34,216 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:34,216 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:40:35,914 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:35,914 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:40:37,582 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:37,582 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:40:39,281 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:39,281 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:40:40,942 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:40,942 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:40:42,608 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:42,609 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:40:44,294 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:44,295 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:40:46,018 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:46,018 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:40:47,714 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:47,714 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:40:49,414 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:49,415 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:40:51,125 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:51,126 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:40:52,823 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:52,824 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:40:54,517 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:54,518 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:40:56,269 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:56,270 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:40:57,962 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:57,963 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:40:59,690 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:59,690 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:41:01,414 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:01,415 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:41:03,137 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:03,138 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:41:04,809 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:04,809 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:41:06,512 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:06,512 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:41:08,226 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:08,226 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:41:09,929 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:09,929 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:41:11,644 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:11,644 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:41:13,324 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:13,324 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:41:14,332 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:41:14,332 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:41:14,333 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:41:14,334 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:41:14,336 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:41:14,339 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:41:14,339 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:41:14,341 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:41:14,351 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:41:14,355 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:41:14,382 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:41:14,543 INFO: โหลด DB สำเร็จ
2025-11-20 14:41:14,545 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:41:14,546 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:41:14,547 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:41:14,547 INFO: === PIPELINE END ===

2025-11-20 14:41:44,653 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:41:44,654 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:41:44,655 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:41:44,655 INFO: Scheduler started
2025-11-20 14:41:44,656 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:41:44,656 INFO: === PIPELINE START ===
2025-11-20 14:41:44,656 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:41:45,347 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:41:45,357 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:45,358 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:41:45,358 INFO: Fetch สำเร็จ
2025-11-20 14:41:45,364 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:41:46,058 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:46,058 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:41:47,811 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:47,812 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:41:49,444 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:49,445 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:41:51,130 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:51,131 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:41:52,849 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:52,849 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:41:54,530 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:54,530 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:41:56,193 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:56,194 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:41:57,836 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:57,836 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:41:59,526 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:59,527 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:42:01,245 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:01,246 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:42:02,992 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:02,993 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:42:04,699 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:04,700 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:42:06,415 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:06,416 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:42:08,125 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:08,126 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:42:09,838 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:09,838 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:42:11,527 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:11,527 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:42:13,220 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:13,220 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:42:14,922 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:14,922 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:42:16,642 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:16,643 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:42:18,314 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:18,315 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:42:20,019 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:20,019 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:42:21,703 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:21,704 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:42:23,453 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:23,454 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:42:25,126 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:25,126 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:42:26,857 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:26,857 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:42:28,547 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:28,547 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:42:30,240 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:30,240 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:42:31,916 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:31,917 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:42:33,677 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:42:33,679 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:42:33,679 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:42:33,680 INFO: Scheduler started
2025-11-20 14:42:33,680 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:42:33,680 INFO: === PIPELINE START ===
2025-11-20 14:42:33,680 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:42:34,377 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:42:34,383 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:34,384 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:42:34,384 INFO: Fetch สำเร็จ
2025-11-20 14:42:34,392 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:42:35,076 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:35,077 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:42:36,481 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:42:36,482 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:42:36,483 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:42:36,483 INFO: Scheduler started
2025-11-20 14:42:36,483 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:42:36,484 INFO: === PIPELINE START ===
2025-11-20 14:42:36,484 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:42:37,216 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:42:37,222 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:37,223 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:42:37,223 INFO: Fetch สำเร็จ
2025-11-20 14:42:37,231 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:42:37,961 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:37,962 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:42:39,693 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:39,694 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:42:41,406 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:41,407 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:42:43,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:43,081 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:42:44,767 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:44,767 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:42:46,484 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:46,484 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:42:48,191 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:48,192 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:42:49,827 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:49,827 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:42:51,519 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:51,520 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:42:53,194 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:53,195 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:42:54,852 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:54,853 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:42:56,554 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:56,555 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:42:58,230 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:58,230 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:42:59,905 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:59,905 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:43:01,563 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:01,563 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:43:03,251 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:03,252 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:43:04,958 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:04,958 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:43:06,737 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:06,739 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:43:08,422 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:08,423 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:43:10,104 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:10,104 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:43:11,770 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:11,771 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:43:13,449 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:13,450 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:43:15,138 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:15,139 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:43:16,882 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:16,883 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:43:18,586 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:18,587 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:43:20,287 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:20,288 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:43:22,032 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:22,033 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:43:23,722 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:23,723 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:43:25,446 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:25,446 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:43:27,178 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:27,178 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:43:28,872 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:28,873 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:43:30,611 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:30,611 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:43:32,288 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:32,288 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:43:33,988 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:33,988 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:43:35,660 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:35,660 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:43:37,392 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:37,393 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:43:39,098 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:39,099 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:43:40,797 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:40,797 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:43:42,514 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:42,515 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:43:44,327 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:44,327 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:43:46,083 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:46,083 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:43:47,787 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:47,788 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:43:50,023 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:43:50,025 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:43:50,026 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:43:50,026 INFO: Scheduler started
2025-11-20 14:43:50,026 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:43:50,026 INFO: === PIPELINE START ===
2025-11-20 14:43:50,026 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:43:50,738 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:43:50,743 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:50,743 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:43:50,743 INFO: Fetch สำเร็จ
2025-11-20 14:43:50,750 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:43:51,428 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:51,428 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:43:53,124 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:53,124 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:43:54,871 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:54,872 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:43:56,623 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:56,623 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:43:58,338 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:58,338 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:44:00,058 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:00,058 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:44:01,798 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:01,798 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:44:03,713 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:03,713 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:44:05,447 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:05,447 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:44:07,133 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:07,133 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:44:08,833 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:08,833 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:44:10,563 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:10,564 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:44:12,234 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:12,234 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:44:13,981 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:13,981 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:44:15,632 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:15,633 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:44:17,368 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:17,369 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:44:19,169 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:19,169 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:44:20,874 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:20,875 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:44:22,580 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:22,581 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:44:24,289 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:24,290 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:44:26,015 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:26,016 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:44:27,714 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:27,714 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:44:29,458 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:29,458 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:44:31,139 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:31,139 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:44:32,876 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:32,876 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:44:34,559 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:34,559 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:44:36,219 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:36,219 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:44:37,926 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:37,927 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:44:39,592 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:39,592 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:44:41,257 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:41,257 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:44:42,889 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:42,890 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:44:44,604 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:44,605 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:44:46,265 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:46,265 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:44:47,971 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:47,971 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:44:49,666 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:49,667 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:44:51,300 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:51,301 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:44:52,972 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:52,973 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:44:54,675 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:54,676 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:44:56,356 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:56,356 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:44:58,014 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:58,014 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:44:59,696 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:59,696 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:45:01,364 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:01,368 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:45:03,024 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:03,024 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:45:33,927 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:45:33,930 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:45:33,931 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:45:33,931 INFO: Scheduler started
2025-11-20 14:45:33,931 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:45:33,932 INFO: === PIPELINE START ===
2025-11-20 14:45:33,932 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:45:34,719 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:45:34,724 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:34,725 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:45:34,725 INFO: Fetch สำเร็จ
2025-11-20 14:45:34,732 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:45:35,393 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:35,393 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:45:37,062 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:37,062 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:45:37,820 ERROR: Predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 207, in predict_next_24h
    pred = max(0, MODEL.predict(current_features)[0])
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 2865, in inplace_predict
    raise ValueError(
ValueError: Feature shape mismatch, expected: 168, got 30

2025-11-20 14:45:38,736 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:38,737 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:45:40,387 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:40,387 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:45:42,046 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:42,047 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:45:43,740 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:43,740 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:45:45,368 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:45,368 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:45:47,075 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:47,075 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:45:48,766 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:48,766 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:45:50,464 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:50,465 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:45:52,193 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:52,194 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:45:53,852 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:53,852 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:45:55,629 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:55,629 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:45:57,343 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:57,343 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:45:59,085 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:59,085 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:46:00,820 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:00,820 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:46:02,508 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:02,509 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:46:04,256 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:04,257 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:46:06,060 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:06,060 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:46:07,771 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:07,772 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:46:09,528 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:09,528 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:46:11,311 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:11,311 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:46:13,021 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:13,021 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:46:14,809 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:14,809 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:46:16,537 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:16,538 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:46:18,270 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:18,271 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:46:20,033 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:20,034 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:46:21,816 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:21,816 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:46:23,488 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:23,488 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:46:25,183 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:25,184 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:46:26,904 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:26,904 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:46:28,634 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:28,634 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:46:30,383 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:30,383 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:46:32,151 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:32,152 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:46:33,877 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:33,877 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:46:35,587 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:35,588 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:46:37,331 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:37,331 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:46:39,030 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:39,030 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:46:40,744 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:40,744 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:46:42,451 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:42,452 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:46:44,142 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:44,142 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:46:45,817 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:45,818 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:46:47,494 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:47,495 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:46:49,221 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:49,221 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:46:50,910 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:50,911 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:46:52,583 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:52,584 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:46:54,342 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:54,342 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:46:56,042 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:56,043 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:46:57,782 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:57,783 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:46:58,799 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:46:58,799 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:46:58,800 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:46:58,801 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:46:58,803 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:46:58,805 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:46:58,806 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:46:58,807 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:46:58,818 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:46:58,822 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:46:58,850 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:46:59,026 INFO: โหลด DB สำเร็จ
2025-11-20 14:46:59,029 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:46:59,035 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:46:59,035 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:46:59,036 INFO: === PIPELINE END ===

2025-11-20 14:47:30,328 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:47:30,330 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:47:30,331 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:47:30,331 INFO: Scheduler started
2025-11-20 14:47:30,332 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:47:30,332 INFO: === PIPELINE START ===
2025-11-20 14:47:30,332 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:47:31,009 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:47:31,015 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:31,016 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:47:31,016 INFO: Fetch สำเร็จ
2025-11-20 14:47:31,022 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:47:31,697 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:31,698 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:47:33,409 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:33,409 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:47:34,403 ERROR: Predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 205, in predict_next_24h
    raise HTTPException(500, f"Feature mismatch: ได้ {X.shape[1]}, ต้องการ 168")
fastapi.exceptions.HTTPException: 500: Feature mismatch: ได้ 161, ต้องการ 168

2025-11-20 14:47:35,069 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:35,070 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:47:36,770 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:36,771 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:47:38,452 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:38,453 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:47:40,143 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:40,144 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:47:41,840 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:41,841 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:47:43,542 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:43,543 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:47:45,251 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:45,252 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:47:46,966 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:46,966 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:47:48,713 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:48,713 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:47:50,537 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:50,537 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:47:52,270 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:52,271 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:47:53,952 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:53,952 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:47:55,645 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:55,645 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:47:57,423 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:57,423 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:47:59,116 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:59,116 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:48:00,839 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:00,840 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:48:02,570 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:02,571 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:48:04,309 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:04,310 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:48:05,991 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:05,992 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:48:07,694 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:07,695 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:48:09,365 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:09,365 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:48:11,046 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:11,046 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:48:12,767 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:12,767 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:48:14,478 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:14,479 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:48:16,173 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:16,174 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:48:17,949 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:17,950 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:48:19,636 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:19,637 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:48:21,410 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:21,410 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:48:23,060 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:23,061 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:48:24,764 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:24,764 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:48:26,453 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:26,453 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:48:28,148 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:28,148 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:48:29,863 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:29,864 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:48:31,542 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:31,543 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:48:33,239 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:33,239 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:48:34,942 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:34,943 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:48:36,635 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:36,636 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:48:38,322 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:38,323 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:48:40,021 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:40,022 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:48:42,615 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:48:42,618 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:48:42,619 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:48:42,620 INFO: Scheduler started
2025-11-20 14:48:42,620 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:48:42,620 INFO: === PIPELINE START ===
2025-11-20 14:48:42,620 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:48:43,333 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:48:43,338 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:43,338 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:48:43,339 INFO: Fetch สำเร็จ
2025-11-20 14:48:43,345 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:48:44,001 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:44,002 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:48:45,681 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:45,681 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:48:45,770 ERROR: Predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 222, in predict_next_24h
    raise HTTPException(500, f"Feature mismatch: ได้ {feature_count}, ต้องการ 168")
fastapi.exceptions.HTTPException: 500: Feature mismatch: ได้ 172, ต้องการ 168

2025-11-20 14:48:47,369 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:47,370 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:48:49,112 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:49,113 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:48:50,763 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:50,764 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:48:52,470 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:52,471 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:48:54,215 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:54,216 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:48:55,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:55,929 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:48:57,614 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:57,614 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:48:59,293 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:59,293 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:49:00,986 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:00,986 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:49:02,663 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:02,663 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:49:04,334 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:04,334 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:49:05,993 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:05,993 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:49:07,685 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:07,686 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:49:09,361 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:09,362 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:49:11,044 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:11,044 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:49:12,735 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:12,737 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:49:14,436 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:14,436 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:49:16,124 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:16,125 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:49:17,812 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:17,813 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:49:19,524 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:19,525 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:49:21,255 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:21,255 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:49:22,949 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:22,950 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:49:24,666 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:24,666 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:49:26,353 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:26,354 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:49:28,114 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:28,115 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:49:29,784 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:29,785 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:49:31,444 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:31,445 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:49:33,148 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:33,149 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:49:34,900 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:34,900 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:49:36,596 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:36,596 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:49:38,366 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:38,367 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:49:40,088 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:40,088 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:49:41,788 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:41,788 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:49:43,449 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:43,450 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:49:45,136 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:45,138 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:49:46,836 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:46,837 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:49:48,571 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:48,572 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:49:50,342 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:50,343 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:49:52,067 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:52,068 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:49:53,789 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:53,790 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:49:55,513 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:55,514 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:49:57,227 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:57,228 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:49:58,939 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:58,939 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:50:00,676 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:50:00,677 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:50:02,358 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:50:02,359 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:50:04,055 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:50:04,056 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:50:05,767 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:50:05,768 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:50:06,761 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:50:06,761 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:50:06,763 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:50:06,764 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:50:06,765 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:50:06,768 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:50:06,768 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:50:06,771 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:50:06,782 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:50:06,786 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:50:06,814 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:50:06,930 INFO: โหลด DB สำเร็จ
2025-11-20 14:50:06,931 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:50:06,934 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:50:06,934 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:50:06,934 INFO: === PIPELINE END ===

2025-11-20 14:59:12,717 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 14:59:12,725 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:59:12,726 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:59:12,728 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:59:12,728 INFO: Scheduler started
2025-11-20 14:59:12,728 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:59:12,728 INFO: === PIPELINE START ===
2025-11-20 14:59:12,729 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:59:13,497 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:59:13,502 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:13,503 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:59:13,503 INFO: Fetch สำเร็จ
2025-11-20 14:59:13,511 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:59:14,195 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:14,195 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:59:15,859 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:15,859 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:59:17,539 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:17,540 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:59:19,335 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:19,336 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:59:21,035 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:21,036 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:59:22,714 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:22,714 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:59:24,415 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:24,415 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:59:26,114 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:26,115 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:59:27,769 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:27,769 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:59:29,540 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:29,541 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:59:31,232 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:31,233 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:59:32,934 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:32,935 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:59:34,626 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:34,627 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:59:36,328 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:36,328 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:59:38,019 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:38,019 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:59:39,736 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:39,736 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:59:41,487 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:41,488 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:59:43,157 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:43,157 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:59:44,801 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:44,801 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:59:46,500 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:46,501 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:59:48,200 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:48,200 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:59:48,400 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 14:59:48,400 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 14:59:49,907 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:49,907 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:59:51,615 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:51,617 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:59:53,338 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:53,338 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:59:55,055 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:55,055 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:59:56,748 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:56,749 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:59:58,450 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:58,450 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 15:00:00,154 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:00,154 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 15:00:01,822 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:01,822 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 15:00:03,523 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:03,523 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 15:00:05,253 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:05,253 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 15:00:07,043 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:07,043 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 15:00:08,776 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:08,776 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 15:00:10,481 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:10,482 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 15:00:12,255 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:12,255 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 15:00:13,967 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:13,967 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 15:00:15,691 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:15,691 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 15:00:17,414 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:17,414 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 15:00:19,098 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:19,098 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 15:00:21,101 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:21,102 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 15:00:22,767 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:22,767 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 15:00:24,465 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:24,465 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 15:00:26,213 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:26,214 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 15:00:27,904 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:27,904 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 15:00:29,594 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:29,594 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 15:00:31,264 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:31,264 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 15:00:33,204 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:33,205 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 15:00:34,888 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:34,889 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 15:00:36,666 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 15:00:36,667 INFO: เติม 2025-11-20 14:00 → +1
2025-11-20 15:00:37,684 INFO: เติมข้อมูลย้อนหลังเสร็จ: +1 แถว
2025-11-20 15:00:37,685 INFO: เติมข้อมูลย้อนหลัง: +1 แถว
2025-11-20 15:00:37,688 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 124 แถว
2025-11-20 15:00:37,690 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 15:00:37,695 INFO: รวมเก่า 123 + ใหม่ 124 → 124 (เพิ่ม 1)
2025-11-20 15:00:37,696 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 15:00:37,697 INFO: Format สำเร็จ: +1 แถว
2025-11-20 15:00:37,708 INFO: เริ่ม clean ข้อมูล: 124 แถว
2025-11-20 15:00:37,720 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (124 แถว)
2025-11-20 15:00:37,723 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 15:00:37,750 INFO: เตรียมโหลด 124 แถว
2025-11-20 15:00:37,872 INFO: โหลด DB สำเร็จ
2025-11-20 15:00:37,873 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 15:00:37,875 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 15:00:37,875 INFO: Load to DB + Backup สำเร็จ
2025-11-20 15:00:37,875 INFO: === PIPELINE END ===

2025-11-20 15:05:00,022 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 16:05:00 +07)" (scheduled at 2025-11-20 15:05:00+07:00)
2025-11-20 15:05:00,023 INFO: === PIPELINE START ===
2025-11-20 15:05:00,023 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:05:00,725 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:05:00,729 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:00,730 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:05:00,730 INFO: Fetch สำเร็จ
2025-11-20 15:05:00,734 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:05:01,419 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:01,419 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:05:03,178 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:03,179 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:05:04,905 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:04,905 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:05:06,604 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:06,605 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:05:08,283 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:08,284 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:05:10,124 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:10,124 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:05:11,912 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:11,913 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:05:13,606 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:13,607 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:05:15,294 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:15,295 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:05:17,059 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:17,060 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:05:18,773 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:18,774 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:05:20,493 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:20,493 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:05:22,264 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:22,264 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:05:23,995 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:23,997 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:05:25,702 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:25,703 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:05:27,405 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:27,405 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:05:29,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:29,081 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:05:30,091 ERROR: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 16:05:00 +07)" raised an exception
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 181, in run_coroutine_job
    retval = await job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\app\main.py", line 97, in run_pipeline
    added = await fill_missing_hours(lookback_hours=48)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in fill_missing_hours
    await asyncio.sleep(1)
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\tasks.py", line 649, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError
2025-11-20 15:05:32,082 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 15:05:32,089 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 15:05:32,090 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:05:32,091 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 15:05:32,092 INFO: Scheduler started
2025-11-20 15:05:32,092 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 15:05:32,092 INFO: === PIPELINE START ===
2025-11-20 15:05:32,092 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:05:32,815 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:05:32,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:32,821 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:05:32,822 INFO: Fetch สำเร็จ
2025-11-20 15:05:32,828 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:05:33,672 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:33,672 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:05:35,419 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:35,420 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:05:36,308 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:05:36,308 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:05:37,554 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:37,554 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:05:39,268 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:39,268 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:05:41,006 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:41,006 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:05:42,824 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:42,824 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:05:44,539 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:44,539 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:05:46,213 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:46,213 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:05:48,128 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:48,129 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:05:49,832 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:49,833 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:05:51,569 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:51,570 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:05:53,267 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:53,268 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:05:55,096 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:55,096 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:05:56,800 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:56,801 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:05:58,526 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:58,527 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:06:00,194 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:00,194 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:06:01,931 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:01,931 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:06:03,673 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:03,674 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 15:06:05,533 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:05,534 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 15:06:07,206 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:07,207 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 15:06:08,885 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:08,887 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 15:06:10,613 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:10,613 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 15:06:12,315 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:12,317 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 15:06:13,969 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:13,969 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 15:06:15,713 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:15,713 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 15:06:17,447 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:17,447 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 15:06:19,190 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:19,191 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 15:06:20,925 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:20,926 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 15:06:22,680 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:22,681 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 15:06:24,380 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:24,381 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 15:06:26,103 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:26,104 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 15:06:27,810 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:27,810 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 15:06:29,508 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:29,508 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 15:06:31,226 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:31,227 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 15:06:32,953 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:32,954 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 15:06:34,629 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:34,629 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 15:06:36,325 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:36,325 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 15:06:38,036 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:38,036 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 15:06:39,725 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:39,726 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 15:06:41,434 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:41,434 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 15:06:43,197 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:43,198 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 15:06:44,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:44,928 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 15:06:46,656 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:46,657 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 15:06:48,343 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:48,344 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 15:06:50,109 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:50,110 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 15:06:51,818 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:51,819 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 15:06:53,571 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:53,571 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 15:06:55,315 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:55,315 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 15:06:57,102 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:57,102 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 15:06:58,106 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 15:06:58,106 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 15:06:58,108 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 124 แถว
2025-11-20 15:06:58,108 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 15:06:58,110 INFO: รวมเก่า 124 + ใหม่ 124 → 124 (เพิ่ม 0)
2025-11-20 15:06:58,112 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 15:06:58,113 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 15:06:58,115 INFO: เริ่ม clean ข้อมูล: 124 แถว
2025-11-20 15:06:58,127 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (124 แถว)
2025-11-20 15:06:58,131 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 15:06:58,160 INFO: เตรียมโหลด 124 แถว
2025-11-20 15:06:58,293 INFO: โหลด DB สำเร็จ
2025-11-20 15:06:58,295 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 15:06:58,298 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 15:06:58,299 INFO: Load to DB + Backup สำเร็จ
2025-11-20 15:06:58,299 INFO: === PIPELINE END ===

2025-11-20 15:12:43,720 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:12:43,720 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:38:08,642 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 15:38:08,649 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 15:38:08,652 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:38:08,653 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 15:38:08,653 INFO: Scheduler started
2025-11-20 15:38:08,653 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 15:38:08,654 INFO: === PIPELINE START ===
2025-11-20 15:38:08,654 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:38:09,368 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:38:09,375 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:09,376 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:38:09,376 INFO: Fetch สำเร็จ
2025-11-20 15:38:09,384 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:38:10,067 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:10,068 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:38:11,756 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:11,756 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:38:13,497 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:13,497 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:38:14,281 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:38:14,282 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:38:15,232 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:15,232 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:38:16,942 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:16,942 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:38:18,622 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:18,622 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:38:20,391 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:20,392 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:38:22,124 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:22,124 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:38:23,826 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:23,826 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:38:25,535 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:25,536 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:38:27,351 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:27,351 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:38:29,073 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:29,073 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:38:30,780 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:30,780 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:38:32,435 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:32,435 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:38:34,116 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:34,117 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:38:35,801 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:35,801 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:38:37,479 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:37,479 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:38:39,182 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:39,183 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 15:38:40,880 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:40,881 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 15:38:42,592 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:42,592 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 15:38:44,337 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:44,337 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 15:38:46,044 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:46,045 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 15:38:47,747 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:47,748 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 15:38:49,464 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:49,465 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 15:38:51,206 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:51,207 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 15:38:52,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:52,929 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 15:38:54,618 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:54,618 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 15:38:56,370 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:56,371 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 15:38:58,107 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:58,107 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 15:38:59,858 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:59,859 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 15:39:01,587 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:01,588 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 15:39:03,293 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:03,293 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 15:39:05,030 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:05,030 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 15:39:06,813 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:06,814 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 15:39:08,479 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:08,480 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 15:39:10,173 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:10,173 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 15:39:11,868 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:11,868 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 15:39:13,565 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:13,565 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 15:39:15,216 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:15,216 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 15:39:16,946 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:16,947 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 15:39:18,628 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:18,628 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 15:39:20,320 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:20,320 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 15:39:22,019 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:22,020 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 15:39:23,712 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:23,713 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 15:39:25,446 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:25,447 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 15:39:27,159 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:27,160 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 15:39:28,834 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:28,835 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 15:39:30,545 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:30,546 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 15:39:32,254 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:32,255 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 15:39:33,251 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 15:39:33,251 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 15:39:33,253 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 124 แถว
2025-11-20 15:39:33,254 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 15:39:33,255 INFO: รวมเก่า 124 + ใหม่ 124 → 124 (เพิ่ม 0)
2025-11-20 15:39:33,257 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 15:39:33,258 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 15:39:33,260 INFO: เริ่ม clean ข้อมูล: 124 แถว
2025-11-20 15:39:33,272 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (124 แถว)
2025-11-20 15:39:33,275 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 15:39:33,314 INFO: เตรียมโหลด 124 แถว
2025-11-20 15:39:33,465 INFO: โหลด DB สำเร็จ
2025-11-20 15:39:33,467 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 15:39:33,469 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 15:39:33,470 INFO: Load to DB + Backup สำเร็จ
2025-11-20 15:39:33,470 INFO: === PIPELINE END ===

2025-11-20 15:39:49,933 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 15:39:49,939 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 15:39:49,941 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:39:49,941 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 15:39:49,943 INFO: Scheduler started
2025-11-20 15:39:49,943 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 15:39:49,943 INFO: === PIPELINE START ===
2025-11-20 15:39:49,943 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:39:50,710 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:39:50,715 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:50,717 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:39:50,717 INFO: Fetch สำเร็จ
2025-11-20 15:39:50,725 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:39:51,396 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:51,397 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:39:51,500 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:39:51,500 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:39:53,120 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:53,121 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:39:54,809 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:54,809 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:39:56,527 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:56,528 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:39:58,180 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:58,181 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:39:59,892 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:59,893 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:40:01,624 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:01,624 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:40:03,349 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:03,350 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:40:05,081 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:05,082 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:40:06,788 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:06,789 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:40:08,461 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:08,461 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:40:10,180 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:10,181 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:40:11,915 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:11,915 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:40:13,592 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:13,592 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:40:15,301 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:15,302 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:40:17,016 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:17,017 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:40:18,736 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:18,738 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:40:20,422 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:20,423 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 15:40:22,399 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 15:40:22,405 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 15:40:22,406 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:40:22,407 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 15:40:22,407 INFO: Scheduler started
2025-11-20 15:40:22,408 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 15:40:22,408 INFO: === PIPELINE START ===
2025-11-20 15:40:22,408 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:40:23,113 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:40:23,119 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:23,119 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:40:23,119 INFO: Fetch สำเร็จ
2025-11-20 15:40:23,126 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:40:23,905 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:23,905 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:40:24,400 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:40:24,400 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:40:25,683 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:25,684 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:40:27,394 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:27,394 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:40:29,103 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:29,104 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:40:30,777 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:30,778 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:40:32,454 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:32,455 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:40:34,177 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:34,177 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:40:35,888 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:35,889 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:40:37,604 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:37,604 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:40:39,327 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:39,328 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:40:41,085 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:41,085 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:40:42,832 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:42,833 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:40:44,570 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:44,570 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:40:46,326 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:46,327 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:40:48,063 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:48,064 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:40:49,819 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:49,819 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:40:51,462 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:51,463 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:40:53,211 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:53,212 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 15:40:54,987 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:54,988 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 15:40:56,728 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:56,729 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 15:40:58,457 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:58,457 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 15:41:00,176 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:00,177 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 15:41:01,957 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:01,957 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 15:41:03,639 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:03,640 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 15:41:05,382 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:05,382 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 15:41:07,091 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:07,091 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 15:41:08,835 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:08,835 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 15:41:10,536 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:10,536 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 15:41:12,196 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:12,196 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 15:41:13,894 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:13,895 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 15:41:15,569 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:15,570 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 15:41:17,242 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:17,243 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 15:41:18,929 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:18,929 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 15:41:20,634 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:20,636 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 15:41:22,353 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:22,354 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 15:41:24,030 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:24,030 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 15:41:25,718 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:25,719 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 15:41:27,412 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:27,412 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 15:41:29,116 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:29,117 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 15:41:30,802 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:30,803 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 15:41:32,489 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:32,490 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 15:41:34,130 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:34,131 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 15:41:35,805 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:35,805 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 15:41:37,500 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:37,501 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 15:41:39,234 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:39,235 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 15:41:40,903 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:40,903 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 15:41:42,655 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:42,655 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 15:41:44,376 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:44,376 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 15:41:46,092 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:46,092 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 15:41:47,112 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 15:41:47,112 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 15:41:47,115 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 124 แถว
2025-11-20 15:41:47,115 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 15:41:47,118 INFO: รวมเก่า 124 + ใหม่ 124 → 124 (เพิ่ม 0)
2025-11-20 15:41:47,119 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 15:41:47,120 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 15:41:47,121 INFO: เริ่ม clean ข้อมูล: 124 แถว
2025-11-20 15:41:47,132 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (124 แถว)
2025-11-20 15:41:47,136 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 15:41:47,163 INFO: เตรียมโหลด 124 แถว
2025-11-20 15:41:47,283 INFO: โหลด DB สำเร็จ
2025-11-20 15:41:47,285 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 15:41:47,287 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 15:41:47,287 INFO: Load to DB + Backup สำเร็จ
2025-11-20 15:41:47,287 INFO: === PIPELINE END ===

2025-11-20 15:42:44,552 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 15:42:44,559 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 15:42:44,561 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:42:44,562 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 15:42:44,562 INFO: Scheduler started
2025-11-20 15:42:44,562 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 15:42:44,562 INFO: === PIPELINE START ===
2025-11-20 15:42:44,563 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:42:45,327 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:42:45,334 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:45,334 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:42:45,336 INFO: Fetch สำเร็จ
2025-11-20 15:42:45,344 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:42:46,069 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:46,070 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:42:46,185 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:42:46,185 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:42:46,261 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:42:46,261 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:42:47,827 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:47,828 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:42:49,594 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:49,594 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:42:51,334 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:51,335 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:42:53,042 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:53,043 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:42:54,752 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:54,753 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:42:56,450 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:56,451 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:42:58,197 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:58,198 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:42:59,947 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:59,948 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:43:01,702 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:01,703 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:43:03,423 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:03,424 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:43:05,154 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:05,155 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:43:06,879 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:06,880 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:43:08,605 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:08,606 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:43:10,335 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:10,335 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:43:12,053 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:12,054 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:43:13,767 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:13,768 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:43:15,514 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:15,514 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 15:43:17,293 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:17,293 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 15:43:19,016 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:19,016 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 15:43:20,720 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:20,721 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 15:43:22,526 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:22,528 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 15:43:24,375 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:24,376 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 15:43:26,121 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:26,122 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 15:43:27,842 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:27,843 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 15:43:29,574 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:29,574 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 15:43:31,257 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:31,257 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 15:43:32,993 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:32,993 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 15:43:34,703 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:34,703 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 15:43:36,428 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:36,428 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 15:43:38,145 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:38,145 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 15:43:39,876 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:39,876 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 15:43:41,604 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:41,605 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 15:43:43,390 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:43,391 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 15:43:45,139 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:45,140 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 15:43:46,924 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:46,925 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 15:43:48,751 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:48,752 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 15:43:50,504 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:50,505 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 15:43:52,471 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:52,472 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 15:43:54,330 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:54,330 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 15:43:56,169 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:56,169 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 15:43:57,948 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:57,949 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 15:43:59,684 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:59,684 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 15:44:01,460 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:44:01,460 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 15:44:03,181 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:44:03,182 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 15:44:05,037 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:44:05,038 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 15:44:06,841 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:44:06,842 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 15:44:08,639 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:44:08,640 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 15:44:10,417 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:44:10,418 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 15:44:11,444 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 15:44:11,444 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 15:44:11,446 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 124 แถว
2025-11-20 15:44:11,447 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 15:44:11,448 INFO: รวมเก่า 124 + ใหม่ 124 → 124 (เพิ่ม 0)
2025-11-20 15:44:11,451 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 15:44:11,451 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 15:44:11,453 INFO: เริ่ม clean ข้อมูล: 124 แถว
2025-11-20 15:44:11,465 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (124 แถว)
2025-11-20 15:44:11,470 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 15:44:11,499 INFO: เตรียมโหลด 124 แถว
2025-11-20 15:44:11,636 INFO: โหลด DB สำเร็จ
2025-11-20 15:44:11,637 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 15:44:11,639 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 15:44:11,639 INFO: Load to DB + Backup สำเร็จ
2025-11-20 15:44:11,640 INFO: === PIPELINE END ===

2025-11-20 15:51:22,354 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 15:51:22,358 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 15:51:22,360 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:51:22,361 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 15:51:22,361 INFO: Scheduler started
2025-11-20 15:51:22,361 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 15:51:22,361 INFO: === PIPELINE START ===
2025-11-20 15:51:22,361 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:51:23,109 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:51:23,115 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:23,115 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:51:23,116 INFO: Fetch สำเร็จ
2025-11-20 15:51:23,123 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:51:23,796 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:23,796 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:51:25,521 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:25,522 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:51:27,251 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:27,251 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:51:28,954 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:28,954 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:51:30,650 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:30,651 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:51:32,328 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:32,328 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:51:34,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:34,081 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:51:35,799 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:35,800 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:51:35,906 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:51:35,906 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:51:37,493 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:37,494 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:51:39,225 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:39,225 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:51:40,932 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:40,932 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:51:42,714 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:42,715 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:51:44,410 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:44,411 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:51:46,070 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:46,071 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:51:47,817 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:47,817 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:51:49,466 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:49,466 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:51:51,160 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:51,160 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:51:52,865 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:52,865 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 15:51:54,561 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:54,562 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 15:51:56,299 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:56,300 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 15:51:58,033 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:58,034 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 15:51:59,726 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:59,727 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 15:52:01,408 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:01,409 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 15:52:03,118 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:03,119 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 15:52:04,858 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:04,859 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 15:52:06,628 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:06,629 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 15:52:08,322 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:08,323 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 15:52:10,027 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:10,027 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 15:52:11,700 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:11,700 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 15:52:13,437 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:13,438 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 15:52:15,122 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:15,122 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 15:52:16,880 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:16,881 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 15:52:18,595 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:18,595 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 15:52:20,740 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:20,740 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 15:52:22,438 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:22,439 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 15:52:24,114 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:24,114 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 15:52:25,815 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:25,816 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 15:52:27,529 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:27,530 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 15:52:29,233 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:29,233 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 15:52:30,925 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:30,926 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 15:52:32,619 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:32,619 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 15:52:34,354 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:34,355 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 15:52:36,078 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:36,078 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 15:52:37,789 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:37,790 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 15:52:39,509 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:39,510 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 15:52:41,225 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:41,226 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 15:52:42,984 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:42,986 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 15:52:44,713 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:44,714 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 15:52:46,422 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:46,423 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 15:52:47,437 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 15:52:47,437 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 15:52:47,438 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 124 แถว
2025-11-20 15:52:47,439 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 15:52:47,441 INFO: รวมเก่า 124 + ใหม่ 124 → 124 (เพิ่ม 0)
2025-11-20 15:52:47,442 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 15:52:47,443 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 15:52:47,445 INFO: เริ่ม clean ข้อมูล: 124 แถว
2025-11-20 15:52:47,457 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (124 แถว)
2025-11-20 15:52:47,461 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 15:52:47,489 INFO: เตรียมโหลด 124 แถว
2025-11-20 15:52:47,642 INFO: โหลด DB สำเร็จ
2025-11-20 15:52:47,644 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 15:52:47,647 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 15:52:47,647 INFO: Load to DB + Backup สำเร็จ
2025-11-20 15:52:47,647 INFO: === PIPELINE END ===

2025-11-20 15:55:38,346 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:55:38,346 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:55:41,597 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:55:41,597 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 16:00:50,992 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 16:00:50,992 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 16:02:26,920 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 16:02:26,920 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 16:05:00,003 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 17:05:00 +07)" (scheduled at 2025-11-20 16:05:00+07:00)
2025-11-20 16:05:00,004 INFO: === PIPELINE START ===
2025-11-20 16:05:00,006 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 16:05:00,774 INFO: ดึง 2025-11-20 15:00:00+07:00 - 2025-11-20 16:00:00+07:00 → 2 แถว
2025-11-20 16:05:00,778 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 16:05:00,780 INFO: สำเร็จ: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-20 16:05:00,780 INFO: Fetch สำเร็จ
2025-11-20 16:05:00,798 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 16:05:01,484 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:01,484 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 16:05:03,207 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:03,208 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 16:05:04,925 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:04,926 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 16:05:06,645 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:06,646 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 16:05:08,409 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:08,410 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 16:05:10,042 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:10,042 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 16:05:11,850 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:11,851 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 16:05:13,626 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:13,626 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 16:05:15,377 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:15,378 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 16:05:17,132 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:17,132 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 16:05:18,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:18,822 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 16:05:20,568 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:20,569 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 16:05:22,309 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:22,310 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 16:05:24,004 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:24,004 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 16:05:25,693 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:25,694 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 16:05:27,346 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:27,346 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 16:05:29,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:29,080 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 16:05:30,806 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:30,807 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 16:05:32,571 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:32,571 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 16:05:34,279 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:34,280 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 16:05:35,956 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:35,957 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 16:05:37,684 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:37,685 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 16:05:39,338 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:39,339 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 16:05:40,993 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:40,993 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 16:05:42,735 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:42,736 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 16:05:44,370 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:44,371 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 16:05:46,059 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:46,060 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 16:05:47,779 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:47,780 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 16:05:49,466 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:49,467 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 16:05:51,164 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:51,164 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 16:05:52,823 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:52,823 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 16:05:54,508 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:54,509 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 16:05:56,252 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:56,252 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 16:05:57,980 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:57,982 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 16:05:59,651 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:59,652 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 16:06:01,314 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:01,314 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 16:06:02,976 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:02,977 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 16:06:04,652 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:04,653 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 16:06:06,304 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:06,304 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 16:06:08,011 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:08,012 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 16:06:09,687 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:09,688 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 16:06:11,316 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:11,316 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 16:06:12,979 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:12,980 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 16:06:14,766 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:14,766 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 16:06:16,474 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:16,474 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 16:06:18,220 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:18,220 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 16:06:19,887 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:19,888 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 16:06:21,652 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:21,653 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 16:06:23,343 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:23,344 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 16:06:24,355 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 16:06:24,356 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 16:06:24,357 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 125 แถว
2025-11-20 16:06:24,358 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 16:06:24,359 INFO: รวมเก่า 124 + ใหม่ 125 → 125 (เพิ่ม 1)
2025-11-20 16:06:24,361 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 16:06:24,361 INFO: Format สำเร็จ: +1 แถว
2025-11-20 16:06:24,372 INFO: เริ่ม clean ข้อมูล: 125 แถว
2025-11-20 16:06:24,382 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (125 แถว)
2025-11-20 16:06:24,385 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 16:06:24,387 INFO: เตรียมโหลด 125 แถว
2025-11-20 16:06:24,517 INFO: โหลด DB สำเร็จ
2025-11-20 16:06:24,519 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 16:06:24,521 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 16:06:24,521 INFO: Load to DB + Backup สำเร็จ
2025-11-20 16:06:24,521 INFO: === PIPELINE END ===

2025-11-20 16:06:24,521 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 17:05:00 +07)" executed successfully
2025-11-20 16:10:25,552 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 16:10:25,553 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 16:51:09,795 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 16:51:09,801 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 16:51:09,802 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 16:51:09,803 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 16:51:09,803 INFO: Scheduler started
2025-11-20 16:51:09,803 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 16:51:09,803 INFO: === PIPELINE START ===
2025-11-20 16:51:09,804 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 16:51:10,493 INFO: ดึง 2025-11-20 15:00:00+07:00 - 2025-11-20 16:00:00+07:00 → 2 แถว
2025-11-20 16:51:10,497 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:10,498 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 16:51:10,498 INFO: Fetch สำเร็จ
2025-11-20 16:51:10,508 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 16:51:11,143 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:11,143 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 16:51:13,116 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:13,117 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 16:51:15,169 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:15,170 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 16:51:16,942 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:16,943 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 16:51:18,688 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:18,688 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 16:51:20,758 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:20,760 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 16:51:22,872 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:22,873 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 16:51:24,645 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:24,646 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 16:51:26,392 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:26,393 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 16:51:28,078 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:28,079 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 16:51:29,770 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:29,770 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 16:51:31,463 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:31,464 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 16:51:33,369 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:33,370 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 16:51:35,047 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:35,048 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 16:51:36,736 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:36,736 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 16:51:36,825 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 16:51:36,825 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 16:51:38,464 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:38,465 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 16:51:40,162 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:40,163 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 16:51:41,833 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:41,833 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 16:51:43,492 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:43,493 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 16:51:45,162 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:45,162 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 16:51:46,832 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:46,832 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 16:51:48,912 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:48,913 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 16:51:51,044 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:51,045 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 16:51:53,131 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:53,132 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 16:51:55,117 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:55,117 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 16:51:56,925 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:56,926 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 16:51:58,612 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:51:58,613 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 16:52:00,353 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:00,353 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 16:52:02,054 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:02,055 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 16:52:03,750 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:03,751 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 16:52:05,402 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:05,403 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 16:52:07,056 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:07,057 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 16:52:08,743 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:08,743 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 16:52:10,403 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:10,404 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 16:52:12,090 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:12,091 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 16:52:13,765 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:13,766 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 16:52:15,445 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:15,445 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 16:52:17,136 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:17,137 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 16:52:18,812 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:18,812 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 16:52:20,759 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:20,760 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 16:52:20,798 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 16:52:20,798 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 16:52:22,672 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:22,673 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 16:52:24,631 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:24,631 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 16:52:26,606 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:26,606 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 16:52:28,691 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:28,692 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 16:52:30,405 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:30,405 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 16:52:32,106 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:32,108 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 16:52:33,846 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:33,847 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 16:52:35,547 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:35,548 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 16:52:37,248 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:52:37,249 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 16:52:38,225 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 16:52:38,226 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 16:52:38,230 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 125 แถว
2025-11-20 16:52:38,231 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 16:52:38,234 INFO: รวมเก่า 125 + ใหม่ 125 → 125 (เพิ่ม 0)
2025-11-20 16:52:38,237 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 16:52:38,237 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 16:52:38,239 INFO: เริ่ม clean ข้อมูล: 125 แถว
2025-11-20 16:52:38,249 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (125 แถว)
2025-11-20 16:52:38,254 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 16:52:38,281 INFO: เตรียมโหลด 125 แถว
2025-11-20 16:52:38,399 INFO: โหลด DB สำเร็จ
2025-11-20 16:52:38,401 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 16:52:38,403 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 16:52:38,403 INFO: Load to DB + Backup สำเร็จ
2025-11-20 16:52:38,403 INFO: === PIPELINE END ===

2025-11-20 16:54:54,028 ERROR: latest_readings error
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 162, in latest_readings
    readings = await upsert_air_reading(db, limit=10)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: upsert_air_reading() got an unexpected keyword argument 'limit'
2025-11-20 16:55:30,161 ERROR: latest_readings error
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 162, in latest_readings
    readings = await upsert_air_reading(db, limit=10)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: upsert_air_reading() got an unexpected keyword argument 'limit'
2025-11-20 16:57:12,882 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 16:57:12,888 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 16:57:12,890 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 16:57:12,891 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 16:57:12,891 INFO: Scheduler started
2025-11-20 16:57:12,891 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 16:57:12,891 INFO: === PIPELINE START ===
2025-11-20 16:57:12,891 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 16:57:13,597 INFO: ดึง 2025-11-20 15:00:00+07:00 - 2025-11-20 16:00:00+07:00 → 2 แถว
2025-11-20 16:57:13,606 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:13,607 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 16:57:13,607 INFO: Fetch สำเร็จ
2025-11-20 16:57:13,616 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 16:57:14,325 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:14,326 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 16:57:16,248 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:16,249 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 16:57:18,275 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:18,275 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 16:57:19,960 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:19,960 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 16:57:21,608 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:21,608 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 16:57:23,307 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:23,307 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 16:57:24,980 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:24,981 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 16:57:26,706 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:26,706 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 16:57:28,352 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:28,353 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 16:57:30,023 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:30,023 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 16:57:31,779 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:31,779 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 16:57:33,457 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:33,458 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 16:57:35,135 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:35,135 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 16:57:36,835 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:36,836 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 16:57:38,522 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:38,523 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 16:57:39,466 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 16:57:39,467 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 16:57:40,255 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:40,256 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 16:57:41,987 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:41,987 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 16:57:43,810 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:43,811 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 16:57:45,797 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:45,797 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 16:57:47,759 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:47,759 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 16:57:49,621 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:49,622 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 16:57:51,532 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:51,533 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 16:57:53,273 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:53,273 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 16:57:54,955 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:54,955 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 16:57:56,643 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:56,644 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 16:57:58,314 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:57:58,314 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 16:58:00,010 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:00,010 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 16:58:01,668 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:01,669 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 16:58:03,386 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:03,386 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 16:58:05,068 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:05,068 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 16:58:06,870 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:06,871 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 16:58:08,498 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:08,499 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 16:58:10,154 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:10,155 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 16:58:11,866 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:11,867 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 16:58:13,564 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:13,565 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 16:58:15,293 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:15,293 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 16:58:17,197 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:17,198 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 16:58:19,002 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:19,003 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 16:58:20,851 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:20,852 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 16:58:22,801 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:22,802 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 16:58:24,731 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:24,731 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 16:58:26,731 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:26,732 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 16:58:28,541 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:28,542 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 16:58:30,198 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:30,199 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 16:58:31,906 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:31,906 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 16:58:33,579 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:33,580 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 16:58:35,258 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:35,258 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 16:58:36,975 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:36,976 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 16:58:38,689 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:58:38,689 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 16:58:39,697 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 16:58:39,697 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 16:58:39,700 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 125 แถว
2025-11-20 16:58:39,700 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 16:58:39,704 INFO: รวมเก่า 125 + ใหม่ 125 → 125 (เพิ่ม 0)
2025-11-20 16:58:39,706 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 16:58:39,706 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 16:58:39,709 INFO: เริ่ม clean ข้อมูล: 125 แถว
2025-11-20 16:58:39,722 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (125 แถว)
2025-11-20 16:58:39,727 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 16:58:40,828 INFO: เตรียมโหลด 125 แถว
2025-11-20 16:58:40,969 INFO: โหลด DB สำเร็จ
2025-11-20 16:58:40,970 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 16:58:40,973 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 16:58:40,973 INFO: Load to DB + Backup สำเร็จ
2025-11-20 16:58:40,973 INFO: === PIPELINE END ===

2025-11-20 16:58:54,635 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 16:58:54,635 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 17:00:29,666 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 17:00:29,666 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 17:02:22,189 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 17:02:22,189 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 17:05:00,003 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 18:05:00 +07)" (scheduled at 2025-11-20 17:05:00+07:00)
2025-11-20 17:05:00,004 INFO: === PIPELINE START ===
2025-11-20 17:05:00,004 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 17:05:00,910 INFO: ดึง 2025-11-20 16:00:00+07:00 - 2025-11-20 17:00:00+07:00 → 2 แถว
2025-11-20 17:05:00,915 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 17:05:00,916 INFO: สำเร็จ: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-20 17:05:00,916 INFO: Fetch สำเร็จ
2025-11-20 17:05:00,934 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 17:05:01,800 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:01,801 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 17:05:03,670 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:03,670 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 17:05:05,444 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:05,444 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 17:05:07,222 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:07,223 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 17:05:09,090 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:09,091 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 17:05:11,147 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:11,148 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 17:05:12,842 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:12,843 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 17:05:14,500 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:14,501 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 17:05:16,161 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:16,162 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 17:05:17,899 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:17,899 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 17:05:19,588 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:19,589 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 17:05:21,249 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:21,249 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 17:05:22,912 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:22,913 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 17:05:24,564 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:24,565 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 17:05:26,291 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:26,291 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 17:05:27,962 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:27,963 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 17:05:29,632 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:29,633 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 17:05:31,352 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:31,353 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 17:05:33,024 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:33,025 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 17:05:34,927 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:34,927 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 17:05:36,869 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:36,870 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 17:05:38,977 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:38,977 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 17:05:41,071 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:41,071 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 17:05:42,815 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:42,815 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 17:05:44,574 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:44,574 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 17:05:46,582 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:46,582 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 17:05:48,365 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:48,365 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 17:05:50,065 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:50,066 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 17:05:51,788 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:51,788 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 17:05:53,502 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:53,503 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 17:05:55,206 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:55,207 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 17:05:56,851 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:56,852 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 17:05:58,617 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:05:58,618 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 17:06:00,330 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:00,331 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 17:06:02,085 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:02,086 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 17:06:03,770 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:03,771 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 17:06:05,485 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:05,485 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 17:06:07,163 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:07,163 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 17:06:08,815 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:08,816 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 17:06:10,536 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:10,536 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 17:06:12,253 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:12,254 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 17:06:14,298 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:14,299 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 17:06:16,265 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:16,266 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 17:06:17,929 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:17,929 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 17:06:19,909 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:19,910 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 17:06:21,903 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:21,903 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 17:06:23,626 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:23,626 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 17:06:25,347 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:25,348 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 17:06:27,033 INFO: ไม่มีข้อมูลใหม่
2025-11-20 17:06:27,034 INFO: เติม 2025-11-20 17:00 → +0
2025-11-20 17:06:28,047 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 17:06:28,048 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 17:06:28,053 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 126 แถว
2025-11-20 17:06:28,055 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 17:06:28,059 INFO: รวมเก่า 125 + ใหม่ 126 → 126 (เพิ่ม 1)
2025-11-20 17:06:28,060 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 17:06:28,061 INFO: Format สำเร็จ: +1 แถว
2025-11-20 17:06:28,071 INFO: เริ่ม clean ข้อมูล: 126 แถว
2025-11-20 17:06:28,081 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (126 แถว)
2025-11-20 17:06:28,083 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 17:00:00          52.7            7.4       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 17:06:28,085 INFO: เตรียมโหลด 126 แถว
2025-11-20 17:06:28,194 INFO: โหลด DB สำเร็จ
2025-11-20 17:06:28,195 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 17:06:28,198 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 17:06:28,198 INFO: Load to DB + Backup สำเร็จ
2025-11-20 17:06:28,198 INFO: === PIPELINE END ===

2025-11-20 17:06:28,198 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 18:05:00 +07)" executed successfully
2025-11-20 17:06:57,151 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 17:06:57,151 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 17:06:57,306 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 17:06:57,307 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 18:05:00,004 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 19:05:00 +07)" (scheduled at 2025-11-20 18:05:00+07:00)
2025-11-20 18:05:00,007 INFO: === PIPELINE START ===
2025-11-20 18:05:00,008 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 18:05:00,743 INFO: ดึง 2025-11-20 17:00:00+07:00 - 2025-11-20 18:00:00+07:00 → 2 แถว
2025-11-20 18:05:00,748 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 18:05:00,749 INFO: สำเร็จ: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-20 18:05:00,749 INFO: Fetch สำเร็จ
2025-11-20 18:05:00,765 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 18:05:01,458 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:01,460 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 18:05:03,127 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:03,128 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 18:05:04,838 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:04,839 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 18:05:06,537 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:06,538 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 18:05:08,267 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:08,268 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 18:05:09,954 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:09,955 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 18:05:11,673 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:11,674 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 18:05:13,344 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:13,345 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 18:05:15,053 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:15,053 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 18:05:16,760 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:16,762 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 18:05:18,462 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:18,463 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 18:05:20,164 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:20,165 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 18:05:21,825 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:21,826 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 18:05:23,543 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:23,543 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 18:05:25,238 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:25,239 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 18:05:26,966 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:26,967 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 18:05:28,621 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:28,621 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 18:05:30,254 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:30,254 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 18:05:31,954 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:31,954 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 18:05:33,615 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:33,616 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 18:05:35,294 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:35,295 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 18:05:36,949 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:36,949 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 18:05:38,633 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:38,634 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 18:05:40,366 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:40,367 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 18:05:42,108 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:42,108 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 18:05:43,780 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:43,780 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 18:05:45,495 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:45,496 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 18:05:47,164 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:47,164 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 18:05:48,841 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:48,841 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 18:05:50,486 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:50,487 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 18:05:52,174 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:52,174 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 18:05:53,866 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:53,866 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 18:05:55,526 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:55,527 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 18:05:57,218 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:57,218 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 18:05:58,890 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:05:58,890 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 18:06:00,611 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:00,612 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 18:06:02,296 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:02,297 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 18:06:03,941 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:03,942 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 18:06:05,672 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:05,673 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 18:06:07,354 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:07,354 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 18:06:09,045 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:09,046 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 18:06:10,716 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:10,716 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 18:06:12,405 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:12,405 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 18:06:14,140 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:14,140 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 18:06:15,820 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:15,820 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 18:06:17,555 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:17,556 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 18:06:19,289 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:19,289 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 18:06:20,957 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:20,958 INFO: เติม 2025-11-20 17:00 → +0
2025-11-20 18:06:22,628 INFO: ไม่มีข้อมูลใหม่
2025-11-20 18:06:22,628 INFO: เติม 2025-11-20 18:00 → +0
2025-11-20 18:06:23,634 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 18:06:23,635 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 18:06:23,638 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 127 แถว
2025-11-20 18:06:23,640 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 18:06:23,643 INFO: รวมเก่า 126 + ใหม่ 127 → 127 (เพิ่ม 1)
2025-11-20 18:06:23,644 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 18:06:23,644 INFO: Format สำเร็จ: +1 แถว
2025-11-20 18:06:23,658 INFO: เริ่ม clean ข้อมูล: 127 แถว
2025-11-20 18:06:23,668 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (127 แถว)
2025-11-20 18:06:23,671 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 18:00:00          46.5            7.4       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7            7.4       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 18:06:23,672 INFO: เตรียมโหลด 127 แถว
2025-11-20 18:06:23,812 INFO: โหลด DB สำเร็จ
2025-11-20 18:06:23,815 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 18:06:23,817 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 18:06:23,818 INFO: Load to DB + Backup สำเร็จ
2025-11-20 18:06:23,818 INFO: === PIPELINE END ===

2025-11-20 18:06:23,818 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 19:05:00 +07)" executed successfully
2025-11-20 19:05:00,005 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 20:05:00 +07)" (scheduled at 2025-11-20 19:05:00+07:00)
2025-11-20 19:05:00,008 INFO: === PIPELINE START ===
2025-11-20 19:05:00,009 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 19:05:00,704 INFO: ดึง 2025-11-20 18:00:00+07:00 - 2025-11-20 19:00:00+07:00 → 2 แถว
2025-11-20 19:05:00,709 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 19:05:00,710 INFO: สำเร็จ: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-20 19:05:00,710 INFO: Fetch สำเร็จ
2025-11-20 19:05:00,725 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 19:05:01,464 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:01,465 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 19:05:03,164 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:03,165 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 19:05:04,859 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:04,859 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 19:05:06,564 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:06,564 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 19:05:08,273 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:08,274 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 19:05:09,998 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:09,998 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 19:05:11,659 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:11,660 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 19:05:13,379 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:13,379 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 19:05:15,100 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:15,100 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 19:05:16,846 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:16,846 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 19:05:18,556 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:18,556 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 19:05:20,253 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:20,253 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 19:05:21,951 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:21,953 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 19:05:23,661 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:23,662 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 19:05:25,324 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:25,325 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 19:05:27,037 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:27,037 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 19:05:28,721 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:28,722 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 19:05:30,480 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:30,480 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 19:05:32,201 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:32,201 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 19:05:33,879 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:33,880 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 19:05:35,588 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:35,589 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 19:05:37,256 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:37,256 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 19:05:38,978 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:38,978 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 19:05:40,646 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:40,646 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 19:05:42,373 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:42,374 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 19:05:44,089 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:44,090 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 19:05:45,763 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:45,764 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 19:05:47,508 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:47,509 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 19:05:49,229 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:49,230 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 19:05:51,017 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:51,018 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 19:05:52,741 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:52,741 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 19:05:54,457 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:54,457 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 19:05:56,159 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:56,159 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 19:05:57,911 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:57,913 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 19:05:59,709 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:05:59,710 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 19:06:01,401 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:01,401 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 19:06:03,135 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:03,135 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 19:06:04,828 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:04,828 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 19:06:06,557 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:06,558 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 19:06:08,316 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:08,316 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 19:06:10,030 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:10,031 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 19:06:11,734 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:11,734 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 19:06:13,447 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:13,447 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 19:06:15,172 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:15,172 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 19:06:16,901 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:16,901 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 19:06:18,671 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:18,672 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 19:06:20,350 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:20,350 INFO: เติม 2025-11-20 17:00 → +0
2025-11-20 19:06:22,063 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:22,063 INFO: เติม 2025-11-20 18:00 → +0
2025-11-20 19:06:23,771 INFO: ไม่มีข้อมูลใหม่
2025-11-20 19:06:23,772 INFO: เติม 2025-11-20 19:00 → +0
2025-11-20 19:06:24,786 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 19:06:24,786 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 19:06:24,789 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 128 แถว
2025-11-20 19:06:24,790 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 19:06:24,791 INFO: รวมเก่า 127 + ใหม่ 128 → 128 (เพิ่ม 1)
2025-11-20 19:06:24,792 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 19:06:24,793 INFO: Format สำเร็จ: +1 แถว
2025-11-20 19:06:24,806 INFO: เริ่ม clean ข้อมูล: 128 แถว
2025-11-20 19:06:24,815 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (128 แถว)
2025-11-20 19:06:24,818 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 19:00:00          46.9            7.4       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5            7.4       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7            7.4       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 19:06:24,819 INFO: เตรียมโหลด 128 แถว
2025-11-20 19:06:24,947 INFO: โหลด DB สำเร็จ
2025-11-20 19:06:24,949 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 19:06:24,951 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 19:06:24,951 INFO: Load to DB + Backup สำเร็จ
2025-11-20 19:06:24,951 INFO: === PIPELINE END ===

2025-11-20 19:06:24,951 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 20:05:00 +07)" executed successfully
2025-11-20 20:05:00,010 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 21:05:00 +07)" (scheduled at 2025-11-20 20:05:00+07:00)
2025-11-20 20:05:00,013 INFO: === PIPELINE START ===
2025-11-20 20:05:00,013 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:05:00,715 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:05:00,721 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 20:05:00,722 INFO: สำเร็จ: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-20 20:05:00,722 INFO: Fetch สำเร็จ
2025-11-20 20:05:00,740 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:05:01,427 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:01,427 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:05:03,140 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:03,141 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 20:05:04,860 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:04,861 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 20:05:06,597 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:06,598 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 20:05:08,291 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:08,291 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 20:05:09,993 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:09,993 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 20:05:11,773 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:11,774 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 20:05:13,499 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:13,500 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 20:05:15,175 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:15,176 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 20:05:16,920 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:16,921 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 20:05:18,629 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:18,629 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 20:05:20,395 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:20,396 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 20:05:22,177 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:22,178 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 20:05:23,911 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:23,911 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 20:05:25,643 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:25,643 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 20:05:27,327 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:27,328 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 20:05:29,057 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:29,057 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 20:05:30,804 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:30,805 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 20:05:32,587 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:32,588 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 20:05:34,308 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:34,308 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 20:05:36,035 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:36,035 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 20:05:37,770 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:37,771 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 20:05:39,551 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:39,551 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 20:05:41,302 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:41,302 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 20:05:43,247 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:43,248 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 20:05:44,977 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:44,978 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 20:05:46,784 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:46,785 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 20:05:48,578 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:48,579 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 20:05:50,321 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:50,322 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 20:05:52,033 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:52,033 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 20:05:53,858 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:53,859 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 20:05:55,644 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:55,644 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 20:05:57,383 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:57,383 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 20:05:59,142 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:05:59,143 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 20:06:00,866 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:00,866 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 20:06:02,578 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:02,579 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 20:06:04,452 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:04,453 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 20:06:06,190 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:06,191 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 20:06:07,970 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:07,970 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 20:06:10,056 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:10,057 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 20:06:12,321 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:12,323 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 20:06:14,121 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:14,122 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 20:06:15,932 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:15,932 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 20:06:17,732 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:17,732 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 20:06:19,549 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:19,550 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 20:06:21,340 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:21,341 INFO: เติม 2025-11-20 17:00 → +0
2025-11-20 20:06:23,089 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:23,090 INFO: เติม 2025-11-20 18:00 → +0
2025-11-20 20:06:24,891 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:24,891 INFO: เติม 2025-11-20 19:00 → +0
2025-11-20 20:06:26,671 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:06:26,672 INFO: เติม 2025-11-20 20:00 → +0
2025-11-20 20:06:27,654 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 20:06:27,654 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 20:06:27,656 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 129 แถว
2025-11-20 20:06:27,656 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 20:06:27,658 INFO: รวมเก่า 128 + ใหม่ 129 → 129 (เพิ่ม 1)
2025-11-20 20:06:27,659 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 20:06:27,659 INFO: Format สำเร็จ: +1 แถว
2025-11-20 20:06:27,673 INFO: เริ่ม clean ข้อมูล: 129 แถว
2025-11-20 20:06:27,683 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (129 แถว)
2025-11-20 20:06:27,685 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 20:00:00          52.6            7.4       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9            7.4       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5            7.4       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7            7.4       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 20:06:27,687 INFO: เตรียมโหลด 129 แถว
2025-11-20 20:06:27,811 INFO: โหลด DB สำเร็จ
2025-11-20 20:06:27,813 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 20:06:27,815 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 20:06:27,815 INFO: Load to DB + Backup สำเร็จ
2025-11-20 20:06:27,815 INFO: === PIPELINE END ===

2025-11-20 20:06:27,815 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 21:05:00 +07)" executed successfully
2025-11-20 20:20:27,670 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 20:20:27,671 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 20:42:51,991 INFO: MODEL loaded. expected features (metadata): 172
2025-11-20 20:42:51,996 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 20:42:51,997 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:42:51,998 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 20:42:51,998 INFO: Scheduler started
2025-11-20 20:42:51,999 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 20:42:51,999 INFO: === PIPELINE START ===
2025-11-20 20:42:51,999 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:42:52,709 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:42:52,714 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:42:52,715 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 20:42:52,715 INFO: Fetch สำเร็จ
2025-11-20 20:42:52,722 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:42:53,465 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:42:53,465 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:42:55,147 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:42:55,147 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 20:42:56,858 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:42:56,859 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 20:42:56,948 INFO: feature built: actual_n=172, model_expected_n=172
2025-11-20 20:42:58,666 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:42:58,667 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 20:43:00,378 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:00,379 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 20:43:02,152 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:02,152 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 20:43:03,888 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:03,888 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 20:43:05,577 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:05,577 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 20:43:07,340 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:07,340 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 20:43:09,087 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:09,087 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 20:43:10,735 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:10,736 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 20:43:12,492 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:12,493 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 20:43:14,182 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:14,182 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 20:43:15,920 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:15,921 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 20:43:17,617 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:17,617 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 20:43:19,331 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:19,331 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 20:43:21,054 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:21,054 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 20:43:22,825 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:22,825 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 20:43:24,559 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:24,559 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 20:43:26,253 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:26,254 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 20:43:27,968 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:27,969 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 20:43:29,645 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:29,646 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 20:43:31,357 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:31,357 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 20:43:33,067 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:33,067 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 20:43:34,771 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:34,772 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 20:43:36,491 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:36,492 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 20:43:38,198 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:38,199 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 20:43:39,939 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:39,940 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 20:43:41,695 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:41,695 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 20:43:43,433 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:43,434 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 20:43:45,133 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:45,133 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 20:43:46,848 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:46,848 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 20:43:48,639 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:48,640 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 20:43:50,430 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:50,431 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 20:43:52,127 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:52,127 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 20:43:53,853 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:53,854 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 20:43:55,585 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:55,585 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 20:43:57,336 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:57,336 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 20:43:59,071 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:43:59,071 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 20:44:00,825 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:00,825 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 20:44:02,529 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:02,530 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 20:44:04,253 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:04,254 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 20:44:06,001 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:06,002 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 20:44:07,729 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:07,730 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 20:44:09,470 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:09,471 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 20:44:11,203 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:11,203 INFO: เติม 2025-11-20 17:00 → +0
2025-11-20 20:44:12,980 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:12,980 INFO: เติม 2025-11-20 18:00 → +0
2025-11-20 20:44:14,697 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:14,698 INFO: เติม 2025-11-20 19:00 → +0
2025-11-20 20:44:16,419 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:16,420 INFO: เติม 2025-11-20 20:00 → +0
2025-11-20 20:44:17,399 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 20:44:17,399 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 20:44:17,400 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 129 แถว
2025-11-20 20:44:17,400 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 20:44:17,402 INFO: รวมเก่า 129 + ใหม่ 129 → 129 (เพิ่ม 0)
2025-11-20 20:44:17,403 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 20:44:17,403 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 20:44:17,418 INFO: เริ่ม clean ข้อมูล: 129 แถว
2025-11-20 20:44:17,430 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (129 แถว)
2025-11-20 20:44:17,437 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 20:00:00          52.6            7.4       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9            7.4       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5            7.4       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7            7.4       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 20:44:17,480 INFO: เตรียมโหลด 129 แถว
2025-11-20 20:44:17,604 INFO: โหลด DB สำเร็จ
2025-11-20 20:44:17,606 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 20:44:17,608 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 20:44:17,608 INFO: Load to DB + Backup สำเร็จ
2025-11-20 20:44:17,608 INFO: === PIPELINE END ===

2025-11-20 20:44:29,762 INFO: MODEL loaded. expected features (metadata): 172
2025-11-20 20:44:29,768 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 20:44:29,770 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:44:29,771 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 20:44:29,771 INFO: Scheduler started
2025-11-20 20:44:29,771 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 20:44:29,771 INFO: === PIPELINE START ===
2025-11-20 20:44:29,771 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:44:30,470 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:44:30,475 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:30,476 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 20:44:30,476 INFO: Fetch สำเร็จ
2025-11-20 20:44:30,483 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:44:31,170 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:31,171 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:44:32,897 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:32,898 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 20:44:34,622 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:34,623 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 20:44:36,334 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:36,334 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 20:44:42,671 INFO: MODEL loaded. expected features (metadata): 172
2025-11-20 20:44:42,675 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 20:44:42,677 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:44:42,678 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 20:44:42,678 INFO: Scheduler started
2025-11-20 20:44:42,678 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 20:44:42,678 INFO: === PIPELINE START ===
2025-11-20 20:44:42,678 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:44:43,393 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:44:43,398 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:43,399 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 20:44:43,399 INFO: Fetch สำเร็จ
2025-11-20 20:44:43,407 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:44:44,155 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:44,156 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:44:45,178 INFO: feature built: actual_n=172, model_expected_n=172
2025-11-20 20:44:45,894 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:45,894 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 20:44:47,602 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:47,602 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 20:44:49,287 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:49,287 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 20:44:51,070 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:51,071 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 20:44:52,784 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:52,784 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 20:44:54,447 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:54,448 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 20:44:56,192 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:56,193 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 20:44:57,930 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:44:57,931 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 20:45:00,043 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:00,043 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 20:45:01,733 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:01,734 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 20:45:03,436 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:03,436 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 20:45:05,151 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:05,151 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 20:45:06,828 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:06,829 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 20:45:08,548 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:08,549 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 20:45:10,291 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:10,291 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 20:45:12,062 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:12,063 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 20:45:13,772 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:13,772 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 20:45:15,566 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:15,567 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 20:45:17,279 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:17,280 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 20:45:19,011 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:19,011 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 20:45:20,693 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:20,693 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 20:45:22,437 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:22,437 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 20:45:24,161 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:24,162 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 20:45:25,896 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:25,897 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 20:45:27,594 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:27,595 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 20:45:29,300 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:29,301 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 20:45:31,055 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:31,056 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 20:45:32,790 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:32,791 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 20:45:34,469 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:34,470 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 20:45:36,197 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:36,198 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 20:45:37,876 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:37,877 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 20:45:39,599 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:39,600 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 20:45:41,400 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:41,401 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 20:45:43,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:43,081 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 20:45:44,756 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:44,758 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 20:45:46,502 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:46,502 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 20:45:48,237 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:48,238 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 20:45:49,994 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:49,994 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 20:45:51,750 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:51,751 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 20:45:53,405 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:53,405 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 20:45:55,090 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:55,091 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 20:45:56,755 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:56,756 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 20:45:58,432 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:45:58,433 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 20:46:00,107 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:46:00,107 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 20:46:01,804 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:46:01,805 INFO: เติม 2025-11-20 17:00 → +0
2025-11-20 20:46:03,484 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:46:03,484 INFO: เติม 2025-11-20 18:00 → +0
2025-11-20 20:46:05,176 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:46:05,177 INFO: เติม 2025-11-20 19:00 → +0
2025-11-20 20:46:06,894 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:46:06,895 INFO: เติม 2025-11-20 20:00 → +0
2025-11-20 20:46:07,914 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 20:46:07,914 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 20:46:07,915 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 129 แถว
2025-11-20 20:46:07,916 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 20:46:07,917 INFO: รวมเก่า 129 + ใหม่ 129 → 129 (เพิ่ม 0)
2025-11-20 20:46:07,919 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 20:46:07,919 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 20:46:07,922 INFO: เริ่ม clean ข้อมูล: 129 แถว
2025-11-20 20:46:07,934 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (129 แถว)
2025-11-20 20:46:07,938 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 20:00:00          52.6            7.4       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9            7.4       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5            7.4       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7            7.4       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 20:46:07,969 INFO: เตรียมโหลด 129 แถว
2025-11-20 20:46:08,109 INFO: โหลด DB สำเร็จ
2025-11-20 20:46:08,111 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 20:46:08,114 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 20:46:08,114 INFO: Load to DB + Backup สำเร็จ
2025-11-20 20:46:08,114 INFO: === PIPELINE END ===

2025-11-20 20:47:53,491 INFO: MODEL loaded. expected features (metadata): 172
2025-11-20 20:47:53,496 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 20:47:53,498 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:47:53,499 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 20:47:53,499 INFO: Scheduler started
2025-11-20 20:47:53,499 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 20:47:53,500 INFO: === PIPELINE START ===
2025-11-20 20:47:53,500 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:47:54,274 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:47:54,280 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:47:54,281 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 20:47:54,281 INFO: Fetch สำเร็จ
2025-11-20 20:47:54,289 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:47:55,019 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:47:55,019 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:47:57,095 INFO: MODEL loaded. expected features (metadata): 172
2025-11-20 20:47:57,101 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 20:47:57,102 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:47:57,103 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 20:47:57,103 INFO: Scheduler started
2025-11-20 20:47:57,104 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 20:47:57,104 INFO: === PIPELINE START ===
2025-11-20 20:47:57,104 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:47:57,820 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:47:57,826 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:47:57,827 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 20:47:57,827 INFO: Fetch สำเร็จ
2025-11-20 20:47:57,833 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:47:58,490 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:47:58,490 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:48:00,167 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:00,168 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 20:48:01,870 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:01,871 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 20:48:03,566 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:03,567 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 20:48:06,388 WARNING: ไม่พบโมเดลที่: C:\Pm2_5\models\xgboost_pm25_.json
2025-11-20 20:48:06,393 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 20:48:06,394 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:48:06,395 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 20:48:06,395 INFO: Scheduler started
2025-11-20 20:48:06,395 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 20:48:06,395 INFO: === PIPELINE START ===
2025-11-20 20:48:06,395 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:48:07,118 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:48:07,125 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:07,126 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 20:48:07,126 INFO: Fetch สำเร็จ
2025-11-20 20:48:07,133 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:48:07,805 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:07,806 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:48:09,847 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 20:48:09,852 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 20:48:09,853 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:48:09,854 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 20:48:09,854 INFO: Scheduler started
2025-11-20 20:48:09,855 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 20:48:09,855 INFO: === PIPELINE START ===
2025-11-20 20:48:09,855 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:48:10,593 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:48:10,598 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:10,599 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 20:48:10,599 INFO: Fetch สำเร็จ
2025-11-20 20:48:10,609 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:48:11,293 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:11,294 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:48:11,409 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 20:48:11,410 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 20:48:13,048 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:13,049 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 20:48:14,773 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:14,773 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 20:48:16,464 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:16,465 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 20:48:18,181 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:18,182 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 20:48:19,912 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:19,912 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 20:48:21,616 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:21,617 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 20:48:23,370 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:23,371 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 20:48:25,011 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:25,012 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 20:48:26,736 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:26,736 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 20:48:28,477 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:28,477 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 20:48:30,209 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:30,209 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 20:48:31,931 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:31,932 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 20:48:33,662 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:33,663 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 20:48:35,348 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:35,349 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 20:48:37,060 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:37,061 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 20:48:38,783 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:38,784 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 20:48:40,493 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:40,494 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 20:48:42,158 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:42,158 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 20:48:43,862 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:43,862 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 20:48:45,550 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:45,550 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 20:48:47,256 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:47,257 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 20:48:49,017 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:49,017 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 20:48:50,778 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:50,778 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 20:48:52,525 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:52,526 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 20:48:54,261 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:54,261 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 20:48:55,971 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:55,972 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 20:48:57,677 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:57,678 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 20:48:59,425 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:48:59,426 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 20:49:01,167 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:01,167 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 20:49:02,869 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:02,870 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 20:49:04,546 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:04,547 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 20:49:06,212 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:06,213 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 20:49:07,949 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:07,949 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 20:49:09,661 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:09,662 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 20:49:11,386 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:11,387 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 20:49:13,091 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:13,091 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 20:49:14,789 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:14,790 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 20:49:16,510 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:16,511 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 20:49:18,230 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:18,231 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 20:49:19,982 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:19,982 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 20:49:21,749 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:21,750 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 20:49:23,485 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:23,485 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 20:49:25,202 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:25,202 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 20:49:26,904 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:26,905 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 20:49:28,617 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:28,618 INFO: เติม 2025-11-20 17:00 → +0
2025-11-20 20:49:30,315 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:30,317 INFO: เติม 2025-11-20 18:00 → +0
2025-11-20 20:49:32,036 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:32,037 INFO: เติม 2025-11-20 19:00 → +0
2025-11-20 20:49:33,729 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:49:33,729 INFO: เติม 2025-11-20 20:00 → +0
2025-11-20 20:49:34,736 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 20:49:34,736 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 20:49:34,738 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 129 แถว
2025-11-20 20:49:34,739 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 20:49:34,741 INFO: รวมเก่า 129 + ใหม่ 129 → 129 (เพิ่ม 0)
2025-11-20 20:49:34,743 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 20:49:34,744 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 20:49:34,746 INFO: เริ่ม clean ข้อมูล: 129 แถว
2025-11-20 20:49:34,759 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (129 แถว)
2025-11-20 20:49:34,763 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 20:00:00          52.6            7.4       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9            7.4       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5            7.4       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7            7.4       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 20:49:34,795 INFO: เตรียมโหลด 129 แถว
2025-11-20 20:49:34,964 INFO: โหลด DB สำเร็จ
2025-11-20 20:49:34,966 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 20:49:34,969 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 20:49:34,969 INFO: Load to DB + Backup สำเร็จ
2025-11-20 20:49:34,969 INFO: === PIPELINE END ===

2025-11-20 20:56:04,818 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 20:56:04,824 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 20:56:04,825 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:56:04,826 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 20:56:04,826 INFO: Scheduler started
2025-11-20 20:56:04,827 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 20:56:04,827 INFO: === PIPELINE START ===
2025-11-20 20:56:04,827 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:56:05,574 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:56:05,580 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:05,581 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 20:56:05,581 INFO: Fetch สำเร็จ
2025-11-20 20:56:05,589 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:56:06,274 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:06,274 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:56:07,984 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:07,984 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 20:56:09,636 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:09,637 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 20:56:11,538 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:11,539 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 20:56:13,184 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:13,184 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 20:56:14,877 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:14,877 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 20:56:16,644 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:16,645 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 20:56:18,388 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:18,389 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 20:56:20,124 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:20,124 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 20:56:21,832 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:21,833 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 20:56:23,567 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:23,567 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 20:56:25,271 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:25,271 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 20:56:27,140 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:27,141 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 20:56:28,903 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:28,904 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 20:56:30,604 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:30,605 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 20:56:32,299 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:32,299 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 20:56:33,989 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:33,989 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 20:56:35,683 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:35,684 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 20:56:37,421 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:37,421 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 20:56:39,096 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:39,097 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 20:56:40,782 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:40,782 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 20:56:42,483 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:42,484 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 20:56:44,203 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:44,204 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 20:56:45,912 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:45,912 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 20:56:47,640 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:47,641 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 20:56:49,358 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:49,358 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 20:56:51,067 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:51,067 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 20:56:52,797 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:52,797 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 20:56:54,515 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:54,516 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 20:56:56,251 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:56,252 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 20:56:58,033 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:58,033 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 20:56:59,678 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:56:59,679 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 20:57:01,407 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:01,407 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 20:57:03,416 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 20:57:03,421 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 20:57:03,423 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:57:03,424 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 20:57:03,424 INFO: Scheduler started
2025-11-20 20:57:03,424 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 20:57:03,425 INFO: === PIPELINE START ===
2025-11-20 20:57:03,425 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:57:04,117 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:57:04,127 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:04,128 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 20:57:04,128 INFO: Fetch สำเร็จ
2025-11-20 20:57:04,137 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:57:04,830 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:04,831 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:57:06,449 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 20:57:06,454 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 20:57:06,455 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:57:06,456 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 20:57:06,456 INFO: Scheduler started
2025-11-20 20:57:06,456 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 20:57:06,456 INFO: === PIPELINE START ===
2025-11-20 20:57:06,456 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:57:07,191 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:57:07,198 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:07,199 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 20:57:07,199 INFO: Fetch สำเร็จ
2025-11-20 20:57:07,206 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:57:07,887 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:07,888 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:57:09,631 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:09,632 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 20:57:11,334 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:11,334 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 20:57:13,024 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:13,025 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 20:57:14,776 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:14,776 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 20:57:16,497 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:16,497 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 20:57:18,161 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:18,161 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 20:57:19,870 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:19,870 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 20:57:21,545 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:21,545 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 20:57:23,205 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:23,205 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 20:57:24,934 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:24,935 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 20:57:26,607 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:26,607 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 20:57:28,352 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:28,352 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 20:57:30,072 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:30,073 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 20:57:31,808 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:31,808 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 20:57:33,518 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:33,519 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 20:57:35,250 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:35,251 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 20:57:36,961 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:36,961 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 20:57:39,090 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 20:57:39,096 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 20:57:39,098 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:57:39,099 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 20:57:39,099 INFO: Scheduler started
2025-11-20 20:57:39,099 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 20:57:39,100 INFO: === PIPELINE START ===
2025-11-20 20:57:39,100 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:57:39,815 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:57:39,822 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:39,823 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 20:57:39,823 INFO: Fetch สำเร็จ
2025-11-20 20:57:39,830 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:57:40,542 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:40,542 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:57:42,234 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:42,234 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 20:57:43,932 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:43,932 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 20:57:45,620 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:45,621 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 20:57:47,328 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:47,328 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 20:57:49,021 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:49,022 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 20:57:50,765 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:50,765 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 20:57:52,415 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:52,415 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 20:57:54,106 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:54,107 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 20:57:55,900 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:55,900 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 20:57:57,635 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:57,636 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 20:57:59,384 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:57:59,385 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 20:58:01,061 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:01,062 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 20:58:02,774 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:02,775 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 20:58:04,507 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:04,508 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 20:58:06,271 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:06,272 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 20:58:08,041 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:08,041 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 20:58:09,744 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:09,745 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 20:58:11,455 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:11,455 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 20:58:13,195 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:13,196 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 20:58:14,930 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:14,931 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 20:58:16,752 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:16,753 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 20:58:18,442 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:18,443 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 20:58:20,168 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:20,169 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 20:58:21,932 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:21,932 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 20:58:23,639 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:23,639 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 20:58:25,337 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:25,337 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 20:58:27,046 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:27,047 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 20:58:28,797 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:28,797 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 20:58:30,472 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:30,473 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 20:58:32,238 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:32,238 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 20:58:34,009 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:34,010 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 20:58:35,724 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:35,726 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 20:58:37,474 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:37,475 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 20:58:39,202 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:39,202 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 20:58:40,931 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:40,931 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 20:58:42,628 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:42,629 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 20:58:44,425 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:44,425 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 20:58:46,097 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:46,098 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 20:58:47,802 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:47,802 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 20:58:49,523 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:49,523 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 20:58:50,999 ERROR: fetch_api_data failed
Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 565, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1378, in getresponse
    response.begin()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\util\retry.py", line 474, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\util\util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 565, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1378, in getresponse
    response.begin()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 102, in fetch_api_data
    r = session.post(URL, data=payload, timeout=30)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 637, in post
    return self.request("POST", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 659, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
2025-11-20 20:58:51,067 ERROR: ดึง 2025-11-20 13:00:00+07:00 ล้มเหลว: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))
2025-11-20 20:58:52,798 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:52,799 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 20:58:54,742 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:54,743 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 20:58:56,403 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:56,404 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 20:58:58,177 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:58,178 INFO: เติม 2025-11-20 17:00 → +0
2025-11-20 20:58:59,870 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:58:59,871 INFO: เติม 2025-11-20 18:00 → +0
2025-11-20 20:59:01,668 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:01,669 INFO: เติม 2025-11-20 19:00 → +0
2025-11-20 20:59:03,572 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:03,572 INFO: เติม 2025-11-20 20:00 → +0
2025-11-20 20:59:04,593 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 20:59:04,601 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 129 แถว
2025-11-20 20:59:04,602 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 20:59:04,612 INFO: รวมเก่า 129 + ใหม่ 129 → 129 (เพิ่ม 0)
2025-11-20 20:59:04,614 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 20:59:04,614 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 20:59:04,616 INFO: เริ่ม clean ข้อมูล: 129 แถว
2025-11-20 20:59:04,626 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (129 แถว)
2025-11-20 20:59:04,630 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 20:00:00          52.6            7.4       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9            7.4       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5            7.4       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7            7.4       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 20:59:04,658 INFO: เตรียมโหลด 129 แถว
2025-11-20 20:59:04,659 INFO: อัปเดตค่าจริงใน DB → 2025-11-13 22:00:00+07:00 | {'PM10': 41.7, 'PM25': 17.3, 'WS': 0.2, 'WD': 55.0, 'Temp': 25.0, 'RH': 90.0, 'BP': 1012.9}
2025-11-20 20:59:04,715 ERROR: โหลด DB ล้มเหลว: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-20 20:59:04,715 ERROR: Pipeline ล้มเหลว: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-20 20:59:04,836 ERROR: Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "PM10" of relation "air_readings" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 111, in run_pipeline
    await load_and_backup(df_cleaned)
  File "C:\Pm2_5\tasks\load_to_db.py", line 78, in load_and_backup
    await upsert_air_reading(db, obj)
  File "C:\Pm2_5\app\crud.py", line 63, in upsert_air_reading
    await db.execute(stmt)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-11-20 20:59:04,837 INFO: === PIPELINE END ===

2025-11-20 20:59:19,735 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 20:59:19,740 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 20:59:19,741 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:59:19,742 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 20:59:19,742 INFO: Scheduler started
2025-11-20 20:59:19,742 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 20:59:19,743 INFO: === PIPELINE START ===
2025-11-20 20:59:19,743 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 20:59:20,515 INFO: ดึง 2025-11-20 19:00:00+07:00 - 2025-11-20 20:00:00+07:00 → 2 แถว
2025-11-20 20:59:20,523 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:20,524 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 20:59:20,524 INFO: Fetch สำเร็จ
2025-11-20 20:59:20,531 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 20:59:21,210 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:21,211 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 20:59:22,877 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:22,878 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 20:59:24,610 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:24,611 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 20:59:26,277 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:26,278 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 20:59:28,027 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:28,027 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 20:59:29,691 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:29,691 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 20:59:31,438 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:31,439 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 20:59:33,143 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:33,145 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 20:59:33,255 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 20:59:33,255 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 20:59:34,857 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:34,858 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 20:59:36,565 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:36,565 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 20:59:38,241 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:38,241 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 20:59:39,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:39,929 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 20:59:41,599 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:41,600 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 20:59:43,272 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:43,272 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 20:59:44,990 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:44,991 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 20:59:46,720 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:46,721 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 20:59:48,408 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:48,409 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 20:59:50,163 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:50,163 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 20:59:51,864 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:51,864 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 20:59:53,527 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:53,527 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 20:59:55,213 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:55,214 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 20:59:56,878 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:56,879 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 20:59:58,545 INFO: ไม่มีข้อมูลใหม่
2025-11-20 20:59:58,546 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 21:00:00,242 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:00,243 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 21:00:01,912 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:01,912 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 21:00:03,589 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:03,589 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 21:00:05,293 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:05,293 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 21:00:07,069 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:07,070 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 21:00:08,787 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:08,788 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 21:00:10,521 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:10,522 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 21:00:12,273 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:12,274 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 21:00:13,940 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:13,940 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 21:00:15,678 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:15,678 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 21:00:17,398 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:17,399 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 21:00:19,110 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:19,110 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 21:00:20,797 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:20,798 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 21:00:22,556 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:22,557 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 21:00:24,268 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:24,268 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 21:00:25,968 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:25,968 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 21:00:27,702 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:27,703 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 21:00:29,414 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:29,415 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 21:00:32,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:32,929 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 21:00:34,705 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:34,706 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 21:00:36,477 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:36,478 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 21:00:38,251 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:38,252 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 21:00:39,999 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:39,999 INFO: เติม 2025-11-20 17:00 → +0
2025-11-20 21:00:41,727 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:41,727 INFO: เติม 2025-11-20 18:00 → +0
2025-11-20 21:00:43,447 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:00:43,448 INFO: เติม 2025-11-20 19:00 → +0
2025-11-20 21:00:45,166 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 21:00:45,167 INFO: เติม 2025-11-20 20:00 → +1
2025-11-20 21:00:46,171 INFO: เติมข้อมูลย้อนหลังเสร็จ: +1 แถว
2025-11-20 21:00:46,173 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 130 แถว
2025-11-20 21:00:46,175 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 21:00:46,178 INFO: รวมเก่า 129 + ใหม่ 130 → 130 (เพิ่ม 1)
2025-11-20 21:00:46,179 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 21:00:46,180 INFO: Format สำเร็จ: +1 แถว
2025-11-20 21:00:46,192 INFO: เริ่ม clean ข้อมูล: 130 แถว
2025-11-20 21:00:46,202 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (130 แถว)
2025-11-20 21:00:46,205 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 21:00:00          56.7            7.4       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6            7.4       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9            7.4       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5            7.4       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7            7.4       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 21:00:46,233 INFO: เตรียมโหลด 130 แถว
2025-11-20 21:00:46,391 INFO: โหลด DB สำเร็จ
2025-11-20 21:00:46,393 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 21:00:46,395 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 21:00:46,395 INFO: Load to DB + Backup สำเร็จ
2025-11-20 21:00:46,395 INFO: === PIPELINE END ===

2025-11-20 21:02:42,008 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:02:42,014 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:02:42,015 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 21:02:42,016 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:02:42,016 INFO: Scheduler started
2025-11-20 21:02:42,016 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:02:42,017 INFO: === PIPELINE START ===
2025-11-20 21:02:42,017 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 21:02:42,852 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:02:42,857 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:02:42,857 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 21:02:42,857 INFO: Fetch สำเร็จ
2025-11-20 21:02:42,864 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:02:43,631 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:02:43,631 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 21:02:45,381 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:02:45,382 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 21:02:47,162 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:02:47,162 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 21:02:48,935 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:02:48,935 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 21:02:50,695 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:02:50,695 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 21:02:52,438 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:02:52,439 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 21:02:54,200 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:02:54,200 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 21:02:55,980 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:02:55,980 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 21:02:57,730 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:02:57,731 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 21:02:59,450 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:02:59,450 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 21:03:01,164 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:01,164 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 21:03:02,940 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:02,940 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 21:03:04,672 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:04,672 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 21:03:06,401 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:06,401 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 21:03:08,197 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:08,198 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 21:03:09,934 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:09,935 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 21:03:11,707 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:11,708 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 21:03:13,445 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:13,445 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 21:03:15,182 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:15,184 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 21:03:16,931 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:16,932 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 21:03:18,923 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:18,923 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 21:03:20,699 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:20,699 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 21:03:22,455 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:22,455 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 21:03:24,198 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:24,199 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 21:03:25,975 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:25,976 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 21:03:27,697 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:27,697 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 21:03:29,452 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:29,453 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 21:03:31,196 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:31,197 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 21:03:32,932 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:32,932 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 21:03:34,699 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:34,700 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 21:03:36,416 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:36,417 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 21:03:38,090 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:38,091 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 21:03:39,843 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:39,844 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 21:03:41,523 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:41,524 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 21:03:43,260 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:43,260 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 21:03:44,960 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:44,960 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 21:03:46,664 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:46,665 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 21:03:48,422 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:48,423 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 21:03:50,124 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:50,125 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 21:03:51,778 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:51,778 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 21:03:53,506 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:53,507 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 21:03:55,231 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:55,232 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 21:03:56,924 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:56,925 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 21:03:58,617 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:03:58,617 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 21:04:00,318 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:04:00,318 INFO: เติม 2025-11-20 17:00 → +0
2025-11-20 21:04:02,049 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:04:02,049 INFO: เติม 2025-11-20 18:00 → +0
2025-11-20 21:04:03,722 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:04:03,722 INFO: เติม 2025-11-20 19:00 → +0
2025-11-20 21:04:05,445 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:04:05,446 INFO: เติม 2025-11-20 20:00 → +0
2025-11-20 21:04:07,142 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:04:07,143 INFO: เติม 2025-11-20 21:00 → +0
2025-11-20 21:04:08,166 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 21:04:08,167 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 130 แถว
2025-11-20 21:04:08,167 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 21:04:08,167 INFO: รวมเก่า 130 + ใหม่ 130 → 130 (เพิ่ม 0)
2025-11-20 21:04:08,167 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 21:04:08,167 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 21:04:08,167 INFO: เริ่ม clean ข้อมูล: 130 แถว
2025-11-20 21:04:08,189 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (130 แถว)
2025-11-20 21:04:08,192 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 21:00:00          56.7            7.4       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6            7.4       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9            7.4       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5            7.4       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7            7.4       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 21:04:08,221 INFO: เตรียมโหลด 130 แถว
2025-11-20 21:04:08,273 ERROR: โหลด DB ล้มเหลว: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-20 21:04:08,274 ERROR: Pipeline ล้มเหลว: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-20 21:04:08,280 ERROR: Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "PM10" of relation "air_readings" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 111, in run_pipeline
    await load_and_backup(df_cleaned)
  File "C:\Pm2_5\tasks\load_to_db.py", line 78, in load_and_backup
    await upsert_air_reading(db, obj)
  File "C:\Pm2_5\app\crud.py", line 38, in upsert_air_reading
    await db.execute(stmt)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-11-20 21:04:08,281 INFO: === PIPELINE END ===

2025-11-20 21:05:00,004 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 22:05:00 +07)" (scheduled at 2025-11-20 21:05:00+07:00)
2025-11-20 21:05:00,005 INFO: === PIPELINE START ===
2025-11-20 21:05:00,005 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 21:05:00,999 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:05:01,002 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:01,003 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 21:05:01,003 INFO: Fetch สำเร็จ
2025-11-20 21:05:01,007 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:05:01,669 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:01,670 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 21:05:03,318 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:03,319 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 21:05:04,987 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:04,988 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 21:05:06,701 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:06,702 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 21:05:08,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:08,821 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 21:05:10,804 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:10,804 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 21:05:12,511 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:12,511 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 21:05:14,209 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:14,209 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 21:05:15,917 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:15,918 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 21:05:17,562 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:17,563 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 21:05:19,266 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:19,266 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 21:05:21,012 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:21,013 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 21:05:22,705 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:22,705 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 21:05:24,411 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:24,412 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 21:05:26,224 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:26,225 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 21:05:27,931 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:27,931 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 21:05:29,653 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:29,653 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 21:05:31,351 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:31,351 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 21:05:33,036 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:33,036 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 21:05:34,734 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:34,734 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 21:05:36,443 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:36,443 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 21:05:38,157 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:38,158 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 21:05:39,862 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:39,863 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 21:05:41,551 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:41,552 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 21:05:43,277 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:43,277 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 21:05:44,953 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:44,954 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 21:05:46,664 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:46,665 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 21:05:48,368 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:48,368 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 21:05:50,061 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:50,061 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 21:05:51,817 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:51,817 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 21:05:53,565 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:53,566 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 21:05:55,309 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:55,310 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 21:05:57,044 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:57,044 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 21:05:58,805 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:05:58,806 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 21:06:00,526 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:00,527 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 21:06:02,259 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:02,260 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 21:06:04,109 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:04,109 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 21:06:05,822 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:05,822 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 21:06:07,564 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:07,565 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 21:06:09,326 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:09,327 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 21:06:11,023 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:11,024 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 21:06:12,764 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:12,765 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 21:06:14,460 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:14,461 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 21:06:16,134 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:16,135 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 21:06:17,895 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:17,895 INFO: เติม 2025-11-20 17:00 → +0
2025-11-20 21:06:19,611 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:19,612 INFO: เติม 2025-11-20 18:00 → +0
2025-11-20 21:06:21,305 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:21,305 INFO: เติม 2025-11-20 19:00 → +0
2025-11-20 21:06:23,028 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:23,028 INFO: เติม 2025-11-20 20:00 → +0
2025-11-20 21:06:24,717 INFO: ไม่มีข้อมูลใหม่
2025-11-20 21:06:24,719 INFO: เติม 2025-11-20 21:00 → +0
2025-11-20 21:06:25,699 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 21:06:25,706 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 130 แถว
2025-11-20 21:06:25,709 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 21:06:25,712 INFO: รวมเก่า 130 + ใหม่ 130 → 130 (เพิ่ม 0)
2025-11-20 21:06:25,713 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 21:06:25,714 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 21:06:25,717 INFO: เริ่ม clean ข้อมูล: 130 แถว
2025-11-20 21:06:25,726 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (130 แถว)
2025-11-20 21:06:25,728 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 21:00:00          56.7            7.4       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6            7.4       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9            7.4       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5            7.4       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7            7.4       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 21:06:25,730 INFO: เตรียมโหลด 130 แถว
2025-11-20 21:06:25,733 ERROR: โหลด DB ล้มเหลว: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-20 21:06:25,733 ERROR: Pipeline ล้มเหลว: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-20 21:06:25,735 ERROR: Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "PM10" of relation "air_readings" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 111, in run_pipeline
    await load_and_backup(df_cleaned)
  File "C:\Pm2_5\tasks\load_to_db.py", line 78, in load_and_backup
    await upsert_air_reading(db, obj)
  File "C:\Pm2_5\app\crud.py", line 38, in upsert_air_reading
    await db.execute(stmt)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-11-20 21:06:25,736 INFO: === PIPELINE END ===

2025-11-20 21:06:25,736 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 22:05:00 +07)" executed successfully
2025-11-20 21:08:35,024 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:08:35,029 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:08:35,031 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:08:35,031 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:08:35,031 INFO: Scheduler started
2025-11-20 21:08:35,031 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:08:35,032 INFO: === PIPELINE START ===
2025-11-20 21:08:35,032 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:08:35,753 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:08:35,760 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:35,760 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:08:35,760 INFO: Fetch สำเร็จ
2025-11-20 21:08:35,781 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:08:36,451 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:36,452 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:08:38,159 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:38,159 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 21:08:39,865 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:39,866 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 21:08:41,593 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:41,593 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 21:08:43,242 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:43,243 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 21:08:44,962 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:44,963 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 21:08:46,699 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:46,699 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 21:08:48,407 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:48,408 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 21:08:50,080 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:50,081 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 21:08:51,817 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:51,818 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 21:08:53,527 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:53,527 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 21:08:55,239 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:55,239 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 21:08:56,958 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:56,959 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 21:08:58,588 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:08:58,589 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 21:09:00,260 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:00,261 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 21:09:01,929 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:01,929 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 21:09:03,636 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:03,637 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 21:09:05,327 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:05,328 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 21:09:07,068 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:07,069 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 21:09:08,780 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:08,780 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 21:09:10,450 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:10,450 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 21:09:12,209 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:12,209 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 21:09:13,929 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:13,929 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 21:09:15,608 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:15,608 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 21:09:17,309 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:17,309 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 21:09:18,994 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:18,994 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 21:09:20,670 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:20,670 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 21:09:22,360 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:22,360 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 21:09:24,029 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:24,029 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 21:09:25,698 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:25,698 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 21:09:27,374 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:27,375 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 21:09:29,092 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:29,092 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 21:09:30,738 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:30,738 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 21:09:32,414 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:32,414 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 21:09:34,116 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:34,116 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 21:09:35,779 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:35,779 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 21:09:37,453 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:37,454 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 21:09:39,129 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:39,129 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 21:09:41,185 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:41,185 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 21:09:42,895 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:42,895 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 21:09:44,636 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:44,637 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 21:09:46,352 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:46,352 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 21:09:48,035 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:48,035 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 21:09:49,749 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:49,750 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 21:09:51,395 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:51,396 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 21:09:53,133 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:53,134 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 21:09:54,845 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:54,846 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 21:09:56,698 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:56,699 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 21:09:58,422 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 21:09:58,423 INFO: เติม 2025-11-20 21:00 → +1
2025-11-20 21:09:59,394 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 21:09:59,395 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 130 แถว
2025-11-20 21:09:59,396 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 21:09:59,398 INFO: รวมเก่า 130 + ใหม่ 130 → 130 (เพิ่ม 0)
2025-11-20 21:09:59,399 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 21:09:59,399 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 21:09:59,413 INFO: เริ่ม clean ข้อมูล: 130 แถว
2025-11-20 21:09:59,426 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (130 แถว)
2025-11-20 21:09:59,433 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 21:09:59,468 INFO: เตรียมโหลด 130 แถว
2025-11-20 21:09:59,527 ERROR: โหลด DB ล้มเหลว: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-20 21:09:59,527 ERROR: Pipeline ล้มเหลว: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-20 21:09:59,533 ERROR: Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "PM10" of relation "air_readings" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 111, in run_pipeline
    await load_and_backup(df_cleaned)
  File "C:\Pm2_5\tasks\load_to_db.py", line 78, in load_and_backup
    await upsert_air_reading(db, obj)
  File "C:\Pm2_5\app\crud.py", line 38, in upsert_air_reading
    await db.execute(stmt)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-11-20 21:09:59,534 INFO: === PIPELINE END ===

2025-11-20 21:10:06,661 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 21:10:06,661 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 21:15:09,291 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:15:09,296 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:15:09,297 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:15:09,298 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:15:09,298 INFO: Scheduler started
2025-11-20 21:15:09,299 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:15:09,299 INFO: === PIPELINE START ===
2025-11-20 21:15:09,299 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:15:10,024 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:15:10,030 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:10,030 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:15:10,031 INFO: Fetch สำเร็จ
2025-11-20 21:15:10,050 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:15:10,789 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:10,789 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:15:12,731 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:15:12,737 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:15:12,739 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:15:12,739 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:15:12,739 INFO: Scheduler started
2025-11-20 21:15:12,740 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:15:12,740 INFO: === PIPELINE START ===
2025-11-20 21:15:12,740 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:15:13,455 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:15:13,461 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:13,462 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:15:13,462 INFO: Fetch สำเร็จ
2025-11-20 21:15:13,475 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:15:14,172 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:14,173 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:15:15,845 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:15,846 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 21:15:17,571 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:17,571 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 21:15:20,503 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:15:20,509 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:15:20,510 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:15:20,511 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:15:20,511 INFO: Scheduler started
2025-11-20 21:15:20,511 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:15:20,512 INFO: === PIPELINE START ===
2025-11-20 21:15:20,512 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:15:21,245 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:15:21,251 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:21,252 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:15:21,252 INFO: Fetch สำเร็จ
2025-11-20 21:15:21,260 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:15:22,033 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:22,034 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:15:23,779 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:23,780 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 21:15:25,490 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:25,491 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 21:15:27,217 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:27,217 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 21:15:28,945 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:28,945 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 21:15:30,646 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:30,647 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 21:15:32,394 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:32,394 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 21:15:34,103 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:34,103 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 21:15:35,854 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:35,854 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 21:15:37,597 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:37,598 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 21:15:39,298 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:39,298 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 21:15:40,995 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:40,996 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 21:15:42,720 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:42,722 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 21:15:44,567 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:44,567 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 21:15:46,277 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:46,278 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 21:15:47,974 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:47,974 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 21:15:49,674 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:49,674 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 21:15:51,409 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:51,410 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 21:15:53,153 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:53,154 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 21:15:54,835 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:54,835 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 21:15:56,489 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:56,489 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 21:15:58,195 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:58,195 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 21:15:59,941 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:15:59,943 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 21:16:01,730 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:01,730 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 21:16:03,434 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:03,435 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 21:16:05,177 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:05,177 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 21:16:06,890 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:06,890 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 21:16:08,629 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:08,630 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 21:16:10,369 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:10,369 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 21:16:12,095 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:12,095 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 21:16:13,814 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:13,814 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 21:16:15,559 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:15,559 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 21:16:17,378 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:17,379 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 21:16:19,124 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:19,124 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 21:16:20,850 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:20,850 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 21:16:22,536 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:22,536 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 21:16:24,290 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:24,291 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 21:16:25,962 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:25,963 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 21:16:27,662 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:27,662 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 21:16:29,364 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:29,364 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 21:16:31,074 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:31,074 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 21:16:32,794 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:32,794 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 21:16:34,508 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:34,508 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 21:16:36,242 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:36,242 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 21:16:37,960 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:37,962 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 21:16:39,695 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:39,695 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 21:16:41,440 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:41,440 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 21:16:43,166 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:43,167 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 21:16:44,854 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 21:16:44,855 INFO: เติม 2025-11-20 21:00 → +1
2025-11-20 21:16:45,863 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 21:16:45,869 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 130 แถว
2025-11-20 21:16:45,872 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 21:16:45,875 INFO: รวมเก่า 130 + ใหม่ 130 → 130 (เพิ่ม 0)
2025-11-20 21:16:45,876 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 21:16:45,876 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 21:16:45,880 INFO: เริ่ม clean ข้อมูล: 130 แถว
2025-11-20 21:16:45,894 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (130 แถว)
2025-11-20 21:16:45,899 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 21:16:45,929 INFO: เตรียมโหลด 130 แถว
2025-11-20 21:16:45,992 ERROR: โหลด DB ล้มเหลว: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-20 21:16:45,992 ERROR: Pipeline ล้มเหลว: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-20 21:16:45,997 ERROR: Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "PM10" of relation "air_readings" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 111, in run_pipeline
    await load_and_backup(df_cleaned)
  File "C:\Pm2_5\tasks\load_to_db.py", line 78, in load_and_backup
    await upsert_air_reading(db, obj)
  File "C:\Pm2_5\app\crud.py", line 38, in upsert_air_reading
    await db.execute(stmt)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-11-20 21:16:45,997 INFO: === PIPELINE END ===

2025-11-20 21:25:52,365 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:25:52,371 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:25:52,373 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:25:52,374 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:25:52,374 INFO: Scheduler started
2025-11-20 21:25:52,374 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:25:52,374 INFO: === PIPELINE START ===
2025-11-20 21:25:52,374 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:25:53,137 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:25:53,144 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:25:53,145 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:25:53,145 INFO: Fetch สำเร็จ
2025-11-20 21:25:53,154 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:25:53,856 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:25:53,856 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:25:55,822 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:25:55,829 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:25:55,830 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:25:55,831 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:25:55,831 INFO: Scheduler started
2025-11-20 21:25:55,832 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:25:55,832 INFO: === PIPELINE START ===
2025-11-20 21:25:55,832 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:25:56,541 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:25:56,551 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:25:56,551 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:25:56,551 INFO: Fetch สำเร็จ
2025-11-20 21:25:56,560 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:25:57,279 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:25:57,279 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:25:59,022 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:25:59,022 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 21:26:00,774 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:00,774 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 21:26:02,522 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:02,522 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 21:26:04,250 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:04,250 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 21:26:05,922 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:05,923 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 21:26:07,664 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:07,665 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 21:26:09,381 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:09,382 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 21:26:11,111 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:11,112 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 21:26:12,834 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:12,834 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 21:26:14,565 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:14,566 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 21:26:16,338 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:16,339 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 21:26:18,035 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:18,036 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 21:26:19,800 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:19,800 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 21:26:21,537 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:21,538 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 21:26:23,280 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:23,281 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 21:26:24,971 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:24,971 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 21:26:26,703 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:26,703 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 21:26:28,440 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:28,440 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 21:26:30,179 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:30,179 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 21:26:31,943 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:31,944 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 21:26:33,629 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:33,629 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 21:26:35,356 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:35,357 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 21:26:37,124 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:37,125 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 21:26:38,832 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:38,833 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 21:26:40,594 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:40,594 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 21:26:42,315 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:42,315 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 21:26:44,012 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:44,012 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 21:26:45,742 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:45,742 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 21:26:47,470 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:47,470 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 21:26:49,210 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:49,211 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 21:26:50,938 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:50,939 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 21:26:52,667 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:52,668 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 21:26:54,369 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:54,369 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 21:26:56,107 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:56,107 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 21:26:57,804 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:57,804 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 21:26:59,556 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:26:59,556 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 21:27:01,258 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:27:01,258 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 21:27:02,987 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:27:02,988 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 21:27:04,704 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:27:04,704 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 21:27:06,417 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:27:06,417 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 21:27:08,277 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:27:08,278 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 21:27:09,999 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:27:09,999 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 21:27:11,727 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:27:11,727 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 21:27:13,412 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:27:13,413 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 21:27:15,126 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:27:15,127 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 21:27:16,866 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:27:16,867 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 21:27:18,553 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:27:18,554 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 21:27:20,259 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 21:27:20,259 INFO: เติม 2025-11-20 21:00 → +1
2025-11-20 21:27:21,265 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 21:27:21,267 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 130 แถว
2025-11-20 21:27:21,267 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 21:27:21,270 INFO: รวมเก่า 130 + ใหม่ 130 → 130 (เพิ่ม 0)
2025-11-20 21:27:21,271 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 21:27:21,271 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 21:27:21,273 INFO: เริ่ม clean ข้อมูล: 130 แถว
2025-11-20 21:27:21,288 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (130 แถว)
2025-11-20 21:27:21,292 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 21:27:21,323 INFO: เตรียมโหลด 130 แถว
2025-11-20 21:27:21,376 ERROR: โหลด DB ล้มเหลว: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-20 21:27:21,376 ERROR: Pipeline ล้มเหลว: ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-11-20 21:27:21,382 ERROR: Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 526, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 773, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "PM10" of relation "air_readings" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 111, in run_pipeline
    await load_and_backup(df_cleaned)
  File "C:\Pm2_5\tasks\load_to_db.py", line 78, in load_and_backup
    await upsert_air_reading(db, obj)
  File "C:\Pm2_5\app\crud.py", line 38, in upsert_air_reading
    await db.execute(stmt)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2351, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1306, in orm_execute_statement
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1419, in execute
    return meth(
           ^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\engine\default.py", line 951, in do_execute
    cursor.execute(statement, parameters)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "C:\Pm2_5\venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "PM10" of relation "air_readings" does not exist
[SQL: INSERT INTO public.air_readings ("Date_Time", "PM10 (µg/m³)", "PM2.5 (µg/m³)", "WS (m/s)", "WD", "Temp (°C)", "RH (%)", "BP (mBar)") VALUES ($1::TIMESTAMP WITH TIME ZONE, $2::FLOAT, $3::FLOAT, $4::FLOAT, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT) ON CONFLICT ("Date_Time") DO UPDATE SET "WD" = $9::FLOAT, "PM10" = $10::FLOAT, "PM25" = $11::FLOAT, "WS" = $12::FLOAT, "Temp" = $13::FLOAT, "RH" = $14::FLOAT, "BP" = $15::FLOAT RETURNING public.air_readings.id]
[parameters: (Timestamp('2025-11-13 22:00:00+0700', tz='Asia/Bangkok'), 41.7, 17.3, 0.2, 55.0, 25.0, 90.0, 1012.9, 55.0, 41.7, 17.3, 0.2, 25.0, 90.0, 1012.9)]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-11-20 21:27:21,383 INFO: === PIPELINE END ===

2025-11-20 21:29:26,725 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:29:26,730 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:29:26,732 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:29:26,733 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:29:26,733 INFO: Scheduler started
2025-11-20 21:29:26,733 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:29:26,734 INFO: === PIPELINE START ===
2025-11-20 21:29:26,734 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:29:27,521 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:29:27,529 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:27,529 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:29:27,529 INFO: Fetch สำเร็จ
2025-11-20 21:29:27,538 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:29:28,254 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:28,255 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:29:30,227 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:29:30,234 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:29:30,235 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:29:30,236 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:29:30,236 INFO: Scheduler started
2025-11-20 21:29:30,236 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:29:30,237 INFO: === PIPELINE START ===
2025-11-20 21:29:30,237 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:29:30,994 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:29:31,002 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:31,002 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:29:31,002 INFO: Fetch สำเร็จ
2025-11-20 21:29:31,014 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:29:31,753 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:31,754 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:29:33,631 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:33,632 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 21:29:35,666 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:29:35,672 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:29:35,674 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:29:35,674 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:29:35,675 INFO: Scheduler started
2025-11-20 21:29:35,675 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:29:35,675 INFO: === PIPELINE START ===
2025-11-20 21:29:35,675 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:29:36,445 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:29:36,452 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:36,453 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:29:36,453 INFO: Fetch สำเร็จ
2025-11-20 21:29:36,461 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:29:37,211 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:37,212 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:29:39,208 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:29:39,214 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:29:39,215 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:29:39,216 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:29:39,216 INFO: Scheduler started
2025-11-20 21:29:39,216 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:29:39,217 INFO: === PIPELINE START ===
2025-11-20 21:29:39,217 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:29:39,957 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:29:39,964 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:39,965 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:29:39,965 INFO: Fetch สำเร็จ
2025-11-20 21:29:39,973 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:29:40,655 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:40,656 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:29:42,575 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:29:42,580 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:29:42,581 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:29:42,582 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:29:42,582 INFO: Scheduler started
2025-11-20 21:29:42,582 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:29:42,583 INFO: === PIPELINE START ===
2025-11-20 21:29:42,583 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:29:43,335 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:29:43,342 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:43,343 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:29:43,343 INFO: Fetch สำเร็จ
2025-11-20 21:29:43,352 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:29:44,056 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:44,056 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:29:45,771 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:45,772 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 21:29:47,503 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:47,504 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 21:29:49,221 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:49,221 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 21:29:50,933 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:50,933 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 21:29:52,659 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:52,660 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 21:29:54,397 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:54,397 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 21:29:56,146 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:56,146 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 21:29:57,869 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:57,870 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 21:29:59,565 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:29:59,566 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 21:30:01,316 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:01,316 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 21:30:03,040 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:03,041 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 21:30:04,780 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:04,780 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 21:30:06,521 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:06,521 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 21:30:08,220 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:08,221 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 21:30:09,967 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:09,968 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 21:30:11,702 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:11,703 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 21:30:13,462 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:13,462 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 21:30:15,163 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:15,164 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 21:30:16,915 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:16,916 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 21:30:18,634 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:18,634 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 21:30:20,412 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:20,412 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 21:30:22,130 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:22,130 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 21:30:23,847 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:23,848 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 21:30:25,565 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:25,566 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 21:30:27,336 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:27,337 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 21:30:29,095 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:29,095 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 21:30:30,805 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:30,806 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 21:30:32,554 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:32,554 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 21:30:34,299 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:34,299 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 21:30:35,995 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:35,996 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 21:30:37,706 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:37,706 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 21:30:39,438 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:39,439 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 21:30:41,142 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:41,142 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 21:30:42,846 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:42,846 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 21:30:44,578 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:44,578 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 21:30:46,263 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:46,263 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 21:30:47,960 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:47,960 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 21:30:49,669 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:49,670 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 21:30:51,335 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:51,336 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 21:30:53,013 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:53,014 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 21:30:54,697 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:54,697 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 21:30:56,406 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:56,406 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 21:30:58,111 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:58,111 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 21:30:59,812 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:30:59,812 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 21:31:01,504 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:31:01,506 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 21:31:03,212 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:31:03,213 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 21:31:04,916 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:31:04,917 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 21:31:06,645 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 21:31:06,646 INFO: เติม 2025-11-20 21:00 → +1
2025-11-20 21:31:07,660 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 21:31:07,666 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 130 แถว
2025-11-20 21:31:07,666 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 21:31:07,668 INFO: รวมเก่า 130 + ใหม่ 130 → 130 (เพิ่ม 0)
2025-11-20 21:31:07,671 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 21:31:07,671 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 21:31:07,673 INFO: เริ่ม clean ข้อมูล: 130 แถว
2025-11-20 21:31:07,684 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (130 แถว)
2025-11-20 21:31:07,687 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 21:31:07,716 INFO: เตรียมโหลด 130 แถว
2025-11-20 21:31:07,765 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 21:31:07,766 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 21:31:07,768 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 21:31:07,770 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 21:31:07,771 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 21:31:07,773 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 21:31:07,774 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 21:31:07,776 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 21:31:07,777 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 21:31:07,779 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 21:31:07,781 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 21:31:07,782 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 21:31:07,784 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 21:31:07,786 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 21:31:07,787 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 21:31:07,788 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 21:31:07,790 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 21:31:07,792 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 21:31:07,793 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 21:31:07,795 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 21:31:07,796 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 21:31:07,798 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 21:31:07,799 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 21:31:07,801 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 21:31:07,802 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 21:31:07,804 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 21:31:07,806 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 21:31:07,807 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 21:31:07,809 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 21:31:07,810 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 21:31:07,812 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 21:31:07,814 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 21:31:07,815 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 21:31:07,818 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 21:31:07,819 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 21:31:07,821 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 21:31:07,822 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 21:31:07,824 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 21:31:07,826 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 21:31:07,827 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 21:31:07,829 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 21:31:07,830 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 21:31:07,832 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 21:31:07,835 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 21:31:07,836 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 21:31:07,838 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 21:31:07,839 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 21:31:07,840 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 21:31:07,842 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 21:31:07,843 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 21:31:07,845 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 21:31:07,847 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 21:31:07,848 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 21:31:07,850 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 21:31:07,851 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 21:31:07,853 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 21:31:07,854 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 21:31:07,856 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 21:31:07,857 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 21:31:07,858 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 21:31:07,861 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 21:31:07,862 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 21:31:07,864 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 21:31:07,865 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 21:31:07,867 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 21:31:07,869 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 21:31:07,871 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 21:31:07,872 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 21:31:07,874 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 21:31:07,875 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 21:31:07,876 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 21:31:07,878 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 21:31:07,881 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 21:31:07,882 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 21:31:07,884 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 21:31:07,885 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 21:31:07,887 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 21:31:07,888 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 21:31:07,891 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 21:31:07,892 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 21:31:07,894 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 21:31:07,895 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 21:31:07,897 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 21:31:07,898 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 21:31:07,900 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 21:31:07,902 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 21:31:07,903 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 21:31:07,905 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 21:31:07,906 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 21:31:07,908 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 21:31:07,909 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 21:31:07,911 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 21:31:07,913 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 21:31:07,914 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 21:31:07,916 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 21:31:07,918 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 21:31:07,919 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 21:31:07,921 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 21:31:07,922 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 21:31:07,924 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 21:31:07,926 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 21:31:07,927 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 21:31:07,929 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 21:31:07,930 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 21:31:07,931 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 21:31:07,933 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 21:31:07,935 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 21:31:07,936 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 21:31:07,937 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 21:31:07,940 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 21:31:07,942 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 21:31:07,943 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 21:31:07,945 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 21:31:07,947 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 21:31:07,948 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 21:31:07,949 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 21:31:07,951 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 21:31:07,952 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 21:31:07,954 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 21:31:07,956 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 21:31:07,957 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 21:31:07,958 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 21:31:07,961 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 21:31:07,963 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 21:31:07,964 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 21:31:07,966 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 21:31:07,968 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 21:31:07,970 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 21:31:07,971 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 21:31:07,973 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 21:31:07,973 INFO: โหลด DB สำเร็จ
2025-11-20 21:31:07,975 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 21:31:07,977 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 21:31:07,977 INFO: Load to DB + Backup สำเร็จ
2025-11-20 21:31:07,977 INFO: === PIPELINE END ===

2025-11-20 21:31:23,164 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 21:31:23,165 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 21:31:26,409 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 21:31:26,409 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 21:35:58,942 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:35:58,948 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:35:58,950 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:35:58,951 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:35:58,951 INFO: Scheduler started
2025-11-20 21:35:58,951 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:35:58,952 INFO: === PIPELINE START ===
2025-11-20 21:35:58,954 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:35:59,720 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:35:59,729 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:35:59,729 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:35:59,729 INFO: Fetch สำเร็จ
2025-11-20 21:35:59,741 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:36:00,458 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:00,458 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:36:00,915 ERROR: Predict error
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 279, in predict_next_24h
    pred_scaled = float(MODEL.predict(current)[0])
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 2865, in inplace_predict
    raise ValueError(
ValueError: Feature shape mismatch, expected: 168, got 260
2025-11-20 21:36:02,167 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:02,168 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 21:36:03,881 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:03,881 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 21:36:05,674 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:05,675 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 21:36:07,426 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:07,426 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 21:36:09,142 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:09,142 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 21:36:10,826 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:10,826 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 21:36:12,518 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:12,518 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 21:36:14,226 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:14,226 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 21:36:15,950 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:15,950 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 21:36:17,696 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:17,697 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 21:36:19,431 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:19,431 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 21:36:21,172 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:21,172 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 21:36:22,872 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:22,872 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 21:36:24,551 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:24,552 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 21:36:26,278 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:26,279 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 21:36:27,974 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:27,974 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 21:36:29,675 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:29,675 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 21:36:31,382 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:31,382 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 21:36:33,071 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:33,072 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 21:36:34,776 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:34,776 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 21:36:36,519 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:36,520 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 21:36:38,237 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:38,238 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 21:36:39,961 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:39,963 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 21:36:41,632 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:41,632 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 21:36:43,332 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:43,333 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 21:36:45,032 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:45,033 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 21:36:46,734 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:46,734 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 21:36:48,427 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:48,427 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 21:36:50,113 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:50,114 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 21:36:51,785 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:51,785 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 21:36:53,483 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:53,484 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 21:36:55,191 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:55,192 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 21:36:56,913 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:56,913 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 21:36:58,600 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:36:58,601 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 21:37:00,280 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:00,280 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 21:37:01,981 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:01,982 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 21:37:03,677 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:03,678 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 21:37:05,422 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:05,422 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 21:37:07,126 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:07,126 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 21:37:08,839 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:08,839 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 21:37:10,517 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:10,518 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 21:37:12,365 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:12,366 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 21:37:14,087 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:14,088 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 21:37:15,730 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:15,731 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 21:37:17,457 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:17,457 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 21:37:19,191 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:19,192 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 21:37:20,905 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:20,905 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 21:37:22,587 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 21:37:22,587 INFO: เติม 2025-11-20 21:00 → +1
2025-11-20 21:37:23,565 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 21:37:23,567 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 130 แถว
2025-11-20 21:37:23,567 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 21:37:23,569 INFO: รวมเก่า 130 + ใหม่ 130 → 130 (เพิ่ม 0)
2025-11-20 21:37:23,570 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 21:37:23,570 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 21:37:23,573 INFO: เริ่ม clean ข้อมูล: 130 แถว
2025-11-20 21:37:23,585 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (130 แถว)
2025-11-20 21:37:23,588 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 21:37:23,623 INFO: เตรียมโหลด 130 แถว
2025-11-20 21:37:23,628 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 21:37:23,630 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 21:37:23,633 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 21:37:23,635 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 21:37:23,637 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 21:37:23,639 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 21:37:23,641 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 21:37:23,643 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 21:37:23,645 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 21:37:23,647 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 21:37:23,651 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 21:37:23,653 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 21:37:23,655 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 21:37:23,656 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 21:37:23,659 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 21:37:23,660 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 21:37:23,662 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 21:37:23,664 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 21:37:23,666 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 21:37:23,667 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 21:37:23,670 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 21:37:23,671 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 21:37:23,673 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 21:37:23,675 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 21:37:23,677 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 21:37:23,678 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 21:37:23,681 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 21:37:23,683 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 21:37:23,684 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 21:37:23,686 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 21:37:23,688 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 21:37:23,690 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 21:37:23,692 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 21:37:23,695 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 21:37:23,696 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 21:37:23,698 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 21:37:23,700 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 21:37:23,702 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 21:37:23,704 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 21:37:23,706 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 21:37:23,708 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 21:37:23,710 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 21:37:23,712 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 21:37:23,713 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 21:37:23,715 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 21:37:23,717 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 21:37:23,719 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 21:37:23,721 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 21:37:23,723 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 21:37:23,725 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 21:37:23,729 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 21:37:23,732 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 21:37:23,734 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 21:37:23,736 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 21:37:23,738 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 21:37:23,739 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 21:37:23,741 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 21:37:23,743 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 21:37:23,745 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 21:37:23,746 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 21:37:23,748 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 21:37:23,751 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 21:37:23,753 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 21:37:23,754 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 21:37:23,756 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 21:37:23,758 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 21:37:23,761 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 21:37:23,763 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 21:37:23,764 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 21:37:23,766 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 21:37:23,768 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 21:37:23,770 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 21:37:23,772 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 21:37:23,774 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 21:37:23,775 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 21:37:23,778 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 21:37:23,780 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 21:37:23,781 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 21:37:23,783 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 21:37:23,785 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 21:37:23,786 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 21:37:23,788 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 21:37:23,790 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 21:37:23,792 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 21:37:23,794 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 21:37:23,795 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 21:37:23,797 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 21:37:23,799 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 21:37:23,801 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 21:37:23,802 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 21:37:23,805 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 21:37:23,806 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 21:37:23,809 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 21:37:23,810 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 21:37:23,812 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 21:37:23,814 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 21:37:23,816 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 21:37:23,818 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 21:37:23,820 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 21:37:23,822 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 21:37:23,823 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 21:37:23,825 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 21:37:23,828 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 21:37:23,830 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 21:37:23,832 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 21:37:23,834 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 21:37:23,836 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 21:37:23,838 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 21:37:23,840 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 21:37:23,842 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 21:37:23,846 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 21:37:23,849 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 21:37:23,850 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 21:37:23,852 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 21:37:23,854 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 21:37:23,856 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 21:37:23,857 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 21:37:23,860 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 21:37:23,862 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 21:37:23,863 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 21:37:23,865 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 21:37:23,867 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 21:37:23,869 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 21:37:23,870 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 21:37:23,872 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 21:37:23,874 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 21:37:23,876 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 21:37:23,878 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 21:37:23,879 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 21:37:23,881 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 21:37:23,881 INFO: โหลด DB สำเร็จ
2025-11-20 21:37:23,884 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 21:37:23,886 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 21:37:23,887 INFO: Load to DB + Backup สำเร็จ
2025-11-20 21:37:23,887 INFO: === PIPELINE END ===

2025-11-20 21:49:29,032 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:49:29,038 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:49:29,039 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:49:29,040 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:49:29,040 INFO: Scheduler started
2025-11-20 21:49:29,040 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:49:29,041 INFO: === PIPELINE START ===
2025-11-20 21:49:29,041 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:49:29,862 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:49:29,870 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:49:29,870 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:49:29,870 INFO: Fetch สำเร็จ
2025-11-20 21:49:29,879 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:49:30,569 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:49:30,569 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:56:44,205 INFO: Model loaded | Expected features: 168
2025-11-20 21:56:44,213 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:56:44,214 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:56:44,215 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:56:44,215 INFO: Scheduler started
2025-11-20 21:56:44,217 INFO: Scheduler started (every hour at :05)
2025-11-20 21:56:44,217 INFO: === PIPELINE START ===
2025-11-20 21:56:44,217 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:56:44,946 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:56:44,952 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:56:44,953 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:56:44,962 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:56:45,652 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:56:45,653 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:56:47,412 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:56:47,413 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 21:56:47,545 ERROR: Prediction failed
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 219, in predict_next_24h
    pred_scaled = float(MODEL.predict(current)[0])
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 2865, in inplace_predict
    raise ValueError(
ValueError: Feature shape mismatch, expected: 168, got 260
2025-11-20 21:56:49,142 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:56:49,142 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 21:56:50,891 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:56:50,891 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 21:56:52,619 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:56:52,620 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 21:56:54,294 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:56:54,294 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 21:56:56,081 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:56:56,082 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 21:56:57,775 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:56:57,775 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 21:56:59,484 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:56:59,484 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 21:57:01,224 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:01,224 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 21:57:02,919 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:02,920 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 21:57:04,637 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:04,638 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 21:57:06,357 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:06,357 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 21:57:08,081 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:08,081 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 21:57:39,107 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:57:39,111 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:57:39,113 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:57:39,114 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:57:39,114 INFO: Scheduler started
2025-11-20 21:57:39,114 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:57:39,115 INFO: === PIPELINE START ===
2025-11-20 21:57:39,115 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:57:39,832 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:57:39,840 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:39,840 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:57:39,840 INFO: Fetch สำเร็จ
2025-11-20 21:57:39,850 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:57:40,579 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:40,581 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:57:43,125 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:57:43,131 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:57:43,133 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:57:43,135 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:57:43,135 INFO: Scheduler started
2025-11-20 21:57:43,135 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:57:43,135 INFO: === PIPELINE START ===
2025-11-20 21:57:43,136 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:57:43,870 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:57:43,879 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:43,879 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:57:43,879 INFO: Fetch สำเร็จ
2025-11-20 21:57:43,889 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:57:44,613 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:44,613 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:57:46,316 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:46,316 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 21:57:48,026 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:48,026 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 21:57:49,753 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:49,753 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 21:57:51,477 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:51,478 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 21:57:53,187 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:53,187 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 21:57:53,294 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 21:57:53,294 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 21:57:54,908 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:54,910 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 21:57:56,628 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:56,628 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 21:57:58,378 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:57:58,378 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 21:58:00,074 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:00,074 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 21:58:01,837 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:01,838 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 21:58:03,538 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:03,538 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 21:58:05,281 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:05,282 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 21:58:06,973 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:06,973 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 21:58:08,702 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:08,702 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 21:58:10,465 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:10,465 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 21:58:12,185 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:12,186 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 21:58:13,918 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:13,919 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 21:58:15,602 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:15,602 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 21:58:17,327 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:17,328 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 21:58:19,079 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:19,079 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 21:58:20,821 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:20,822 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 21:58:22,559 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:22,560 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 21:58:24,317 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:24,318 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 21:58:26,080 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:26,081 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 21:58:27,954 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:27,955 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 21:58:29,679 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:29,680 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 21:58:31,451 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:31,451 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 21:58:33,177 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:33,178 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 21:58:34,948 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:34,949 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 21:58:36,753 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:36,753 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 21:58:38,538 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:38,538 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 21:58:40,315 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:40,315 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 21:58:42,080 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:42,081 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 21:58:43,870 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:43,870 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 21:58:45,575 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:45,575 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 21:58:47,408 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:47,408 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 21:58:49,169 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:49,169 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 21:58:50,873 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:50,873 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 21:58:52,563 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:52,563 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 21:58:54,291 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:54,292 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 21:58:56,019 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:56,019 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 21:58:57,765 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:57,766 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 21:58:59,475 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:58:59,475 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 21:59:01,190 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:01,191 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 21:59:02,955 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:02,956 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 21:59:04,672 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:04,672 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 21:59:06,368 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:06,369 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 21:59:08,181 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:08,182 INFO: เติม 2025-11-20 21:00 → +1
2025-11-20 21:59:09,180 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 21:59:09,181 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 130 แถว
2025-11-20 21:59:09,182 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 21:59:09,184 INFO: รวมเก่า 130 + ใหม่ 130 → 130 (เพิ่ม 0)
2025-11-20 21:59:09,185 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 21:59:09,185 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 21:59:09,188 INFO: เริ่ม clean ข้อมูล: 130 แถว
2025-11-20 21:59:09,201 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (130 แถว)
2025-11-20 21:59:09,204 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 21:59:09,234 INFO: เตรียมโหลด 130 แถว
2025-11-20 21:59:09,239 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 21:59:09,241 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 21:59:09,243 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 21:59:09,244 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 21:59:09,246 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 21:59:09,248 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 21:59:09,249 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 21:59:09,251 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 21:59:09,253 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 21:59:09,255 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 21:59:09,257 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 21:59:09,259 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 21:59:09,260 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 21:59:09,262 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 21:59:09,264 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 21:59:09,265 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 21:59:09,268 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 21:59:09,269 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 21:59:09,270 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 21:59:09,272 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 21:59:09,274 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 21:59:09,276 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 21:59:09,277 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 21:59:09,279 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 21:59:09,282 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 21:59:09,283 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 21:59:09,284 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 21:59:09,286 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 21:59:09,288 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 21:59:09,289 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 21:59:09,292 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 21:59:09,294 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 21:59:09,295 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 21:59:09,297 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 21:59:09,298 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 21:59:09,301 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 21:59:09,302 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 21:59:09,304 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 21:59:09,305 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 21:59:09,307 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 21:59:09,309 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 21:59:09,310 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 21:59:09,312 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 21:59:09,314 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 21:59:09,316 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 21:59:09,318 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 21:59:09,320 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 21:59:09,322 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 21:59:09,324 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 21:59:09,326 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 21:59:09,328 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 21:59:09,329 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 21:59:09,330 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 21:59:09,332 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 21:59:09,334 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 21:59:09,336 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 21:59:09,337 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 21:59:09,340 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 21:59:09,342 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 21:59:09,344 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 21:59:09,345 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 21:59:09,347 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 21:59:09,348 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 21:59:09,351 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 21:59:09,353 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 21:59:09,355 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 21:59:09,357 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 21:59:09,358 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 21:59:09,361 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 21:59:09,363 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 21:59:09,365 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 21:59:09,367 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 21:59:09,369 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 21:59:09,371 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 21:59:09,373 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 21:59:09,375 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 21:59:09,376 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 21:59:09,378 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 21:59:09,381 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 21:59:09,383 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 21:59:09,385 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 21:59:09,386 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 21:59:09,388 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 21:59:09,390 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 21:59:09,391 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 21:59:09,393 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 21:59:09,396 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 21:59:09,398 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 21:59:09,399 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 21:59:09,401 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 21:59:09,403 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 21:59:09,405 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 21:59:09,407 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 21:59:09,409 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 21:59:09,411 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 21:59:09,413 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 21:59:09,415 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 21:59:09,417 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 21:59:09,418 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 21:59:09,421 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 21:59:09,423 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 21:59:09,425 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 21:59:09,426 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 21:59:09,428 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 21:59:09,430 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 21:59:09,432 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 21:59:09,434 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 21:59:09,436 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 21:59:09,438 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 21:59:09,440 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 21:59:09,443 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 21:59:09,445 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 21:59:09,447 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 21:59:09,448 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 21:59:09,450 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 21:59:09,452 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 21:59:09,454 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 21:59:09,456 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 21:59:09,458 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 21:59:09,461 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 21:59:09,464 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 21:59:09,465 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 21:59:09,467 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 21:59:09,469 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 21:59:09,471 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 21:59:09,472 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 21:59:09,475 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 21:59:09,476 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 21:59:09,478 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 21:59:09,480 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 21:59:09,480 INFO: โหลด DB สำเร็จ
2025-11-20 21:59:09,482 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 21:59:09,484 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 21:59:09,484 INFO: Load to DB + Backup สำเร็จ
2025-11-20 21:59:09,485 INFO: === PIPELINE END ===

2025-11-20 21:59:16,210 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 21:59:16,216 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 21:59:16,218 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:59:16,218 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 21:59:16,218 INFO: Scheduler started
2025-11-20 21:59:16,218 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 21:59:16,220 INFO: === PIPELINE START ===
2025-11-20 21:59:16,220 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 21:59:16,943 INFO: ดึง 2025-11-20 20:00:00+07:00 - 2025-11-20 21:00:00+07:00 → 2 แถว
2025-11-20 21:59:16,949 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:16,949 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 21:59:16,949 INFO: Fetch สำเร็จ
2025-11-20 21:59:16,957 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 21:59:17,653 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:17,653 INFO: เติม 2025-11-18 21:00 → +2
2025-11-20 21:59:19,360 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:19,360 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 21:59:21,025 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:21,025 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 21:59:22,759 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:22,760 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 21:59:24,496 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:24,497 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 21:59:24,638 ERROR: Prediction error
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 271, in predict_next_24h
    pred_scaled = float(MODEL.predict(current)[0])
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 2865, in inplace_predict
    raise ValueError(
ValueError: Feature shape mismatch, expected: 168, got 260
2025-11-20 21:59:26,186 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:26,187 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 21:59:27,856 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:27,856 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 21:59:29,631 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:29,633 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 21:59:31,355 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:31,355 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 21:59:33,076 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:33,077 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 21:59:34,775 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:34,775 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 21:59:36,512 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:36,513 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 21:59:38,195 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:38,196 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 21:59:39,919 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:39,919 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 21:59:41,609 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:41,610 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 21:59:43,356 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:43,356 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 21:59:45,063 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:45,063 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 21:59:46,765 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:46,765 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 21:59:48,451 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:48,451 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 21:59:50,146 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:50,146 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 21:59:51,854 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:51,855 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 21:59:53,519 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:53,521 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 21:59:55,191 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:55,193 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 21:59:56,940 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:56,941 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 21:59:58,660 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 21:59:58,661 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 22:00:00,369 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:00,369 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 22:00:02,031 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:02,031 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 22:00:03,711 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:03,711 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 22:00:05,406 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:05,407 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 22:00:07,178 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:07,180 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 22:00:08,918 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:08,919 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 22:00:10,649 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:10,650 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 22:00:12,385 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:12,385 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 22:00:14,104 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:14,105 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 22:00:15,825 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:15,826 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 22:00:17,538 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:17,538 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 22:00:19,290 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:19,291 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 22:00:21,019 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:21,019 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 22:00:22,779 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:22,781 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 22:00:24,496 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:24,496 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 22:00:26,287 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:26,287 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 22:00:27,978 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:27,979 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 22:00:29,699 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:29,699 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 22:00:31,405 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:31,405 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 22:00:33,104 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:33,104 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 22:00:34,794 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:34,795 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 22:00:36,455 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:36,456 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 22:00:38,104 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:38,105 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 22:00:39,798 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:00:39,798 INFO: เติม 2025-11-20 21:00 → +2
2025-11-20 22:00:40,802 INFO: เติมข้อมูลย้อนหลังเสร็จ: +98 แถว
2025-11-20 22:00:40,803 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 131 แถว
2025-11-20 22:00:40,804 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 22:00:40,806 INFO: รวมเก่า 130 + ใหม่ 131 → 131 (เพิ่ม 1)
2025-11-20 22:00:40,807 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 22:00:40,807 INFO: Format สำเร็จ: +1 แถว
2025-11-20 22:00:40,822 INFO: เริ่ม clean ข้อมูล: 131 แถว
2025-11-20 22:00:40,836 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (131 แถว)
2025-11-20 22:00:40,840 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 22:00:00          57.9           23.3       0.8 144.5       25.0    50.2     1016.1
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 22:00:40,870 INFO: เตรียมโหลด 131 แถว
2025-11-20 22:00:40,876 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 22:00:40,878 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 22:00:40,881 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 22:00:40,883 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 22:00:40,885 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 22:00:40,887 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:00:40,889 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 22:00:40,890 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 22:00:40,891 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 22:00:40,894 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:00:40,897 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:00:40,898 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:00:40,900 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:00:40,902 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:00:40,904 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 22:00:40,906 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:00:40,908 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 22:00:40,911 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 22:00:40,912 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:00:40,914 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 22:00:40,916 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 22:00:40,918 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 22:00:40,920 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:00:40,922 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:00:40,923 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 22:00:40,924 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:00:40,927 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 22:00:40,929 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:00:40,931 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:00:40,933 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:00:40,936 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:00:40,937 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 22:00:40,940 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 22:00:40,942 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 22:00:40,944 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 22:00:40,946 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:00:40,947 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 22:00:40,950 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 22:00:40,952 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 22:00:40,953 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 22:00:40,955 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:00:40,956 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 22:00:40,956 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 22:00:40,961 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 22:00:40,963 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 22:00:40,964 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 22:00:40,966 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:00:40,968 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 22:00:40,970 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:00:40,972 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 22:00:40,974 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 22:00:40,975 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:00:40,977 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:00:40,978 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:00:40,981 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 22:00:40,983 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:00:40,985 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 22:00:40,986 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:00:40,988 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 22:00:40,990 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:00:40,992 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 22:00:40,994 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 22:00:40,995 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 22:00:40,997 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 22:00:40,998 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:00:41,001 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 22:00:41,003 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:00:41,005 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 22:00:41,007 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 22:00:41,008 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:00:41,010 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 22:00:41,012 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 22:00:41,013 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 22:00:41,015 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 22:00:41,017 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 22:00:41,019 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 22:00:41,021 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 22:00:41,023 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:00:41,025 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:00:41,027 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 22:00:41,029 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:00:41,030 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 22:00:41,032 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 22:00:41,034 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:00:41,036 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 22:00:41,037 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:00:41,039 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:00:41,041 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 22:00:41,042 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 22:00:41,045 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:00:41,047 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 22:00:41,048 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 22:00:41,050 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 22:00:41,052 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 22:00:41,054 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 22:00:41,056 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 22:00:41,057 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:00:41,059 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 22:00:41,062 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 22:00:41,063 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:00:41,065 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:00:41,066 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 22:00:41,069 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 22:00:41,070 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:00:41,072 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:00:41,075 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 22:00:41,077 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 22:00:41,078 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 22:00:41,080 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 22:00:41,082 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 22:00:41,084 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 22:00:41,086 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 22:00:41,087 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 22:00:41,089 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 22:00:41,091 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:00:41,092 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 22:00:41,095 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 22:00:41,096 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 22:00:41,098 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 22:00:41,101 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 22:00:41,102 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 22:00:41,104 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 22:00:41,106 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 22:00:41,108 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 22:00:41,109 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 22:00:41,111 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:00:41,112 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:00:41,114 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 22:00:41,116 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 22:00:41,118 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 22:00:41,121 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 23.3
2025-11-20 22:00:41,122 INFO: โหลด DB สำเร็จ
2025-11-20 22:00:41,124 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 22:00:41,126 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 22:00:41,126 INFO: Load to DB + Backup สำเร็จ
2025-11-20 22:00:41,127 INFO: === PIPELINE END ===

2025-11-20 22:05:00,004 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 23:05:00 +07)" (scheduled at 2025-11-20 22:05:00+07:00)
2025-11-20 22:05:00,005 INFO: === PIPELINE START ===
2025-11-20 22:05:00,005 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:05:00,747 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:05:00,752 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:00,753 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:05:00,753 INFO: Fetch สำเร็จ
2025-11-20 22:05:00,760 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:05:01,479 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:01,479 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:05:03,198 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:03,198 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:05:04,970 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:04,971 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:05:06,718 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:06,718 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:05:08,392 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:08,392 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:05:10,397 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:10,397 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:05:12,159 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:12,159 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:05:13,869 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:13,870 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:05:15,587 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:15,587 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 22:05:17,299 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:17,299 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 22:05:19,068 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:19,068 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 22:05:20,891 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:20,891 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 22:05:22,591 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:22,591 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 22:05:24,314 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:24,314 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 22:05:26,086 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:26,087 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 22:05:27,842 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:27,843 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 22:05:29,570 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:29,570 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 22:05:31,333 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:31,333 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 22:05:31,478 ERROR: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 23:05:00 +07)" raised an exception
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 181, in run_coroutine_job
    retval = await job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\app\main.py", line 97, in run_pipeline
    added = await fill_missing_hours(lookback_hours=48)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 224, in fill_missing_hours
    await asyncio.sleep(1)
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\tasks.py", line 649, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError
2025-11-20 22:05:33,433 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:05:33,440 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:05:33,441 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:05:33,442 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:05:33,443 INFO: Scheduler started
2025-11-20 22:05:33,443 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:05:33,443 INFO: === PIPELINE START ===
2025-11-20 22:05:33,443 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:05:34,183 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:05:34,192 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:34,192 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:05:34,192 INFO: Fetch สำเร็จ
2025-11-20 22:05:34,201 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:05:34,940 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:34,940 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:05:36,927 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:05:36,934 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:05:36,936 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:05:36,937 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:05:36,937 INFO: Scheduler started
2025-11-20 22:05:36,937 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:05:36,937 INFO: === PIPELINE START ===
2025-11-20 22:05:36,937 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:05:37,687 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:05:37,697 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:37,697 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:05:37,698 INFO: Fetch สำเร็จ
2025-11-20 22:05:37,707 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:05:38,434 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:38,435 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:05:40,514 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:05:40,520 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:05:40,522 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:05:40,523 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:05:40,523 INFO: Scheduler started
2025-11-20 22:05:40,523 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:05:40,524 INFO: === PIPELINE START ===
2025-11-20 22:05:40,524 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:05:41,276 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:05:41,283 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:41,284 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:05:41,284 INFO: Fetch สำเร็จ
2025-11-20 22:05:41,295 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:05:42,006 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:42,007 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:05:42,141 ERROR: Predict error
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 255, in predict_next_24h
    pred_scaled = float(MODEL.predict(current)[0])
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 2865, in inplace_predict
    raise ValueError(
ValueError: Feature shape mismatch, expected: 168, got 236
2025-11-20 22:05:43,705 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:43,705 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:05:45,422 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:45,422 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:05:47,090 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:47,091 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:05:48,812 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:48,812 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:05:50,509 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:50,510 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:05:52,307 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:52,308 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:05:54,056 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:54,057 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:05:55,814 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:55,815 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 22:05:57,568 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:57,569 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 22:05:59,328 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:05:59,329 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 22:06:01,111 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:01,111 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 22:06:02,862 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:02,862 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 22:06:04,617 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:04,618 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 22:06:06,309 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:06,310 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 22:06:08,054 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:08,054 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 22:06:09,738 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:09,739 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 22:06:11,503 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:11,504 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 22:06:13,232 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:13,232 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 22:06:14,975 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:14,976 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 22:06:16,729 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:16,730 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 22:06:18,434 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:18,434 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 22:06:20,172 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:20,172 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 22:06:21,908 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:21,908 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 22:06:23,684 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:23,685 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 22:06:25,440 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:25,440 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 22:06:27,198 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:27,198 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 22:06:28,978 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:28,978 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 22:06:30,742 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:30,743 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 22:06:32,460 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:32,461 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 22:06:34,223 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:34,223 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 22:06:35,946 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:35,946 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 22:06:37,678 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:37,678 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 22:06:39,447 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:39,448 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 22:06:42,394 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:06:42,401 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:06:42,403 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:06:42,404 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:06:42,404 INFO: Scheduler started
2025-11-20 22:06:42,404 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:06:42,405 INFO: === PIPELINE START ===
2025-11-20 22:06:42,405 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:06:43,158 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:06:43,166 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:43,167 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:06:43,167 INFO: Fetch สำเร็จ
2025-11-20 22:06:43,177 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:06:43,936 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:43,937 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:06:46,172 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:06:46,178 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:06:46,182 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:06:46,183 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:06:46,183 INFO: Scheduler started
2025-11-20 22:06:46,183 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:06:46,183 INFO: === PIPELINE START ===
2025-11-20 22:06:46,184 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:06:46,914 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:06:46,923 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:46,924 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:06:46,925 INFO: Fetch สำเร็จ
2025-11-20 22:06:46,935 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:06:47,679 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:47,681 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:06:47,807 WARNING: Feature count mismatch: 236
2025-11-20 22:06:47,808 ERROR: Prediction failed
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 266, in predict_next_24h
    X[0, i] = latest[col]
    ~^^^^^^
IndexError: index 168 is out of bounds for axis 1 with size 168
2025-11-20 22:06:49,394 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:49,395 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:06:51,144 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:51,144 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:06:52,897 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:52,897 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:06:54,625 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:54,626 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:06:56,325 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:56,325 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:06:58,078 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:58,078 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:06:59,799 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:06:59,800 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:07:01,552 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:01,553 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 22:07:03,337 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:03,338 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 22:07:05,037 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:05,037 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 22:07:06,787 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:06,788 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 22:07:08,480 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:08,480 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 22:07:10,232 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:10,232 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 22:07:11,961 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:11,962 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 22:07:13,679 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:13,679 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 22:07:15,422 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:15,423 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 22:07:17,188 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:17,188 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 22:07:18,954 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:18,955 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 22:07:20,709 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:20,710 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 22:07:22,436 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:22,436 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 22:07:24,208 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:24,209 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 22:07:25,928 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:25,928 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 22:07:27,704 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:27,705 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 22:07:29,445 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:29,445 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 22:07:31,188 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:31,188 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 22:07:32,926 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:32,927 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 22:07:34,641 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:34,641 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 22:07:36,335 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:36,336 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 22:07:38,065 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:38,066 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 22:07:40,611 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:07:40,617 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:07:40,619 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:07:40,620 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:07:40,620 INFO: Scheduler started
2025-11-20 22:07:40,620 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:07:40,620 INFO: === PIPELINE START ===
2025-11-20 22:07:40,620 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:07:41,353 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:07:41,361 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:41,361 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:07:41,361 INFO: Fetch สำเร็จ
2025-11-20 22:07:41,380 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:07:42,087 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:42,087 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:07:44,064 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:07:44,069 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:07:44,071 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:07:44,072 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:07:44,072 INFO: Scheduler started
2025-11-20 22:07:44,072 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:07:44,073 INFO: === PIPELINE START ===
2025-11-20 22:07:44,073 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:07:44,856 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:07:44,865 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:44,865 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:07:44,865 INFO: Fetch สำเร็จ
2025-11-20 22:07:44,875 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:07:45,668 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:45,668 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:07:47,386 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:47,387 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:07:49,139 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:49,139 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:07:51,502 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:07:51,507 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:07:51,509 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:07:51,510 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:07:51,510 INFO: Scheduler started
2025-11-20 22:07:51,510 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:07:51,511 INFO: === PIPELINE START ===
2025-11-20 22:07:51,511 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:07:52,280 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:07:52,287 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:52,287 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:07:52,287 INFO: Fetch สำเร็จ
2025-11-20 22:07:52,296 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:07:52,974 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:52,974 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:07:55,064 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:07:55,070 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:07:55,072 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:07:55,073 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:07:55,073 INFO: Scheduler started
2025-11-20 22:07:55,074 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:07:55,074 INFO: === PIPELINE START ===
2025-11-20 22:07:55,074 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:07:55,803 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:07:55,813 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:55,813 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:07:55,814 INFO: Fetch สำเร็จ
2025-11-20 22:07:55,823 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:07:56,598 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:56,598 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:07:56,712 ERROR: Prediction failed
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 257, in predict_next_24h
    X[0, i] = latest[col]
    ~^^^^^^
IndexError: index 168 is out of bounds for axis 1 with size 168
2025-11-20 22:07:58,348 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:07:58,348 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:08:00,055 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:00,056 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:08:01,728 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:01,728 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:08:03,473 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:03,473 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:08:05,326 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:05,327 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:08:07,049 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:07,050 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:08:08,795 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:08,795 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:08:10,480 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:10,480 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 22:08:12,195 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:12,195 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 22:08:13,935 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:13,935 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 22:08:15,629 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:15,629 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 22:08:17,354 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:17,354 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 22:08:19,102 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:19,103 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 22:08:20,858 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:20,858 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 22:08:22,601 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:22,602 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 22:08:24,353 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:24,353 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 22:08:26,080 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:26,080 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 22:08:27,846 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:27,847 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 22:08:29,586 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:29,586 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 22:08:31,338 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:31,338 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 22:08:33,048 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:33,048 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 22:08:34,789 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:34,789 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 22:08:36,480 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:36,480 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 22:08:38,259 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:38,259 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 22:08:40,027 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:40,028 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 22:08:41,773 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:41,774 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 22:08:43,512 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:43,513 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 22:08:45,231 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:45,231 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 22:08:46,960 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:46,960 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 22:08:48,654 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:48,654 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 22:08:50,384 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:50,385 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 22:08:52,134 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:52,134 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 22:08:53,864 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:53,864 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 22:08:55,553 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:55,554 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 22:08:57,269 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:57,270 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 22:08:57,336 ERROR: Prediction failed
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 257, in predict_next_24h
    X[0, i] = latest[col]
    ~^^^^^^
IndexError: index 168 is out of bounds for axis 1 with size 168
2025-11-20 22:08:59,004 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:08:59,004 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 22:09:00,768 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:00,769 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 22:09:02,553 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:02,554 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 22:09:04,278 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:04,278 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 22:09:06,095 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:06,095 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 22:09:07,802 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:07,803 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 22:09:10,054 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:09:10,058 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:09:10,060 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:09:10,061 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:09:10,061 INFO: Scheduler started
2025-11-20 22:09:10,061 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:09:10,062 INFO: === PIPELINE START ===
2025-11-20 22:09:10,062 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:09:10,834 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:09:10,843 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:10,843 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:09:10,843 INFO: Fetch สำเร็จ
2025-11-20 22:09:10,851 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:09:11,565 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:11,565 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:09:13,511 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:09:13,518 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:09:13,520 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:09:13,521 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:09:13,521 INFO: Scheduler started
2025-11-20 22:09:13,521 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:09:13,521 INFO: === PIPELINE START ===
2025-11-20 22:09:13,522 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:09:14,230 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:09:14,239 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:14,239 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:09:14,240 INFO: Fetch สำเร็จ
2025-11-20 22:09:14,250 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:09:14,963 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:14,964 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:09:16,708 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:16,708 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:09:18,392 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:18,393 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:09:20,135 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:20,136 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:09:21,861 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:21,862 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:09:44,103 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:09:44,108 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:09:44,110 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:09:44,111 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:09:44,111 INFO: Scheduler started
2025-11-20 22:09:44,111 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:09:44,111 INFO: === PIPELINE START ===
2025-11-20 22:09:44,112 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:09:44,847 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:09:44,854 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:44,854 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:09:44,855 INFO: Fetch สำเร็จ
2025-11-20 22:09:44,862 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:09:45,589 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:45,589 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:09:47,283 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:47,283 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:09:48,999 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:48,999 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:09:50,737 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:50,738 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:09:52,417 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:52,417 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:09:54,151 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:54,151 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:09:55,894 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:55,895 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:09:57,636 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:09:57,636 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:10:00,520 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:10:00,526 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:10:00,527 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:10:00,528 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:10:00,528 INFO: Scheduler started
2025-11-20 22:10:00,528 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:10:00,529 INFO: === PIPELINE START ===
2025-11-20 22:10:00,529 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:10:01,279 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:10:01,287 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:01,288 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:10:01,288 INFO: Fetch สำเร็จ
2025-11-20 22:10:01,298 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:10:02,041 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:02,042 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:10:02,160 ERROR: Prediction failed
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 259, in predict_next_24
    raise ValueError(f"Expected 168 features, got {len(expected_features)}")
ValueError: Expected 168 features, got 236
2025-11-20 22:10:03,782 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:03,782 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:10:05,488 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:05,489 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:10:07,169 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:07,169 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:10:08,852 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:08,853 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:10:10,551 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:10,552 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:10:12,288 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:12,289 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:10:14,033 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:14,033 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:10:15,757 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:15,757 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 22:10:17,451 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:17,451 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 22:10:19,149 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:19,150 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 22:10:20,908 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:20,909 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 22:10:22,601 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:22,602 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 22:10:24,335 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:24,335 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 22:10:26,052 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:26,053 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 22:10:27,761 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:27,762 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 22:10:29,491 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:29,491 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 22:10:31,235 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:31,236 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 22:10:32,983 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:32,984 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 22:10:34,692 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:34,692 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 22:10:36,451 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:36,451 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 22:10:38,188 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:38,189 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 22:10:39,948 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:39,948 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 22:10:41,691 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:41,692 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 22:10:43,445 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:43,446 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 22:10:45,195 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:45,195 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 22:10:46,923 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:46,924 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 22:10:48,637 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:48,638 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 22:10:50,385 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:50,386 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 22:10:52,135 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:52,135 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 22:10:53,872 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:53,872 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 22:10:55,600 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:55,600 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 22:10:57,275 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:57,275 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 22:10:59,064 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:10:59,064 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 22:11:01,702 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:11:01,708 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:11:01,710 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:11:01,711 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:11:01,711 INFO: Scheduler started
2025-11-20 22:11:01,712 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:11:01,712 INFO: === PIPELINE START ===
2025-11-20 22:11:01,712 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:11:02,457 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:11:02,464 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:02,465 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:11:02,465 INFO: Fetch สำเร็จ
2025-11-20 22:11:02,474 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:11:03,159 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:03,160 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:11:05,158 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:11:05,165 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:11:05,166 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:11:05,167 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:11:05,168 INFO: Scheduler started
2025-11-20 22:11:05,168 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:11:05,168 INFO: === PIPELINE START ===
2025-11-20 22:11:05,168 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:11:05,878 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:11:05,885 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:05,886 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:11:05,886 INFO: Fetch สำเร็จ
2025-11-20 22:11:05,897 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:11:06,639 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:06,639 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:11:08,374 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:08,375 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:11:10,049 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:10,049 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:11:11,782 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:11,783 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:11:14,002 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:11:14,008 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:11:14,011 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:11:14,013 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:11:14,013 INFO: Scheduler started
2025-11-20 22:11:14,013 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:11:14,014 INFO: === PIPELINE START ===
2025-11-20 22:11:14,014 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:11:14,743 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:11:14,750 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:14,750 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:11:14,751 INFO: Fetch สำเร็จ
2025-11-20 22:11:14,761 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:11:15,482 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:15,483 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:11:15,615 ERROR: Prediction failed
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 269, in predict_next_24h
    raise ValueError(f"BUG! Expected 168 features, got {len(expected_features)}")
ValueError: BUG! Expected 168 features, got 236
2025-11-20 22:11:17,172 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:17,172 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:11:18,887 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:18,887 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:11:20,745 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:20,746 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:11:22,424 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:22,425 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:11:24,145 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:24,146 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:11:25,891 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:25,892 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:11:27,635 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:27,636 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:11:29,324 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:29,324 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 22:11:31,042 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:31,042 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 22:11:32,759 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:32,760 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 22:11:34,522 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:34,522 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 22:11:36,232 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:36,233 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 22:11:37,953 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:37,954 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 22:11:39,715 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:39,715 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 22:11:41,411 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:41,411 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 22:11:43,092 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:43,092 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 22:11:44,835 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:44,835 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 22:11:46,549 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:46,549 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 22:11:48,279 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:48,280 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 22:11:49,980 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:49,980 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 22:11:51,691 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:51,692 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 22:11:53,418 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:53,418 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 22:11:55,105 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:55,106 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 22:11:57,047 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:57,048 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 22:11:58,741 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:11:58,742 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 22:12:00,472 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:00,473 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 22:12:02,229 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:02,230 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 22:12:03,972 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:03,972 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 22:12:05,696 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:05,696 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 22:12:07,389 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:07,391 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 22:12:09,148 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:09,149 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 22:12:10,874 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:10,874 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 22:12:12,604 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:12,605 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 22:12:14,344 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:14,345 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 22:12:16,093 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:16,094 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 22:12:17,876 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:17,876 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 22:12:19,633 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:19,633 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 22:12:21,358 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:21,358 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 22:12:23,101 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:23,102 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 22:12:24,848 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:24,849 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 22:12:26,624 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:26,625 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 22:12:28,417 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:28,418 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 22:12:30,349 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:30,350 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 22:12:32,110 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:32,111 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 22:12:33,878 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:33,878 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 22:12:35,667 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:35,667 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 22:12:37,362 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:37,362 INFO: เติม 2025-11-20 21:00 → +2
2025-11-20 22:12:39,187 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 22:12:39,188 INFO: เติม 2025-11-20 22:00 → +1
2025-11-20 22:12:40,200 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 22:12:40,202 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 131 แถว
2025-11-20 22:12:40,202 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 22:12:40,204 INFO: รวมเก่า 131 + ใหม่ 131 → 131 (เพิ่ม 0)
2025-11-20 22:12:40,206 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 22:12:40,206 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 22:12:40,222 INFO: เริ่ม clean ข้อมูล: 131 แถว
2025-11-20 22:12:40,233 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (131 แถว)
2025-11-20 22:12:40,237 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 22:00:00          57.9           13.3       0.8 144.5       25.0    50.2     1016.1
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 22:12:40,267 INFO: เตรียมโหลด 131 แถว
2025-11-20 22:12:40,273 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 22:12:40,275 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 22:12:40,278 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 22:12:40,280 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 22:12:40,282 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 22:12:40,284 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:12:40,286 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 22:12:40,288 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 22:12:40,289 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 22:12:40,290 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:12:40,292 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:12:40,295 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:12:40,296 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:12:40,298 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:12:40,299 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 22:12:40,302 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:12:40,304 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 22:12:40,305 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 22:12:40,307 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:12:40,308 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 22:12:40,310 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 22:12:40,313 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 22:12:40,315 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:12:40,316 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:12:40,319 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 22:12:40,320 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:12:40,322 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 22:12:40,325 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:12:40,328 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:12:40,332 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:12:40,335 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:12:40,338 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 22:12:40,341 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 22:12:40,345 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 22:12:40,348 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 22:12:40,352 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:12:40,354 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 22:12:40,358 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 22:12:40,361 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 22:12:40,363 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 22:12:40,366 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:12:40,367 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 22:12:40,369 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 22:12:40,372 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 22:12:40,374 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 22:12:40,375 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 22:12:40,377 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:12:40,379 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 22:12:40,381 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:12:40,382 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 22:12:40,384 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 22:12:40,386 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:12:40,388 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:12:40,391 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:12:40,393 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 22:12:40,395 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:12:40,397 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 22:12:40,398 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:12:40,400 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 22:12:40,402 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:12:40,404 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 22:12:40,405 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 22:12:40,408 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 22:12:40,410 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 22:12:40,411 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:12:40,413 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 22:12:40,415 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:12:40,417 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 22:12:40,419 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 22:12:40,421 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:12:40,423 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 22:12:40,425 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 22:12:40,426 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 22:12:40,428 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 22:12:40,429 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 22:12:40,431 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 22:12:40,433 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 22:12:40,435 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:12:40,436 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:12:40,440 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 22:12:40,444 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:12:40,447 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 22:12:40,449 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 22:12:40,452 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:12:40,455 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 22:12:40,458 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:12:40,461 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:12:40,464 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 22:12:40,467 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 22:12:40,469 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:12:40,472 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 22:12:40,475 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 22:12:40,478 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 22:12:40,480 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 22:12:40,482 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 22:12:40,483 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 22:12:40,485 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:12:40,487 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 22:12:40,488 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 22:12:40,491 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:12:40,493 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:12:40,494 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 22:12:40,496 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 22:12:40,497 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:12:40,498 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:12:40,500 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 22:12:40,502 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 22:12:40,504 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 22:12:40,505 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 22:12:40,507 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 22:12:40,509 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 22:12:40,511 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 22:12:40,512 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 22:12:40,514 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 22:12:40,516 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:12:40,518 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 22:12:40,519 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 22:12:40,520 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 22:12:40,522 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 22:12:40,524 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 22:12:40,526 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 22:12:40,527 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 22:12:40,529 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 22:12:40,530 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 22:12:40,532 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 22:12:40,534 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:12:40,536 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:12:40,538 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 22:12:40,539 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 22:12:40,541 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 22:12:40,543 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-20 22:12:40,543 INFO: โหลด DB สำเร็จ
2025-11-20 22:12:40,545 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 22:12:40,547 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 22:12:40,548 INFO: Load to DB + Backup สำเร็จ
2025-11-20 22:12:40,548 INFO: === PIPELINE END ===

2025-11-20 22:15:50,238 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:15:50,244 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:15:50,246 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:15:50,248 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:15:50,248 INFO: Scheduler started
2025-11-20 22:15:50,248 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:15:50,248 INFO: === PIPELINE START ===
2025-11-20 22:15:50,248 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:15:51,000 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:15:51,009 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:15:51,010 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:15:51,010 INFO: Fetch สำเร็จ
2025-11-20 22:15:51,022 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:15:51,785 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:15:51,786 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:15:53,928 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:15:53,934 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:15:53,935 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:15:53,936 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:15:53,937 INFO: Scheduler started
2025-11-20 22:15:53,937 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:15:53,937 INFO: === PIPELINE START ===
2025-11-20 22:15:53,937 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:15:54,688 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:15:54,695 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:15:54,696 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:15:54,696 INFO: Fetch สำเร็จ
2025-11-20 22:15:54,706 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:15:55,432 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:15:55,433 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:15:57,162 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:15:57,163 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:15:58,892 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:15:58,892 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:16:00,664 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:00,664 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:16:02,384 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:02,385 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:16:04,129 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:04,129 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:16:06,130 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:06,131 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:16:07,854 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:07,854 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:16:09,628 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:09,629 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 22:16:11,380 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:11,380 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 22:16:13,145 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:13,145 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 22:16:14,887 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:14,887 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 22:16:16,638 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:16,638 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 22:16:18,376 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:18,377 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 22:16:20,101 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:20,102 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 22:16:21,835 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:21,835 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 22:16:23,604 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:23,605 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 22:16:25,295 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:25,295 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 22:16:26,994 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:26,994 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 22:16:28,714 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:28,714 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 22:16:30,408 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:30,408 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 22:16:32,124 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:32,125 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 22:16:33,789 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:33,791 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 22:16:35,525 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:35,526 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 22:16:37,291 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:37,292 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 22:16:39,154 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:39,154 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 22:16:40,895 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:40,895 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 22:16:42,642 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:42,644 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 22:16:44,395 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:44,396 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 22:16:46,146 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:46,147 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 22:16:47,874 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:47,874 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 22:16:49,631 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:49,631 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 22:16:51,339 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:51,339 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 22:16:53,087 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:53,088 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 22:16:54,790 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:54,791 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 22:16:56,530 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:56,531 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 22:16:58,288 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:16:58,288 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 22:17:00,072 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:17:00,072 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 22:17:01,811 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:17:01,811 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 22:17:03,551 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:17:03,551 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 22:17:05,293 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:17:05,294 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 22:17:06,969 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:17:06,969 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 22:17:08,693 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:17:08,694 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 22:17:10,450 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:17:10,451 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 22:17:12,176 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:17:12,177 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 22:17:13,937 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:17:13,938 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 22:17:15,684 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:17:15,684 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 22:17:17,412 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:17:17,413 INFO: เติม 2025-11-20 21:00 → +2
2025-11-20 22:17:19,181 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 22:17:19,182 INFO: เติม 2025-11-20 22:00 → +1
2025-11-20 22:17:20,180 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 22:17:20,182 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 131 แถว
2025-11-20 22:17:20,183 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 22:17:20,187 INFO: รวมเก่า 131 + ใหม่ 131 → 131 (เพิ่ม 0)
2025-11-20 22:17:20,188 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 22:17:20,188 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 22:17:20,189 INFO: เริ่ม clean ข้อมูล: 131 แถว
2025-11-20 22:17:20,200 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (131 แถว)
2025-11-20 22:17:20,204 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 22:00:00          57.9           13.3       0.8 144.5       25.0    50.2     1016.1
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 22:17:20,233 INFO: เตรียมโหลด 131 แถว
2025-11-20 22:17:20,238 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 22:17:20,239 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 22:17:20,240 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 22:17:20,243 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 22:17:20,245 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 22:17:20,246 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:17:20,248 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 22:17:20,250 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 22:17:20,251 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 22:17:20,252 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:17:20,253 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:17:20,255 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:17:20,256 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:17:20,258 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:17:20,260 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 22:17:20,262 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:17:20,263 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 22:17:20,265 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 22:17:20,266 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:17:20,268 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 22:17:20,270 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 22:17:20,271 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 22:17:20,273 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:17:20,274 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:17:20,276 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 22:17:20,277 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:17:20,279 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 22:17:20,281 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:17:20,282 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:17:20,284 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:17:20,285 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:17:20,287 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 22:17:20,288 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 22:17:20,289 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 22:17:20,292 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 22:17:20,293 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:17:20,295 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 22:17:20,296 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 22:17:20,298 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 22:17:20,299 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 22:17:20,300 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:17:20,302 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 22:17:20,303 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 22:17:20,305 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 22:17:20,306 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 22:17:20,309 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 22:17:20,310 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:17:20,311 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 22:17:20,312 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:17:20,314 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 22:17:20,316 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 22:17:20,317 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:17:20,319 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:17:20,320 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:17:20,322 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 22:17:20,323 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:17:20,325 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 22:17:20,326 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:17:20,328 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 22:17:20,329 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:17:20,331 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 22:17:20,332 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 22:17:20,334 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 22:17:20,335 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 22:17:20,337 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:17:20,338 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 22:17:20,341 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:17:20,342 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 22:17:20,344 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 22:17:20,345 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:17:20,346 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 22:17:20,348 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 22:17:20,349 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 22:17:20,351 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 22:17:20,353 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 22:17:20,355 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 22:17:20,356 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 22:17:20,358 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:17:20,359 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:17:20,360 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 22:17:20,361 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:17:20,363 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 22:17:20,365 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 22:17:20,366 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:17:20,368 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 22:17:20,369 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:17:20,371 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:17:20,372 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 22:17:20,374 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 22:17:20,375 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:17:20,377 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 22:17:20,379 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 22:17:20,380 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 22:17:20,381 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 22:17:20,383 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 22:17:20,385 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 22:17:20,387 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:17:20,388 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 22:17:20,389 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 22:17:20,392 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:17:20,393 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:17:20,394 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 22:17:20,395 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 22:17:20,397 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:17:20,399 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:17:20,400 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 22:17:20,402 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 22:17:20,403 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 22:17:20,405 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 22:17:20,406 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 22:17:20,408 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 22:17:20,409 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 22:17:20,411 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 22:17:20,413 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 22:17:20,415 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:17:20,416 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 22:17:20,417 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 22:17:20,418 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 22:17:20,420 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 22:17:20,422 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 22:17:20,423 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 22:17:20,425 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 22:17:20,426 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 22:17:20,428 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 22:17:20,429 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 22:17:20,432 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:17:20,433 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:17:20,435 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 22:17:20,436 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 22:17:20,438 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 22:17:20,438 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-20 22:17:20,439 INFO: โหลด DB สำเร็จ
2025-11-20 22:17:20,440 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 22:17:20,443 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 22:17:20,443 INFO: Load to DB + Backup สำเร็จ
2025-11-20 22:17:20,443 INFO: === PIPELINE END ===

2025-11-20 22:18:09,856 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:18:09,862 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:18:09,864 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:18:09,865 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:18:09,865 INFO: Scheduler started
2025-11-20 22:18:09,865 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:18:09,866 INFO: === PIPELINE START ===
2025-11-20 22:18:09,866 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:18:10,595 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:18:10,602 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:10,603 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:18:10,603 INFO: Fetch สำเร็จ
2025-11-20 22:18:10,611 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:18:11,331 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:11,332 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:18:16,349 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:18:16,355 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:18:16,356 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:18:16,357 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:18:16,357 INFO: Scheduler started
2025-11-20 22:18:16,358 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:18:16,358 INFO: === PIPELINE START ===
2025-11-20 22:18:16,358 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:18:17,141 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:18:17,148 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:17,149 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:18:17,149 INFO: Fetch สำเร็จ
2025-11-20 22:18:17,159 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:18:17,921 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:17,921 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:18:18,029 ERROR: Prediction failed
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 296, in predict_next_24h
    max_val = max(preds)
              ^^^^^^^^^^
ValueError: max() arg is an empty sequence
2025-11-20 22:18:19,684 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:19,685 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:18:21,404 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:21,405 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:18:22,017 ERROR: Prediction failed
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 296, in predict_next_24h
    max_val = max(preds)
              ^^^^^^^^^^
ValueError: max() arg is an empty sequence
2025-11-20 22:18:23,146 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:23,146 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:18:24,911 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:24,911 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:18:26,653 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:26,654 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:18:28,416 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:28,417 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:18:30,158 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:30,159 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:18:31,910 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:31,911 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 22:18:33,687 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:33,688 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 22:18:35,650 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:35,650 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 22:18:37,384 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:37,385 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 22:18:39,104 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:39,105 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 22:18:40,867 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:40,868 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 22:18:42,578 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:42,578 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 22:18:44,315 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:44,316 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 22:18:46,028 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:46,028 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 22:18:47,769 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:47,769 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 22:18:49,489 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:49,490 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 22:18:51,176 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:51,177 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 22:18:52,882 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:52,882 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 22:18:54,570 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:54,571 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 22:18:56,287 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:56,289 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 22:18:58,017 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:58,017 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 22:18:59,735 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:18:59,736 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 22:19:01,412 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:01,413 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 22:19:03,120 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:03,121 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 22:19:04,871 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:04,871 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 22:19:06,567 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:06,567 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 22:19:08,339 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:08,340 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 22:19:10,054 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:10,054 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 22:19:11,755 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:11,756 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 22:19:13,471 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:13,471 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 22:19:15,217 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:15,218 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 22:19:16,943 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:16,943 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 22:19:18,647 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:18,647 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 22:19:20,357 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:20,357 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 22:19:22,117 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:22,118 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 22:19:23,848 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:23,848 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 22:19:25,607 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:25,607 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 22:19:27,311 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:27,312 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 22:19:29,057 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:29,057 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 22:19:30,772 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:30,772 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 22:19:32,482 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:32,482 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 22:19:34,168 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:34,168 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 22:19:35,874 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:35,874 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 22:19:37,566 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:37,567 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 22:19:39,892 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:19:39,898 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:19:39,899 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:19:39,900 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:19:39,901 INFO: Scheduler started
2025-11-20 22:19:39,901 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:19:39,901 INFO: === PIPELINE START ===
2025-11-20 22:19:39,901 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:19:41,023 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:19:41,033 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:41,033 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:19:41,033 INFO: Fetch สำเร็จ
2025-11-20 22:19:41,043 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:19:41,748 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:41,748 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:19:43,461 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:43,462 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:19:45,160 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:45,161 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:19:46,923 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:46,923 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:19:48,641 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:48,641 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:19:50,325 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:50,325 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:19:51,987 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:51,987 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:19:53,727 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:53,728 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:19:55,443 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:55,444 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 22:19:57,286 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:57,287 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 22:19:58,984 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:19:58,985 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 22:20:00,702 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:00,703 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 22:20:02,447 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:02,449 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 22:20:04,239 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:04,241 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 22:20:05,995 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:05,995 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 22:20:07,701 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:07,702 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 22:20:09,474 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:09,474 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 22:20:11,190 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:11,191 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 22:20:12,875 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:12,875 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 22:20:14,556 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:14,557 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 22:20:16,265 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:16,266 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 22:20:17,950 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:17,950 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 22:20:19,613 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:19,614 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 22:20:21,324 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:21,325 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 22:20:23,035 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:23,036 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 22:20:24,733 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:24,733 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 22:20:26,409 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:26,410 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 22:20:28,079 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:28,080 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 22:20:29,777 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:29,777 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 22:20:31,475 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:31,475 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 22:20:33,166 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:33,166 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 22:20:34,868 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:34,869 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 22:20:36,551 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:36,551 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 22:20:38,259 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:38,260 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 22:20:39,938 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:39,939 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 22:20:41,632 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:41,633 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 22:20:43,305 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:43,305 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 22:20:44,981 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:44,982 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 22:20:46,901 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:46,901 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 22:20:48,613 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:48,614 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 22:20:50,325 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:50,325 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 22:20:52,092 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:52,092 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 22:20:53,720 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:53,720 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 22:20:55,482 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:55,482 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 22:20:57,158 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:57,158 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 22:20:58,857 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:20:58,859 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 22:21:00,526 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:21:00,527 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 22:21:02,207 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:21:02,208 INFO: เติม 2025-11-20 21:00 → +2
2025-11-20 22:21:03,895 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 22:21:03,895 INFO: เติม 2025-11-20 22:00 → +1
2025-11-20 22:21:04,899 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 22:21:04,901 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 131 แถว
2025-11-20 22:21:04,902 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 22:21:04,903 INFO: รวมเก่า 131 + ใหม่ 131 → 131 (เพิ่ม 0)
2025-11-20 22:21:04,905 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 22:21:04,905 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 22:21:04,907 INFO: เริ่ม clean ข้อมูล: 131 แถว
2025-11-20 22:21:04,918 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (131 แถว)
2025-11-20 22:21:04,920 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 22:00:00          57.9           13.3       0.8 144.5       25.0    50.2     1016.1
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 22:21:04,949 INFO: เตรียมโหลด 131 แถว
2025-11-20 22:21:04,955 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 22:21:04,958 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 22:21:04,958 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 22:21:04,960 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 22:21:04,963 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 22:21:04,964 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:21:04,966 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 22:21:04,967 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 22:21:04,969 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 22:21:04,970 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:21:04,972 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:21:04,974 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:21:04,975 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:21:04,977 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:21:04,979 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 22:21:04,981 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:21:04,982 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 22:21:04,984 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 22:21:04,985 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:21:04,987 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 22:21:04,989 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 22:21:04,990 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 22:21:04,995 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:21:04,998 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:21:05,002 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 22:21:05,004 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:21:05,007 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 22:21:05,008 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:21:05,011 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:21:05,015 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:21:05,018 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:21:05,020 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 22:21:05,022 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 22:21:05,024 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 22:21:05,026 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 22:21:05,030 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:21:05,033 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 22:21:05,035 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 22:21:05,037 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 22:21:05,038 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 22:21:05,039 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:21:05,041 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 22:21:05,043 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 22:21:05,044 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 22:21:05,046 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 22:21:05,048 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 22:21:05,049 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:21:05,052 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 22:21:05,053 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:21:05,055 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 22:21:05,056 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 22:21:05,058 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:21:05,060 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:21:05,061 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:21:05,063 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 22:21:05,064 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:21:05,066 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 22:21:05,067 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:21:05,070 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 22:21:05,071 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:21:05,072 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 22:21:05,074 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 22:21:05,076 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 22:21:05,077 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 22:21:05,080 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:21:05,081 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 22:21:05,083 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:21:05,085 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 22:21:05,086 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 22:21:05,087 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:21:05,089 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 22:21:05,091 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 22:21:05,092 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 22:21:05,094 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 22:21:05,095 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 22:21:05,097 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 22:21:05,098 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 22:21:05,101 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:21:05,103 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:21:05,104 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 22:21:05,105 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:21:05,107 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 22:21:05,109 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 22:21:05,110 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:21:05,112 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 22:21:05,114 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:21:05,115 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:21:05,116 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 22:21:05,118 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 22:21:05,119 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:21:05,121 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 22:21:05,122 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 22:21:05,124 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 22:21:05,125 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 22:21:05,127 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 22:21:05,128 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 22:21:05,130 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:21:05,131 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 22:21:05,133 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 22:21:05,134 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:21:05,136 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:21:05,137 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 22:21:05,139 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 22:21:05,141 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:21:05,142 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:21:05,144 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 22:21:05,145 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 22:21:05,147 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 22:21:05,148 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 22:21:05,149 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 22:21:05,150 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 22:21:05,152 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 22:21:05,153 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 22:21:05,155 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 22:21:05,156 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:21:05,158 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 22:21:05,159 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 22:21:05,161 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 22:21:05,162 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 22:21:05,164 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 22:21:05,165 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 22:21:05,167 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 22:21:05,169 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 22:21:05,171 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 22:21:05,172 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 22:21:05,174 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:21:05,175 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:21:05,177 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 22:21:05,178 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 22:21:05,179 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 22:21:05,181 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-20 22:21:05,181 INFO: โหลด DB สำเร็จ
2025-11-20 22:21:05,183 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 22:21:05,185 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 22:21:05,185 INFO: Load to DB + Backup สำเร็จ
2025-11-20 22:21:05,186 INFO: === PIPELINE END ===

2025-11-20 22:23:04,484 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:23:04,490 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:23:04,492 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:23:04,493 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:23:04,493 INFO: Scheduler started
2025-11-20 22:23:04,493 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:23:04,494 INFO: === PIPELINE START ===
2025-11-20 22:23:04,494 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:23:05,202 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:23:05,209 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:05,211 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:23:05,211 INFO: Fetch สำเร็จ
2025-11-20 22:23:05,218 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:23:05,892 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:05,893 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:23:08,036 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:23:08,042 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:23:08,043 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:23:08,044 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:23:08,045 INFO: Scheduler started
2025-11-20 22:23:08,045 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:23:08,045 INFO: === PIPELINE START ===
2025-11-20 22:23:08,045 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:23:08,752 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:23:08,760 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:08,760 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:23:08,760 INFO: Fetch สำเร็จ
2025-11-20 22:23:08,770 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:23:09,455 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:09,456 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:23:11,152 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:11,152 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:23:12,818 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:12,818 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:23:14,504 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:14,504 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:23:16,188 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:16,188 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:23:17,921 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:17,921 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:23:19,583 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:19,584 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:23:21,269 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:21,269 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:23:23,128 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:23,129 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 22:23:24,852 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:24,852 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 22:23:26,668 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:26,668 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 22:23:28,344 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:28,344 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 22:23:30,130 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:30,130 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 22:23:31,961 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:31,961 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 22:23:33,729 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:33,729 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 22:23:35,636 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:35,637 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 22:23:37,393 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:37,394 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 22:23:39,165 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:39,166 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 22:23:40,856 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:40,857 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 22:23:42,552 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:42,552 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 22:23:44,285 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:44,285 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 22:23:45,978 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:45,978 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 22:23:47,663 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:47,664 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 22:23:49,371 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:49,371 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 22:23:51,080 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:51,081 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 22:23:52,893 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:52,894 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 22:23:54,611 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:54,611 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 22:23:56,326 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:56,327 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 22:23:58,043 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:58,043 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 22:23:59,709 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:23:59,710 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 22:24:01,398 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:01,398 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 22:24:03,147 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:03,147 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 22:24:04,859 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:04,860 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 22:24:06,552 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:06,553 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 22:24:08,275 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:08,275 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 22:24:09,989 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:09,989 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 22:24:11,668 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:11,669 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 22:24:13,356 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:13,356 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 22:24:15,039 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:15,040 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 22:24:16,712 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:16,712 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 22:24:18,367 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:18,369 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 22:24:20,054 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:20,055 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 22:24:21,728 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:21,728 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 22:24:23,449 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:23,450 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 22:24:25,507 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:25,507 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 22:24:27,214 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:27,214 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 22:24:28,916 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:28,916 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 22:24:30,618 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:30,619 INFO: เติม 2025-11-20 21:00 → +2
2025-11-20 22:24:32,307 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 22:24:32,307 INFO: เติม 2025-11-20 22:00 → +1
2025-11-20 22:24:33,303 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 22:24:33,305 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 131 แถว
2025-11-20 22:24:33,305 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 22:24:33,307 INFO: รวมเก่า 131 + ใหม่ 131 → 131 (เพิ่ม 0)
2025-11-20 22:24:33,309 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 22:24:33,309 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 22:24:33,312 INFO: เริ่ม clean ข้อมูล: 131 แถว
2025-11-20 22:24:33,325 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (131 แถว)
2025-11-20 22:24:33,329 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 22:00:00          57.9           13.3       0.8 144.5       25.0    50.2     1016.1
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 22:24:33,386 INFO: เตรียมโหลด 131 แถว
2025-11-20 22:24:33,390 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 22:24:33,393 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 22:24:33,395 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 22:24:33,397 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 22:24:33,399 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 22:24:33,401 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:24:33,403 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 22:24:33,405 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 22:24:33,407 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 22:24:33,410 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:24:33,412 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:24:33,414 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:24:33,416 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:24:33,418 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:24:33,421 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 22:24:33,423 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:24:33,425 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 22:24:33,427 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 22:24:33,429 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:24:33,431 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 22:24:33,433 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 22:24:33,435 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 22:24:33,436 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:24:33,439 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:24:33,441 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 22:24:33,443 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:24:33,445 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 22:24:33,447 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:24:33,449 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:24:33,451 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:24:33,453 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:24:33,455 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 22:24:33,456 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 22:24:33,458 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 22:24:33,460 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 22:24:33,463 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:24:33,464 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 22:24:33,466 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 22:24:33,468 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 22:24:33,469 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 22:24:33,471 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:24:33,473 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 22:24:33,475 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 22:24:33,478 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 22:24:33,480 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 22:24:33,483 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 22:24:33,485 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:24:33,488 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 22:24:33,490 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:24:33,492 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 22:24:33,495 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 22:24:33,497 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:24:33,500 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:24:33,502 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:24:33,504 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 22:24:33,507 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:24:33,508 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 22:24:33,510 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:24:33,512 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 22:24:33,513 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:24:33,516 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 22:24:33,517 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 22:24:33,519 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 22:24:33,522 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 22:24:33,524 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:24:33,525 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 22:24:33,528 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:24:33,529 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 22:24:33,531 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 22:24:33,533 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:24:33,534 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 22:24:33,536 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 22:24:33,539 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 22:24:33,541 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 22:24:33,543 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 22:24:33,545 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 22:24:33,547 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 22:24:33,548 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:24:33,550 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:24:33,551 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 22:24:33,553 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:24:33,555 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 22:24:33,560 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 22:24:33,562 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:24:33,566 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 22:24:33,569 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:24:33,571 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:24:33,574 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 22:24:33,577 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 22:24:33,580 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:24:33,583 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 22:24:33,586 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 22:24:33,588 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 22:24:33,591 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 22:24:33,593 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 22:24:33,595 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 22:24:33,598 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:24:33,600 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 22:24:33,602 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 22:24:33,604 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:24:33,606 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:24:33,608 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 22:24:33,609 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 22:24:33,612 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:24:33,613 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:24:33,615 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 22:24:33,617 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 22:24:33,619 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 22:24:33,620 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 22:24:33,622 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 22:24:33,624 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 22:24:33,625 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 22:24:33,627 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 22:24:33,630 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 22:24:33,632 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:24:33,634 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 22:24:33,635 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 22:24:33,637 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 22:24:33,639 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 22:24:33,641 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 22:24:33,643 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 22:24:33,646 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 22:24:33,647 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 22:24:33,649 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 22:24:33,651 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 22:24:33,652 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:24:33,654 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:24:33,656 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 22:24:33,658 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 22:24:33,659 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 22:24:33,661 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-20 22:24:33,662 INFO: โหลด DB สำเร็จ
2025-11-20 22:24:33,664 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 22:24:33,667 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 22:24:33,667 INFO: Load to DB + Backup สำเร็จ
2025-11-20 22:24:33,667 INFO: === PIPELINE END ===

2025-11-20 22:25:00,271 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:25:00,276 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:25:00,277 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:25:00,279 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:25:00,279 INFO: Scheduler started
2025-11-20 22:25:00,280 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:25:00,280 INFO: === PIPELINE START ===
2025-11-20 22:25:00,280 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:25:01,005 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:25:01,012 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:01,013 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:25:01,013 INFO: Fetch สำเร็จ
2025-11-20 22:25:01,025 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:25:01,748 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:01,748 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:25:03,421 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:03,421 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:25:05,110 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:05,111 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:25:06,795 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:06,796 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:25:08,473 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:08,474 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:25:10,184 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:10,184 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:25:11,922 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:11,923 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:25:13,614 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:13,614 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:25:15,344 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:15,344 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 22:25:17,037 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:17,038 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 22:25:18,773 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:18,774 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 22:25:20,473 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:20,473 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 22:25:22,212 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:22,213 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 22:25:23,874 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:23,874 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 22:25:25,554 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:25,555 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 22:25:27,282 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:27,282 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 22:25:28,959 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:28,959 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 22:25:30,767 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:30,769 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 22:25:32,508 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:32,509 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 22:25:34,224 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:34,225 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 22:25:35,928 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:35,929 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 22:25:37,608 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:37,609 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 22:25:39,305 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:39,305 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 22:25:41,048 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:41,048 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 22:25:42,726 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:42,727 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 22:25:44,406 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:44,406 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 22:25:46,086 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:46,086 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 22:25:47,766 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:47,766 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 22:25:49,461 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:49,462 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 22:25:51,137 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:51,137 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 22:25:52,840 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:52,840 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 22:25:54,491 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:54,492 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 22:25:56,220 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:56,221 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 22:25:57,922 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:57,922 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 22:25:59,597 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:25:59,599 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 22:26:01,289 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:01,290 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 22:26:03,001 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:03,001 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 22:26:04,677 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:04,677 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 22:26:06,434 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:06,435 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 22:26:08,141 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:08,141 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 22:26:09,840 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:09,841 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 22:26:11,489 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:11,490 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 22:26:13,198 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:13,199 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 22:26:14,903 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:14,903 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 22:26:16,613 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:16,613 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 22:26:18,289 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:18,289 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 22:26:20,170 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:20,170 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 22:26:21,895 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:21,895 INFO: เติม 2025-11-20 21:00 → +2
2025-11-20 22:26:23,608 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 22:26:23,609 INFO: เติม 2025-11-20 22:00 → +1
2025-11-20 22:26:24,625 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 22:26:24,627 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 131 แถว
2025-11-20 22:26:24,628 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 22:26:24,631 INFO: รวมเก่า 131 + ใหม่ 131 → 131 (เพิ่ม 0)
2025-11-20 22:26:24,633 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 22:26:24,633 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 22:26:24,636 INFO: เริ่ม clean ข้อมูล: 131 แถว
2025-11-20 22:26:24,647 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (131 แถว)
2025-11-20 22:26:24,651 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 22:00:00          57.9           13.3       0.8 144.5       25.0    50.2     1016.1
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 22:26:24,682 INFO: เตรียมโหลด 131 แถว
2025-11-20 22:26:24,689 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 22:26:24,691 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 22:26:24,693 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 22:26:24,695 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 22:26:24,698 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 22:26:24,699 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:26:24,701 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 22:26:24,703 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 22:26:24,705 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 22:26:24,708 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:26:24,709 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:26:24,710 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:26:24,712 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:26:24,714 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:26:24,715 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 22:26:24,717 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:26:24,719 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 22:26:24,720 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 22:26:24,722 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:26:24,724 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 22:26:24,726 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 22:26:24,727 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 22:26:24,729 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:26:24,734 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:26:24,737 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 22:26:24,742 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:26:24,744 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 22:26:24,746 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:26:24,748 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:26:24,752 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:26:24,755 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:26:24,757 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 22:26:24,760 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 22:26:24,762 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 22:26:24,765 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 22:26:24,767 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:26:24,770 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 22:26:24,772 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 22:26:24,775 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 22:26:24,776 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 22:26:24,777 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:26:24,780 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 22:26:24,782 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 22:26:24,784 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 22:26:24,786 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 22:26:24,787 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 22:26:24,790 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:26:24,792 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 22:26:24,793 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:26:24,795 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 22:26:24,797 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 22:26:24,798 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:26:24,801 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:26:24,803 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:26:24,804 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 22:26:24,806 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:26:24,808 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 22:26:24,809 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:26:24,811 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 22:26:24,813 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:26:24,815 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 22:26:24,818 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 22:26:24,819 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 22:26:24,822 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 22:26:24,824 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:26:24,826 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 22:26:24,828 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:26:24,830 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 22:26:24,832 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 22:26:24,834 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:26:24,836 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 22:26:24,837 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 22:26:24,840 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 22:26:24,842 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 22:26:24,844 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 22:26:24,846 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 22:26:24,848 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 22:26:24,849 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:26:24,851 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:26:24,853 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 22:26:24,854 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:26:24,857 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 22:26:24,858 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 22:26:24,860 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:26:24,862 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 22:26:24,864 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:26:24,866 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:26:24,868 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 22:26:24,869 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 22:26:24,871 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:26:24,873 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 22:26:24,875 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 22:26:24,877 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 22:26:24,880 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 22:26:24,882 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 22:26:24,883 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 22:26:24,885 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:26:24,887 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 22:26:24,889 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 22:26:24,891 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:26:24,893 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:26:24,895 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 22:26:24,897 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 22:26:24,899 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:26:24,901 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:26:24,902 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 22:26:24,904 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 22:26:24,906 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 22:26:24,908 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 22:26:24,910 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 22:26:24,913 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 22:26:24,915 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 22:26:24,916 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 22:26:24,918 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 22:26:24,920 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:26:24,921 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 22:26:24,923 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 22:26:24,925 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 22:26:24,927 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 22:26:24,929 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 22:26:24,931 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 22:26:24,933 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 22:26:24,935 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 22:26:24,937 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 22:26:24,938 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 22:26:24,941 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:26:24,943 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:26:24,945 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 22:26:24,947 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 22:26:24,948 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 22:26:24,949 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-20 22:26:24,950 INFO: โหลด DB สำเร็จ
2025-11-20 22:26:24,952 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 22:26:24,955 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 22:26:24,955 INFO: Load to DB + Backup สำเร็จ
2025-11-20 22:26:24,955 INFO: === PIPELINE END ===

2025-11-20 22:27:27,572 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 22:27:27,579 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 22:27:27,581 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:27:27,582 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 22:27:27,582 INFO: Scheduler started
2025-11-20 22:27:27,582 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 22:27:27,582 INFO: === PIPELINE START ===
2025-11-20 22:27:27,582 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 22:27:28,402 INFO: ดึง 2025-11-20 21:00:00+07:00 - 2025-11-20 22:00:00+07:00 → 2 แถว
2025-11-20 22:27:28,413 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:28,413 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 22:27:28,414 INFO: Fetch สำเร็จ
2025-11-20 22:27:28,423 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 22:27:29,133 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:29,133 INFO: เติม 2025-11-18 22:00 → +2
2025-11-20 22:27:30,952 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:30,952 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 22:27:32,660 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:32,660 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 22:27:34,369 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:34,370 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 22:27:36,050 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:36,050 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 22:27:37,791 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:37,791 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 22:27:39,677 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:39,678 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 22:27:41,387 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:41,388 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 22:27:43,116 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:43,117 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 22:27:44,818 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:44,818 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 22:27:46,527 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:46,527 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 22:27:48,204 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:48,205 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 22:27:49,929 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:49,930 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 22:27:51,691 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:51,691 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 22:27:53,419 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:53,420 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 22:27:55,201 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:55,201 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 22:27:56,929 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:56,929 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 22:27:58,772 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:27:58,773 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 22:28:00,512 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:00,512 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 22:28:02,193 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:02,194 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 22:28:03,948 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:03,948 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 22:28:05,689 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:05,689 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 22:28:07,377 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:07,378 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 22:28:09,102 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:09,102 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 22:28:10,861 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:10,861 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 22:28:12,617 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:12,618 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 22:28:14,317 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:14,317 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 22:28:16,097 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:16,099 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 22:28:17,842 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:17,843 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 22:28:19,557 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:19,557 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 22:28:21,330 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:21,331 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 22:28:23,080 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:23,081 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 22:28:24,803 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:24,804 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 22:28:26,583 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:26,583 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 22:28:28,332 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:28,333 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 22:28:30,062 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:30,062 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 22:28:31,822 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:31,823 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 22:28:33,586 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:33,587 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 22:28:35,245 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:35,245 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 22:28:36,967 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:36,969 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 22:28:38,693 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:38,694 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 22:28:40,432 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:40,432 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 22:28:42,208 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:42,209 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 22:28:43,906 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:43,907 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 22:28:45,617 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:45,617 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 22:28:47,269 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:47,270 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 22:28:48,990 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:48,990 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 22:28:50,741 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:50,742 INFO: เติม 2025-11-20 21:00 → +2
2025-11-20 22:28:52,470 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 22:28:52,470 INFO: เติม 2025-11-20 22:00 → +1
2025-11-20 22:28:53,486 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 22:28:53,489 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 131 แถว
2025-11-20 22:28:53,490 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 22:28:53,492 INFO: รวมเก่า 131 + ใหม่ 131 → 131 (เพิ่ม 0)
2025-11-20 22:28:53,493 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 22:28:53,494 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 22:28:53,496 INFO: เริ่ม clean ข้อมูล: 131 แถว
2025-11-20 22:28:53,509 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (131 แถว)
2025-11-20 22:28:53,512 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 22:00:00          57.9           13.3       0.8 144.5       25.0    50.2     1016.1
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 22:28:53,540 INFO: เตรียมโหลด 131 แถว
2025-11-20 22:28:53,547 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 22:28:53,549 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 22:28:53,552 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 22:28:53,553 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 22:28:53,555 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 22:28:53,557 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:28:53,558 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 22:28:53,560 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 22:28:53,562 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 22:28:53,563 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:28:53,565 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:28:53,567 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:28:53,568 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:28:53,569 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:28:53,571 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 22:28:53,572 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:28:53,574 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 22:28:53,576 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 22:28:53,577 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:28:53,579 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 22:28:53,580 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 22:28:53,582 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 22:28:53,583 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:28:53,586 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 22:28:53,587 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 22:28:53,588 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:28:53,589 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 22:28:53,591 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:28:53,592 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:28:53,592 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 22:28:53,595 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:28:53,598 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 22:28:53,599 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 22:28:53,600 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 22:28:53,602 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 22:28:53,603 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:28:53,605 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 22:28:53,606 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 22:28:53,608 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 22:28:53,610 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 22:28:53,611 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 22:28:53,613 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 22:28:53,614 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 22:28:53,616 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 22:28:53,617 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 22:28:53,619 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 22:28:53,621 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:28:53,622 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 22:28:53,624 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:28:53,625 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 22:28:53,626 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 22:28:53,628 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:28:53,629 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:28:53,631 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:28:53,632 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 22:28:53,634 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 22:28:53,636 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 22:28:53,637 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 22:28:53,638 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 22:28:53,639 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:28:53,642 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 22:28:53,643 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 22:28:53,644 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 22:28:53,647 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 22:28:53,648 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:28:53,649 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 22:28:53,650 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:28:53,652 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 22:28:53,653 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 22:28:53,655 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 22:28:53,656 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 22:28:53,658 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 22:28:53,659 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 22:28:53,661 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 22:28:53,662 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 22:28:53,664 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 22:28:53,665 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 22:28:53,667 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:28:53,669 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 22:28:53,670 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 22:28:53,671 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 22:28:53,673 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 22:28:53,675 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 22:28:53,677 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 22:28:53,678 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 22:28:53,680 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 22:28:53,684 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 22:28:53,686 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 22:28:53,688 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 22:28:53,691 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 22:28:53,694 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 22:28:53,697 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 22:28:53,700 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 22:28:53,702 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 22:28:53,705 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 22:28:53,707 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 22:28:53,710 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 22:28:53,712 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 22:28:53,715 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 22:28:53,717 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:28:53,720 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 22:28:53,722 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 22:28:53,725 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 22:28:53,726 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 22:28:53,727 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 22:28:53,730 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 22:28:53,731 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 22:28:53,733 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 22:28:53,735 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 22:28:53,736 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 22:28:53,738 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 22:28:53,740 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 22:28:53,742 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 22:28:53,743 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 22:28:53,744 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 22:28:53,746 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 22:28:53,747 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 22:28:53,749 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 22:28:53,751 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 22:28:53,753 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 22:28:53,755 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 22:28:53,756 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 22:28:53,758 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 22:28:53,759 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 22:28:53,761 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 22:28:53,763 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 22:28:53,764 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 22:28:53,767 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 22:28:53,769 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 22:28:53,771 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 22:28:53,772 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-20 22:28:53,773 INFO: โหลด DB สำเร็จ
2025-11-20 22:28:53,775 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 22:28:53,777 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 22:28:53,777 INFO: Load to DB + Backup สำเร็จ
2025-11-20 22:28:53,778 INFO: === PIPELINE END ===

2025-11-20 23:05:00,016 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-21 00:05:00 +07)" (scheduled at 2025-11-20 23:05:00+07:00)
2025-11-20 23:05:00,016 INFO: === PIPELINE START ===
2025-11-20 23:05:00,017 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:05:00,713 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:05:00,718 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:00,718 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:05:00,719 INFO: Fetch สำเร็จ
2025-11-20 23:05:00,740 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:05:01,437 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:01,437 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:05:03,149 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:03,151 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:05:04,856 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:04,857 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:05:06,558 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:06,559 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:05:08,246 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:08,246 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 23:05:10,172 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:10,172 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 23:05:11,861 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:11,862 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 23:05:13,528 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:13,528 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 23:05:15,219 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:15,219 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 23:05:16,900 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:16,900 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 23:05:18,706 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:18,706 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 23:05:20,390 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:20,390 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 23:05:22,091 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:22,091 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 23:05:23,712 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:23,712 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 23:05:25,345 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:25,346 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 23:05:27,050 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:27,051 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 23:05:28,758 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:28,759 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 23:05:30,460 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:30,460 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 23:05:32,111 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:32,112 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 23:05:33,812 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:33,812 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 23:05:35,500 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:35,501 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 23:05:37,234 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:37,235 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 23:05:38,914 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:38,914 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 23:05:40,595 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:40,595 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 23:05:42,365 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:42,365 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 23:05:44,112 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:44,113 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 23:05:45,773 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:45,773 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 23:05:47,448 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:47,449 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 23:05:49,164 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:49,164 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 23:05:50,848 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:50,849 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 23:05:52,546 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:52,547 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 23:05:54,205 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:54,206 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 23:05:55,851 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:55,852 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 23:05:57,561 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:57,562 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 23:05:59,243 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:05:59,243 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 23:06:00,896 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:00,896 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 23:06:02,606 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:02,607 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 23:06:04,309 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:04,309 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 23:06:05,969 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:05,970 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 23:06:07,652 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:07,652 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 23:06:09,333 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:09,333 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 23:06:11,032 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:11,034 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 23:06:12,771 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:12,771 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 23:06:14,516 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:14,516 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 23:06:16,245 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:16,245 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 23:06:17,947 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:17,947 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 23:06:19,702 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:19,703 INFO: เติม 2025-11-20 21:00 → +2
2025-11-20 23:06:21,382 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:21,383 INFO: เติม 2025-11-20 22:00 → +2
2025-11-20 23:06:23,112 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 23:06:23,113 INFO: เติม 2025-11-20 23:00 → +1
2025-11-20 23:06:24,132 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 23:06:24,134 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 132 แถว
2025-11-20 23:06:24,135 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 23:06:24,137 INFO: รวมเก่า 131 + ใหม่ 132 → 132 (เพิ่ม 1)
2025-11-20 23:06:24,138 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 23:06:24,138 INFO: Format สำเร็จ: +1 แถว
2025-11-20 23:06:24,150 INFO: เริ่ม clean ข้อมูล: 132 แถว
2025-11-20 23:06:24,161 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (132 แถว)
2025-11-20 23:06:24,165 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 23:00:00          49.6           13.3       0.8 169.2       25.0    49.9     1016.4
2025-11-20 22:00:00          57.9           13.3       0.8 144.5       25.0    50.2     1016.1
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 23:06:24,167 INFO: เตรียมโหลด 132 แถว
2025-11-20 23:06:24,171 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 23:06:24,173 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 23:06:24,174 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 23:06:24,176 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 23:06:24,177 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 23:06:24,179 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 23:06:24,181 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 23:06:24,182 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 23:06:24,185 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 23:06:24,186 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 23:06:24,188 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 23:06:24,189 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 23:06:24,191 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 23:06:24,192 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 23:06:24,195 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 23:06:24,196 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 23:06:24,198 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 23:06:24,199 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 23:06:24,201 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 23:06:24,202 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 23:06:24,204 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 23:06:24,205 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 23:06:24,207 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 23:06:24,208 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 23:06:24,209 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 23:06:24,212 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 23:06:24,214 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 23:06:24,216 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 23:06:24,218 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 23:06:24,220 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 23:06:24,221 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 23:06:24,223 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 23:06:24,224 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 23:06:24,226 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 23:06:24,228 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 23:06:24,229 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 23:06:24,231 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 23:06:24,232 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 23:06:24,234 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 23:06:24,236 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 23:06:24,237 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 23:06:24,239 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 23:06:24,241 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 23:06:24,242 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 23:06:24,244 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 23:06:24,245 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 23:06:24,247 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 23:06:24,249 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 23:06:24,251 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 23:06:24,252 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 23:06:24,255 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 23:06:24,257 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 23:06:24,258 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 23:06:24,260 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 23:06:24,262 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 23:06:24,264 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 23:06:24,266 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 23:06:24,267 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 23:06:24,269 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 23:06:24,271 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 23:06:24,274 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 23:06:24,275 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 23:06:24,277 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 23:06:24,279 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 23:06:24,281 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 23:06:24,282 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 23:06:24,285 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 23:06:24,286 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 23:06:24,287 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 23:06:24,290 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 23:06:24,292 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 23:06:24,294 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 23:06:24,295 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 23:06:24,297 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 23:06:24,299 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 23:06:24,301 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 23:06:24,303 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 23:06:24,304 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 23:06:24,306 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 23:06:24,308 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 23:06:24,309 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 23:06:24,311 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 23:06:24,312 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 23:06:24,315 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 23:06:24,316 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 23:06:24,318 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 23:06:24,320 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 23:06:24,322 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 23:06:24,323 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 23:06:24,324 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 23:06:24,326 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 23:06:24,328 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 23:06:24,330 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 23:06:24,332 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 23:06:24,335 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 23:06:24,337 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 23:06:24,339 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 23:06:24,341 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 23:06:24,342 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 23:06:24,344 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 23:06:24,346 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 23:06:24,348 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 23:06:24,350 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 23:06:24,353 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 23:06:24,355 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 23:06:24,357 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 23:06:24,359 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 23:06:24,362 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 23:06:24,364 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 23:06:24,366 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 23:06:24,369 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 23:06:24,370 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 23:06:24,372 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 23:06:24,375 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 23:06:24,377 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 23:06:24,379 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 23:06:24,381 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 23:06:24,383 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 23:06:24,386 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 23:06:24,388 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 23:06:24,390 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 23:06:24,392 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 23:06:24,393 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 23:06:24,396 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 23:06:24,398 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 23:06:24,400 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 23:06:24,402 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 23:06:24,405 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 23:06:24,407 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 23:06:24,409 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 23:06:24,411 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-20 23:06:24,414 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 13.3
2025-11-20 23:06:24,414 INFO: โหลด DB สำเร็จ
2025-11-20 23:06:24,416 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 23:06:24,419 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 23:06:24,419 INFO: Load to DB + Backup สำเร็จ
2025-11-20 23:06:24,419 INFO: === PIPELINE END ===

2025-11-20 23:06:24,419 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-21 00:05:00 +07)" executed successfully
2025-11-20 23:21:22,311 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:21:22,317 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:21:22,319 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:21:22,320 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:21:22,320 INFO: Scheduler started
2025-11-20 23:21:22,320 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:21:22,321 INFO: === PIPELINE START ===
2025-11-20 23:21:22,321 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:21:24,792 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:21:24,800 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:24,800 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:21:24,800 INFO: Fetch สำเร็จ
2025-11-20 23:21:24,829 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:21:26,144 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:26,144 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:21:29,179 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:29,179 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:21:31,442 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:31,443 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:21:34,302 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:34,302 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:21:36,732 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:36,732 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 23:21:39,392 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:39,392 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 23:21:42,002 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:42,004 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 23:21:43,887 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:43,887 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 23:21:46,252 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:46,253 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 23:21:48,516 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:48,517 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 23:21:51,629 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:51,629 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 23:21:54,839 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:54,839 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 23:21:57,053 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:57,053 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 23:21:59,204 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:21:59,204 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 23:22:02,173 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:02,173 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 23:22:07,147 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:07,147 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 23:22:09,171 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:09,171 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 23:22:11,747 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:11,747 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 23:22:14,149 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:14,149 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 23:22:16,177 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:16,178 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 23:22:18,812 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:18,813 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 23:22:21,500 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:21,501 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 23:22:23,748 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:23,748 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 23:22:26,942 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:26,942 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 23:22:28,738 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:28,738 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 23:22:31,226 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:31,227 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 23:22:33,991 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:33,992 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 23:22:36,289 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:36,290 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 23:22:38,418 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:38,419 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 23:22:40,644 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:40,644 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 23:22:42,537 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:42,538 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 23:22:44,536 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:44,537 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 23:22:46,533 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:46,534 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 23:22:48,442 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:48,442 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 23:22:50,207 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:50,208 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 23:22:52,490 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:52,491 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 23:22:54,451 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:54,451 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 23:22:56,301 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:56,302 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 23:22:58,246 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:58,246 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 23:22:59,973 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:22:59,974 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 23:23:01,728 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:23:01,729 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 23:23:03,461 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:23:03,461 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 23:23:05,181 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:23:05,182 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 23:23:06,870 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:23:06,871 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 23:23:08,547 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:23:08,547 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 23:23:10,238 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:23:10,238 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 23:23:11,950 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:23:11,951 INFO: เติม 2025-11-20 21:00 → +2
2025-11-20 23:23:13,642 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:23:13,643 INFO: เติม 2025-11-20 22:00 → +2
2025-11-20 23:23:15,351 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 23:23:15,352 INFO: เติม 2025-11-20 23:00 → +1
2025-11-20 23:23:16,358 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 23:23:16,359 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 132 แถว
2025-11-20 23:23:16,360 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 23:23:16,361 INFO: รวมเก่า 132 + ใหม่ 132 → 132 (เพิ่ม 0)
2025-11-20 23:23:16,362 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 23:23:16,363 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 23:23:16,375 INFO: เริ่ม clean ข้อมูล: 132 แถว
2025-11-20 23:23:16,386 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (132 แถว)
2025-11-20 23:23:16,390 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 23:00:00          49.6           15.4       0.8 169.2       25.0    49.9     1016.4
2025-11-20 22:00:00          57.9           13.3       0.8 144.5       25.0    50.2     1016.1
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 23:23:16,430 INFO: เตรียมโหลด 132 แถว
2025-11-20 23:23:16,496 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 23:23:16,499 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 23:23:16,501 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 23:23:16,503 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 23:23:16,505 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 23:23:16,507 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 23:23:16,509 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 23:23:16,511 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 23:23:16,513 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 23:23:16,514 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 23:23:16,517 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 23:23:16,518 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 23:23:16,520 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 23:23:16,522 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 23:23:16,524 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 23:23:16,527 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 23:23:16,530 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 23:23:16,533 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 23:23:16,536 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 23:23:16,538 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 23:23:16,541 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 23:23:16,544 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 23:23:16,547 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 23:23:16,551 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 23:23:16,556 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 23:23:16,560 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 23:23:16,564 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 23:23:16,567 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 23:23:16,570 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 23:23:16,573 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 23:23:16,575 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 23:23:16,577 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 23:23:16,580 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 23:23:16,582 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 23:23:16,585 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 23:23:16,587 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 23:23:16,589 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 23:23:16,592 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 23:23:16,595 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 23:23:16,597 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 23:23:16,599 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 23:23:16,601 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 23:23:16,604 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 23:23:16,607 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 23:23:16,609 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 23:23:16,611 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 23:23:16,613 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 23:23:16,615 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 23:23:16,618 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 23:23:16,620 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 23:23:16,622 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 23:23:16,625 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 23:23:16,627 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 23:23:16,629 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 23:23:16,631 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 23:23:16,632 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 23:23:16,634 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 23:23:16,636 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 23:23:16,638 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 23:23:16,639 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 23:23:16,640 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 23:23:16,642 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 23:23:16,643 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 23:23:16,645 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 23:23:16,646 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 23:23:16,648 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 23:23:16,650 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 23:23:16,651 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 23:23:16,653 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 23:23:16,655 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 23:23:16,656 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 23:23:16,658 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 23:23:16,660 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 23:23:16,661 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 23:23:16,662 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 23:23:16,665 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 23:23:16,667 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 23:23:16,668 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 23:23:16,670 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 23:23:16,671 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 23:23:16,673 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 23:23:16,674 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 23:23:16,676 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 23:23:16,678 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 23:23:16,680 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 23:23:16,681 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 23:23:16,683 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 23:23:16,684 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 23:23:16,685 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 23:23:16,687 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 23:23:16,688 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 23:23:16,689 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 23:23:16,691 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 23:23:16,693 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 23:23:16,695 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 23:23:16,696 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 23:23:16,698 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 23:23:16,699 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 23:23:16,700 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 23:23:16,702 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 23:23:16,703 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 23:23:16,704 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 23:23:16,707 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 23:23:16,708 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 23:23:16,710 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 23:23:16,712 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 23:23:16,715 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 23:23:16,716 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 23:23:16,718 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 23:23:16,720 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 23:23:16,722 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 23:23:16,725 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 23:23:16,727 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 23:23:16,728 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 23:23:16,730 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 23:23:16,732 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 23:23:16,734 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 23:23:16,736 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 23:23:16,738 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 23:23:16,740 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 23:23:16,742 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 23:23:16,744 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 23:23:16,745 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 23:23:16,747 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 23:23:16,749 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 23:23:16,750 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 23:23:16,752 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 23:23:16,754 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 23:23:16,756 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 23:23:16,758 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 23:23:16,760 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-20 23:23:16,762 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-20 23:23:16,762 INFO: โหลด DB สำเร็จ
2025-11-20 23:23:16,765 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 23:23:16,767 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 23:23:16,768 INFO: Load to DB + Backup สำเร็จ
2025-11-20 23:23:16,768 INFO: === PIPELINE END ===

2025-11-20 23:35:31,267 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:35:31,274 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:35:31,275 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:35:31,276 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:35:31,276 INFO: Scheduler started
2025-11-20 23:35:31,276 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:35:31,277 INFO: === PIPELINE START ===
2025-11-20 23:35:31,277 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:35:32,027 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:35:32,033 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:32,033 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:35:32,033 INFO: Fetch สำเร็จ
2025-11-20 23:35:32,042 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:35:32,697 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:32,698 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:35:34,359 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:34,359 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:35:36,041 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:36,041 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:35:37,728 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:37,728 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:35:39,442 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:39,442 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 23:35:41,148 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:41,148 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 23:35:42,953 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:42,953 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 23:35:44,686 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:44,687 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 23:35:46,425 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:46,426 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 23:35:48,114 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:48,115 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 23:35:49,808 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:49,809 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 23:35:51,491 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:51,491 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 23:35:53,158 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:53,158 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 23:35:54,796 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:54,797 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 23:35:56,480 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:56,480 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 23:35:58,192 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:58,192 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 23:35:59,893 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:35:59,893 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 23:36:01,636 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:01,637 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 23:36:03,327 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:03,327 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 23:36:05,100 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:05,101 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 23:36:06,803 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:06,803 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 23:36:08,534 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:08,534 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 23:36:10,216 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:10,217 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 23:36:11,942 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:11,942 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 23:36:13,686 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:13,687 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 23:36:15,404 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:15,405 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 23:36:17,094 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:17,094 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 23:36:18,814 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:18,814 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 23:36:20,553 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:20,553 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 23:36:22,294 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:22,296 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 23:36:24,024 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:24,025 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 23:36:25,722 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:25,724 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 23:36:27,407 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:27,412 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 23:36:29,132 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:29,132 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 23:36:30,851 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:30,851 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 23:36:32,552 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:32,553 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 23:36:34,250 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:34,250 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 23:36:35,947 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:35,947 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 23:36:37,630 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:37,630 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 23:36:39,366 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:39,366 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 23:36:41,052 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:41,056 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 23:36:42,721 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:42,721 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 23:36:44,461 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:44,462 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 23:36:46,167 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:46,167 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 23:36:48,683 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:36:48,688 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:36:48,690 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:36:48,692 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:36:48,692 INFO: Scheduler started
2025-11-20 23:36:48,692 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:36:48,693 INFO: === PIPELINE START ===
2025-11-20 23:36:48,693 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:36:49,398 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:36:49,406 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:49,406 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:36:49,406 INFO: Fetch สำเร็จ
2025-11-20 23:36:49,414 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:36:50,092 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:50,092 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:36:51,812 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:51,812 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:36:53,531 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:53,532 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:36:55,223 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:55,224 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:36:56,922 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:56,923 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 23:36:58,597 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:36:58,597 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 23:37:00,305 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:00,305 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 23:37:01,997 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:01,997 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 23:37:03,669 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:03,670 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 23:37:05,338 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:05,338 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 23:37:07,039 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:07,044 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 23:37:08,751 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:08,751 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 23:37:10,422 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:10,423 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 23:37:13,143 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:37:13,149 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:37:13,151 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:37:13,152 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:37:13,152 INFO: Scheduler started
2025-11-20 23:37:13,152 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:37:13,153 INFO: === PIPELINE START ===
2025-11-20 23:37:13,153 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:37:13,842 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:37:13,850 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:13,851 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:37:13,851 INFO: Fetch สำเร็จ
2025-11-20 23:37:13,859 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:37:14,560 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:14,560 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:37:16,266 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:16,266 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:37:17,934 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:17,934 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:37:19,625 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:19,625 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:37:21,345 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:21,345 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 23:37:23,111 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:23,111 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 23:37:24,828 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:24,829 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 23:37:26,520 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:26,520 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 23:37:28,230 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:28,230 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 23:37:29,955 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:29,955 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 23:37:31,663 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:31,664 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 23:37:33,413 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:33,413 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 23:37:35,116 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:35,116 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 23:37:36,841 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:36,842 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 23:37:38,525 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:38,525 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 23:37:40,238 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:40,239 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 23:37:41,946 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:41,948 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 23:37:43,658 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:43,659 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 23:37:45,364 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:45,365 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 23:37:47,062 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:47,063 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 23:37:48,740 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:48,741 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 23:37:50,464 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:50,464 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 23:37:52,153 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:52,153 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 23:37:53,892 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:53,892 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 23:37:55,630 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:55,630 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 23:37:57,414 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:57,415 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 23:37:59,115 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:37:59,116 INFO: เติม 2025-11-20 01:00 → +2
2025-11-20 23:38:00,819 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:00,821 INFO: เติม 2025-11-20 02:00 → +2
2025-11-20 23:38:02,593 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:02,594 INFO: เติม 2025-11-20 03:00 → +2
2025-11-20 23:38:04,298 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:04,298 INFO: เติม 2025-11-20 04:00 → +2
2025-11-20 23:38:06,003 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:06,003 INFO: เติม 2025-11-20 05:00 → +2
2025-11-20 23:38:07,716 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:07,716 INFO: เติม 2025-11-20 06:00 → +2
2025-11-20 23:38:09,418 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:09,418 INFO: เติม 2025-11-20 07:00 → +2
2025-11-20 23:38:11,065 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:11,065 INFO: เติม 2025-11-20 08:00 → +2
2025-11-20 23:38:12,787 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:12,788 INFO: เติม 2025-11-20 09:00 → +2
2025-11-20 23:38:14,546 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:14,547 INFO: เติม 2025-11-20 10:00 → +2
2025-11-20 23:38:16,231 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:16,231 INFO: เติม 2025-11-20 11:00 → +2
2025-11-20 23:38:17,932 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:17,932 INFO: เติม 2025-11-20 12:00 → +2
2025-11-20 23:38:19,724 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:19,725 INFO: เติม 2025-11-20 13:00 → +2
2025-11-20 23:38:21,453 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:21,453 INFO: เติม 2025-11-20 14:00 → +2
2025-11-20 23:38:23,162 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:23,162 INFO: เติม 2025-11-20 15:00 → +2
2025-11-20 23:38:24,887 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:24,887 INFO: เติม 2025-11-20 16:00 → +2
2025-11-20 23:38:26,628 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:26,629 INFO: เติม 2025-11-20 17:00 → +2
2025-11-20 23:38:28,352 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:28,352 INFO: เติม 2025-11-20 18:00 → +2
2025-11-20 23:38:30,116 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:30,116 INFO: เติม 2025-11-20 19:00 → +2
2025-11-20 23:38:31,824 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:31,824 INFO: เติม 2025-11-20 20:00 → +2
2025-11-20 23:38:33,518 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:33,518 INFO: เติม 2025-11-20 21:00 → +2
2025-11-20 23:38:35,248 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:35,248 INFO: เติม 2025-11-20 22:00 → +2
2025-11-20 23:38:36,959 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-20 23:38:36,960 INFO: เติม 2025-11-20 23:00 → +1
2025-11-20 23:38:37,969 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-20 23:38:37,970 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 132 แถว
2025-11-20 23:38:37,971 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 23:38:37,973 INFO: รวมเก่า 132 + ใหม่ 132 → 132 (เพิ่ม 0)
2025-11-20 23:38:37,974 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 23:38:37,974 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 23:38:37,977 INFO: เริ่ม clean ข้อมูล: 132 แถว
2025-11-20 23:38:37,988 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (132 แถว)
2025-11-20 23:38:37,992 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 23:00:00          49.6           15.4       0.8 169.2       25.0    49.9     1016.4
2025-11-20 22:00:00          57.9           13.3       0.8 144.5       25.0    50.2     1016.1
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-20 16:00:00          47.7           15.1       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4           11.7       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.1       0.9 143.5       26.9    42.8     1014.4
2025-11-20 23:38:38,021 INFO: เตรียมโหลด 132 แถว
2025-11-20 23:38:38,027 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-20 23:38:38,029 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-20 23:38:38,031 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-20 23:38:38,032 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-20 23:38:38,034 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-20 23:38:38,036 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-20 23:38:38,038 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-20 23:38:38,039 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-20 23:38:38,041 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-20 23:38:38,042 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-20 23:38:38,044 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-20 23:38:38,045 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-20 23:38:38,047 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-20 23:38:38,050 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-20 23:38:38,052 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-20 23:38:38,053 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-20 23:38:38,055 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-20 23:38:38,056 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-20 23:38:38,059 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-20 23:38:38,061 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-20 23:38:38,063 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-20 23:38:38,065 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-20 23:38:38,067 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-20 23:38:38,069 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-20 23:38:38,071 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-20 23:38:38,072 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-20 23:38:38,074 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-20 23:38:38,075 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-20 23:38:38,076 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 23:38:38,078 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-20 23:38:38,080 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-20 23:38:38,082 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-20 23:38:38,083 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-20 23:38:38,086 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-20 23:38:38,088 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-20 23:38:38,090 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-20 23:38:38,092 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-20 23:38:38,093 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-20 23:38:38,095 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-20 23:38:38,098 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-20 23:38:38,100 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-20 23:38:38,101 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-20 23:38:38,103 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-20 23:38:38,105 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-20 23:38:38,106 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-20 23:38:38,107 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-20 23:38:38,109 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-20 23:38:38,111 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-20 23:38:38,113 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-20 23:38:38,114 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-20 23:38:38,117 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-20 23:38:38,118 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-20 23:38:38,120 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-20 23:38:38,121 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-20 23:38:38,123 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-20 23:38:38,124 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-20 23:38:38,127 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-20 23:38:38,129 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-20 23:38:38,131 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-20 23:38:38,132 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-20 23:38:38,134 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-20 23:38:38,135 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-20 23:38:38,137 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-20 23:38:38,138 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-20 23:38:38,140 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-20 23:38:38,141 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-20 23:38:38,143 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-20 23:38:38,145 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-20 23:38:38,147 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-20 23:38:38,149 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-20 23:38:38,151 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-20 23:38:38,153 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-20 23:38:38,155 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-20 23:38:38,156 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-20 23:38:38,159 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-20 23:38:38,160 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-20 23:38:38,162 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-20 23:38:38,164 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-20 23:38:38,166 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-20 23:38:38,168 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-20 23:38:38,169 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-20 23:38:38,171 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-20 23:38:38,172 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-20 23:38:38,174 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-20 23:38:38,175 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-20 23:38:38,177 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-20 23:38:38,178 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-20 23:38:38,180 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-20 23:38:38,181 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-20 23:38:38,183 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-20 23:38:38,184 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-20 23:38:38,186 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-20 23:38:38,188 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-20 23:38:38,189 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-20 23:38:38,191 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-20 23:38:38,193 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-20 23:38:38,194 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-20 23:38:38,195 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-20 23:38:38,196 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-20 23:38:38,198 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-20 23:38:38,199 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-20 23:38:38,201 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-20 23:38:38,202 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-20 23:38:38,204 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-20 23:38:38,206 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-20 23:38:38,208 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-20 23:38:38,210 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-20 23:38:38,212 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-20 23:38:38,213 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-20 23:38:38,215 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-20 23:38:38,216 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-20 23:38:38,217 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-20 23:38:38,219 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-20 23:38:38,221 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-20 23:38:38,222 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-20 23:38:38,224 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-20 23:38:38,225 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-20 23:38:38,227 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-20 23:38:38,228 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-20 23:38:38,229 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-20 23:38:38,231 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-20 23:38:38,232 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-20 23:38:38,234 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-20 23:38:38,236 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-20 23:38:38,237 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-20 23:38:38,239 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-20 23:38:38,241 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-20 23:38:38,242 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-20 23:38:38,244 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-20 23:38:38,245 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-20 23:38:38,247 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-20 23:38:38,248 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-20 23:38:38,249 INFO: โหลด DB สำเร็จ
2025-11-20 23:38:38,251 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 23:38:38,253 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 23:38:38,253 INFO: Load to DB + Backup สำเร็จ
2025-11-20 23:38:38,253 INFO: === PIPELINE END ===

2025-11-20 23:39:38,698 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:39:38,704 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:39:38,707 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:39:38,708 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:39:38,708 INFO: Scheduler started
2025-11-20 23:39:38,708 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:39:38,709 INFO: === PIPELINE START ===
2025-11-20 23:39:38,709 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:39:39,446 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:39:39,456 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:39:39,456 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:39:39,456 INFO: Fetch สำเร็จ
2025-11-20 23:39:39,466 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:39:40,151 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:39:40,151 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:39:42,054 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:39:42,058 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:39:42,061 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:39:42,062 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:39:42,063 INFO: Scheduler started
2025-11-20 23:39:42,063 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:39:42,063 INFO: === PIPELINE START ===
2025-11-20 23:39:42,063 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:39:42,826 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:39:42,837 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:39:42,838 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:39:42,838 INFO: Fetch สำเร็จ
2025-11-20 23:39:42,850 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:39:43,608 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:39:43,608 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:39:45,623 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:39:45,630 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:39:45,632 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:39:45,633 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:39:45,633 INFO: Scheduler started
2025-11-20 23:39:45,633 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:39:45,634 INFO: === PIPELINE START ===
2025-11-20 23:39:45,634 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:39:46,359 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:39:46,369 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:39:46,369 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:39:46,370 INFO: Fetch สำเร็จ
2025-11-20 23:39:46,381 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:39:47,107 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:39:47,107 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:39:49,144 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:39:49,150 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:39:49,152 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:39:49,153 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:39:49,153 INFO: Scheduler started
2025-11-20 23:39:49,153 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:39:49,153 INFO: === PIPELINE START ===
2025-11-20 23:39:49,153 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:39:49,909 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:39:49,916 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:39:49,916 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:39:49,916 INFO: Fetch สำเร็จ
2025-11-20 23:39:49,924 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:39:50,609 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:39:50,609 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:39:52,366 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:39:52,366 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:39:54,083 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:39:54,083 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:39:55,810 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:39:55,810 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:39:59,096 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:39:59,102 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:39:59,103 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:39:59,104 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:39:59,104 INFO: Scheduler started
2025-11-20 23:39:59,104 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:39:59,104 INFO: === PIPELINE START ===
2025-11-20 23:39:59,104 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:39:59,830 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:39:59,839 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:39:59,840 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:39:59,840 INFO: Fetch สำเร็จ
2025-11-20 23:39:59,848 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:40:00,564 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:00,564 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:40:02,311 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:02,311 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:40:04,042 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:04,042 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:40:05,776 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:05,776 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:40:07,856 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:40:07,862 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:40:07,865 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:40:07,866 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:40:07,866 INFO: Scheduler started
2025-11-20 23:40:07,866 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:40:07,866 INFO: === PIPELINE START ===
2025-11-20 23:40:07,866 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:40:08,633 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:40:08,638 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:08,638 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:40:08,638 INFO: Fetch สำเร็จ
2025-11-20 23:40:08,648 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:40:09,379 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:09,379 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:40:11,376 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:40:11,383 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:40:11,385 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:40:11,386 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:40:11,386 INFO: Scheduler started
2025-11-20 23:40:11,386 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:40:11,386 INFO: === PIPELINE START ===
2025-11-20 23:40:11,387 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:40:12,115 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:40:12,122 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:12,122 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:40:12,122 INFO: Fetch สำเร็จ
2025-11-20 23:40:12,130 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:40:12,823 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:12,824 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:40:14,545 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:14,546 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:40:16,213 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:16,214 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:40:17,916 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:17,916 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:40:19,611 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:19,612 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 23:40:21,334 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:21,334 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 23:40:23,055 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:23,055 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 23:40:24,775 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:24,775 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 23:40:26,455 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:26,455 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 23:40:28,193 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:28,193 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 23:40:29,916 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:29,917 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 23:40:31,652 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:31,652 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 23:40:34,133 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:40:34,138 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:40:34,139 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:40:34,140 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:40:34,140 INFO: Scheduler started
2025-11-20 23:40:34,141 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:40:34,141 INFO: === PIPELINE START ===
2025-11-20 23:40:34,141 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:40:34,876 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:40:34,885 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:34,886 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:40:34,886 INFO: Fetch สำเร็จ
2025-11-20 23:40:34,895 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:40:35,611 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:35,611 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:40:37,311 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:37,311 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:40:39,054 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:39,055 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:40:40,746 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:40,746 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:40:42,428 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:42,428 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 23:40:44,156 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:44,156 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 23:40:46,698 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:40:46,703 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:40:46,704 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:40:46,705 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:40:46,706 INFO: Scheduler started
2025-11-20 23:40:46,706 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:40:46,707 INFO: === PIPELINE START ===
2025-11-20 23:40:46,707 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:40:47,453 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:40:47,460 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:47,460 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:40:47,460 INFO: Fetch สำเร็จ
2025-11-20 23:40:47,467 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:40:48,177 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:48,177 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:40:49,919 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:49,919 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:40:51,598 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:51,598 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:40:53,309 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:53,309 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:40:55,449 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:40:55,454 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:40:55,456 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:40:55,457 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:40:55,457 INFO: Scheduler started
2025-11-20 23:40:55,458 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:40:55,458 INFO: === PIPELINE START ===
2025-11-20 23:40:55,458 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:40:56,168 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:40:56,176 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:56,177 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:40:56,177 INFO: Fetch สำเร็จ
2025-11-20 23:40:56,189 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:40:56,919 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:56,919 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:40:58,634 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:40:58,634 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:41:00,341 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:00,342 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:41:02,033 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:02,034 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:41:04,320 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:41:04,326 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:41:04,328 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:41:04,329 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:41:04,329 INFO: Scheduler started
2025-11-20 23:41:04,329 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:41:04,329 INFO: === PIPELINE START ===
2025-11-20 23:41:04,329 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:41:05,145 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:41:05,153 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:05,153 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:41:05,153 INFO: Fetch สำเร็จ
2025-11-20 23:41:05,162 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:41:05,832 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:05,833 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:41:07,586 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:07,587 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:41:09,277 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:09,277 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:41:10,973 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:10,973 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:41:12,716 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:12,717 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 23:41:14,739 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:41:14,741 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:41:14,746 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:41:14,748 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:41:14,748 INFO: Scheduler started
2025-11-20 23:41:14,748 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:41:14,748 INFO: === PIPELINE START ===
2025-11-20 23:41:14,748 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:41:15,457 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:41:15,459 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:15,459 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:41:15,459 INFO: Fetch สำเร็จ
2025-11-20 23:41:15,472 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:41:16,187 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:16,187 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:41:17,877 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:17,877 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:41:19,593 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:19,593 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:41:21,295 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:21,295 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:41:23,957 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 23:41:23,963 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 23:41:23,965 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:41:23,967 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 23:41:23,967 INFO: Scheduler started
2025-11-20 23:41:23,967 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 23:41:23,967 INFO: === PIPELINE START ===
2025-11-20 23:41:23,967 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-20 23:41:24,743 INFO: ดึง 2025-11-20 22:00:00+07:00 - 2025-11-20 23:00:00+07:00 → 2 แถว
2025-11-20 23:41:24,749 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:24,749 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-20 23:41:24,749 INFO: Fetch สำเร็จ
2025-11-20 23:41:24,758 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 23:41:25,499 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:25,499 INFO: เติม 2025-11-18 23:00 → +2
2025-11-20 23:41:27,166 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:27,167 INFO: เติม 2025-11-19 00:00 → +2
2025-11-20 23:41:28,873 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:28,874 INFO: เติม 2025-11-19 01:00 → +2
2025-11-20 23:41:30,573 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:30,573 INFO: เติม 2025-11-19 02:00 → +2
2025-11-20 23:41:32,324 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:32,324 INFO: เติม 2025-11-19 03:00 → +2
2025-11-20 23:41:34,068 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:34,069 INFO: เติม 2025-11-19 04:00 → +2
2025-11-20 23:41:35,819 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:35,819 INFO: เติม 2025-11-19 05:00 → +2
2025-11-20 23:41:37,554 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:37,554 INFO: เติม 2025-11-19 06:00 → +2
2025-11-20 23:41:39,280 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:39,280 INFO: เติม 2025-11-19 07:00 → +2
2025-11-20 23:41:40,955 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:40,955 INFO: เติม 2025-11-19 08:00 → +2
2025-11-20 23:41:42,677 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:42,678 INFO: เติม 2025-11-19 09:00 → +2
2025-11-20 23:41:44,430 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:44,430 INFO: เติม 2025-11-19 10:00 → +2
2025-11-20 23:41:46,155 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:46,156 INFO: เติม 2025-11-19 11:00 → +2
2025-11-20 23:41:47,904 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:47,905 INFO: เติม 2025-11-19 12:00 → +2
2025-11-20 23:41:49,622 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:49,622 INFO: เติม 2025-11-19 13:00 → +2
2025-11-20 23:41:51,329 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:51,329 INFO: เติม 2025-11-19 14:00 → +2
2025-11-20 23:41:53,055 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:53,056 INFO: เติม 2025-11-19 15:00 → +2
2025-11-20 23:41:54,842 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:54,842 INFO: เติม 2025-11-19 16:00 → +2
2025-11-20 23:41:56,517 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:56,518 INFO: เติม 2025-11-19 17:00 → +2
2025-11-20 23:41:58,236 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:41:58,236 INFO: เติม 2025-11-19 18:00 → +2
2025-11-20 23:42:00,016 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:42:00,017 INFO: เติม 2025-11-19 19:00 → +2
2025-11-20 23:42:01,725 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:42:01,726 INFO: เติม 2025-11-19 20:00 → +2
2025-11-20 23:42:03,478 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:42:03,478 INFO: เติม 2025-11-19 21:00 → +2
2025-11-20 23:42:05,190 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:42:05,191 INFO: เติม 2025-11-19 22:00 → +2
2025-11-20 23:42:06,886 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:42:06,887 INFO: เติม 2025-11-19 23:00 → +2
2025-11-20 23:42:08,598 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:42:08,599 INFO: เติม 2025-11-20 00:00 → +2
2025-11-20 23:42:10,338 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-20 23:42:10,339 INFO: เติม 2025-11-20 01:00 → +2
2025-11-21 01:16:27,233 INFO: MODEL loaded. expected features (metadata): 168
2025-11-21 01:16:27,249 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-21 01:16:27,250 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-21 01:16:27,252 INFO: Added job "run_pipeline" to job store "default"
2025-11-21 01:16:27,252 INFO: Scheduler started
2025-11-21 01:16:27,252 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-21 01:16:27,252 INFO: === PIPELINE START ===
2025-11-21 01:16:27,253 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-21 01:16:28,040 INFO: ดึง 2025-11-21 00:00:00+07:00 - 2025-11-21 01:00:00+07:00 → 2 แถว
2025-11-21 01:16:28,075 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:28,076 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-21 01:16:28,077 INFO: Fetch สำเร็จ
2025-11-21 01:16:28,109 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-21 01:16:28,779 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:28,779 INFO: เติม 2025-11-19 01:00 → +2
2025-11-21 01:16:30,471 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:30,472 INFO: เติม 2025-11-19 02:00 → +2
2025-11-21 01:16:32,178 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:32,179 INFO: เติม 2025-11-19 03:00 → +2
2025-11-21 01:16:33,975 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:33,975 INFO: เติม 2025-11-19 04:00 → +2
2025-11-21 01:16:35,726 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:35,726 INFO: เติม 2025-11-19 05:00 → +2
2025-11-21 01:16:37,527 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:37,527 INFO: เติม 2025-11-19 06:00 → +2
2025-11-21 01:16:39,276 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:39,277 INFO: เติม 2025-11-19 07:00 → +2
2025-11-21 01:16:41,024 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:41,024 INFO: เติม 2025-11-19 08:00 → +2
2025-11-21 01:16:42,742 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:42,742 INFO: เติม 2025-11-19 09:00 → +2
2025-11-21 01:16:44,432 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:44,433 INFO: เติม 2025-11-19 10:00 → +2
2025-11-21 01:16:46,145 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:46,147 INFO: เติม 2025-11-19 11:00 → +2
2025-11-21 01:16:47,839 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:47,839 INFO: เติม 2025-11-19 12:00 → +2
2025-11-21 01:16:49,545 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:49,546 INFO: เติม 2025-11-19 13:00 → +2
2025-11-21 01:16:51,297 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:51,302 INFO: เติม 2025-11-19 14:00 → +2
2025-11-21 01:16:53,014 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:53,014 INFO: เติม 2025-11-19 15:00 → +2
2025-11-21 01:16:54,727 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:54,727 INFO: เติม 2025-11-19 16:00 → +2
2025-11-21 01:16:56,473 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:16:56,474 INFO: เติม 2025-11-19 17:00 → +2
2025-11-21 01:18:36,494 INFO: MODEL loaded. expected features (metadata): 168
2025-11-21 01:18:36,499 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-21 01:18:36,502 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-21 01:18:36,503 INFO: Added job "run_pipeline" to job store "default"
2025-11-21 01:18:36,503 INFO: Scheduler started
2025-11-21 01:18:36,503 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-21 01:18:36,503 INFO: === PIPELINE START ===
2025-11-21 01:18:36,503 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-21 01:18:37,265 INFO: ดึง 2025-11-21 00:00:00+07:00 - 2025-11-21 01:00:00+07:00 → 2 แถว
2025-11-21 01:18:37,272 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:18:37,273 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-21 01:18:37,273 INFO: Fetch สำเร็จ
2025-11-21 01:18:37,281 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-21 01:18:37,965 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:18:37,965 INFO: เติม 2025-11-19 01:00 → +2
2025-11-21 01:42:42,565 INFO: MODEL loaded. expected features (metadata): 168
2025-11-21 01:42:42,571 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-21 01:42:42,573 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-21 01:42:42,574 INFO: Added job "run_pipeline" to job store "default"
2025-11-21 01:42:42,574 INFO: Scheduler started
2025-11-21 01:42:42,574 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-21 01:42:42,574 INFO: === PIPELINE START ===
2025-11-21 01:42:42,574 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-21 01:42:43,311 INFO: ดึง 2025-11-21 00:00:00+07:00 - 2025-11-21 01:00:00+07:00 → 2 แถว
2025-11-21 01:42:43,323 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:42:43,323 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-21 01:42:43,323 INFO: Fetch สำเร็จ
2025-11-21 01:42:43,343 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-21 01:42:44,055 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:42:44,055 INFO: เติม 2025-11-19 01:00 → +2
2025-11-21 01:42:45,772 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:42:45,772 INFO: เติม 2025-11-19 02:00 → +2
2025-11-21 01:42:47,501 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:42:47,502 INFO: เติม 2025-11-19 03:00 → +2
2025-11-21 01:42:49,204 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:42:49,205 INFO: เติม 2025-11-19 04:00 → +2
2025-11-21 01:42:50,925 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:42:50,926 INFO: เติม 2025-11-19 05:00 → +2
2025-11-21 01:42:52,610 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:42:52,611 INFO: เติม 2025-11-19 06:00 → +2
2025-11-21 01:42:54,313 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:42:54,313 INFO: เติม 2025-11-19 07:00 → +2
2025-11-21 01:42:56,024 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:42:56,025 INFO: เติม 2025-11-19 08:00 → +2
2025-11-21 01:42:57,730 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:42:57,730 INFO: เติม 2025-11-19 09:00 → +2
2025-11-21 01:42:59,504 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:42:59,505 INFO: เติม 2025-11-19 10:00 → +2
2025-11-21 01:43:01,190 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:43:01,190 INFO: เติม 2025-11-19 11:00 → +2
2025-11-21 01:43:02,892 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:43:02,893 INFO: เติม 2025-11-19 12:00 → +2
2025-11-21 01:43:04,631 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:43:04,631 INFO: เติม 2025-11-19 13:00 → +2
2025-11-21 01:43:06,363 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:43:06,363 INFO: เติม 2025-11-19 14:00 → +2
2025-11-21 01:43:08,076 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 01:43:08,076 INFO: เติม 2025-11-19 15:00 → +2
2025-11-21 02:13:56,882 INFO: MODEL loaded. expected features (metadata): 168
2025-11-21 02:13:56,888 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-21 02:13:56,890 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-21 02:13:56,891 INFO: Added job "run_pipeline" to job store "default"
2025-11-21 02:13:56,891 INFO: Scheduler started
2025-11-21 02:13:56,891 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-21 02:13:56,891 INFO: === PIPELINE START ===
2025-11-21 02:13:56,891 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-21 02:13:57,839 INFO: ดึง 2025-11-21 01:00:00+07:00 - 2025-11-21 02:00:00+07:00 → 2 แถว
2025-11-21 02:13:57,847 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:13:57,848 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-21 02:13:57,848 INFO: Fetch สำเร็จ
2025-11-21 02:13:57,866 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-21 02:13:58,649 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:13:58,649 INFO: เติม 2025-11-19 02:00 → +2
2025-11-21 02:14:00,513 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:00,514 INFO: เติม 2025-11-19 03:00 → +2
2025-11-21 02:14:02,312 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:02,313 INFO: เติม 2025-11-19 04:00 → +2
2025-11-21 02:14:04,180 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:04,180 INFO: เติม 2025-11-19 05:00 → +2
2025-11-21 02:14:05,905 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:05,905 INFO: เติม 2025-11-19 06:00 → +2
2025-11-21 02:14:07,701 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:07,702 INFO: เติม 2025-11-19 07:00 → +2
2025-11-21 02:14:09,491 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:09,491 INFO: เติม 2025-11-19 08:00 → +2
2025-11-21 02:14:11,306 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:11,306 INFO: เติม 2025-11-19 09:00 → +2
2025-11-21 02:14:13,062 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:13,063 INFO: เติม 2025-11-19 10:00 → +2
2025-11-21 02:14:14,997 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:14,997 INFO: เติม 2025-11-19 11:00 → +2
2025-11-21 02:14:16,748 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:16,749 INFO: เติม 2025-11-19 12:00 → +2
2025-11-21 02:14:18,504 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:18,504 INFO: เติม 2025-11-19 13:00 → +2
2025-11-21 02:14:20,257 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:20,258 INFO: เติม 2025-11-19 14:00 → +2
2025-11-21 02:14:21,991 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:21,993 INFO: เติม 2025-11-19 15:00 → +2
2025-11-21 02:14:24,019 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:24,020 INFO: เติม 2025-11-19 16:00 → +2
2025-11-21 02:14:25,726 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:25,728 INFO: เติม 2025-11-19 17:00 → +2
2025-11-21 02:14:27,476 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:27,477 INFO: เติม 2025-11-19 18:00 → +2
2025-11-21 02:14:29,230 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:29,231 INFO: เติม 2025-11-19 19:00 → +2
2025-11-21 02:14:31,112 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:31,113 INFO: เติม 2025-11-19 20:00 → +2
2025-11-21 02:14:32,825 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:32,825 INFO: เติม 2025-11-19 21:00 → +2
2025-11-21 02:14:34,567 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:34,567 INFO: เติม 2025-11-19 22:00 → +2
2025-11-21 02:14:36,351 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:36,351 INFO: เติม 2025-11-19 23:00 → +2
2025-11-21 02:14:38,135 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:38,136 INFO: เติม 2025-11-20 00:00 → +2
2025-11-21 02:14:39,857 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:39,857 INFO: เติม 2025-11-20 01:00 → +2
2025-11-21 02:14:41,566 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:41,566 INFO: เติม 2025-11-20 02:00 → +2
2025-11-21 02:14:43,316 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:43,316 INFO: เติม 2025-11-20 03:00 → +2
2025-11-21 02:14:45,040 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:45,040 INFO: เติม 2025-11-20 04:00 → +2
2025-11-21 02:14:46,722 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:46,723 INFO: เติม 2025-11-20 05:00 → +2
2025-11-21 02:14:48,445 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:48,445 INFO: เติม 2025-11-20 06:00 → +2
2025-11-21 02:14:50,201 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:50,202 INFO: เติม 2025-11-20 07:00 → +2
2025-11-21 02:14:51,910 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:51,910 INFO: เติม 2025-11-20 08:00 → +2
2025-11-21 02:14:53,630 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:53,630 INFO: เติม 2025-11-20 09:00 → +2
2025-11-21 02:14:55,406 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:55,406 INFO: เติม 2025-11-20 10:00 → +2
2025-11-21 02:14:57,138 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:57,138 INFO: เติม 2025-11-20 11:00 → +2
2025-11-21 02:14:58,869 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:14:58,870 INFO: เติม 2025-11-20 12:00 → +2
2025-11-21 02:15:00,602 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:00,602 INFO: เติม 2025-11-20 13:00 → +2
2025-11-21 02:15:02,351 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:02,352 INFO: เติม 2025-11-20 14:00 → +2
2025-11-21 02:15:04,229 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:04,229 INFO: เติม 2025-11-20 15:00 → +2
2025-11-21 02:15:05,955 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:05,956 INFO: เติม 2025-11-20 16:00 → +2
2025-11-21 02:15:07,701 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:07,702 INFO: เติม 2025-11-20 17:00 → +2
2025-11-21 02:15:09,443 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:09,444 INFO: เติม 2025-11-20 18:00 → +2
2025-11-21 02:15:11,278 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:11,279 INFO: เติม 2025-11-20 19:00 → +2
2025-11-21 02:15:12,974 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:12,974 INFO: เติม 2025-11-20 20:00 → +2
2025-11-21 02:15:14,722 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:14,723 INFO: เติม 2025-11-20 21:00 → +2
2025-11-21 02:15:16,500 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:16,501 INFO: เติม 2025-11-20 22:00 → +2
2025-11-21 02:15:18,229 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:18,230 INFO: เติม 2025-11-20 23:00 → +2
2025-11-21 02:15:20,009 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:20,009 INFO: เติม 2025-11-21 00:00 → +2
2025-11-21 02:15:21,706 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:21,707 INFO: เติม 2025-11-21 01:00 → +2
2025-11-21 02:15:23,439 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-21 02:15:23,439 INFO: เติม 2025-11-21 02:00 → +1
2025-11-21 02:15:24,460 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-21 02:15:24,463 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 135 แถว
2025-11-21 02:15:24,464 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-21 02:15:24,481 INFO: รวมเก่า 132 + ใหม่ 135 → 135 (เพิ่ม 3)
2025-11-21 02:15:24,482 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-21 02:15:24,483 INFO: Format สำเร็จ: +3 แถว
2025-11-21 02:15:24,495 INFO: เริ่ม clean ข้อมูล: 135 แถว
2025-11-21 02:15:24,517 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (135 แถว)
2025-11-21 02:15:24,521 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-21 02:00:00          40.1            9.3       1.1 156.0       24.2    51.5     1015.4
2025-11-21 01:00:00          42.3           13.5       0.8 143.4       24.2    52.7     1015.8
2025-11-21 00:00:00          46.2           16.0       0.7 146.2       24.5    52.1     1016.2
2025-11-20 23:00:00          49.6           15.4       0.8 169.2       25.0    49.9     1016.4
2025-11-20 22:00:00          57.9           13.3       0.8 144.5       25.0    50.2     1016.1
2025-11-20 21:00:00          56.7           23.3       0.9 164.4       25.5    47.9     1015.8
2025-11-20 20:00:00          52.6           26.6       1.0 166.9       25.5    47.7     1015.3
2025-11-20 19:00:00          46.9           15.7       0.9 164.7       25.5    48.0     1014.7
2025-11-20 18:00:00          46.5           13.6       1.0 155.2       25.8    46.3     1014.0
2025-11-20 17:00:00          52.7           12.6       1.1 146.9       26.2    45.2     1013.4
2025-11-21 02:15:26,705 INFO: เตรียมโหลด 135 แถว
2025-11-21 02:15:26,713 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-21 02:15:26,715 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-21 02:15:26,716 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-21 02:15:26,719 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-21 02:15:26,721 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-21 02:15:26,724 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-21 02:15:26,726 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-21 02:15:26,728 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-21 02:15:26,730 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-21 02:15:26,732 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-21 02:15:26,734 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-21 02:15:26,737 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-21 02:15:26,739 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-21 02:15:26,741 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-21 02:15:26,743 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-21 02:15:26,744 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-21 02:15:26,746 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-21 02:15:26,748 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-21 02:15:26,751 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-21 02:15:26,753 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-21 02:15:26,755 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-21 02:15:26,756 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-21 02:15:26,757 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-21 02:15:26,759 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-21 02:15:26,761 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-21 02:15:26,763 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-21 02:15:26,765 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-21 02:15:26,766 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-21 02:15:26,769 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-21 02:15:26,771 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-21 02:15:26,774 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-21 02:15:26,776 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-21 02:15:26,778 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-21 02:15:26,780 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-21 02:15:26,782 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-21 02:15:26,784 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-21 02:15:26,787 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-21 02:15:26,788 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-21 02:15:26,789 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-21 02:15:26,792 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-21 02:15:26,794 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-21 02:15:26,796 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-21 02:15:26,798 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-21 02:15:26,800 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-21 02:15:26,802 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-21 02:15:26,804 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-21 02:15:26,806 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-21 02:15:26,810 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-21 02:15:26,812 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-21 02:15:26,814 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-21 02:15:26,816 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-21 02:15:26,817 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-21 02:15:26,820 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-21 02:15:26,822 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-21 02:15:26,824 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-21 02:15:26,826 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-21 02:15:26,828 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-21 02:15:26,830 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-21 02:15:26,832 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-21 02:15:26,834 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-21 02:15:26,836 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-21 02:15:26,838 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-21 02:15:26,840 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-21 02:15:26,842 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-21 02:15:26,843 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-21 02:15:26,843 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-21 02:15:26,847 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-21 02:15:26,849 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-21 02:15:26,851 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-21 02:15:26,853 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-21 02:15:26,855 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-21 02:15:26,857 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-21 02:15:26,859 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-21 02:15:26,861 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-21 02:15:26,862 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-21 02:15:26,863 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-21 02:15:26,865 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-21 02:15:26,867 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-21 02:15:26,869 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-21 02:15:26,871 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-21 02:15:26,873 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-21 02:15:26,875 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-21 02:15:26,878 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-21 02:15:26,880 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-21 02:15:26,882 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-21 02:15:26,884 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-21 02:15:26,885 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-21 02:15:26,888 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-21 02:15:26,889 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-21 02:15:26,891 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-21 02:15:26,893 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-21 02:15:26,895 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-21 02:15:26,897 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-21 02:15:26,899 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-21 02:15:26,900 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-21 02:15:26,903 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-21 02:15:26,905 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-21 02:15:26,906 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-21 02:15:26,908 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-21 02:15:26,910 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-21 02:15:26,912 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-21 02:15:26,914 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-21 02:15:26,917 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-21 02:15:26,918 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-21 02:15:26,921 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-21 02:15:26,923 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-21 02:15:26,924 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-21 02:15:26,928 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-21 02:15:26,929 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-21 02:15:26,931 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-21 02:15:26,934 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-21 02:15:26,935 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-21 02:15:26,937 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-21 02:15:26,939 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-21 02:15:26,941 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-21 02:15:26,943 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-21 02:15:26,945 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-21 02:15:26,947 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-21 02:15:26,949 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-21 02:15:26,951 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-21 02:15:26,953 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-21 02:15:26,955 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-21 02:15:26,956 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-21 02:15:26,959 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-21 02:15:26,961 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-21 02:15:26,963 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-21 02:15:26,965 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-21 02:15:26,967 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-21 02:15:26,968 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-21 02:15:26,970 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-21 02:15:26,972 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-21 02:15:26,974 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-21 02:15:26,976 INFO: อัปเดต DB สำเร็จ: 2025-11-21 00:00:00+07:00 → PM2.5 = 16.0
2025-11-21 02:15:26,979 INFO: อัปเดต DB สำเร็จ: 2025-11-21 01:00:00+07:00 → PM2.5 = 13.5
2025-11-21 02:15:26,981 INFO: อัปเดต DB สำเร็จ: 2025-11-21 02:00:00+07:00 → PM2.5 = 9.3
2025-11-21 02:15:26,982 INFO: โหลด DB สำเร็จ
2025-11-21 02:15:26,984 INFO: Backup สำเร็จ: data\backups\2025-11-21.csv
2025-11-21 02:15:26,986 INFO: อัพเดท latest.csv สำเร็จ
2025-11-21 02:15:26,986 INFO: Load to DB + Backup สำเร็จ
2025-11-21 02:15:26,986 INFO: === PIPELINE END ===

2025-11-21 19:33:01,213 INFO: MODEL loaded. expected features (metadata): 168
2025-11-21 19:33:01,227 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-21 19:33:01,229 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-21 19:33:01,231 INFO: Added job "run_pipeline" to job store "default"
2025-11-21 19:33:01,231 INFO: Scheduler started
2025-11-21 19:33:01,231 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-21 19:33:01,231 INFO: === PIPELINE START ===
2025-11-21 19:33:01,231 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-21 19:33:02,112 INFO: ดึง 2025-11-21 18:00:00+07:00 - 2025-11-21 19:00:00+07:00 → 2 แถว
2025-11-21 19:33:02,149 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:02,149 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-21 19:33:02,149 INFO: Fetch สำเร็จ
2025-11-21 19:33:02,178 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-21 19:33:03,197 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:03,197 INFO: เติม 2025-11-19 19:00 → +2
2025-11-21 19:33:05,008 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:05,008 INFO: เติม 2025-11-19 20:00 → +2
2025-11-21 19:33:06,804 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:06,805 INFO: เติม 2025-11-19 21:00 → +2
2025-11-21 19:33:11,845 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:11,846 INFO: เติม 2025-11-19 22:00 → +2
2025-11-21 19:33:14,284 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:14,284 INFO: เติม 2025-11-19 23:00 → +2
2025-11-21 19:33:16,277 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:16,277 INFO: เติม 2025-11-20 00:00 → +2
2025-11-21 19:33:18,086 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:18,086 INFO: เติม 2025-11-20 01:00 → +2
2025-11-21 19:33:23,055 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:23,055 INFO: เติม 2025-11-20 02:00 → +2
2025-11-21 19:33:24,935 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:24,936 INFO: เติม 2025-11-20 03:00 → +2
2025-11-21 19:33:26,780 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:26,781 INFO: เติม 2025-11-20 04:00 → +2
2025-11-21 19:33:29,022 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:29,023 INFO: เติม 2025-11-20 05:00 → +2
2025-11-21 19:33:30,968 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:30,968 INFO: เติม 2025-11-20 06:00 → +2
2025-11-21 19:33:32,966 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:32,967 INFO: เติม 2025-11-20 07:00 → +2
2025-11-21 19:33:34,838 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:34,839 INFO: เติม 2025-11-20 08:00 → +2
2025-11-21 19:33:36,611 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:36,612 INFO: เติม 2025-11-20 09:00 → +2
2025-11-21 19:33:38,618 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:38,619 INFO: เติม 2025-11-20 10:00 → +2
2025-11-21 19:33:40,604 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:40,604 INFO: เติม 2025-11-20 11:00 → +2
2025-11-21 19:33:42,437 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:42,438 INFO: เติม 2025-11-20 12:00 → +2
2025-11-21 19:33:44,252 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:44,253 INFO: เติม 2025-11-20 13:00 → +2
2025-11-21 19:33:46,088 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:46,089 INFO: เติม 2025-11-20 14:00 → +2
2025-11-21 19:33:47,877 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:47,877 INFO: เติม 2025-11-20 15:00 → +2
2025-11-21 19:33:53,191 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:53,192 INFO: เติม 2025-11-20 16:00 → +2
2025-11-21 19:33:55,876 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:55,877 INFO: เติม 2025-11-20 17:00 → +2
2025-11-21 19:33:57,937 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:33:57,937 INFO: เติม 2025-11-20 18:00 → +2
2025-11-21 19:34:00,218 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:00,218 INFO: เติม 2025-11-20 19:00 → +2
2025-11-21 19:34:02,275 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:02,276 INFO: เติม 2025-11-20 20:00 → +2
2025-11-21 19:34:04,346 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:04,347 INFO: เติม 2025-11-20 21:00 → +2
2025-11-21 19:34:06,380 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:06,380 INFO: เติม 2025-11-20 22:00 → +2
2025-11-21 19:34:11,544 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:11,545 INFO: เติม 2025-11-20 23:00 → +2
2025-11-21 19:34:13,361 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:13,361 INFO: เติม 2025-11-21 00:00 → +2
2025-11-21 19:34:15,152 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:15,152 INFO: เติม 2025-11-21 01:00 → +2
2025-11-21 19:34:17,156 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:17,156 INFO: เติม 2025-11-21 02:00 → +2
2025-11-21 19:34:19,182 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:19,182 INFO: เติม 2025-11-21 03:00 → +2
2025-11-21 19:34:20,962 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:20,962 INFO: เติม 2025-11-21 04:00 → +2
2025-11-21 19:34:23,066 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:23,066 INFO: เติม 2025-11-21 05:00 → +2
2025-11-21 19:34:35,279 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:35,279 INFO: เติม 2025-11-21 06:00 → +2
2025-11-21 19:34:37,057 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:37,058 INFO: เติม 2025-11-21 07:00 → +2
2025-11-21 19:34:39,096 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:39,096 INFO: เติม 2025-11-21 08:00 → +2
2025-11-21 19:34:40,903 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:40,904 INFO: เติม 2025-11-21 09:00 → +2
2025-11-21 19:34:43,051 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:43,051 INFO: เติม 2025-11-21 10:00 → +2
2025-11-21 19:34:47,062 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:47,062 INFO: เติม 2025-11-21 11:00 → +2
2025-11-21 19:34:49,926 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:49,926 INFO: เติม 2025-11-21 12:00 → +2
2025-11-21 19:34:55,043 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:55,044 INFO: เติม 2025-11-21 13:00 → +2
2025-11-21 19:34:57,705 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:34:57,705 INFO: เติม 2025-11-21 14:00 → +2
2025-11-21 19:35:00,024 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:35:00,024 INFO: เติม 2025-11-21 15:00 → +2
2025-11-21 19:35:02,070 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-21 19:35:02,070 INFO: เติม 2025-11-21 16:00 → +2
2025-11-23 16:00:38,136 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 16:00:38,148 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 16:00:38,150 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 16:00:38,151 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 16:00:38,151 INFO: Scheduler started
2025-11-23 16:00:38,151 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 16:00:38,151 INFO: === PIPELINE START ===
2025-11-23 16:00:38,151 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 16:00:38,882 INFO: ดึง 2025-11-23 15:00:00+07:00 - 2025-11-23 16:00:00+07:00 → 1 แถว
2025-11-23 16:00:38,910 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:38,910 INFO: สำเร็จ: อัปเดต/เพิ่ม 1 แถว
2025-11-23 16:00:38,910 INFO: Fetch สำเร็จ
2025-11-23 16:00:38,945 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-23 16:00:39,621 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:39,621 INFO: เติม 2025-11-21 16:00 → +2
2025-11-23 16:00:41,363 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:41,364 INFO: เติม 2025-11-21 17:00 → +2
2025-11-23 16:00:43,115 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:43,116 INFO: เติม 2025-11-21 18:00 → +2
2025-11-23 16:00:44,790 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:44,790 INFO: เติม 2025-11-21 19:00 → +2
2025-11-23 16:00:46,480 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:46,481 INFO: เติม 2025-11-21 20:00 → +2
2025-11-23 16:00:48,203 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:48,204 INFO: เติม 2025-11-21 21:00 → +2
2025-11-23 16:00:49,871 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:49,871 INFO: เติม 2025-11-21 22:00 → +2
2025-11-23 16:00:51,605 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:51,606 INFO: เติม 2025-11-21 23:00 → +2
2025-11-23 16:00:53,318 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:53,318 INFO: เติม 2025-11-22 00:00 → +2
2025-11-23 16:00:55,037 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:55,037 INFO: เติม 2025-11-22 01:00 → +2
2025-11-23 16:00:56,676 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:56,676 INFO: เติม 2025-11-22 02:00 → +2
2025-11-23 16:00:58,419 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:00:58,420 INFO: เติม 2025-11-22 03:00 → +2
2025-11-23 16:01:00,084 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:00,085 INFO: เติม 2025-11-22 04:00 → +2
2025-11-23 16:01:01,809 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:01,809 INFO: เติม 2025-11-22 05:00 → +2
2025-11-23 16:01:03,514 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:03,515 INFO: เติม 2025-11-22 06:00 → +2
2025-11-23 16:01:05,266 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:05,266 INFO: เติม 2025-11-22 07:00 → +2
2025-11-23 16:01:06,975 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:06,975 INFO: เติม 2025-11-22 08:00 → +2
2025-11-23 16:01:08,673 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:08,674 INFO: เติม 2025-11-22 09:00 → +2
2025-11-23 16:01:10,355 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:10,356 INFO: เติม 2025-11-22 10:00 → +2
2025-11-23 16:01:12,100 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:12,100 INFO: เติม 2025-11-22 11:00 → +2
2025-11-23 16:01:13,829 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:13,829 INFO: เติม 2025-11-22 12:00 → +2
2025-11-23 16:01:15,529 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:15,529 INFO: เติม 2025-11-22 13:00 → +2
2025-11-23 16:01:17,268 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:17,268 INFO: เติม 2025-11-22 14:00 → +2
2025-11-23 16:01:18,973 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:18,973 INFO: เติม 2025-11-22 15:00 → +2
2025-11-23 16:01:20,664 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:20,664 INFO: เติม 2025-11-22 16:00 → +2
2025-11-23 16:01:22,355 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:22,356 INFO: เติม 2025-11-22 17:00 → +2
2025-11-23 16:01:24,074 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:24,074 INFO: เติม 2025-11-22 18:00 → +2
2025-11-23 16:01:25,761 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:25,761 INFO: เติม 2025-11-22 19:00 → +2
2025-11-23 16:01:27,402 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:27,403 INFO: เติม 2025-11-22 20:00 → +2
2025-11-23 16:01:29,097 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:29,097 INFO: เติม 2025-11-22 21:00 → +2
2025-11-23 16:01:30,784 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:30,785 INFO: เติม 2025-11-22 22:00 → +2
2025-11-23 16:01:32,450 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:32,450 INFO: เติม 2025-11-22 23:00 → +2
2025-11-23 16:01:34,396 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:34,396 INFO: เติม 2025-11-23 00:00 → +2
2025-11-23 16:01:36,085 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:36,086 INFO: เติม 2025-11-23 01:00 → +2
2025-11-23 16:01:37,803 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:37,803 INFO: เติม 2025-11-23 02:00 → +2
2025-11-23 16:01:39,544 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:39,545 INFO: เติม 2025-11-23 03:00 → +2
2025-11-23 16:01:41,262 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:41,263 INFO: เติม 2025-11-23 04:00 → +2
2025-11-23 16:01:42,924 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:42,924 INFO: เติม 2025-11-23 05:00 → +2
2025-11-23 16:01:44,661 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:44,661 INFO: เติม 2025-11-23 06:00 → +2
2025-11-23 16:01:46,329 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:46,330 INFO: เติม 2025-11-23 07:00 → +2
2025-11-23 16:01:48,010 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:48,010 INFO: เติม 2025-11-23 08:00 → +2
2025-11-23 16:01:49,671 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:49,671 INFO: เติม 2025-11-23 09:00 → +2
2025-11-23 16:01:51,416 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:51,416 INFO: เติม 2025-11-23 10:00 → +2
2025-11-23 16:01:53,096 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:53,097 INFO: เติม 2025-11-23 11:00 → +2
2025-11-23 16:01:54,821 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:54,822 INFO: เติม 2025-11-23 12:00 → +2
2025-11-23 16:01:56,521 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:56,522 INFO: เติม 2025-11-23 13:00 → +2
2025-11-23 16:01:58,225 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:58,225 INFO: เติม 2025-11-23 14:00 → +2
2025-11-23 16:01:59,939 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-23 16:01:59,940 INFO: เติม 2025-11-23 15:00 → +1
2025-11-23 16:02:02,642 INFO: เติมข้อมูลย้อนหลังเสร็จ: +95 แถว
2025-11-23 16:02:02,659 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 196 แถว
2025-11-23 16:02:02,660 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 16:02:02,674 INFO: รวมเก่า 135 + ใหม่ 196 → 196 (เพิ่ม 61)
2025-11-23 16:02:02,677 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 16:02:02,677 INFO: Format สำเร็จ: +61 แถว
2025-11-23 16:02:02,695 INFO: เริ่ม clean ข้อมูล: 196 แถว
2025-11-23 16:02:02,710 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (196 แถว)
2025-11-23 16:02:02,716 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 11:00:00          60.1           16.3       1.1 145.8       27.4    47.8     1015.4
2025-11-23 10:00:00          61.1           20.3       1.0 141.1       26.2    50.5     1015.5
2025-11-23 09:00:00          49.9           26.5       1.0 143.4       24.9    54.0     1015.2
2025-11-23 08:00:00          48.3           20.2       0.8 139.4       23.9    57.2     1014.4
2025-11-23 07:00:00          52.6           22.1       0.8 141.2       23.3    58.2     1013.8
2025-11-23 06:00:00          48.7           19.6       0.6 131.8       23.3    58.0     1013.4
2025-11-23 16:02:04,618 INFO: เตรียมโหลด 196 แถว
2025-11-23 16:02:04,702 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-23 16:02:04,704 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-23 16:02:04,706 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-23 16:02:04,708 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-23 16:02:04,710 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-23 16:02:04,712 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-23 16:02:04,713 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-23 16:02:04,717 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-23 16:02:04,719 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-23 16:02:04,720 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-23 16:02:04,722 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-23 16:02:04,724 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-23 16:02:04,726 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 16:02:04,728 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-23 16:02:04,730 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-23 16:02:04,731 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-23 16:02:04,733 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-23 16:02:04,735 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-23 16:02:04,737 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-23 16:02:04,739 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-23 16:02:04,741 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-23 16:02:04,743 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-23 16:02:04,745 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 16:02:04,746 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-23 16:02:04,747 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-23 16:02:04,749 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-23 16:02:04,751 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-23 16:02:04,752 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-23 16:02:04,754 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 16:02:04,755 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-23 16:02:04,756 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-23 16:02:04,758 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-23 16:02:04,760 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-23 16:02:04,762 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-23 16:02:04,763 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-23 16:02:04,765 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-23 16:02:04,766 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-23 16:02:04,767 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 16:02:04,769 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-23 16:02:04,770 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-23 16:02:04,771 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-23 16:02:04,773 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-23 16:02:04,774 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-23 16:02:04,776 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-23 16:02:04,777 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-23 16:02:04,779 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-23 16:02:04,780 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-23 16:02:04,781 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-23 16:02:04,783 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-23 16:02:04,784 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-23 16:02:04,785 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-23 16:02:04,787 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-23 16:02:04,788 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-23 16:02:04,789 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-23 16:02:04,791 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-23 16:02:04,793 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-23 16:02:04,794 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-23 16:02:04,795 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-23 16:02:04,797 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-23 16:02:04,798 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-23 16:02:04,800 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-23 16:02:04,801 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-23 16:02:04,803 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-23 16:02:04,804 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-23 16:02:04,805 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-23 16:02:04,806 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-23 16:02:04,807 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-23 16:02:04,809 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-23 16:02:04,810 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-23 16:02:04,812 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-23 16:02:04,813 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-23 16:02:04,814 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-23 16:02:04,816 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-23 16:02:04,818 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-23 16:02:04,819 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-23 16:02:04,820 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-23 16:02:04,822 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-23 16:02:04,823 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-23 16:02:04,825 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-23 16:02:04,826 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-23 16:02:04,827 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-23 16:02:04,828 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 16:02:04,829 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-23 16:02:04,831 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-23 16:02:04,832 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-23 16:02:04,833 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-23 16:02:04,835 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 16:02:04,836 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-23 16:02:04,838 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-23 16:02:04,839 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-23 16:02:04,841 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-23 16:02:04,842 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-23 16:02:04,844 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-23 16:02:04,845 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-23 16:02:04,846 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-23 16:02:04,847 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-23 16:02:04,849 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-23 16:02:04,850 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-23 16:02:04,851 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-23 16:02:04,853 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-23 16:02:04,854 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-23 16:02:04,856 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-23 16:02:04,858 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-23 16:02:04,859 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-23 16:02:04,860 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-23 16:02:04,862 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-23 16:02:04,863 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-23 16:02:04,864 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-23 16:02:04,866 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-23 16:02:04,866 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-23 16:02:04,868 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-23 16:02:04,869 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-23 16:02:04,870 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-23 16:02:04,872 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-23 16:02:04,873 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-23 16:02:04,874 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-23 16:02:04,875 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-23 16:02:04,876 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-23 16:02:04,879 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-23 16:02:04,880 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-23 16:02:04,881 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-23 16:02:04,882 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-23 16:02:04,883 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-23 16:02:04,885 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-23 16:02:04,886 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-23 16:02:04,887 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-23 16:02:04,888 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-23 16:02:04,889 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-23 16:02:04,891 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-23 16:02:04,892 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 16:02:04,894 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-23 16:02:04,895 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-23 16:02:04,896 INFO: อัปเดต DB สำเร็จ: 2025-11-21 00:00:00+07:00 → PM2.5 = 16.0
2025-11-23 16:02:04,898 INFO: อัปเดต DB สำเร็จ: 2025-11-21 01:00:00+07:00 → PM2.5 = 13.5
2025-11-23 16:02:04,900 INFO: อัปเดต DB สำเร็จ: 2025-11-21 02:00:00+07:00 → PM2.5 = 9.3
2025-11-23 16:02:04,903 INFO: อัปเดต DB สำเร็จ: 2025-11-21 03:00:00+07:00 → PM2.5 = 16.2
2025-11-23 16:02:04,905 INFO: อัปเดต DB สำเร็จ: 2025-11-21 04:00:00+07:00 → PM2.5 = 15.4
2025-11-23 16:02:04,907 INFO: อัปเดต DB สำเร็จ: 2025-11-21 05:00:00+07:00 → PM2.5 = 17.2
2025-11-23 16:02:04,909 INFO: อัปเดต DB สำเร็จ: 2025-11-21 06:00:00+07:00 → PM2.5 = 18.0
2025-11-23 16:02:04,911 INFO: อัปเดต DB สำเร็จ: 2025-11-21 07:00:00+07:00 → PM2.5 = 15.7
2025-11-23 16:02:04,912 INFO: อัปเดต DB สำเร็จ: 2025-11-21 08:00:00+07:00 → PM2.5 = 14.6
2025-11-23 16:02:04,914 INFO: อัปเดต DB สำเร็จ: 2025-11-21 09:00:00+07:00 → PM2.5 = 20.8
2025-11-23 16:02:04,915 INFO: อัปเดต DB สำเร็จ: 2025-11-21 10:00:00+07:00 → PM2.5 = 13.9
2025-11-23 16:02:04,916 INFO: อัปเดต DB สำเร็จ: 2025-11-21 11:00:00+07:00 → PM2.5 = 14.4
2025-11-23 16:02:04,918 INFO: อัปเดต DB สำเร็จ: 2025-11-21 12:00:00+07:00 → PM2.5 = 10.4
2025-11-23 16:02:04,919 INFO: อัปเดต DB สำเร็จ: 2025-11-21 13:00:00+07:00 → PM2.5 = 8.5
2025-11-23 16:02:04,921 INFO: อัปเดต DB สำเร็จ: 2025-11-21 14:00:00+07:00 → PM2.5 = 10.4
2025-11-23 16:02:04,922 INFO: อัปเดต DB สำเร็จ: 2025-11-21 15:00:00+07:00 → PM2.5 = 17.6
2025-11-23 16:02:04,923 INFO: อัปเดต DB สำเร็จ: 2025-11-21 16:00:00+07:00 → PM2.5 = 19.0
2025-11-23 16:02:04,924 INFO: อัปเดต DB สำเร็จ: 2025-11-21 17:00:00+07:00 → PM2.5 = 15.7
2025-11-23 16:02:04,925 INFO: อัปเดต DB สำเร็จ: 2025-11-21 18:00:00+07:00 → PM2.5 = 19.4
2025-11-23 16:02:04,927 INFO: อัปเดต DB สำเร็จ: 2025-11-21 19:00:00+07:00 → PM2.5 = 19.2
2025-11-23 16:02:04,929 INFO: อัปเดต DB สำเร็จ: 2025-11-21 20:00:00+07:00 → PM2.5 = 19.8
2025-11-23 16:02:04,930 INFO: อัปเดต DB สำเร็จ: 2025-11-21 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 16:02:04,931 INFO: อัปเดต DB สำเร็จ: 2025-11-21 22:00:00+07:00 → PM2.5 = 22.8
2025-11-23 16:02:04,932 INFO: อัปเดต DB สำเร็จ: 2025-11-21 23:00:00+07:00 → PM2.5 = 19.2
2025-11-23 16:02:04,934 INFO: อัปเดต DB สำเร็จ: 2025-11-22 00:00:00+07:00 → PM2.5 = 15.5
2025-11-23 16:02:04,935 INFO: อัปเดต DB สำเร็จ: 2025-11-22 01:00:00+07:00 → PM2.5 = 14.8
2025-11-23 16:02:04,936 INFO: อัปเดต DB สำเร็จ: 2025-11-22 02:00:00+07:00 → PM2.5 = 11.0
2025-11-23 16:02:04,937 INFO: อัปเดต DB สำเร็จ: 2025-11-22 03:00:00+07:00 → PM2.5 = 15.5
2025-11-23 16:02:04,938 INFO: อัปเดต DB สำเร็จ: 2025-11-22 04:00:00+07:00 → PM2.5 = 13.3
2025-11-23 16:02:04,939 INFO: อัปเดต DB สำเร็จ: 2025-11-22 05:00:00+07:00 → PM2.5 = 14.3
2025-11-23 16:02:04,941 INFO: อัปเดต DB สำเร็จ: 2025-11-22 06:00:00+07:00 → PM2.5 = 22.1
2025-11-23 16:02:04,942 INFO: อัปเดต DB สำเร็จ: 2025-11-22 07:00:00+07:00 → PM2.5 = 18.8
2025-11-23 16:02:04,943 INFO: อัปเดต DB สำเร็จ: 2025-11-22 08:00:00+07:00 → PM2.5 = 20.6
2025-11-23 16:02:04,945 INFO: อัปเดต DB สำเร็จ: 2025-11-22 09:00:00+07:00 → PM2.5 = 19.0
2025-11-23 16:02:04,946 INFO: อัปเดต DB สำเร็จ: 2025-11-22 10:00:00+07:00 → PM2.5 = 10.5
2025-11-23 16:02:04,947 INFO: อัปเดต DB สำเร็จ: 2025-11-22 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 16:02:04,948 INFO: อัปเดต DB สำเร็จ: 2025-11-22 12:00:00+07:00 → PM2.5 = 6.8
2025-11-23 16:02:04,949 INFO: อัปเดต DB สำเร็จ: 2025-11-22 13:00:00+07:00 → PM2.5 = 7.3
2025-11-23 16:02:04,950 INFO: อัปเดต DB สำเร็จ: 2025-11-22 14:00:00+07:00 → PM2.5 = 7.8
2025-11-23 16:02:04,952 INFO: อัปเดต DB สำเร็จ: 2025-11-22 15:00:00+07:00 → PM2.5 = 8.9
2025-11-23 16:02:04,953 INFO: อัปเดต DB สำเร็จ: 2025-11-22 16:00:00+07:00 → PM2.5 = 14.4
2025-11-23 16:02:04,954 INFO: อัปเดต DB สำเร็จ: 2025-11-22 17:00:00+07:00 → PM2.5 = 18.2
2025-11-23 16:02:04,955 INFO: อัปเดต DB สำเร็จ: 2025-11-22 18:00:00+07:00 → PM2.5 = 10.5
2025-11-23 16:02:04,958 INFO: อัปเดต DB สำเร็จ: 2025-11-22 19:00:00+07:00 → PM2.5 = 14.9
2025-11-23 16:02:04,959 INFO: อัปเดต DB สำเร็จ: 2025-11-22 20:00:00+07:00 → PM2.5 = 22.7
2025-11-23 16:02:04,961 INFO: อัปเดต DB สำเร็จ: 2025-11-22 21:00:00+07:00 → PM2.5 = 20.9
2025-11-23 16:02:04,962 INFO: อัปเดต DB สำเร็จ: 2025-11-22 22:00:00+07:00 → PM2.5 = 26.4
2025-11-23 16:02:04,963 INFO: อัปเดต DB สำเร็จ: 2025-11-22 23:00:00+07:00 → PM2.5 = 24.0
2025-11-23 16:02:04,965 INFO: อัปเดต DB สำเร็จ: 2025-11-23 00:00:00+07:00 → PM2.5 = 15.4
2025-11-23 16:02:04,966 INFO: อัปเดต DB สำเร็จ: 2025-11-23 01:00:00+07:00 → PM2.5 = 17.4
2025-11-23 16:02:04,968 INFO: อัปเดต DB สำเร็จ: 2025-11-23 02:00:00+07:00 → PM2.5 = 20.2
2025-11-23 16:02:04,970 INFO: อัปเดต DB สำเร็จ: 2025-11-23 03:00:00+07:00 → PM2.5 = 22.8
2025-11-23 16:02:04,971 INFO: อัปเดต DB สำเร็จ: 2025-11-23 04:00:00+07:00 → PM2.5 = 21.1
2025-11-23 16:02:04,972 INFO: อัปเดต DB สำเร็จ: 2025-11-23 05:00:00+07:00 → PM2.5 = 22.0
2025-11-23 16:02:04,973 INFO: อัปเดต DB สำเร็จ: 2025-11-23 06:00:00+07:00 → PM2.5 = 19.6
2025-11-23 16:02:04,974 INFO: อัปเดต DB สำเร็จ: 2025-11-23 07:00:00+07:00 → PM2.5 = 22.1
2025-11-23 16:02:04,976 INFO: อัปเดต DB สำเร็จ: 2025-11-23 08:00:00+07:00 → PM2.5 = 20.2
2025-11-23 16:02:04,977 INFO: อัปเดต DB สำเร็จ: 2025-11-23 09:00:00+07:00 → PM2.5 = 26.5
2025-11-23 16:02:04,978 INFO: อัปเดต DB สำเร็จ: 2025-11-23 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 16:02:04,980 INFO: อัปเดต DB สำเร็จ: 2025-11-23 11:00:00+07:00 → PM2.5 = 16.3
2025-11-23 16:02:04,981 INFO: อัปเดต DB สำเร็จ: 2025-11-23 12:00:00+07:00 → PM2.5 = 19.0
2025-11-23 16:02:04,983 INFO: อัปเดต DB สำเร็จ: 2025-11-23 13:00:00+07:00 → PM2.5 = 15.3
2025-11-23 16:02:04,983 INFO: อัปเดต DB สำเร็จ: 2025-11-23 14:00:00+07:00 → PM2.5 = 11.5
2025-11-23 16:02:04,985 INFO: อัปเดต DB สำเร็จ: 2025-11-23 15:00:00+07:00 → PM2.5 = 16.5
2025-11-23 16:02:04,985 INFO: โหลด DB สำเร็จ
2025-11-23 16:02:04,987 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 16:02:04,990 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 16:02:04,990 INFO: Load to DB + Backup สำเร็จ
2025-11-23 16:02:04,990 INFO: === PIPELINE END ===

2025-11-23 16:05:00,008 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 17:05:00 +07)" (scheduled at 2025-11-23 16:05:00+07:00)
2025-11-23 16:05:00,010 INFO: === PIPELINE START ===
2025-11-23 16:05:00,011 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 16:05:00,712 INFO: ดึง 2025-11-23 15:00:00+07:00 - 2025-11-23 16:00:00+07:00 → 2 แถว
2025-11-23 16:05:00,720 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:00,721 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 16:05:00,721 INFO: Fetch สำเร็จ
2025-11-23 16:05:00,746 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-23 16:05:01,719 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:01,720 INFO: เติม 2025-11-21 16:00 → +2
2025-11-23 16:05:03,424 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:03,425 INFO: เติม 2025-11-21 17:00 → +2
2025-11-23 16:05:05,159 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:05,159 INFO: เติม 2025-11-21 18:00 → +2
2025-11-23 16:05:06,965 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:06,966 INFO: เติม 2025-11-21 19:00 → +2
2025-11-23 16:05:08,651 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:08,652 INFO: เติม 2025-11-21 20:00 → +2
2025-11-23 16:05:10,375 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:10,375 INFO: เติม 2025-11-21 21:00 → +2
2025-11-23 16:05:12,061 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:12,062 INFO: เติม 2025-11-21 22:00 → +2
2025-11-23 16:05:13,778 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:13,778 INFO: เติม 2025-11-21 23:00 → +2
2025-11-23 16:05:15,510 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:15,510 INFO: เติม 2025-11-22 00:00 → +2
2025-11-23 16:05:17,235 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:17,235 INFO: เติม 2025-11-22 01:00 → +2
2025-11-23 16:05:18,998 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:18,998 INFO: เติม 2025-11-22 02:00 → +2
2025-11-23 16:05:20,738 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:20,739 INFO: เติม 2025-11-22 03:00 → +2
2025-11-23 16:05:22,471 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:22,471 INFO: เติม 2025-11-22 04:00 → +2
2025-11-23 16:05:24,224 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:24,225 INFO: เติม 2025-11-22 05:00 → +2
2025-11-23 16:05:25,951 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:25,952 INFO: เติม 2025-11-22 06:00 → +2
2025-11-23 16:05:27,689 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:27,690 INFO: เติม 2025-11-22 07:00 → +2
2025-11-23 16:05:29,381 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:29,382 INFO: เติม 2025-11-22 08:00 → +2
2025-11-23 16:05:31,176 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:31,176 INFO: เติม 2025-11-22 09:00 → +2
2025-11-23 16:05:32,935 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:32,935 INFO: เติม 2025-11-22 10:00 → +2
2025-11-23 16:05:34,637 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:34,638 INFO: เติม 2025-11-22 11:00 → +2
2025-11-23 16:05:36,317 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:36,317 INFO: เติม 2025-11-22 12:00 → +2
2025-11-23 16:05:38,062 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:38,062 INFO: เติม 2025-11-22 13:00 → +2
2025-11-23 16:05:39,789 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:39,790 INFO: เติม 2025-11-22 14:00 → +2
2025-11-23 16:05:41,535 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:41,535 INFO: เติม 2025-11-22 15:00 → +2
2025-11-23 16:05:43,224 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:43,224 INFO: เติม 2025-11-22 16:00 → +2
2025-11-23 16:05:44,975 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:44,975 INFO: เติม 2025-11-22 17:00 → +2
2025-11-23 16:05:46,721 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:46,722 INFO: เติม 2025-11-22 18:00 → +2
2025-11-23 16:05:48,452 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:48,452 INFO: เติม 2025-11-22 19:00 → +2
2025-11-23 16:05:50,207 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:50,207 INFO: เติม 2025-11-22 20:00 → +2
2025-11-23 16:05:51,924 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:51,925 INFO: เติม 2025-11-22 21:00 → +2
2025-11-23 16:05:53,652 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:53,653 INFO: เติม 2025-11-22 22:00 → +2
2025-11-23 16:05:55,329 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:55,330 INFO: เติม 2025-11-22 23:00 → +2
2025-11-23 16:05:57,070 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:57,071 INFO: เติม 2025-11-23 00:00 → +2
2025-11-23 16:05:58,773 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:05:58,773 INFO: เติม 2025-11-23 01:00 → +2
2025-11-23 16:06:00,538 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:00,538 INFO: เติม 2025-11-23 02:00 → +2
2025-11-23 16:06:02,270 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:02,270 INFO: เติม 2025-11-23 03:00 → +2
2025-11-23 16:06:04,000 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:04,001 INFO: เติม 2025-11-23 04:00 → +2
2025-11-23 16:06:05,687 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:05,688 INFO: เติม 2025-11-23 05:00 → +2
2025-11-23 16:06:07,351 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:07,352 INFO: เติม 2025-11-23 06:00 → +2
2025-11-23 16:06:09,068 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:09,068 INFO: เติม 2025-11-23 07:00 → +2
2025-11-23 16:06:10,769 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:10,769 INFO: เติม 2025-11-23 08:00 → +2
2025-11-23 16:06:12,471 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:12,471 INFO: เติม 2025-11-23 09:00 → +2
2025-11-23 16:06:14,197 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:14,197 INFO: เติม 2025-11-23 10:00 → +2
2025-11-23 16:06:15,933 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:15,934 INFO: เติม 2025-11-23 11:00 → +2
2025-11-23 16:06:17,614 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:17,615 INFO: เติม 2025-11-23 12:00 → +2
2025-11-23 16:06:19,364 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:19,365 INFO: เติม 2025-11-23 13:00 → +2
2025-11-23 16:06:21,075 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:21,076 INFO: เติม 2025-11-23 14:00 → +2
2025-11-23 16:06:22,797 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:22,797 INFO: เติม 2025-11-23 15:00 → +2
2025-11-23 16:06:24,604 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-23 16:06:24,605 INFO: เติม 2025-11-23 16:00 → +1
2025-11-23 16:06:25,614 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-23 16:06:25,638 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 197 แถว
2025-11-23 16:06:25,639 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 16:06:25,641 INFO: รวมเก่า 196 + ใหม่ 197 → 197 (เพิ่ม 1)
2025-11-23 16:06:25,642 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 16:06:25,642 INFO: Format สำเร็จ: +1 แถว
2025-11-23 16:06:25,654 INFO: เริ่ม clean ข้อมูล: 197 แถว
2025-11-23 16:06:25,666 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (197 แถว)
2025-11-23 16:06:25,669 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 16:00:00          54.1           16.5       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 11:00:00          60.1           16.3       1.1 145.8       27.4    47.8     1015.4
2025-11-23 10:00:00          61.1           20.3       1.0 141.1       26.2    50.5     1015.5
2025-11-23 09:00:00          49.9           26.5       1.0 143.4       24.9    54.0     1015.2
2025-11-23 08:00:00          48.3           20.2       0.8 139.4       23.9    57.2     1014.4
2025-11-23 07:00:00          52.6           22.1       0.8 141.2       23.3    58.2     1013.8
2025-11-23 16:06:25,671 INFO: เตรียมโหลด 197 แถว
2025-11-23 16:06:25,675 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-23 16:06:25,676 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-23 16:06:25,678 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-23 16:06:25,680 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-23 16:06:25,682 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-23 16:06:25,684 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-23 16:06:25,685 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-23 16:06:25,686 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-23 16:06:25,688 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-23 16:06:25,690 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-23 16:06:25,691 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-23 16:06:25,693 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-23 16:06:25,695 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 16:06:25,696 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-23 16:06:25,698 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-23 16:06:25,700 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-23 16:06:25,702 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-23 16:06:25,705 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-23 16:06:25,708 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-23 16:06:25,710 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-23 16:06:25,713 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-23 16:06:25,715 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-23 16:06:25,718 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 16:06:25,720 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-23 16:06:25,724 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-23 16:06:25,726 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-23 16:06:25,730 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-23 16:06:25,733 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-23 16:06:25,735 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 16:06:25,736 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-23 16:06:25,738 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-23 16:06:25,740 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-23 16:06:25,742 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-23 16:06:25,744 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-23 16:06:25,746 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-23 16:06:25,748 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-23 16:06:25,751 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-23 16:06:25,753 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 16:06:25,755 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-23 16:06:25,757 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-23 16:06:25,759 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-23 16:06:25,760 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-23 16:06:25,763 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-23 16:06:25,765 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-23 16:06:25,767 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-23 16:06:25,770 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-23 16:06:25,772 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-23 16:06:25,775 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-23 16:06:25,776 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-23 16:06:25,778 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-23 16:06:25,780 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-23 16:06:25,781 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-23 16:06:25,783 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-23 16:06:25,785 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-23 16:06:25,787 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-23 16:06:25,789 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-23 16:06:25,791 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-23 16:06:25,793 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-23 16:06:25,794 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-23 16:06:25,796 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-23 16:06:25,798 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-23 16:06:25,800 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-23 16:06:25,802 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-23 16:06:25,803 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-23 16:06:25,805 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-23 16:06:25,808 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-23 16:06:25,809 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-23 16:06:25,811 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-23 16:06:25,813 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-23 16:06:25,815 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-23 16:06:25,816 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-23 16:06:25,818 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-23 16:06:25,820 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-23 16:06:25,821 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-23 16:06:25,823 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-23 16:06:25,824 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-23 16:06:25,826 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-23 16:06:25,828 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-23 16:06:25,830 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-23 16:06:25,832 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-23 16:06:25,833 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-23 16:06:25,835 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 16:06:25,837 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-23 16:06:25,838 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-23 16:06:25,840 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-23 16:06:25,842 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-23 16:06:25,844 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 16:06:25,845 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-23 16:06:25,847 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-23 16:06:25,849 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-23 16:06:25,850 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-23 16:06:25,852 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-23 16:06:25,854 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-23 16:06:25,855 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-23 16:06:25,857 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-23 16:06:25,858 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-23 16:06:25,860 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-23 16:06:25,862 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-23 16:06:25,863 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-23 16:06:25,865 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-23 16:06:25,867 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-23 16:06:25,869 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-23 16:06:25,870 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-23 16:06:25,872 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-23 16:06:25,873 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-23 16:06:25,875 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-23 16:06:25,876 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-23 16:06:25,877 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-23 16:06:25,880 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-23 16:06:25,881 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-23 16:06:25,883 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-23 16:06:25,885 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-23 16:06:25,886 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-23 16:06:25,888 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-23 16:06:25,889 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-23 16:06:25,891 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-23 16:06:25,892 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-23 16:06:25,895 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-23 16:06:25,896 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-23 16:06:25,898 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-23 16:06:25,899 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-23 16:06:25,902 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-23 16:06:25,903 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-23 16:06:25,904 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-23 16:06:25,906 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-23 16:06:25,907 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-23 16:06:25,908 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-23 16:06:25,911 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-23 16:06:25,913 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-23 16:06:25,914 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 16:06:25,915 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-23 16:06:25,917 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-23 16:06:25,918 INFO: อัปเดต DB สำเร็จ: 2025-11-21 00:00:00+07:00 → PM2.5 = 16.0
2025-11-23 16:06:25,921 INFO: อัปเดต DB สำเร็จ: 2025-11-21 01:00:00+07:00 → PM2.5 = 13.5
2025-11-23 16:06:25,922 INFO: อัปเดต DB สำเร็จ: 2025-11-21 02:00:00+07:00 → PM2.5 = 9.3
2025-11-23 16:06:25,924 INFO: อัปเดต DB สำเร็จ: 2025-11-21 03:00:00+07:00 → PM2.5 = 16.2
2025-11-23 16:06:25,925 INFO: อัปเดต DB สำเร็จ: 2025-11-21 04:00:00+07:00 → PM2.5 = 15.4
2025-11-23 16:06:25,927 INFO: อัปเดต DB สำเร็จ: 2025-11-21 05:00:00+07:00 → PM2.5 = 17.2
2025-11-23 16:06:25,928 INFO: อัปเดต DB สำเร็จ: 2025-11-21 06:00:00+07:00 → PM2.5 = 18.0
2025-11-23 16:06:25,930 INFO: อัปเดต DB สำเร็จ: 2025-11-21 07:00:00+07:00 → PM2.5 = 15.7
2025-11-23 16:06:25,931 INFO: อัปเดต DB สำเร็จ: 2025-11-21 08:00:00+07:00 → PM2.5 = 14.6
2025-11-23 16:06:25,933 INFO: อัปเดต DB สำเร็จ: 2025-11-21 09:00:00+07:00 → PM2.5 = 20.8
2025-11-23 16:06:25,934 INFO: อัปเดต DB สำเร็จ: 2025-11-21 10:00:00+07:00 → PM2.5 = 13.9
2025-11-23 16:06:25,936 INFO: อัปเดต DB สำเร็จ: 2025-11-21 11:00:00+07:00 → PM2.5 = 14.4
2025-11-23 16:06:25,937 INFO: อัปเดต DB สำเร็จ: 2025-11-21 12:00:00+07:00 → PM2.5 = 10.4
2025-11-23 16:06:25,939 INFO: อัปเดต DB สำเร็จ: 2025-11-21 13:00:00+07:00 → PM2.5 = 8.5
2025-11-23 16:06:25,941 INFO: อัปเดต DB สำเร็จ: 2025-11-21 14:00:00+07:00 → PM2.5 = 10.4
2025-11-23 16:06:25,943 INFO: อัปเดต DB สำเร็จ: 2025-11-21 15:00:00+07:00 → PM2.5 = 17.6
2025-11-23 16:06:25,944 INFO: อัปเดต DB สำเร็จ: 2025-11-21 16:00:00+07:00 → PM2.5 = 19.0
2025-11-23 16:06:25,945 INFO: อัปเดต DB สำเร็จ: 2025-11-21 17:00:00+07:00 → PM2.5 = 15.7
2025-11-23 16:06:25,947 INFO: อัปเดต DB สำเร็จ: 2025-11-21 18:00:00+07:00 → PM2.5 = 19.4
2025-11-23 16:06:25,948 INFO: อัปเดต DB สำเร็จ: 2025-11-21 19:00:00+07:00 → PM2.5 = 19.2
2025-11-23 16:06:25,950 INFO: อัปเดต DB สำเร็จ: 2025-11-21 20:00:00+07:00 → PM2.5 = 19.8
2025-11-23 16:06:25,952 INFO: อัปเดต DB สำเร็จ: 2025-11-21 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 16:06:25,953 INFO: อัปเดต DB สำเร็จ: 2025-11-21 22:00:00+07:00 → PM2.5 = 22.8
2025-11-23 16:06:25,955 INFO: อัปเดต DB สำเร็จ: 2025-11-21 23:00:00+07:00 → PM2.5 = 19.2
2025-11-23 16:06:25,956 INFO: อัปเดต DB สำเร็จ: 2025-11-22 00:00:00+07:00 → PM2.5 = 15.5
2025-11-23 16:06:25,958 INFO: อัปเดต DB สำเร็จ: 2025-11-22 01:00:00+07:00 → PM2.5 = 14.8
2025-11-23 16:06:25,959 INFO: อัปเดต DB สำเร็จ: 2025-11-22 02:00:00+07:00 → PM2.5 = 11.0
2025-11-23 16:06:25,961 INFO: อัปเดต DB สำเร็จ: 2025-11-22 03:00:00+07:00 → PM2.5 = 15.5
2025-11-23 16:06:25,963 INFO: อัปเดต DB สำเร็จ: 2025-11-22 04:00:00+07:00 → PM2.5 = 13.3
2025-11-23 16:06:25,964 INFO: อัปเดต DB สำเร็จ: 2025-11-22 05:00:00+07:00 → PM2.5 = 14.3
2025-11-23 16:06:25,966 INFO: อัปเดต DB สำเร็จ: 2025-11-22 06:00:00+07:00 → PM2.5 = 22.1
2025-11-23 16:06:25,967 INFO: อัปเดต DB สำเร็จ: 2025-11-22 07:00:00+07:00 → PM2.5 = 18.8
2025-11-23 16:06:25,970 INFO: อัปเดต DB สำเร็จ: 2025-11-22 08:00:00+07:00 → PM2.5 = 20.6
2025-11-23 16:06:25,971 INFO: อัปเดต DB สำเร็จ: 2025-11-22 09:00:00+07:00 → PM2.5 = 19.0
2025-11-23 16:06:25,973 INFO: อัปเดต DB สำเร็จ: 2025-11-22 10:00:00+07:00 → PM2.5 = 10.5
2025-11-23 16:06:25,975 INFO: อัปเดต DB สำเร็จ: 2025-11-22 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 16:06:25,977 INFO: อัปเดต DB สำเร็จ: 2025-11-22 12:00:00+07:00 → PM2.5 = 6.8
2025-11-23 16:06:25,978 INFO: อัปเดต DB สำเร็จ: 2025-11-22 13:00:00+07:00 → PM2.5 = 7.3
2025-11-23 16:06:25,980 INFO: อัปเดต DB สำเร็จ: 2025-11-22 14:00:00+07:00 → PM2.5 = 7.8
2025-11-23 16:06:25,982 INFO: อัปเดต DB สำเร็จ: 2025-11-22 15:00:00+07:00 → PM2.5 = 8.9
2025-11-23 16:06:25,983 INFO: อัปเดต DB สำเร็จ: 2025-11-22 16:00:00+07:00 → PM2.5 = 14.4
2025-11-23 16:06:25,985 INFO: อัปเดต DB สำเร็จ: 2025-11-22 17:00:00+07:00 → PM2.5 = 18.2
2025-11-23 16:06:25,986 INFO: อัปเดต DB สำเร็จ: 2025-11-22 18:00:00+07:00 → PM2.5 = 10.5
2025-11-23 16:06:25,987 INFO: อัปเดต DB สำเร็จ: 2025-11-22 19:00:00+07:00 → PM2.5 = 14.9
2025-11-23 16:06:25,989 INFO: อัปเดต DB สำเร็จ: 2025-11-22 20:00:00+07:00 → PM2.5 = 22.7
2025-11-23 16:06:25,991 INFO: อัปเดต DB สำเร็จ: 2025-11-22 21:00:00+07:00 → PM2.5 = 20.9
2025-11-23 16:06:25,992 INFO: อัปเดต DB สำเร็จ: 2025-11-22 22:00:00+07:00 → PM2.5 = 26.4
2025-11-23 16:06:25,993 INFO: อัปเดต DB สำเร็จ: 2025-11-22 23:00:00+07:00 → PM2.5 = 24.0
2025-11-23 16:06:25,995 INFO: อัปเดต DB สำเร็จ: 2025-11-23 00:00:00+07:00 → PM2.5 = 15.4
2025-11-23 16:06:25,997 INFO: อัปเดต DB สำเร็จ: 2025-11-23 01:00:00+07:00 → PM2.5 = 17.4
2025-11-23 16:06:25,999 INFO: อัปเดต DB สำเร็จ: 2025-11-23 02:00:00+07:00 → PM2.5 = 20.2
2025-11-23 16:06:26,000 INFO: อัปเดต DB สำเร็จ: 2025-11-23 03:00:00+07:00 → PM2.5 = 22.8
2025-11-23 16:06:26,002 INFO: อัปเดต DB สำเร็จ: 2025-11-23 04:00:00+07:00 → PM2.5 = 21.1
2025-11-23 16:06:26,003 INFO: อัปเดต DB สำเร็จ: 2025-11-23 05:00:00+07:00 → PM2.5 = 22.0
2025-11-23 16:06:26,005 INFO: อัปเดต DB สำเร็จ: 2025-11-23 06:00:00+07:00 → PM2.5 = 19.6
2025-11-23 16:06:26,006 INFO: อัปเดต DB สำเร็จ: 2025-11-23 07:00:00+07:00 → PM2.5 = 22.1
2025-11-23 16:06:26,009 INFO: อัปเดต DB สำเร็จ: 2025-11-23 08:00:00+07:00 → PM2.5 = 20.2
2025-11-23 16:06:26,010 INFO: อัปเดต DB สำเร็จ: 2025-11-23 09:00:00+07:00 → PM2.5 = 26.5
2025-11-23 16:06:26,012 INFO: อัปเดต DB สำเร็จ: 2025-11-23 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 16:06:26,013 INFO: อัปเดต DB สำเร็จ: 2025-11-23 11:00:00+07:00 → PM2.5 = 16.3
2025-11-23 16:06:26,014 INFO: อัปเดต DB สำเร็จ: 2025-11-23 12:00:00+07:00 → PM2.5 = 19.0
2025-11-23 16:06:26,015 INFO: อัปเดต DB สำเร็จ: 2025-11-23 13:00:00+07:00 → PM2.5 = 15.3
2025-11-23 16:06:26,017 INFO: อัปเดต DB สำเร็จ: 2025-11-23 14:00:00+07:00 → PM2.5 = 11.5
2025-11-23 16:06:26,018 INFO: อัปเดต DB สำเร็จ: 2025-11-23 15:00:00+07:00 → PM2.5 = 16.5
2025-11-23 16:06:26,020 INFO: อัปเดต DB สำเร็จ: 2025-11-23 16:00:00+07:00 → PM2.5 = 16.5
2025-11-23 16:06:26,021 INFO: โหลด DB สำเร็จ
2025-11-23 16:06:26,023 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 16:06:26,025 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 16:06:26,025 INFO: Load to DB + Backup สำเร็จ
2025-11-23 16:06:26,025 INFO: === PIPELINE END ===

2025-11-23 16:06:26,026 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 17:05:00 +07)" executed successfully
2025-11-23 17:05:00,001 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 18:05:00 +07)" (scheduled at 2025-11-23 17:05:00+07:00)
2025-11-23 17:05:00,003 INFO: === PIPELINE START ===
2025-11-23 17:05:00,003 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 17:05:00,864 INFO: ดึง 2025-11-23 16:00:00+07:00 - 2025-11-23 17:00:00+07:00 → 2 แถว
2025-11-23 17:05:00,892 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:00,893 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 17:05:00,893 INFO: Fetch สำเร็จ
2025-11-23 17:05:00,906 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-23 17:05:01,627 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:01,629 INFO: เติม 2025-11-21 17:00 → +2
2025-11-23 17:05:03,369 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:03,369 INFO: เติม 2025-11-21 18:00 → +2
2025-11-23 17:05:05,146 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:05,146 INFO: เติม 2025-11-21 19:00 → +2
2025-11-23 17:05:06,896 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:06,896 INFO: เติม 2025-11-21 20:00 → +2
2025-11-23 17:05:08,638 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:08,639 INFO: เติม 2025-11-21 21:00 → +2
2025-11-23 17:05:10,395 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:10,395 INFO: เติม 2025-11-21 22:00 → +2
2025-11-23 17:05:12,163 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:12,163 INFO: เติม 2025-11-21 23:00 → +2
2025-11-23 17:05:13,879 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:13,880 INFO: เติม 2025-11-22 00:00 → +2
2025-11-23 17:05:15,594 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:15,595 INFO: เติม 2025-11-22 01:00 → +2
2025-11-23 17:05:17,341 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:17,341 INFO: เติม 2025-11-22 02:00 → +2
2025-11-23 17:05:19,054 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:19,054 INFO: เติม 2025-11-22 03:00 → +2
2025-11-23 17:05:20,855 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:20,855 INFO: เติม 2025-11-22 04:00 → +2
2025-11-23 17:05:22,649 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:22,649 INFO: เติม 2025-11-22 05:00 → +2
2025-11-23 17:05:24,369 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:24,369 INFO: เติม 2025-11-22 06:00 → +2
2025-11-23 17:05:26,085 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:26,086 INFO: เติม 2025-11-22 07:00 → +2
2025-11-23 17:05:27,755 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:27,756 INFO: เติม 2025-11-22 08:00 → +2
2025-11-23 17:05:29,465 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:29,466 INFO: เติม 2025-11-22 09:00 → +2
2025-11-23 17:05:31,128 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:31,128 INFO: เติม 2025-11-22 10:00 → +2
2025-11-23 17:05:32,802 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:32,802 INFO: เติม 2025-11-22 11:00 → +2
2025-11-23 17:05:34,507 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:34,507 INFO: เติม 2025-11-22 12:00 → +2
2025-11-23 17:05:36,155 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:36,155 INFO: เติม 2025-11-22 13:00 → +2
2025-11-23 17:05:37,859 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:37,859 INFO: เติม 2025-11-22 14:00 → +2
2025-11-23 17:05:39,593 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:39,594 INFO: เติม 2025-11-22 15:00 → +2
2025-11-23 17:05:41,326 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:41,327 INFO: เติม 2025-11-22 16:00 → +2
2025-11-23 17:05:43,019 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:43,019 INFO: เติม 2025-11-22 17:00 → +2
2025-11-23 17:05:44,707 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:44,707 INFO: เติม 2025-11-22 18:00 → +2
2025-11-23 17:05:46,496 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:46,496 INFO: เติม 2025-11-22 19:00 → +2
2025-11-23 17:05:48,210 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:48,210 INFO: เติม 2025-11-22 20:00 → +2
2025-11-23 17:05:49,864 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:49,864 INFO: เติม 2025-11-22 21:00 → +2
2025-11-23 17:05:51,563 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:51,564 INFO: เติม 2025-11-22 22:00 → +2
2025-11-23 17:05:53,304 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:53,305 INFO: เติม 2025-11-22 23:00 → +2
2025-11-23 17:05:54,966 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:54,966 INFO: เติม 2025-11-23 00:00 → +2
2025-11-23 17:05:56,653 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:56,654 INFO: เติม 2025-11-23 01:00 → +2
2025-11-23 17:05:58,359 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:05:58,360 INFO: เติม 2025-11-23 02:00 → +2
2025-11-23 17:06:00,044 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:00,045 INFO: เติม 2025-11-23 03:00 → +2
2025-11-23 17:06:01,711 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:01,711 INFO: เติม 2025-11-23 04:00 → +2
2025-11-23 17:06:03,423 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:03,424 INFO: เติม 2025-11-23 05:00 → +2
2025-11-23 17:06:05,155 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:05,156 INFO: เติม 2025-11-23 06:00 → +2
2025-11-23 17:06:06,941 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:06,942 INFO: เติม 2025-11-23 07:00 → +2
2025-11-23 17:06:08,657 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:08,657 INFO: เติม 2025-11-23 08:00 → +2
2025-11-23 17:06:10,337 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:10,337 INFO: เติม 2025-11-23 09:00 → +2
2025-11-23 17:06:12,091 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:12,091 INFO: เติม 2025-11-23 10:00 → +2
2025-11-23 17:06:13,797 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:13,798 INFO: เติม 2025-11-23 11:00 → +2
2025-11-23 17:06:15,527 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:15,528 INFO: เติม 2025-11-23 12:00 → +2
2025-11-23 17:06:17,286 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:17,286 INFO: เติม 2025-11-23 13:00 → +2
2025-11-23 17:06:19,011 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:19,012 INFO: เติม 2025-11-23 14:00 → +2
2025-11-23 17:06:20,728 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:20,728 INFO: เติม 2025-11-23 15:00 → +2
2025-11-23 17:06:22,523 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:22,523 INFO: เติม 2025-11-23 16:00 → +2
2025-11-23 17:06:24,268 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-23 17:06:24,268 INFO: เติม 2025-11-23 17:00 → +1
2025-11-23 17:06:25,281 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-23 17:06:25,298 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 198 แถว
2025-11-23 17:06:25,299 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 17:06:25,309 INFO: รวมเก่า 197 + ใหม่ 198 → 198 (เพิ่ม 1)
2025-11-23 17:06:25,310 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 17:06:25,310 INFO: Format สำเร็จ: +1 แถว
2025-11-23 17:06:25,319 INFO: เริ่ม clean ข้อมูล: 198 แถว
2025-11-23 17:06:25,328 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (198 แถว)
2025-11-23 17:06:25,330 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 17:00:00          45.6           16.6       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 11:00:00          60.1           16.3       1.1 145.8       27.4    47.8     1015.4
2025-11-23 10:00:00          61.1           20.3       1.0 141.1       26.2    50.5     1015.5
2025-11-23 09:00:00          49.9           26.5       1.0 143.4       24.9    54.0     1015.2
2025-11-23 08:00:00          48.3           20.2       0.8 139.4       23.9    57.2     1014.4
2025-11-23 17:06:25,332 INFO: เตรียมโหลด 198 แถว
2025-11-23 17:06:25,335 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-23 17:06:25,336 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-23 17:06:25,337 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-23 17:06:25,338 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-23 17:06:25,340 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-23 17:06:25,341 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-23 17:06:25,342 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-23 17:06:25,343 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-23 17:06:25,344 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-23 17:06:25,346 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-23 17:06:25,347 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-23 17:06:25,348 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-23 17:06:25,349 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 17:06:25,350 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-23 17:06:25,351 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-23 17:06:25,352 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-23 17:06:25,353 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-23 17:06:25,355 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-23 17:06:25,356 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-23 17:06:25,357 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-23 17:06:25,358 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-23 17:06:25,360 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-23 17:06:25,361 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 17:06:25,362 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-23 17:06:25,363 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-23 17:06:25,364 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-23 17:06:25,365 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-23 17:06:25,366 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-23 17:06:25,368 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 17:06:25,369 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-23 17:06:25,370 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-23 17:06:25,371 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-23 17:06:25,372 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-23 17:06:25,374 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-23 17:06:25,375 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-23 17:06:25,376 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-23 17:06:25,378 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-23 17:06:25,379 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 17:06:25,380 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-23 17:06:25,381 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-23 17:06:25,382 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-23 17:06:25,383 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-23 17:06:25,385 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-23 17:06:25,386 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-23 17:06:25,387 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-23 17:06:25,388 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-23 17:06:25,389 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-23 17:06:25,391 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-23 17:06:25,392 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-23 17:06:25,393 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-23 17:06:25,395 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-23 17:06:25,396 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-23 17:06:25,397 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-23 17:06:25,398 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-23 17:06:25,399 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-23 17:06:25,401 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-23 17:06:25,402 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-23 17:06:25,403 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-23 17:06:25,404 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-23 17:06:25,406 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-23 17:06:25,407 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-23 17:06:25,408 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-23 17:06:25,409 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-23 17:06:25,410 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-23 17:06:25,411 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-23 17:06:25,412 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-23 17:06:25,413 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-23 17:06:25,414 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-23 17:06:25,415 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-23 17:06:25,416 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-23 17:06:25,417 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-23 17:06:25,419 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-23 17:06:25,420 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-23 17:06:25,421 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-23 17:06:25,423 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-23 17:06:25,424 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-23 17:06:25,425 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-23 17:06:25,426 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-23 17:06:25,428 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-23 17:06:25,429 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-23 17:06:25,430 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-23 17:06:25,431 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 17:06:25,432 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-23 17:06:25,434 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-23 17:06:25,435 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-23 17:06:25,436 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-23 17:06:25,437 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 17:06:25,438 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-23 17:06:25,440 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-23 17:06:25,441 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-23 17:06:25,442 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-23 17:06:25,443 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-23 17:06:25,444 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-23 17:06:25,445 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-23 17:06:25,446 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-23 17:06:25,448 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-23 17:06:25,449 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-23 17:06:25,450 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-23 17:06:25,451 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-23 17:06:25,452 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-23 17:06:25,454 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-23 17:06:25,455 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-23 17:06:25,456 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-23 17:06:25,458 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-23 17:06:25,459 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-23 17:06:25,460 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-23 17:06:25,461 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-23 17:06:25,462 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-23 17:06:25,463 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-23 17:06:25,464 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-23 17:06:25,465 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-23 17:06:25,466 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-23 17:06:25,467 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-23 17:06:25,469 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-23 17:06:25,470 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-23 17:06:25,471 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-23 17:06:25,472 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-23 17:06:25,474 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-23 17:06:25,475 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-23 17:06:25,476 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-23 17:06:25,477 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-23 17:06:25,478 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-23 17:06:25,480 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-23 17:06:25,481 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-23 17:06:25,482 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-23 17:06:25,483 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-23 17:06:25,484 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-23 17:06:25,486 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-23 17:06:25,487 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-23 17:06:25,488 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 17:06:25,490 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-23 17:06:25,491 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-23 17:06:25,492 INFO: อัปเดต DB สำเร็จ: 2025-11-21 00:00:00+07:00 → PM2.5 = 16.0
2025-11-23 17:06:25,493 INFO: อัปเดต DB สำเร็จ: 2025-11-21 01:00:00+07:00 → PM2.5 = 13.5
2025-11-23 17:06:25,494 INFO: อัปเดต DB สำเร็จ: 2025-11-21 02:00:00+07:00 → PM2.5 = 9.3
2025-11-23 17:06:25,495 INFO: อัปเดต DB สำเร็จ: 2025-11-21 03:00:00+07:00 → PM2.5 = 16.2
2025-11-23 17:06:25,497 INFO: อัปเดต DB สำเร็จ: 2025-11-21 04:00:00+07:00 → PM2.5 = 15.4
2025-11-23 17:06:25,498 INFO: อัปเดต DB สำเร็จ: 2025-11-21 05:00:00+07:00 → PM2.5 = 17.2
2025-11-23 17:06:25,499 INFO: อัปเดต DB สำเร็จ: 2025-11-21 06:00:00+07:00 → PM2.5 = 18.0
2025-11-23 17:06:25,501 INFO: อัปเดต DB สำเร็จ: 2025-11-21 07:00:00+07:00 → PM2.5 = 15.7
2025-11-23 17:06:25,502 INFO: อัปเดต DB สำเร็จ: 2025-11-21 08:00:00+07:00 → PM2.5 = 14.6
2025-11-23 17:06:25,503 INFO: อัปเดต DB สำเร็จ: 2025-11-21 09:00:00+07:00 → PM2.5 = 20.8
2025-11-23 17:06:25,504 INFO: อัปเดต DB สำเร็จ: 2025-11-21 10:00:00+07:00 → PM2.5 = 13.9
2025-11-23 17:06:25,505 INFO: อัปเดต DB สำเร็จ: 2025-11-21 11:00:00+07:00 → PM2.5 = 14.4
2025-11-23 17:06:25,506 INFO: อัปเดต DB สำเร็จ: 2025-11-21 12:00:00+07:00 → PM2.5 = 10.4
2025-11-23 17:06:25,508 INFO: อัปเดต DB สำเร็จ: 2025-11-21 13:00:00+07:00 → PM2.5 = 8.5
2025-11-23 17:06:25,509 INFO: อัปเดต DB สำเร็จ: 2025-11-21 14:00:00+07:00 → PM2.5 = 10.4
2025-11-23 17:06:25,510 INFO: อัปเดต DB สำเร็จ: 2025-11-21 15:00:00+07:00 → PM2.5 = 17.6
2025-11-23 17:06:25,512 INFO: อัปเดต DB สำเร็จ: 2025-11-21 16:00:00+07:00 → PM2.5 = 19.0
2025-11-23 17:06:25,513 INFO: อัปเดต DB สำเร็จ: 2025-11-21 17:00:00+07:00 → PM2.5 = 15.7
2025-11-23 17:06:25,514 INFO: อัปเดต DB สำเร็จ: 2025-11-21 18:00:00+07:00 → PM2.5 = 19.4
2025-11-23 17:06:25,515 INFO: อัปเดต DB สำเร็จ: 2025-11-21 19:00:00+07:00 → PM2.5 = 19.2
2025-11-23 17:06:25,517 INFO: อัปเดต DB สำเร็จ: 2025-11-21 20:00:00+07:00 → PM2.5 = 19.8
2025-11-23 17:06:25,518 INFO: อัปเดต DB สำเร็จ: 2025-11-21 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 17:06:25,519 INFO: อัปเดต DB สำเร็จ: 2025-11-21 22:00:00+07:00 → PM2.5 = 22.8
2025-11-23 17:06:25,520 INFO: อัปเดต DB สำเร็จ: 2025-11-21 23:00:00+07:00 → PM2.5 = 19.2
2025-11-23 17:06:25,522 INFO: อัปเดต DB สำเร็จ: 2025-11-22 00:00:00+07:00 → PM2.5 = 15.5
2025-11-23 17:06:25,523 INFO: อัปเดต DB สำเร็จ: 2025-11-22 01:00:00+07:00 → PM2.5 = 14.8
2025-11-23 17:06:25,524 INFO: อัปเดต DB สำเร็จ: 2025-11-22 02:00:00+07:00 → PM2.5 = 11.0
2025-11-23 17:06:25,525 INFO: อัปเดต DB สำเร็จ: 2025-11-22 03:00:00+07:00 → PM2.5 = 15.5
2025-11-23 17:06:25,526 INFO: อัปเดต DB สำเร็จ: 2025-11-22 04:00:00+07:00 → PM2.5 = 13.3
2025-11-23 17:06:25,527 INFO: อัปเดต DB สำเร็จ: 2025-11-22 05:00:00+07:00 → PM2.5 = 14.3
2025-11-23 17:06:25,528 INFO: อัปเดต DB สำเร็จ: 2025-11-22 06:00:00+07:00 → PM2.5 = 22.1
2025-11-23 17:06:25,529 INFO: อัปเดต DB สำเร็จ: 2025-11-22 07:00:00+07:00 → PM2.5 = 18.8
2025-11-23 17:06:25,533 INFO: อัปเดต DB สำเร็จ: 2025-11-22 08:00:00+07:00 → PM2.5 = 20.6
2025-11-23 17:06:25,534 INFO: อัปเดต DB สำเร็จ: 2025-11-22 09:00:00+07:00 → PM2.5 = 19.0
2025-11-23 17:06:25,535 INFO: อัปเดต DB สำเร็จ: 2025-11-22 10:00:00+07:00 → PM2.5 = 10.5
2025-11-23 17:06:25,537 INFO: อัปเดต DB สำเร็จ: 2025-11-22 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 17:06:25,538 INFO: อัปเดต DB สำเร็จ: 2025-11-22 12:00:00+07:00 → PM2.5 = 6.8
2025-11-23 17:06:25,539 INFO: อัปเดต DB สำเร็จ: 2025-11-22 13:00:00+07:00 → PM2.5 = 7.3
2025-11-23 17:06:25,540 INFO: อัปเดต DB สำเร็จ: 2025-11-22 14:00:00+07:00 → PM2.5 = 7.8
2025-11-23 17:06:25,541 INFO: อัปเดต DB สำเร็จ: 2025-11-22 15:00:00+07:00 → PM2.5 = 8.9
2025-11-23 17:06:25,542 INFO: อัปเดต DB สำเร็จ: 2025-11-22 16:00:00+07:00 → PM2.5 = 14.4
2025-11-23 17:06:25,543 INFO: อัปเดต DB สำเร็จ: 2025-11-22 17:00:00+07:00 → PM2.5 = 18.2
2025-11-23 17:06:25,543 INFO: อัปเดต DB สำเร็จ: 2025-11-22 18:00:00+07:00 → PM2.5 = 10.5
2025-11-23 17:06:25,546 INFO: อัปเดต DB สำเร็จ: 2025-11-22 19:00:00+07:00 → PM2.5 = 14.9
2025-11-23 17:06:25,547 INFO: อัปเดต DB สำเร็จ: 2025-11-22 20:00:00+07:00 → PM2.5 = 22.7
2025-11-23 17:06:25,548 INFO: อัปเดต DB สำเร็จ: 2025-11-22 21:00:00+07:00 → PM2.5 = 20.9
2025-11-23 17:06:25,549 INFO: อัปเดต DB สำเร็จ: 2025-11-22 22:00:00+07:00 → PM2.5 = 26.4
2025-11-23 17:06:25,550 INFO: อัปเดต DB สำเร็จ: 2025-11-22 23:00:00+07:00 → PM2.5 = 24.0
2025-11-23 17:06:25,551 INFO: อัปเดต DB สำเร็จ: 2025-11-23 00:00:00+07:00 → PM2.5 = 15.4
2025-11-23 17:06:25,553 INFO: อัปเดต DB สำเร็จ: 2025-11-23 01:00:00+07:00 → PM2.5 = 17.4
2025-11-23 17:06:25,553 INFO: อัปเดต DB สำเร็จ: 2025-11-23 02:00:00+07:00 → PM2.5 = 20.2
2025-11-23 17:06:25,555 INFO: อัปเดต DB สำเร็จ: 2025-11-23 03:00:00+07:00 → PM2.5 = 22.8
2025-11-23 17:06:25,556 INFO: อัปเดต DB สำเร็จ: 2025-11-23 04:00:00+07:00 → PM2.5 = 21.1
2025-11-23 17:06:25,557 INFO: อัปเดต DB สำเร็จ: 2025-11-23 05:00:00+07:00 → PM2.5 = 22.0
2025-11-23 17:06:25,558 INFO: อัปเดต DB สำเร็จ: 2025-11-23 06:00:00+07:00 → PM2.5 = 19.6
2025-11-23 17:06:25,559 INFO: อัปเดต DB สำเร็จ: 2025-11-23 07:00:00+07:00 → PM2.5 = 22.1
2025-11-23 17:06:25,560 INFO: อัปเดต DB สำเร็จ: 2025-11-23 08:00:00+07:00 → PM2.5 = 20.2
2025-11-23 17:06:25,562 INFO: อัปเดต DB สำเร็จ: 2025-11-23 09:00:00+07:00 → PM2.5 = 26.5
2025-11-23 17:06:25,563 INFO: อัปเดต DB สำเร็จ: 2025-11-23 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 17:06:25,564 INFO: อัปเดต DB สำเร็จ: 2025-11-23 11:00:00+07:00 → PM2.5 = 16.3
2025-11-23 17:06:25,565 INFO: อัปเดต DB สำเร็จ: 2025-11-23 12:00:00+07:00 → PM2.5 = 19.0
2025-11-23 17:06:25,566 INFO: อัปเดต DB สำเร็จ: 2025-11-23 13:00:00+07:00 → PM2.5 = 15.3
2025-11-23 17:06:25,568 INFO: อัปเดต DB สำเร็จ: 2025-11-23 14:00:00+07:00 → PM2.5 = 11.5
2025-11-23 17:06:25,569 INFO: อัปเดต DB สำเร็จ: 2025-11-23 15:00:00+07:00 → PM2.5 = 16.5
2025-11-23 17:06:25,570 INFO: อัปเดต DB สำเร็จ: 2025-11-23 16:00:00+07:00 → PM2.5 = 16.6
2025-11-23 17:06:25,571 INFO: อัปเดต DB สำเร็จ: 2025-11-23 17:00:00+07:00 → PM2.5 = 16.6
2025-11-23 17:06:25,571 INFO: โหลด DB สำเร็จ
2025-11-23 17:06:25,573 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 17:06:25,576 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 17:06:25,576 INFO: Load to DB + Backup สำเร็จ
2025-11-23 17:06:25,576 INFO: === PIPELINE END ===

2025-11-23 17:06:25,576 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 18:05:00 +07)" executed successfully
2025-11-23 18:05:01,587 WARNING: Run time of job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 19:05:00 +07)" was missed by 0:00:01.587934
2025-11-23 19:05:00,016 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 20:05:00 +07)" (scheduled at 2025-11-23 19:05:00+07:00)
2025-11-23 19:05:00,019 INFO: === PIPELINE START ===
2025-11-23 19:05:00,019 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 19:05:00,712 INFO: ดึง 2025-11-23 18:00:00+07:00 - 2025-11-23 19:00:00+07:00 → 2 แถว
2025-11-23 19:05:00,721 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:00,723 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 19:05:00,723 INFO: Fetch สำเร็จ
2025-11-23 19:05:00,751 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-23 19:05:01,393 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:01,394 INFO: เติม 2025-11-21 19:00 → +2
2025-11-23 19:05:03,100 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:03,100 INFO: เติม 2025-11-21 20:00 → +2
2025-11-23 19:05:04,748 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:04,749 INFO: เติม 2025-11-21 21:00 → +2
2025-11-23 19:05:06,410 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:06,410 INFO: เติม 2025-11-21 22:00 → +2
2025-11-23 19:05:08,113 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:08,114 INFO: เติม 2025-11-21 23:00 → +2
2025-11-23 19:05:09,796 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:09,796 INFO: เติม 2025-11-22 00:00 → +2
2025-11-23 19:05:11,441 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:11,443 INFO: เติม 2025-11-22 01:00 → +2
2025-11-23 19:05:13,137 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:13,137 INFO: เติม 2025-11-22 02:00 → +2
2025-11-23 19:05:14,857 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:14,858 INFO: เติม 2025-11-22 03:00 → +2
2025-11-23 19:05:16,608 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:16,608 INFO: เติม 2025-11-22 04:00 → +2
2025-11-23 19:05:18,408 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:18,408 INFO: เติม 2025-11-22 05:00 → +2
2025-11-23 19:05:20,184 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:20,184 INFO: เติม 2025-11-22 06:00 → +2
2025-11-23 19:05:21,949 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:21,949 INFO: เติม 2025-11-22 07:00 → +2
2025-11-23 19:05:23,700 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:23,701 INFO: เติม 2025-11-22 08:00 → +2
2025-11-23 19:05:25,410 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:25,410 INFO: เติม 2025-11-22 09:00 → +2
2025-11-23 19:05:27,161 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:27,161 INFO: เติม 2025-11-22 10:00 → +2
2025-11-23 19:05:28,915 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:28,915 INFO: เติม 2025-11-22 11:00 → +2
2025-11-23 19:05:30,754 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:30,754 INFO: เติม 2025-11-22 12:00 → +2
2025-11-23 19:05:32,554 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:32,555 INFO: เติม 2025-11-22 13:00 → +2
2025-11-23 19:05:34,274 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:34,275 INFO: เติม 2025-11-22 14:00 → +2
2025-11-23 19:05:36,036 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:36,036 INFO: เติม 2025-11-22 15:00 → +2
2025-11-23 19:05:37,908 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:37,908 INFO: เติม 2025-11-22 16:00 → +2
2025-11-23 19:05:39,627 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:39,627 INFO: เติม 2025-11-22 17:00 → +2
2025-11-23 19:05:41,301 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:41,301 INFO: เติม 2025-11-22 18:00 → +2
2025-11-23 19:05:42,975 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:42,976 INFO: เติม 2025-11-22 19:00 → +2
2025-11-23 19:05:44,673 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:44,674 INFO: เติม 2025-11-22 20:00 → +2
2025-11-23 19:05:46,409 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:46,410 INFO: เติม 2025-11-22 21:00 → +2
2025-11-23 19:05:48,098 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:48,099 INFO: เติม 2025-11-22 22:00 → +2
2025-11-23 19:05:49,794 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:49,794 INFO: เติม 2025-11-22 23:00 → +2
2025-11-23 19:05:51,557 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:51,557 INFO: เติม 2025-11-23 00:00 → +2
2025-11-23 19:05:53,311 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:53,311 INFO: เติม 2025-11-23 01:00 → +2
2025-11-23 19:05:55,074 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:55,074 INFO: เติม 2025-11-23 02:00 → +2
2025-11-23 19:05:56,796 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:56,796 INFO: เติม 2025-11-23 03:00 → +2
2025-11-23 19:05:58,462 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:05:58,463 INFO: เติม 2025-11-23 04:00 → +2
2025-11-23 19:06:00,155 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:00,156 INFO: เติม 2025-11-23 05:00 → +2
2025-11-23 19:06:01,857 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:01,857 INFO: เติม 2025-11-23 06:00 → +2
2025-11-23 19:06:03,528 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:03,529 INFO: เติม 2025-11-23 07:00 → +2
2025-11-23 19:06:05,262 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:05,263 INFO: เติม 2025-11-23 08:00 → +2
2025-11-23 19:06:07,079 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:07,080 INFO: เติม 2025-11-23 09:00 → +2
2025-11-23 19:06:08,857 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:08,857 INFO: เติม 2025-11-23 10:00 → +2
2025-11-23 19:06:10,582 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:10,582 INFO: เติม 2025-11-23 11:00 → +2
2025-11-23 19:06:12,397 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:12,397 INFO: เติม 2025-11-23 12:00 → +2
2025-11-23 19:06:14,147 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:14,148 INFO: เติม 2025-11-23 13:00 → +2
2025-11-23 19:06:15,911 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:15,911 INFO: เติม 2025-11-23 14:00 → +2
2025-11-23 19:06:17,694 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:17,695 INFO: เติม 2025-11-23 15:00 → +2
2025-11-23 19:06:19,456 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:19,457 INFO: เติม 2025-11-23 16:00 → +2
2025-11-23 19:06:21,208 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:21,209 INFO: เติม 2025-11-23 17:00 → +2
2025-11-23 19:06:22,871 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:22,872 INFO: เติม 2025-11-23 18:00 → +2
2025-11-23 19:06:24,607 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-23 19:06:24,607 INFO: เติม 2025-11-23 19:00 → +1
2025-11-23 19:06:25,621 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-23 19:06:25,636 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 200 แถว
2025-11-23 19:06:25,637 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 19:06:25,639 INFO: รวมเก่า 198 + ใหม่ 200 → 200 (เพิ่ม 2)
2025-11-23 19:06:25,640 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 19:06:25,641 INFO: Format สำเร็จ: +2 แถว
2025-11-23 19:06:25,650 INFO: เริ่ม clean ข้อมูล: 200 แถว
2025-11-23 19:06:25,661 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (200 แถว)
2025-11-23 19:06:25,663 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 19:00:00          51.0           16.3       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 11:00:00          60.1           16.3       1.1 145.8       27.4    47.8     1015.4
2025-11-23 10:00:00          61.1           20.3       1.0 141.1       26.2    50.5     1015.5
2025-11-23 19:06:25,665 INFO: เตรียมโหลด 200 แถว
2025-11-23 19:06:25,670 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-23 19:06:25,672 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-23 19:06:25,674 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-23 19:06:25,675 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-23 19:06:25,676 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-23 19:06:25,677 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-23 19:06:25,679 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-23 19:06:25,680 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-23 19:06:25,681 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-23 19:06:25,682 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-23 19:06:25,683 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-23 19:06:25,685 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-23 19:06:25,686 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 19:06:25,688 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-23 19:06:25,689 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-23 19:06:25,690 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-23 19:06:25,692 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-23 19:06:25,693 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-23 19:06:25,694 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-23 19:06:25,695 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-23 19:06:25,696 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-23 19:06:25,697 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-23 19:06:25,698 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 19:06:25,700 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-23 19:06:25,701 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-23 19:06:25,702 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-23 19:06:25,704 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-23 19:06:25,705 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-23 19:06:25,706 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 19:06:25,707 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-23 19:06:25,709 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-23 19:06:25,710 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-23 19:06:25,711 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-23 19:06:25,711 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-23 19:06:25,712 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-23 19:06:25,714 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-23 19:06:25,716 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-23 19:06:25,717 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 19:06:25,718 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-23 19:06:25,720 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-23 19:06:25,721 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-23 19:06:25,722 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-23 19:06:25,725 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-23 19:06:25,726 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-23 19:06:25,728 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-23 19:06:25,729 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-23 19:06:25,731 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-23 19:06:25,733 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-23 19:06:25,734 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-23 19:06:25,736 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-23 19:06:25,737 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-23 19:06:25,739 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-23 19:06:25,740 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-23 19:06:25,741 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-23 19:06:25,743 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-23 19:06:25,744 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-23 19:06:25,746 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-23 19:06:25,747 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-23 19:06:25,748 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-23 19:06:25,750 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-23 19:06:25,751 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-23 19:06:25,752 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-23 19:06:25,753 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-23 19:06:25,754 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-23 19:06:25,756 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-23 19:06:25,757 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-23 19:06:25,758 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-23 19:06:25,759 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-23 19:06:25,761 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-23 19:06:25,762 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-23 19:06:25,764 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-23 19:06:25,765 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-23 19:06:25,766 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-23 19:06:25,768 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-23 19:06:25,769 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-23 19:06:25,770 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-23 19:06:25,771 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-23 19:06:25,774 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-23 19:06:25,775 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-23 19:06:25,777 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-23 19:06:25,778 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-23 19:06:25,780 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 19:06:25,781 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-23 19:06:25,782 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-23 19:06:25,783 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-23 19:06:25,785 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-23 19:06:25,786 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 19:06:25,788 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-23 19:06:25,789 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-23 19:06:25,790 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-23 19:06:25,792 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-23 19:06:25,793 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-23 19:06:25,794 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-23 19:06:25,796 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-23 19:06:25,797 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-23 19:06:25,798 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-23 19:06:25,800 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-23 19:06:25,801 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-23 19:06:25,803 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-23 19:06:25,804 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-23 19:06:25,805 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-23 19:06:25,806 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-23 19:06:25,808 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-23 19:06:25,809 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-23 19:06:25,811 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-23 19:06:25,813 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-23 19:06:25,814 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-23 19:06:25,815 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-23 19:06:25,817 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-23 19:06:25,818 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-23 19:06:25,820 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-23 19:06:25,821 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-23 19:06:25,822 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-23 19:06:25,824 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-23 19:06:25,825 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-23 19:06:25,827 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-23 19:06:25,828 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-23 19:06:25,829 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-23 19:06:25,830 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-23 19:06:25,831 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-23 19:06:25,832 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-23 19:06:25,834 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-23 19:06:25,835 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-23 19:06:25,836 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-23 19:06:25,838 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-23 19:06:25,839 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-23 19:06:25,840 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-23 19:06:25,842 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-23 19:06:25,844 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-23 19:06:25,845 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 19:06:25,847 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-23 19:06:25,848 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-23 19:06:25,849 INFO: อัปเดต DB สำเร็จ: 2025-11-21 00:00:00+07:00 → PM2.5 = 16.0
2025-11-23 19:06:25,851 INFO: อัปเดต DB สำเร็จ: 2025-11-21 01:00:00+07:00 → PM2.5 = 13.5
2025-11-23 19:06:25,852 INFO: อัปเดต DB สำเร็จ: 2025-11-21 02:00:00+07:00 → PM2.5 = 9.3
2025-11-23 19:06:25,853 INFO: อัปเดต DB สำเร็จ: 2025-11-21 03:00:00+07:00 → PM2.5 = 16.2
2025-11-23 19:06:25,855 INFO: อัปเดต DB สำเร็จ: 2025-11-21 04:00:00+07:00 → PM2.5 = 15.4
2025-11-23 19:06:25,856 INFO: อัปเดต DB สำเร็จ: 2025-11-21 05:00:00+07:00 → PM2.5 = 17.2
2025-11-23 19:06:25,857 INFO: อัปเดต DB สำเร็จ: 2025-11-21 06:00:00+07:00 → PM2.5 = 18.0
2025-11-23 19:06:25,859 INFO: อัปเดต DB สำเร็จ: 2025-11-21 07:00:00+07:00 → PM2.5 = 15.7
2025-11-23 19:06:25,860 INFO: อัปเดต DB สำเร็จ: 2025-11-21 08:00:00+07:00 → PM2.5 = 14.6
2025-11-23 19:06:25,861 INFO: อัปเดต DB สำเร็จ: 2025-11-21 09:00:00+07:00 → PM2.5 = 20.8
2025-11-23 19:06:25,863 INFO: อัปเดต DB สำเร็จ: 2025-11-21 10:00:00+07:00 → PM2.5 = 13.9
2025-11-23 19:06:25,864 INFO: อัปเดต DB สำเร็จ: 2025-11-21 11:00:00+07:00 → PM2.5 = 14.4
2025-11-23 19:06:25,865 INFO: อัปเดต DB สำเร็จ: 2025-11-21 12:00:00+07:00 → PM2.5 = 10.4
2025-11-23 19:06:25,866 INFO: อัปเดต DB สำเร็จ: 2025-11-21 13:00:00+07:00 → PM2.5 = 8.5
2025-11-23 19:06:25,868 INFO: อัปเดต DB สำเร็จ: 2025-11-21 14:00:00+07:00 → PM2.5 = 10.4
2025-11-23 19:06:25,869 INFO: อัปเดต DB สำเร็จ: 2025-11-21 15:00:00+07:00 → PM2.5 = 17.6
2025-11-23 19:06:25,871 INFO: อัปเดต DB สำเร็จ: 2025-11-21 16:00:00+07:00 → PM2.5 = 19.0
2025-11-23 19:06:25,873 INFO: อัปเดต DB สำเร็จ: 2025-11-21 17:00:00+07:00 → PM2.5 = 15.7
2025-11-23 19:06:25,874 INFO: อัปเดต DB สำเร็จ: 2025-11-21 18:00:00+07:00 → PM2.5 = 19.4
2025-11-23 19:06:25,875 INFO: อัปเดต DB สำเร็จ: 2025-11-21 19:00:00+07:00 → PM2.5 = 19.2
2025-11-23 19:06:25,876 INFO: อัปเดต DB สำเร็จ: 2025-11-21 20:00:00+07:00 → PM2.5 = 19.8
2025-11-23 19:06:25,877 INFO: อัปเดต DB สำเร็จ: 2025-11-21 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 19:06:25,878 INFO: อัปเดต DB สำเร็จ: 2025-11-21 22:00:00+07:00 → PM2.5 = 22.8
2025-11-23 19:06:25,880 INFO: อัปเดต DB สำเร็จ: 2025-11-21 23:00:00+07:00 → PM2.5 = 19.2
2025-11-23 19:06:25,882 INFO: อัปเดต DB สำเร็จ: 2025-11-22 00:00:00+07:00 → PM2.5 = 15.5
2025-11-23 19:06:25,883 INFO: อัปเดต DB สำเร็จ: 2025-11-22 01:00:00+07:00 → PM2.5 = 14.8
2025-11-23 19:06:25,884 INFO: อัปเดต DB สำเร็จ: 2025-11-22 02:00:00+07:00 → PM2.5 = 11.0
2025-11-23 19:06:25,885 INFO: อัปเดต DB สำเร็จ: 2025-11-22 03:00:00+07:00 → PM2.5 = 15.5
2025-11-23 19:06:25,887 INFO: อัปเดต DB สำเร็จ: 2025-11-22 04:00:00+07:00 → PM2.5 = 13.3
2025-11-23 19:06:25,888 INFO: อัปเดต DB สำเร็จ: 2025-11-22 05:00:00+07:00 → PM2.5 = 14.3
2025-11-23 19:06:25,890 INFO: อัปเดต DB สำเร็จ: 2025-11-22 06:00:00+07:00 → PM2.5 = 22.1
2025-11-23 19:06:25,891 INFO: อัปเดต DB สำเร็จ: 2025-11-22 07:00:00+07:00 → PM2.5 = 18.8
2025-11-23 19:06:25,893 INFO: อัปเดต DB สำเร็จ: 2025-11-22 08:00:00+07:00 → PM2.5 = 20.6
2025-11-23 19:06:25,894 INFO: อัปเดต DB สำเร็จ: 2025-11-22 09:00:00+07:00 → PM2.5 = 19.0
2025-11-23 19:06:25,894 INFO: อัปเดต DB สำเร็จ: 2025-11-22 10:00:00+07:00 → PM2.5 = 10.5
2025-11-23 19:06:25,897 INFO: อัปเดต DB สำเร็จ: 2025-11-22 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 19:06:25,898 INFO: อัปเดต DB สำเร็จ: 2025-11-22 12:00:00+07:00 → PM2.5 = 6.8
2025-11-23 19:06:25,899 INFO: อัปเดต DB สำเร็จ: 2025-11-22 13:00:00+07:00 → PM2.5 = 7.3
2025-11-23 19:06:25,900 INFO: อัปเดต DB สำเร็จ: 2025-11-22 14:00:00+07:00 → PM2.5 = 7.8
2025-11-23 19:06:25,902 INFO: อัปเดต DB สำเร็จ: 2025-11-22 15:00:00+07:00 → PM2.5 = 8.9
2025-11-23 19:06:25,904 INFO: อัปเดต DB สำเร็จ: 2025-11-22 16:00:00+07:00 → PM2.5 = 14.4
2025-11-23 19:06:25,905 INFO: อัปเดต DB สำเร็จ: 2025-11-22 17:00:00+07:00 → PM2.5 = 18.2
2025-11-23 19:06:25,907 INFO: อัปเดต DB สำเร็จ: 2025-11-22 18:00:00+07:00 → PM2.5 = 10.5
2025-11-23 19:06:25,908 INFO: อัปเดต DB สำเร็จ: 2025-11-22 19:00:00+07:00 → PM2.5 = 14.9
2025-11-23 19:06:25,909 INFO: อัปเดต DB สำเร็จ: 2025-11-22 20:00:00+07:00 → PM2.5 = 22.7
2025-11-23 19:06:25,911 INFO: อัปเดต DB สำเร็จ: 2025-11-22 21:00:00+07:00 → PM2.5 = 20.9
2025-11-23 19:06:25,912 INFO: อัปเดต DB สำเร็จ: 2025-11-22 22:00:00+07:00 → PM2.5 = 26.4
2025-11-23 19:06:25,913 INFO: อัปเดต DB สำเร็จ: 2025-11-22 23:00:00+07:00 → PM2.5 = 24.0
2025-11-23 19:06:25,914 INFO: อัปเดต DB สำเร็จ: 2025-11-23 00:00:00+07:00 → PM2.5 = 15.4
2025-11-23 19:06:25,916 INFO: อัปเดต DB สำเร็จ: 2025-11-23 01:00:00+07:00 → PM2.5 = 17.4
2025-11-23 19:06:25,917 INFO: อัปเดต DB สำเร็จ: 2025-11-23 02:00:00+07:00 → PM2.5 = 20.2
2025-11-23 19:06:25,918 INFO: อัปเดต DB สำเร็จ: 2025-11-23 03:00:00+07:00 → PM2.5 = 22.8
2025-11-23 19:06:25,920 INFO: อัปเดต DB สำเร็จ: 2025-11-23 04:00:00+07:00 → PM2.5 = 21.1
2025-11-23 19:06:25,921 INFO: อัปเดต DB สำเร็จ: 2025-11-23 05:00:00+07:00 → PM2.5 = 22.0
2025-11-23 19:06:25,922 INFO: อัปเดต DB สำเร็จ: 2025-11-23 06:00:00+07:00 → PM2.5 = 19.6
2025-11-23 19:06:25,923 INFO: อัปเดต DB สำเร็จ: 2025-11-23 07:00:00+07:00 → PM2.5 = 22.1
2025-11-23 19:06:25,925 INFO: อัปเดต DB สำเร็จ: 2025-11-23 08:00:00+07:00 → PM2.5 = 20.2
2025-11-23 19:06:25,926 INFO: อัปเดต DB สำเร็จ: 2025-11-23 09:00:00+07:00 → PM2.5 = 26.5
2025-11-23 19:06:25,928 INFO: อัปเดต DB สำเร็จ: 2025-11-23 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 19:06:25,930 INFO: อัปเดต DB สำเร็จ: 2025-11-23 11:00:00+07:00 → PM2.5 = 16.3
2025-11-23 19:06:25,931 INFO: อัปเดต DB สำเร็จ: 2025-11-23 12:00:00+07:00 → PM2.5 = 19.0
2025-11-23 19:06:25,933 INFO: อัปเดต DB สำเร็จ: 2025-11-23 13:00:00+07:00 → PM2.5 = 15.3
2025-11-23 19:06:25,934 INFO: อัปเดต DB สำเร็จ: 2025-11-23 14:00:00+07:00 → PM2.5 = 11.5
2025-11-23 19:06:25,936 INFO: อัปเดต DB สำเร็จ: 2025-11-23 15:00:00+07:00 → PM2.5 = 16.5
2025-11-23 19:06:25,937 INFO: อัปเดต DB สำเร็จ: 2025-11-23 16:00:00+07:00 → PM2.5 = 16.6
2025-11-23 19:06:25,939 INFO: อัปเดต DB สำเร็จ: 2025-11-23 17:00:00+07:00 → PM2.5 = 15.3
2025-11-23 19:06:25,940 INFO: อัปเดต DB สำเร็จ: 2025-11-23 18:00:00+07:00 → PM2.5 = 16.3
2025-11-23 19:06:25,941 INFO: อัปเดต DB สำเร็จ: 2025-11-23 19:00:00+07:00 → PM2.5 = 16.3
2025-11-23 19:06:25,941 INFO: โหลด DB สำเร็จ
2025-11-23 19:06:25,943 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 19:06:25,946 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 19:06:25,946 INFO: Load to DB + Backup สำเร็จ
2025-11-23 19:06:25,946 INFO: === PIPELINE END ===

2025-11-23 19:06:25,946 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 20:05:00 +07)" executed successfully
2025-11-23 20:05:00,000 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 21:05:00 +07)" (scheduled at 2025-11-23 20:05:00+07:00)
2025-11-23 20:05:00,001 INFO: === PIPELINE START ===
2025-11-23 20:05:00,001 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 20:05:00,749 INFO: ดึง 2025-11-23 19:00:00+07:00 - 2025-11-23 20:00:00+07:00 → 2 แถว
2025-11-23 20:05:00,757 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:00,757 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 20:05:00,758 INFO: Fetch สำเร็จ
2025-11-23 20:05:00,787 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-23 20:05:01,440 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:01,440 INFO: เติม 2025-11-21 20:00 → +2
2025-11-23 20:05:03,177 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:03,177 INFO: เติม 2025-11-21 21:00 → +2
2025-11-23 20:05:04,872 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:04,872 INFO: เติม 2025-11-21 22:00 → +2
2025-11-23 20:05:06,577 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:06,578 INFO: เติม 2025-11-21 23:00 → +2
2025-11-23 20:05:08,270 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:08,271 INFO: เติม 2025-11-22 00:00 → +2
2025-11-23 20:05:09,972 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:09,972 INFO: เติม 2025-11-22 01:00 → +2
2025-11-23 20:05:11,650 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:11,650 INFO: เติม 2025-11-22 02:00 → +2
2025-11-23 20:05:13,339 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:13,340 INFO: เติม 2025-11-22 03:00 → +2
2025-11-23 20:05:15,056 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:15,057 INFO: เติม 2025-11-22 04:00 → +2
2025-11-23 20:05:16,738 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:16,739 INFO: เติม 2025-11-22 05:00 → +2
2025-11-23 20:05:18,431 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:18,431 INFO: เติม 2025-11-22 06:00 → +2
2025-11-23 20:05:20,163 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:20,164 INFO: เติม 2025-11-22 07:00 → +2
2025-11-23 20:05:21,877 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:21,877 INFO: เติม 2025-11-22 08:00 → +2
2025-11-23 20:05:23,530 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:23,530 INFO: เติม 2025-11-22 09:00 → +2
2025-11-23 20:05:25,233 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:25,233 INFO: เติม 2025-11-22 10:00 → +2
2025-11-23 20:05:26,925 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:26,926 INFO: เติม 2025-11-22 11:00 → +2
2025-11-23 20:05:28,581 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:28,581 INFO: เติม 2025-11-22 12:00 → +2
2025-11-23 20:05:30,254 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:30,254 INFO: เติม 2025-11-22 13:00 → +2
2025-11-23 20:05:31,917 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:31,918 INFO: เติม 2025-11-22 14:00 → +2
2025-11-23 20:05:33,630 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:33,630 INFO: เติม 2025-11-22 15:00 → +2
2025-11-23 20:05:35,313 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:35,314 INFO: เติม 2025-11-22 16:00 → +2
2025-11-23 20:05:37,014 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:37,015 INFO: เติม 2025-11-22 17:00 → +2
2025-11-23 20:05:38,729 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:38,730 INFO: เติม 2025-11-22 18:00 → +2
2025-11-23 20:05:40,409 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:40,410 INFO: เติม 2025-11-22 19:00 → +2
2025-11-23 20:05:42,096 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:42,096 INFO: เติม 2025-11-22 20:00 → +2
2025-11-23 20:05:43,791 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:43,792 INFO: เติม 2025-11-22 21:00 → +2
2025-11-23 20:05:45,497 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:45,498 INFO: เติม 2025-11-22 22:00 → +2
2025-11-23 20:05:47,216 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:47,217 INFO: เติม 2025-11-22 23:00 → +2
2025-11-23 20:05:48,972 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:48,972 INFO: เติม 2025-11-23 00:00 → +2
2025-11-23 20:05:50,628 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:50,629 INFO: เติม 2025-11-23 01:00 → +2
2025-11-23 20:05:52,351 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:52,352 INFO: เติม 2025-11-23 02:00 → +2
2025-11-23 20:05:54,046 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:54,047 INFO: เติม 2025-11-23 03:00 → +2
2025-11-23 20:05:55,757 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:55,758 INFO: เติม 2025-11-23 04:00 → +2
2025-11-23 20:05:57,459 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:57,460 INFO: เติม 2025-11-23 05:00 → +2
2025-11-23 20:05:59,159 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:05:59,160 INFO: เติม 2025-11-23 06:00 → +2
2025-11-23 20:06:00,876 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:00,877 INFO: เติม 2025-11-23 07:00 → +2
2025-11-23 20:06:02,613 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:02,613 INFO: เติม 2025-11-23 08:00 → +2
2025-11-23 20:06:04,304 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:04,305 INFO: เติม 2025-11-23 09:00 → +2
2025-11-23 20:06:05,998 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:05,999 INFO: เติม 2025-11-23 10:00 → +2
2025-11-23 20:06:07,715 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:07,715 INFO: เติม 2025-11-23 11:00 → +2
2025-11-23 20:06:09,442 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:09,443 INFO: เติม 2025-11-23 12:00 → +2
2025-11-23 20:06:11,135 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:11,135 INFO: เติม 2025-11-23 13:00 → +2
2025-11-23 20:06:12,861 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:12,863 INFO: เติม 2025-11-23 14:00 → +2
2025-11-23 20:06:14,559 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:14,559 INFO: เติม 2025-11-23 15:00 → +2
2025-11-23 20:06:16,293 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:16,294 INFO: เติม 2025-11-23 16:00 → +2
2025-11-23 20:06:18,000 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:18,001 INFO: เติม 2025-11-23 17:00 → +2
2025-11-23 20:06:19,718 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:19,719 INFO: เติม 2025-11-23 18:00 → +2
2025-11-23 20:06:21,423 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:21,424 INFO: เติม 2025-11-23 19:00 → +2
2025-11-23 20:06:23,146 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-23 20:06:23,147 INFO: เติม 2025-11-23 20:00 → +1
2025-11-23 20:06:24,138 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-23 20:06:24,170 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 201 แถว
2025-11-23 20:06:24,171 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 20:06:24,173 INFO: รวมเก่า 200 + ใหม่ 201 → 201 (เพิ่ม 1)
2025-11-23 20:06:24,174 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 20:06:24,174 INFO: Format สำเร็จ: +1 แถว
2025-11-23 20:06:24,184 INFO: เริ่ม clean ข้อมูล: 201 แถว
2025-11-23 20:06:24,194 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (201 แถว)
2025-11-23 20:06:24,196 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 20:00:00          51.0           16.1       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 11:00:00          60.1           16.3       1.1 145.8       27.4    47.8     1015.4
2025-11-23 20:06:24,197 INFO: เตรียมโหลด 201 แถว
2025-11-23 20:06:24,203 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-23 20:06:24,204 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-23 20:06:24,205 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-23 20:06:24,207 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-23 20:06:24,208 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-23 20:06:24,210 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-23 20:06:24,211 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-23 20:06:24,213 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-23 20:06:24,214 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-23 20:06:24,216 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-23 20:06:24,218 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-23 20:06:24,219 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-23 20:06:24,220 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 20:06:24,222 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-23 20:06:24,223 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-23 20:06:24,225 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-23 20:06:24,226 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-23 20:06:24,227 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-23 20:06:24,228 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-23 20:06:24,230 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-23 20:06:24,230 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-23 20:06:24,233 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-23 20:06:24,234 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 20:06:24,236 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-23 20:06:24,238 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-23 20:06:24,240 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-23 20:06:24,240 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-23 20:06:24,242 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-23 20:06:24,243 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 20:06:24,246 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-23 20:06:24,247 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-23 20:06:24,249 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-23 20:06:24,250 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-23 20:06:24,252 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-23 20:06:24,253 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-23 20:06:24,254 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-23 20:06:24,255 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-23 20:06:24,257 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 20:06:24,258 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-23 20:06:24,259 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-23 20:06:24,261 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-23 20:06:24,262 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-23 20:06:24,263 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-23 20:06:24,265 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-23 20:06:24,266 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-23 20:06:24,267 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-23 20:06:24,269 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-23 20:06:24,271 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-23 20:06:24,272 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-23 20:06:24,273 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-23 20:06:24,274 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-23 20:06:24,276 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-23 20:06:24,277 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-23 20:06:24,279 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-23 20:06:24,280 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-23 20:06:24,282 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-23 20:06:24,284 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-23 20:06:24,285 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-23 20:06:24,287 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-23 20:06:24,288 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-23 20:06:24,290 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-23 20:06:24,292 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-23 20:06:24,293 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-23 20:06:24,294 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-23 20:06:24,296 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-23 20:06:24,297 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-23 20:06:24,298 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-23 20:06:24,300 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-23 20:06:24,300 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-23 20:06:24,305 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-23 20:06:24,306 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-23 20:06:24,307 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-23 20:06:24,309 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-23 20:06:24,310 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-23 20:06:24,311 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-23 20:06:24,313 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-23 20:06:24,314 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-23 20:06:24,316 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-23 20:06:24,317 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-23 20:06:24,319 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-23 20:06:24,320 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-23 20:06:24,322 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 20:06:24,323 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-23 20:06:24,324 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-23 20:06:24,325 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-23 20:06:24,327 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-23 20:06:24,328 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 20:06:24,330 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-23 20:06:24,331 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-23 20:06:24,333 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-23 20:06:24,335 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-23 20:06:24,336 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-23 20:06:24,338 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-23 20:06:24,339 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-23 20:06:24,340 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-23 20:06:24,342 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-23 20:06:24,343 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-23 20:06:24,344 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-23 20:06:24,346 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-23 20:06:24,347 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-23 20:06:24,349 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-23 20:06:24,351 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-23 20:06:24,352 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-23 20:06:24,353 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-23 20:06:24,354 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-23 20:06:24,355 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-23 20:06:24,357 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-23 20:06:24,358 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-23 20:06:24,359 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-23 20:06:24,360 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-23 20:06:24,362 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-23 20:06:24,363 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-23 20:06:24,364 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-23 20:06:24,366 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-23 20:06:24,367 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-23 20:06:24,369 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-23 20:06:24,370 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-23 20:06:24,371 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-23 20:06:24,373 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-23 20:06:24,374 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-23 20:06:24,376 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-23 20:06:24,377 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-23 20:06:24,378 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-23 20:06:24,379 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-23 20:06:24,380 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-23 20:06:24,382 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-23 20:06:24,383 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-23 20:06:24,384 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-23 20:06:24,386 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-23 20:06:24,388 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 20:06:24,389 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-23 20:06:24,390 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-23 20:06:24,391 INFO: อัปเดต DB สำเร็จ: 2025-11-21 00:00:00+07:00 → PM2.5 = 16.0
2025-11-23 20:06:24,392 INFO: อัปเดต DB สำเร็จ: 2025-11-21 01:00:00+07:00 → PM2.5 = 13.5
2025-11-23 20:06:24,394 INFO: อัปเดต DB สำเร็จ: 2025-11-21 02:00:00+07:00 → PM2.5 = 9.3
2025-11-23 20:06:24,394 INFO: อัปเดต DB สำเร็จ: 2025-11-21 03:00:00+07:00 → PM2.5 = 16.2
2025-11-23 20:06:24,394 INFO: อัปเดต DB สำเร็จ: 2025-11-21 04:00:00+07:00 → PM2.5 = 15.4
2025-11-23 20:06:24,394 INFO: อัปเดต DB สำเร็จ: 2025-11-21 05:00:00+07:00 → PM2.5 = 17.2
2025-11-23 20:06:24,399 INFO: อัปเดต DB สำเร็จ: 2025-11-21 06:00:00+07:00 → PM2.5 = 18.0
2025-11-23 20:06:24,401 INFO: อัปเดต DB สำเร็จ: 2025-11-21 07:00:00+07:00 → PM2.5 = 15.7
2025-11-23 20:06:24,403 INFO: อัปเดต DB สำเร็จ: 2025-11-21 08:00:00+07:00 → PM2.5 = 14.6
2025-11-23 20:06:24,404 INFO: อัปเดต DB สำเร็จ: 2025-11-21 09:00:00+07:00 → PM2.5 = 20.8
2025-11-23 20:06:24,406 INFO: อัปเดต DB สำเร็จ: 2025-11-21 10:00:00+07:00 → PM2.5 = 13.9
2025-11-23 20:06:24,407 INFO: อัปเดต DB สำเร็จ: 2025-11-21 11:00:00+07:00 → PM2.5 = 14.4
2025-11-23 20:06:24,408 INFO: อัปเดต DB สำเร็จ: 2025-11-21 12:00:00+07:00 → PM2.5 = 10.4
2025-11-23 20:06:24,409 INFO: อัปเดต DB สำเร็จ: 2025-11-21 13:00:00+07:00 → PM2.5 = 8.5
2025-11-23 20:06:24,411 INFO: อัปเดต DB สำเร็จ: 2025-11-21 14:00:00+07:00 → PM2.5 = 10.4
2025-11-23 20:06:24,412 INFO: อัปเดต DB สำเร็จ: 2025-11-21 15:00:00+07:00 → PM2.5 = 17.6
2025-11-23 20:06:24,413 INFO: อัปเดต DB สำเร็จ: 2025-11-21 16:00:00+07:00 → PM2.5 = 19.0
2025-11-23 20:06:24,415 INFO: อัปเดต DB สำเร็จ: 2025-11-21 17:00:00+07:00 → PM2.5 = 15.7
2025-11-23 20:06:24,416 INFO: อัปเดต DB สำเร็จ: 2025-11-21 18:00:00+07:00 → PM2.5 = 19.4
2025-11-23 20:06:24,418 INFO: อัปเดต DB สำเร็จ: 2025-11-21 19:00:00+07:00 → PM2.5 = 19.2
2025-11-23 20:06:24,419 INFO: อัปเดต DB สำเร็จ: 2025-11-21 20:00:00+07:00 → PM2.5 = 19.8
2025-11-23 20:06:24,420 INFO: อัปเดต DB สำเร็จ: 2025-11-21 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 20:06:24,422 INFO: อัปเดต DB สำเร็จ: 2025-11-21 22:00:00+07:00 → PM2.5 = 22.8
2025-11-23 20:06:24,423 INFO: อัปเดต DB สำเร็จ: 2025-11-21 23:00:00+07:00 → PM2.5 = 19.2
2025-11-23 20:06:24,424 INFO: อัปเดต DB สำเร็จ: 2025-11-22 00:00:00+07:00 → PM2.5 = 15.5
2025-11-23 20:06:24,426 INFO: อัปเดต DB สำเร็จ: 2025-11-22 01:00:00+07:00 → PM2.5 = 14.8
2025-11-23 20:06:24,427 INFO: อัปเดต DB สำเร็จ: 2025-11-22 02:00:00+07:00 → PM2.5 = 11.0
2025-11-23 20:06:24,428 INFO: อัปเดต DB สำเร็จ: 2025-11-22 03:00:00+07:00 → PM2.5 = 15.5
2025-11-23 20:06:24,429 INFO: อัปเดต DB สำเร็จ: 2025-11-22 04:00:00+07:00 → PM2.5 = 13.3
2025-11-23 20:06:24,431 INFO: อัปเดต DB สำเร็จ: 2025-11-22 05:00:00+07:00 → PM2.5 = 14.3
2025-11-23 20:06:24,432 INFO: อัปเดต DB สำเร็จ: 2025-11-22 06:00:00+07:00 → PM2.5 = 22.1
2025-11-23 20:06:24,433 INFO: อัปเดต DB สำเร็จ: 2025-11-22 07:00:00+07:00 → PM2.5 = 18.8
2025-11-23 20:06:24,435 INFO: อัปเดต DB สำเร็จ: 2025-11-22 08:00:00+07:00 → PM2.5 = 20.6
2025-11-23 20:06:24,436 INFO: อัปเดต DB สำเร็จ: 2025-11-22 09:00:00+07:00 → PM2.5 = 19.0
2025-11-23 20:06:24,437 INFO: อัปเดต DB สำเร็จ: 2025-11-22 10:00:00+07:00 → PM2.5 = 10.5
2025-11-23 20:06:24,439 INFO: อัปเดต DB สำเร็จ: 2025-11-22 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 20:06:24,440 INFO: อัปเดต DB สำเร็จ: 2025-11-22 12:00:00+07:00 → PM2.5 = 6.8
2025-11-23 20:06:24,441 INFO: อัปเดต DB สำเร็จ: 2025-11-22 13:00:00+07:00 → PM2.5 = 7.3
2025-11-23 20:06:24,443 INFO: อัปเดต DB สำเร็จ: 2025-11-22 14:00:00+07:00 → PM2.5 = 7.8
2025-11-23 20:06:24,444 INFO: อัปเดต DB สำเร็จ: 2025-11-22 15:00:00+07:00 → PM2.5 = 8.9
2025-11-23 20:06:24,445 INFO: อัปเดต DB สำเร็จ: 2025-11-22 16:00:00+07:00 → PM2.5 = 14.4
2025-11-23 20:06:24,447 INFO: อัปเดต DB สำเร็จ: 2025-11-22 17:00:00+07:00 → PM2.5 = 18.2
2025-11-23 20:06:24,448 INFO: อัปเดต DB สำเร็จ: 2025-11-22 18:00:00+07:00 → PM2.5 = 10.5
2025-11-23 20:06:24,449 INFO: อัปเดต DB สำเร็จ: 2025-11-22 19:00:00+07:00 → PM2.5 = 14.9
2025-11-23 20:06:24,451 INFO: อัปเดต DB สำเร็จ: 2025-11-22 20:00:00+07:00 → PM2.5 = 22.7
2025-11-23 20:06:24,452 INFO: อัปเดต DB สำเร็จ: 2025-11-22 21:00:00+07:00 → PM2.5 = 20.9
2025-11-23 20:06:24,454 INFO: อัปเดต DB สำเร็จ: 2025-11-22 22:00:00+07:00 → PM2.5 = 26.4
2025-11-23 20:06:24,455 INFO: อัปเดต DB สำเร็จ: 2025-11-22 23:00:00+07:00 → PM2.5 = 24.0
2025-11-23 20:06:24,457 INFO: อัปเดต DB สำเร็จ: 2025-11-23 00:00:00+07:00 → PM2.5 = 15.4
2025-11-23 20:06:24,458 INFO: อัปเดต DB สำเร็จ: 2025-11-23 01:00:00+07:00 → PM2.5 = 17.4
2025-11-23 20:06:24,459 INFO: อัปเดต DB สำเร็จ: 2025-11-23 02:00:00+07:00 → PM2.5 = 20.2
2025-11-23 20:06:24,460 INFO: อัปเดต DB สำเร็จ: 2025-11-23 03:00:00+07:00 → PM2.5 = 22.8
2025-11-23 20:06:24,463 INFO: อัปเดต DB สำเร็จ: 2025-11-23 04:00:00+07:00 → PM2.5 = 21.1
2025-11-23 20:06:24,464 INFO: อัปเดต DB สำเร็จ: 2025-11-23 05:00:00+07:00 → PM2.5 = 22.0
2025-11-23 20:06:24,465 INFO: อัปเดต DB สำเร็จ: 2025-11-23 06:00:00+07:00 → PM2.5 = 19.6
2025-11-23 20:06:24,467 INFO: อัปเดต DB สำเร็จ: 2025-11-23 07:00:00+07:00 → PM2.5 = 22.1
2025-11-23 20:06:24,468 INFO: อัปเดต DB สำเร็จ: 2025-11-23 08:00:00+07:00 → PM2.5 = 20.2
2025-11-23 20:06:24,469 INFO: อัปเดต DB สำเร็จ: 2025-11-23 09:00:00+07:00 → PM2.5 = 26.5
2025-11-23 20:06:24,470 INFO: อัปเดต DB สำเร็จ: 2025-11-23 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 20:06:24,472 INFO: อัปเดต DB สำเร็จ: 2025-11-23 11:00:00+07:00 → PM2.5 = 16.3
2025-11-23 20:06:24,473 INFO: อัปเดต DB สำเร็จ: 2025-11-23 12:00:00+07:00 → PM2.5 = 19.0
2025-11-23 20:06:24,474 INFO: อัปเดต DB สำเร็จ: 2025-11-23 13:00:00+07:00 → PM2.5 = 15.3
2025-11-23 20:06:24,476 INFO: อัปเดต DB สำเร็จ: 2025-11-23 14:00:00+07:00 → PM2.5 = 11.5
2025-11-23 20:06:24,477 INFO: อัปเดต DB สำเร็จ: 2025-11-23 15:00:00+07:00 → PM2.5 = 16.5
2025-11-23 20:06:24,478 INFO: อัปเดต DB สำเร็จ: 2025-11-23 16:00:00+07:00 → PM2.5 = 16.6
2025-11-23 20:06:24,480 INFO: อัปเดต DB สำเร็จ: 2025-11-23 17:00:00+07:00 → PM2.5 = 15.3
2025-11-23 20:06:24,481 INFO: อัปเดต DB สำเร็จ: 2025-11-23 18:00:00+07:00 → PM2.5 = 16.3
2025-11-23 20:06:24,483 INFO: อัปเดต DB สำเร็จ: 2025-11-23 19:00:00+07:00 → PM2.5 = 16.1
2025-11-23 20:06:24,484 INFO: อัปเดต DB สำเร็จ: 2025-11-23 20:00:00+07:00 → PM2.5 = 16.1
2025-11-23 20:06:24,484 INFO: โหลด DB สำเร็จ
2025-11-23 20:06:24,487 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 20:06:24,489 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 20:06:24,489 INFO: Load to DB + Backup สำเร็จ
2025-11-23 20:06:24,489 INFO: === PIPELINE END ===

2025-11-23 20:06:24,489 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 21:05:00 +07)" executed successfully
2025-11-23 21:05:00,015 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 22:05:00 +07)" (scheduled at 2025-11-23 21:05:00+07:00)
2025-11-23 21:05:00,018 INFO: === PIPELINE START ===
2025-11-23 21:05:00,018 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:05:00,777 INFO: ดึง 2025-11-23 20:00:00+07:00 - 2025-11-23 21:00:00+07:00 → 2 แถว
2025-11-23 21:05:00,784 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:00,784 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 21:05:00,784 INFO: Fetch สำเร็จ
2025-11-23 21:05:00,803 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-23 21:05:01,468 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:01,469 INFO: เติม 2025-11-21 21:00 → +2
2025-11-23 21:05:03,208 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:03,209 INFO: เติม 2025-11-21 22:00 → +2
2025-11-23 21:05:04,932 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:04,932 INFO: เติม 2025-11-21 23:00 → +2
2025-11-23 21:05:06,688 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:06,688 INFO: เติม 2025-11-22 00:00 → +2
2025-11-23 21:05:08,469 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:08,469 INFO: เติม 2025-11-22 01:00 → +2
2025-11-23 21:05:10,425 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:10,426 INFO: เติม 2025-11-22 02:00 → +2
2025-11-23 21:05:12,082 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:12,083 INFO: เติม 2025-11-22 03:00 → +2
2025-11-23 21:05:13,828 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:13,828 INFO: เติม 2025-11-22 04:00 → +2
2025-11-23 21:05:15,532 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:15,533 INFO: เติม 2025-11-22 05:00 → +2
2025-11-23 21:05:17,260 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:17,261 INFO: เติม 2025-11-22 06:00 → +2
2025-11-23 21:05:18,965 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:18,966 INFO: เติม 2025-11-22 07:00 → +2
2025-11-23 21:05:20,728 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:20,728 INFO: เติม 2025-11-22 08:00 → +2
2025-11-23 21:05:22,482 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:22,483 INFO: เติม 2025-11-22 09:00 → +2
2025-11-23 21:05:24,198 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:24,198 INFO: เติม 2025-11-22 10:00 → +2
2025-11-23 21:05:25,940 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:25,941 INFO: เติม 2025-11-22 11:00 → +2
2025-11-23 21:05:27,642 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:27,643 INFO: เติม 2025-11-22 12:00 → +2
2025-11-23 21:05:29,381 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:29,381 INFO: เติม 2025-11-22 13:00 → +2
2025-11-23 21:05:31,063 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:31,063 INFO: เติม 2025-11-22 14:00 → +2
2025-11-23 21:05:32,884 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:32,884 INFO: เติม 2025-11-22 15:00 → +2
2025-11-23 21:05:34,615 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:34,615 INFO: เติม 2025-11-22 16:00 → +2
2025-11-23 21:05:36,373 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:36,373 INFO: เติม 2025-11-22 17:00 → +2
2025-11-23 21:05:38,066 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:38,067 INFO: เติม 2025-11-22 18:00 → +2
2025-11-23 21:05:39,799 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:39,800 INFO: เติม 2025-11-22 19:00 → +2
2025-11-23 21:05:41,516 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:41,516 INFO: เติม 2025-11-22 20:00 → +2
2025-11-23 21:05:43,257 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:43,257 INFO: เติม 2025-11-22 21:00 → +2
2025-11-23 21:05:44,941 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:44,942 INFO: เติม 2025-11-22 22:00 → +2
2025-11-23 21:05:46,664 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:46,664 INFO: เติม 2025-11-22 23:00 → +2
2025-11-23 21:05:48,428 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:48,428 INFO: เติม 2025-11-23 00:00 → +2
2025-11-23 21:05:50,103 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:50,103 INFO: เติม 2025-11-23 01:00 → +2
2025-11-23 21:05:51,831 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:51,831 INFO: เติม 2025-11-23 02:00 → +2
2025-11-23 21:05:53,721 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:53,722 INFO: เติม 2025-11-23 03:00 → +2
2025-11-23 21:05:55,443 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:55,443 INFO: เติม 2025-11-23 04:00 → +2
2025-11-23 21:05:57,244 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:57,245 INFO: เติม 2025-11-23 05:00 → +2
2025-11-23 21:05:59,081 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:05:59,082 INFO: เติม 2025-11-23 06:00 → +2
2025-11-23 21:06:00,876 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:00,876 INFO: เติม 2025-11-23 07:00 → +2
2025-11-23 21:06:02,735 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:02,736 INFO: เติม 2025-11-23 08:00 → +2
2025-11-23 21:06:04,457 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:04,459 INFO: เติม 2025-11-23 09:00 → +2
2025-11-23 21:06:06,220 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:06,220 INFO: เติม 2025-11-23 10:00 → +2
2025-11-23 21:06:08,028 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:08,028 INFO: เติม 2025-11-23 11:00 → +2
2025-11-23 21:06:09,806 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:09,806 INFO: เติม 2025-11-23 12:00 → +2
2025-11-23 21:06:11,596 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:11,597 INFO: เติม 2025-11-23 13:00 → +2
2025-11-23 21:06:13,489 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:13,490 INFO: เติม 2025-11-23 14:00 → +2
2025-11-23 21:06:15,891 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:15,891 INFO: เติม 2025-11-23 15:00 → +2
2025-11-23 21:06:17,894 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:17,894 INFO: เติม 2025-11-23 16:00 → +2
2025-11-23 21:06:19,785 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:19,785 INFO: เติม 2025-11-23 17:00 → +2
2025-11-23 21:06:21,699 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:21,700 INFO: เติม 2025-11-23 18:00 → +2
2025-11-23 21:06:23,835 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:23,835 INFO: เติม 2025-11-23 19:00 → +2
2025-11-23 21:06:25,613 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:25,614 INFO: เติม 2025-11-23 20:00 → +2
2025-11-23 21:06:27,489 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-23 21:06:27,490 INFO: เติม 2025-11-23 21:00 → +1
2025-11-23 21:06:28,507 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว
2025-11-23 21:06:28,522 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 202 แถว
2025-11-23 21:06:28,524 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 21:06:28,526 INFO: รวมเก่า 201 + ใหม่ 202 → 202 (เพิ่ม 1)
2025-11-23 21:06:28,527 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 21:06:28,527 INFO: Format สำเร็จ: +1 แถว
2025-11-23 21:06:28,538 INFO: เริ่ม clean ข้อมูล: 202 แถว
2025-11-23 21:06:28,549 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (202 แถว)
2025-11-23 21:06:28,552 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 21:00:00          50.1           19.6       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 21:06:28,553 INFO: เตรียมโหลด 202 แถว
2025-11-23 21:06:28,559 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-23 21:06:28,561 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-23 21:06:28,563 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-23 21:06:28,565 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-23 21:06:28,566 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-23 21:06:28,569 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-23 21:06:28,570 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-23 21:06:28,572 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-23 21:06:28,574 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-23 21:06:28,575 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-23 21:06:28,577 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-23 21:06:28,579 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-23 21:06:28,581 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:06:28,582 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-23 21:06:28,583 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-23 21:06:28,585 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:06:28,586 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-23 21:06:28,588 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-23 21:06:28,589 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-23 21:06:28,591 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-23 21:06:28,594 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-23 21:06:28,595 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-23 21:06:28,597 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:06:28,598 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:06:28,600 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-23 21:06:28,602 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:06:28,603 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:06:28,604 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:06:28,606 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:06:28,608 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-23 21:06:28,609 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:06:28,610 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-23 21:06:28,612 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-23 21:06:28,614 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-23 21:06:28,615 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-23 21:06:28,616 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:06:28,618 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-23 21:06:28,619 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 21:06:28,620 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-23 21:06:28,622 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-23 21:06:28,624 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-23 21:06:28,625 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-23 21:06:28,627 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-23 21:06:28,629 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-23 21:06:28,631 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:06:28,632 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-23 21:06:28,634 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-23 21:06:28,635 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-23 21:06:28,637 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:06:28,638 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-23 21:06:28,640 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-23 21:06:28,642 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:06:28,643 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-23 21:06:28,645 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:06:28,646 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-23 21:06:28,648 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-23 21:06:28,649 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-23 21:06:28,651 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:06:28,653 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-23 21:06:28,654 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:06:28,656 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-23 21:06:28,657 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-23 21:06:28,659 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-23 21:06:28,660 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-23 21:06:28,662 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-23 21:06:28,664 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-23 21:06:28,665 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-23 21:06:28,667 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-23 21:06:28,669 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-23 21:06:28,671 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-23 21:06:28,672 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:06:28,674 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-23 21:06:28,675 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-23 21:06:28,678 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:06:28,680 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-23 21:06:28,681 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-23 21:06:28,683 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-23 21:06:28,684 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-23 21:06:28,686 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-23 21:06:28,687 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-23 21:06:28,689 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-23 21:06:28,691 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 21:06:28,692 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-23 21:06:28,694 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:06:28,695 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-23 21:06:28,696 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:06:28,698 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:06:28,699 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-23 21:06:28,701 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-23 21:06:28,703 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:06:28,705 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-23 21:06:28,706 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-23 21:06:28,708 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-23 21:06:28,710 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-23 21:06:28,712 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-23 21:06:28,713 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-23 21:06:28,715 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-23 21:06:28,716 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-23 21:06:28,718 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-23 21:06:28,719 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-23 21:06:28,721 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-23 21:06:28,722 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-23 21:06:28,724 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-23 21:06:28,725 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-23 21:06:28,727 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:06:28,728 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-23 21:06:28,730 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-23 21:06:28,732 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-23 21:06:28,734 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:06:28,736 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-23 21:06:28,739 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-23 21:06:28,742 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-23 21:06:28,744 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-23 21:06:28,746 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-23 21:06:28,749 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-23 21:06:28,752 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-23 21:06:28,754 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-23 21:06:28,756 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-23 21:06:28,758 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-23 21:06:28,760 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-23 21:06:28,762 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-23 21:06:28,765 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-23 21:06:28,768 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-23 21:06:28,770 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-23 21:06:28,771 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-23 21:06:28,773 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-23 21:06:28,774 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-23 21:06:28,776 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:06:28,776 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-23 21:06:28,778 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 21:06:28,780 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-23 21:06:28,782 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:06:28,784 INFO: อัปเดต DB สำเร็จ: 2025-11-21 00:00:00+07:00 → PM2.5 = 16.0
2025-11-23 21:06:28,785 INFO: อัปเดต DB สำเร็จ: 2025-11-21 01:00:00+07:00 → PM2.5 = 13.5
2025-11-23 21:06:28,787 INFO: อัปเดต DB สำเร็จ: 2025-11-21 02:00:00+07:00 → PM2.5 = 9.3
2025-11-23 21:06:28,788 INFO: อัปเดต DB สำเร็จ: 2025-11-21 03:00:00+07:00 → PM2.5 = 16.2
2025-11-23 21:06:28,790 INFO: อัปเดต DB สำเร็จ: 2025-11-21 04:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:06:28,791 INFO: อัปเดต DB สำเร็จ: 2025-11-21 05:00:00+07:00 → PM2.5 = 17.2
2025-11-23 21:06:28,793 INFO: อัปเดต DB สำเร็จ: 2025-11-21 06:00:00+07:00 → PM2.5 = 18.0
2025-11-23 21:06:28,794 INFO: อัปเดต DB สำเร็จ: 2025-11-21 07:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:06:28,795 INFO: อัปเดต DB สำเร็จ: 2025-11-21 08:00:00+07:00 → PM2.5 = 14.6
2025-11-23 21:06:28,797 INFO: อัปเดต DB สำเร็จ: 2025-11-21 09:00:00+07:00 → PM2.5 = 20.8
2025-11-23 21:06:28,798 INFO: อัปเดต DB สำเร็จ: 2025-11-21 10:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:06:28,800 INFO: อัปเดต DB สำเร็จ: 2025-11-21 11:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:06:28,802 INFO: อัปเดต DB สำเร็จ: 2025-11-21 12:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:06:28,803 INFO: อัปเดต DB สำเร็จ: 2025-11-21 13:00:00+07:00 → PM2.5 = 8.5
2025-11-23 21:06:28,805 INFO: อัปเดต DB สำเร็จ: 2025-11-21 14:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:06:28,806 INFO: อัปเดต DB สำเร็จ: 2025-11-21 15:00:00+07:00 → PM2.5 = 17.6
2025-11-23 21:06:28,807 INFO: อัปเดต DB สำเร็จ: 2025-11-21 16:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:06:28,809 INFO: อัปเดต DB สำเร็จ: 2025-11-21 17:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:06:28,810 INFO: อัปเดต DB สำเร็จ: 2025-11-21 18:00:00+07:00 → PM2.5 = 19.4
2025-11-23 21:06:28,812 INFO: อัปเดต DB สำเร็จ: 2025-11-21 19:00:00+07:00 → PM2.5 = 19.2
2025-11-23 21:06:28,813 INFO: อัปเดต DB สำเร็จ: 2025-11-21 20:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:06:28,814 INFO: อัปเดต DB สำเร็จ: 2025-11-21 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 21:06:28,816 INFO: อัปเดต DB สำเร็จ: 2025-11-21 22:00:00+07:00 → PM2.5 = 22.8
2025-11-23 21:06:28,818 INFO: อัปเดต DB สำเร็จ: 2025-11-21 23:00:00+07:00 → PM2.5 = 19.2
2025-11-23 21:06:28,820 INFO: อัปเดต DB สำเร็จ: 2025-11-22 00:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:06:28,821 INFO: อัปเดต DB สำเร็จ: 2025-11-22 01:00:00+07:00 → PM2.5 = 14.8
2025-11-23 21:06:28,822 INFO: อัปเดต DB สำเร็จ: 2025-11-22 02:00:00+07:00 → PM2.5 = 11.0
2025-11-23 21:06:28,824 INFO: อัปเดต DB สำเร็จ: 2025-11-22 03:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:06:28,825 INFO: อัปเดต DB สำเร็จ: 2025-11-22 04:00:00+07:00 → PM2.5 = 13.3
2025-11-23 21:06:28,827 INFO: อัปเดต DB สำเร็จ: 2025-11-22 05:00:00+07:00 → PM2.5 = 14.3
2025-11-23 21:06:28,828 INFO: อัปเดต DB สำเร็จ: 2025-11-22 06:00:00+07:00 → PM2.5 = 22.1
2025-11-23 21:06:28,830 INFO: อัปเดต DB สำเร็จ: 2025-11-22 07:00:00+07:00 → PM2.5 = 18.8
2025-11-23 21:06:28,831 INFO: อัปเดต DB สำเร็จ: 2025-11-22 08:00:00+07:00 → PM2.5 = 20.6
2025-11-23 21:06:28,833 INFO: อัปเดต DB สำเร็จ: 2025-11-22 09:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:06:28,835 INFO: อัปเดต DB สำเร็จ: 2025-11-22 10:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:06:28,836 INFO: อัปเดต DB สำเร็จ: 2025-11-22 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 21:06:28,837 INFO: อัปเดต DB สำเร็จ: 2025-11-22 12:00:00+07:00 → PM2.5 = 6.8
2025-11-23 21:06:28,839 INFO: อัปเดต DB สำเร็จ: 2025-11-22 13:00:00+07:00 → PM2.5 = 7.3
2025-11-23 21:06:28,840 INFO: อัปเดต DB สำเร็จ: 2025-11-22 14:00:00+07:00 → PM2.5 = 7.8
2025-11-23 21:06:28,842 INFO: อัปเดต DB สำเร็จ: 2025-11-22 15:00:00+07:00 → PM2.5 = 8.9
2025-11-23 21:06:28,844 INFO: อัปเดต DB สำเร็จ: 2025-11-22 16:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:06:28,846 INFO: อัปเดต DB สำเร็จ: 2025-11-22 17:00:00+07:00 → PM2.5 = 18.2
2025-11-23 21:06:28,847 INFO: อัปเดต DB สำเร็จ: 2025-11-22 18:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:06:28,849 INFO: อัปเดต DB สำเร็จ: 2025-11-22 19:00:00+07:00 → PM2.5 = 14.9
2025-11-23 21:06:28,850 INFO: อัปเดต DB สำเร็จ: 2025-11-22 20:00:00+07:00 → PM2.5 = 22.7
2025-11-23 21:06:28,852 INFO: อัปเดต DB สำเร็จ: 2025-11-22 21:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:06:28,853 INFO: อัปเดต DB สำเร็จ: 2025-11-22 22:00:00+07:00 → PM2.5 = 26.4
2025-11-23 21:06:28,855 INFO: อัปเดต DB สำเร็จ: 2025-11-22 23:00:00+07:00 → PM2.5 = 24.0
2025-11-23 21:06:28,856 INFO: อัปเดต DB สำเร็จ: 2025-11-23 00:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:06:28,858 INFO: อัปเดต DB สำเร็จ: 2025-11-23 01:00:00+07:00 → PM2.5 = 17.4
2025-11-23 21:06:28,860 INFO: อัปเดต DB สำเร็จ: 2025-11-23 02:00:00+07:00 → PM2.5 = 20.2
2025-11-23 21:06:28,861 INFO: อัปเดต DB สำเร็จ: 2025-11-23 03:00:00+07:00 → PM2.5 = 22.8
2025-11-23 21:06:28,863 INFO: อัปเดต DB สำเร็จ: 2025-11-23 04:00:00+07:00 → PM2.5 = 21.1
2025-11-23 21:06:28,864 INFO: อัปเดต DB สำเร็จ: 2025-11-23 05:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:06:28,866 INFO: อัปเดต DB สำเร็จ: 2025-11-23 06:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:06:28,867 INFO: อัปเดต DB สำเร็จ: 2025-11-23 07:00:00+07:00 → PM2.5 = 22.1
2025-11-23 21:06:28,868 INFO: อัปเดต DB สำเร็จ: 2025-11-23 08:00:00+07:00 → PM2.5 = 20.2
2025-11-23 21:06:28,870 INFO: อัปเดต DB สำเร็จ: 2025-11-23 09:00:00+07:00 → PM2.5 = 26.5
2025-11-23 21:06:28,872 INFO: อัปเดต DB สำเร็จ: 2025-11-23 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:06:28,873 INFO: อัปเดต DB สำเร็จ: 2025-11-23 11:00:00+07:00 → PM2.5 = 16.3
2025-11-23 21:06:28,875 INFO: อัปเดต DB สำเร็จ: 2025-11-23 12:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:06:28,876 INFO: อัปเดต DB สำเร็จ: 2025-11-23 13:00:00+07:00 → PM2.5 = 15.3
2025-11-23 21:06:28,878 INFO: อัปเดต DB สำเร็จ: 2025-11-23 14:00:00+07:00 → PM2.5 = 11.5
2025-11-23 21:06:28,880 INFO: อัปเดต DB สำเร็จ: 2025-11-23 15:00:00+07:00 → PM2.5 = 16.5
2025-11-23 21:06:28,881 INFO: อัปเดต DB สำเร็จ: 2025-11-23 16:00:00+07:00 → PM2.5 = 16.6
2025-11-23 21:06:28,882 INFO: อัปเดต DB สำเร็จ: 2025-11-23 17:00:00+07:00 → PM2.5 = 15.3
2025-11-23 21:06:28,883 INFO: อัปเดต DB สำเร็จ: 2025-11-23 18:00:00+07:00 → PM2.5 = 16.3
2025-11-23 21:06:28,885 INFO: อัปเดต DB สำเร็จ: 2025-11-23 19:00:00+07:00 → PM2.5 = 16.1
2025-11-23 21:06:28,886 INFO: อัปเดต DB สำเร็จ: 2025-11-23 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:06:28,888 INFO: อัปเดต DB สำเร็จ: 2025-11-23 21:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:06:28,889 INFO: โหลด DB สำเร็จ
2025-11-23 21:06:28,891 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 21:06:28,893 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 21:06:28,894 INFO: Load to DB + Backup สำเร็จ
2025-11-23 21:06:28,894 INFO: === PIPELINE END ===

2025-11-23 21:06:28,894 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 22:05:00 +07)" executed successfully
2025-11-23 21:14:27,159 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 21:14:27,166 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 21:14:27,167 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:14:27,168 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 21:14:27,168 INFO: Scheduler started
2025-11-23 21:14:27,169 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 21:14:27,169 INFO: === PIPELINE START ===
2025-11-23 21:14:27,169 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:14:27,896 INFO: ดึง 2025-11-23 20:00:00+07:00 - 2025-11-23 21:00:00+07:00 → 2 แถว
2025-11-23 21:14:27,903 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:14:27,903 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 21:14:27,904 INFO: Fetch สำเร็จ
2025-11-23 21:14:27,924 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-23 21:15:51,981 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว จาก 49 ชั่วโมง
2025-11-23 21:15:51,993 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 202 แถว
2025-11-23 21:15:51,994 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 21:15:51,997 INFO: รวมเก่า 202 + ใหม่ 202 → 202 (เพิ่ม 0)
2025-11-23 21:15:51,998 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 21:15:51,998 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 21:15:52,009 INFO: เริ่ม clean ข้อมูล: 202 แถว
2025-11-23 21:15:52,023 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (202 แถว)
2025-11-23 21:15:52,027 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 21:15:52,704 INFO: เตรียมโหลด 202 แถว
2025-11-23 21:15:52,757 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-23 21:15:52,759 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-23 21:15:52,760 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-23 21:15:52,762 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-23 21:15:52,763 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-23 21:15:52,765 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-23 21:15:52,767 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-23 21:15:52,768 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-23 21:15:52,770 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-23 21:15:52,772 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-23 21:15:52,774 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-23 21:15:52,776 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-23 21:15:52,778 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:15:52,780 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-23 21:15:52,781 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-23 21:15:52,783 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:15:52,785 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-23 21:15:52,786 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-23 21:15:52,788 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-23 21:15:52,789 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-23 21:15:52,790 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-23 21:15:52,793 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-23 21:15:52,795 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:15:52,796 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:15:52,799 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-23 21:15:52,801 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:15:52,802 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:15:52,804 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:15:52,805 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:15:52,807 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-23 21:15:52,810 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:15:52,811 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-23 21:15:52,812 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-23 21:15:52,814 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-23 21:15:52,816 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-23 21:15:52,818 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:15:52,819 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-23 21:15:52,821 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 21:15:52,822 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-23 21:15:52,824 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-23 21:15:52,826 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-23 21:15:52,827 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-23 21:15:52,829 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-23 21:15:52,829 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-23 21:15:52,831 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:15:52,833 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-23 21:15:52,834 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-23 21:15:52,837 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-23 21:15:52,838 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:15:52,840 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-23 21:15:52,842 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-23 21:15:52,843 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:15:52,843 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-23 21:15:52,848 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:15:52,849 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-23 21:15:52,851 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-23 21:15:52,853 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-23 21:15:52,855 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:15:52,856 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-23 21:15:52,858 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:15:52,859 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-23 21:15:52,861 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-23 21:15:52,862 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-23 21:15:52,864 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-23 21:15:52,866 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-23 21:15:52,867 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-23 21:15:52,869 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-23 21:15:52,870 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-23 21:15:52,870 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-23 21:15:52,870 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-23 21:15:52,876 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:15:52,877 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-23 21:15:52,878 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-23 21:15:52,879 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:15:52,881 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-23 21:15:52,883 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-23 21:15:52,884 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-23 21:15:52,886 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-23 21:15:52,887 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-23 21:15:52,888 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-23 21:15:52,891 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-23 21:15:52,893 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 21:15:52,894 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-23 21:15:52,895 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:15:52,898 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-23 21:15:52,899 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:15:52,900 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:15:52,902 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-23 21:15:52,904 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-23 21:15:52,905 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:15:52,906 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-23 21:15:52,909 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-23 21:15:52,910 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-23 21:15:52,912 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-23 21:15:52,913 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-23 21:15:52,915 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-23 21:15:52,916 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-23 21:15:52,917 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-23 21:15:52,919 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-23 21:15:52,921 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-23 21:15:52,922 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-23 21:15:52,924 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-23 21:15:52,925 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-23 21:15:52,928 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-23 21:15:52,929 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:15:52,930 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-23 21:15:52,933 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-23 21:15:52,934 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-23 21:15:52,936 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:15:52,937 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-23 21:15:52,939 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-23 21:15:52,940 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-23 21:15:52,942 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-23 21:15:52,943 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-23 21:15:52,945 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-23 21:15:52,946 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-23 21:15:52,948 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-23 21:15:52,950 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-23 21:15:52,951 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-23 21:15:52,952 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-23 21:15:52,954 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-23 21:15:52,956 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-23 21:15:52,957 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-23 21:15:52,959 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-23 21:15:52,961 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-23 21:15:52,962 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-23 21:15:52,964 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-23 21:15:52,966 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:15:52,967 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-23 21:15:52,969 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 21:15:52,970 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-23 21:15:52,972 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:15:52,973 INFO: อัปเดต DB สำเร็จ: 2025-11-21 00:00:00+07:00 → PM2.5 = 16.0
2025-11-23 21:15:52,975 INFO: อัปเดต DB สำเร็จ: 2025-11-21 01:00:00+07:00 → PM2.5 = 13.5
2025-11-23 21:15:52,976 INFO: อัปเดต DB สำเร็จ: 2025-11-21 02:00:00+07:00 → PM2.5 = 9.3
2025-11-23 21:15:52,978 INFO: อัปเดต DB สำเร็จ: 2025-11-21 03:00:00+07:00 → PM2.5 = 16.2
2025-11-23 21:15:52,980 INFO: อัปเดต DB สำเร็จ: 2025-11-21 04:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:15:52,982 INFO: อัปเดต DB สำเร็จ: 2025-11-21 05:00:00+07:00 → PM2.5 = 17.2
2025-11-23 21:15:52,983 INFO: อัปเดต DB สำเร็จ: 2025-11-21 06:00:00+07:00 → PM2.5 = 18.0
2025-11-23 21:15:52,985 INFO: อัปเดต DB สำเร็จ: 2025-11-21 07:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:15:52,987 INFO: อัปเดต DB สำเร็จ: 2025-11-21 08:00:00+07:00 → PM2.5 = 14.6
2025-11-23 21:15:52,988 INFO: อัปเดต DB สำเร็จ: 2025-11-21 09:00:00+07:00 → PM2.5 = 20.8
2025-11-23 21:15:52,990 INFO: อัปเดต DB สำเร็จ: 2025-11-21 10:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:15:52,991 INFO: อัปเดต DB สำเร็จ: 2025-11-21 11:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:15:52,993 INFO: อัปเดต DB สำเร็จ: 2025-11-21 12:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:15:52,994 INFO: อัปเดต DB สำเร็จ: 2025-11-21 13:00:00+07:00 → PM2.5 = 8.5
2025-11-23 21:15:52,997 INFO: อัปเดต DB สำเร็จ: 2025-11-21 14:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:15:52,997 INFO: อัปเดต DB สำเร็จ: 2025-11-21 15:00:00+07:00 → PM2.5 = 17.6
2025-11-23 21:15:52,997 INFO: อัปเดต DB สำเร็จ: 2025-11-21 16:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:15:53,000 INFO: อัปเดต DB สำเร็จ: 2025-11-21 17:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:15:53,003 INFO: อัปเดต DB สำเร็จ: 2025-11-21 18:00:00+07:00 → PM2.5 = 19.4
2025-11-23 21:15:53,005 INFO: อัปเดต DB สำเร็จ: 2025-11-21 19:00:00+07:00 → PM2.5 = 19.2
2025-11-23 21:15:53,006 INFO: อัปเดต DB สำเร็จ: 2025-11-21 20:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:15:53,007 INFO: อัปเดต DB สำเร็จ: 2025-11-21 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 21:15:53,009 INFO: อัปเดต DB สำเร็จ: 2025-11-21 22:00:00+07:00 → PM2.5 = 22.8
2025-11-23 21:15:53,010 INFO: อัปเดต DB สำเร็จ: 2025-11-21 23:00:00+07:00 → PM2.5 = 19.2
2025-11-23 21:15:53,013 INFO: อัปเดต DB สำเร็จ: 2025-11-22 00:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:15:53,014 INFO: อัปเดต DB สำเร็จ: 2025-11-22 01:00:00+07:00 → PM2.5 = 14.8
2025-11-23 21:15:53,016 INFO: อัปเดต DB สำเร็จ: 2025-11-22 02:00:00+07:00 → PM2.5 = 11.0
2025-11-23 21:15:53,017 INFO: อัปเดต DB สำเร็จ: 2025-11-22 03:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:15:53,019 INFO: อัปเดต DB สำเร็จ: 2025-11-22 04:00:00+07:00 → PM2.5 = 13.3
2025-11-23 21:15:53,020 INFO: อัปเดต DB สำเร็จ: 2025-11-22 05:00:00+07:00 → PM2.5 = 14.3
2025-11-23 21:15:53,023 INFO: อัปเดต DB สำเร็จ: 2025-11-22 06:00:00+07:00 → PM2.5 = 22.1
2025-11-23 21:15:53,024 INFO: อัปเดต DB สำเร็จ: 2025-11-22 07:00:00+07:00 → PM2.5 = 18.8
2025-11-23 21:15:53,025 INFO: อัปเดต DB สำเร็จ: 2025-11-22 08:00:00+07:00 → PM2.5 = 20.6
2025-11-23 21:15:53,027 INFO: อัปเดต DB สำเร็จ: 2025-11-22 09:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:15:53,028 INFO: อัปเดต DB สำเร็จ: 2025-11-22 10:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:15:53,029 INFO: อัปเดต DB สำเร็จ: 2025-11-22 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 21:15:53,031 INFO: อัปเดต DB สำเร็จ: 2025-11-22 12:00:00+07:00 → PM2.5 = 6.8
2025-11-23 21:15:53,032 INFO: อัปเดต DB สำเร็จ: 2025-11-22 13:00:00+07:00 → PM2.5 = 7.3
2025-11-23 21:15:53,035 INFO: อัปเดต DB สำเร็จ: 2025-11-22 14:00:00+07:00 → PM2.5 = 7.8
2025-11-23 21:15:53,036 INFO: อัปเดต DB สำเร็จ: 2025-11-22 15:00:00+07:00 → PM2.5 = 8.9
2025-11-23 21:15:53,038 INFO: อัปเดต DB สำเร็จ: 2025-11-22 16:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:15:53,039 INFO: อัปเดต DB สำเร็จ: 2025-11-22 17:00:00+07:00 → PM2.5 = 18.2
2025-11-23 21:15:53,040 INFO: อัปเดต DB สำเร็จ: 2025-11-22 18:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:15:53,042 INFO: อัปเดต DB สำเร็จ: 2025-11-22 19:00:00+07:00 → PM2.5 = 14.9
2025-11-23 21:15:53,043 INFO: อัปเดต DB สำเร็จ: 2025-11-22 20:00:00+07:00 → PM2.5 = 22.7
2025-11-23 21:15:53,045 INFO: อัปเดต DB สำเร็จ: 2025-11-22 21:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:15:53,047 INFO: อัปเดต DB สำเร็จ: 2025-11-22 22:00:00+07:00 → PM2.5 = 26.4
2025-11-23 21:15:53,049 INFO: อัปเดต DB สำเร็จ: 2025-11-22 23:00:00+07:00 → PM2.5 = 24.0
2025-11-23 21:15:53,051 INFO: อัปเดต DB สำเร็จ: 2025-11-23 00:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:15:53,052 INFO: อัปเดต DB สำเร็จ: 2025-11-23 01:00:00+07:00 → PM2.5 = 17.4
2025-11-23 21:15:53,055 INFO: อัปเดต DB สำเร็จ: 2025-11-23 02:00:00+07:00 → PM2.5 = 20.2
2025-11-23 21:15:53,055 INFO: อัปเดต DB สำเร็จ: 2025-11-23 03:00:00+07:00 → PM2.5 = 22.8
2025-11-23 21:15:53,058 INFO: อัปเดต DB สำเร็จ: 2025-11-23 04:00:00+07:00 → PM2.5 = 21.1
2025-11-23 21:15:53,060 INFO: อัปเดต DB สำเร็จ: 2025-11-23 05:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:15:53,061 INFO: อัปเดต DB สำเร็จ: 2025-11-23 06:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:15:53,062 INFO: อัปเดต DB สำเร็จ: 2025-11-23 07:00:00+07:00 → PM2.5 = 22.1
2025-11-23 21:15:53,064 INFO: อัปเดต DB สำเร็จ: 2025-11-23 08:00:00+07:00 → PM2.5 = 20.2
2025-11-23 21:15:53,066 INFO: อัปเดต DB สำเร็จ: 2025-11-23 09:00:00+07:00 → PM2.5 = 26.5
2025-11-23 21:15:53,067 INFO: อัปเดต DB สำเร็จ: 2025-11-23 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:15:53,069 INFO: อัปเดต DB สำเร็จ: 2025-11-23 11:00:00+07:00 → PM2.5 = 16.3
2025-11-23 21:15:53,071 INFO: อัปเดต DB สำเร็จ: 2025-11-23 12:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:15:53,072 INFO: อัปเดต DB สำเร็จ: 2025-11-23 13:00:00+07:00 → PM2.5 = 15.3
2025-11-23 21:15:53,074 INFO: อัปเดต DB สำเร็จ: 2025-11-23 14:00:00+07:00 → PM2.5 = 11.5
2025-11-23 21:15:53,076 INFO: อัปเดต DB สำเร็จ: 2025-11-23 15:00:00+07:00 → PM2.5 = 16.5
2025-11-23 21:15:53,078 INFO: อัปเดต DB สำเร็จ: 2025-11-23 16:00:00+07:00 → PM2.5 = 16.6
2025-11-23 21:15:53,079 INFO: อัปเดต DB สำเร็จ: 2025-11-23 17:00:00+07:00 → PM2.5 = 15.3
2025-11-23 21:15:53,081 INFO: อัปเดต DB สำเร็จ: 2025-11-23 18:00:00+07:00 → PM2.5 = 16.3
2025-11-23 21:15:53,083 INFO: อัปเดต DB สำเร็จ: 2025-11-23 19:00:00+07:00 → PM2.5 = 16.1
2025-11-23 21:15:53,085 INFO: อัปเดต DB สำเร็จ: 2025-11-23 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:15:53,086 INFO: อัปเดต DB สำเร็จ: 2025-11-23 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 21:15:53,087 INFO: โหลด DB สำเร็จ
2025-11-23 21:15:53,089 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 21:15:53,092 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 21:15:53,092 INFO: Load to DB + Backup สำเร็จ
2025-11-23 21:15:53,093 INFO: === PIPELINE END ===

2025-11-23 21:18:25,388 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 21:18:25,393 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 21:18:25,395 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:18:25,396 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 21:18:25,396 INFO: Scheduler started
2025-11-23 21:18:25,396 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 21:18:25,396 INFO: === PIPELINE START ===
2025-11-23 21:18:25,396 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:18:26,091 INFO: ดึง 2025-11-23 20:00:00+07:00 - 2025-11-23 21:00:00+07:00 → 2 แถว
2025-11-23 21:18:26,099 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:18:26,099 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 21:18:26,099 INFO: Fetch สำเร็จ
2025-11-23 21:18:26,119 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-23 21:19:50,145 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว จาก 49 ชั่วโมง
2025-11-23 21:19:50,162 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 202 แถว
2025-11-23 21:19:50,163 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 21:19:50,165 INFO: รวมเก่า 202 + ใหม่ 202 → 202 (เพิ่ม 0)
2025-11-23 21:19:50,167 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 21:19:50,167 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 21:19:50,180 INFO: เริ่ม clean ข้อมูล: 202 แถว
2025-11-23 21:19:50,191 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (202 แถว)
2025-11-23 21:19:50,196 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 21:19:50,227 INFO: เตรียมโหลด 202 แถว
2025-11-23 21:19:50,286 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-23 21:19:50,288 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-23 21:19:50,290 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-23 21:19:50,292 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-23 21:19:50,294 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-23 21:19:50,296 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-23 21:19:50,297 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-23 21:19:50,300 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-23 21:19:50,302 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-23 21:19:50,304 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-23 21:19:50,305 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-23 21:19:50,307 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-23 21:19:50,309 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:19:50,310 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-23 21:19:50,312 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-23 21:19:50,313 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:19:50,315 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-23 21:19:50,318 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-23 21:19:50,319 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-23 21:19:50,321 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-23 21:19:50,323 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-23 21:19:50,324 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-23 21:19:50,326 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:19:50,328 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:19:50,332 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-23 21:19:50,335 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:19:50,337 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:19:50,339 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:19:50,342 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:19:50,345 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-23 21:19:50,348 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:19:50,351 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-23 21:19:50,353 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-23 21:19:50,355 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-23 21:19:50,358 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-23 21:19:50,362 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:19:50,364 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-23 21:19:50,365 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 21:19:50,368 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-23 21:19:50,369 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-23 21:19:50,371 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-23 21:19:50,373 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-23 21:19:50,375 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-23 21:19:50,380 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-23 21:19:50,383 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:19:50,384 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-23 21:19:50,388 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-23 21:19:50,390 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-23 21:19:50,392 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:19:50,394 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-23 21:19:50,397 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-23 21:19:50,400 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:19:50,402 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-23 21:19:50,404 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:19:50,407 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-23 21:19:50,409 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-23 21:19:50,412 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-23 21:19:50,414 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:19:50,417 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-23 21:19:50,420 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:19:50,423 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-23 21:19:50,425 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-23 21:19:50,428 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-23 21:19:50,430 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-23 21:19:50,432 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-23 21:19:50,435 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-23 21:19:50,437 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-23 21:19:50,440 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-23 21:19:50,442 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-23 21:19:50,446 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-23 21:19:50,449 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:19:50,451 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-23 21:19:50,453 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-23 21:19:50,456 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:19:50,459 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-23 21:19:50,461 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-23 21:19:50,463 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-23 21:19:50,465 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-23 21:19:50,467 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-23 21:19:50,468 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-23 21:19:50,471 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-23 21:19:50,474 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 21:19:50,476 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-23 21:19:50,480 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:19:50,482 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-23 21:19:50,485 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:19:50,487 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:19:50,490 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-23 21:19:50,493 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-23 21:19:50,496 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:19:50,497 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-23 21:19:50,499 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-23 21:19:50,500 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-23 21:19:50,502 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-23 21:19:50,504 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-23 21:19:50,506 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-23 21:19:50,508 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-23 21:19:50,510 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-23 21:19:50,512 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-23 21:19:50,514 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-23 21:19:50,516 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-23 21:19:50,519 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-23 21:19:50,520 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-23 21:19:50,521 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-23 21:19:50,523 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:19:50,525 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-23 21:19:50,527 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-23 21:19:50,529 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-23 21:19:50,531 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:19:50,533 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-23 21:19:50,535 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-23 21:19:50,537 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-23 21:19:50,538 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-23 21:19:50,540 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-23 21:19:50,542 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-23 21:19:50,544 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-23 21:19:50,546 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-23 21:19:50,548 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-23 21:19:50,549 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-23 21:19:50,551 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-23 21:19:50,553 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-23 21:19:50,555 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-23 21:19:50,557 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-23 21:19:50,559 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-23 21:19:50,561 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-23 21:19:50,562 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-23 21:19:50,564 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-23 21:19:50,566 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:19:50,568 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-23 21:19:50,570 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 21:19:50,572 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-23 21:19:50,574 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:19:50,575 INFO: อัปเดต DB สำเร็จ: 2025-11-21 00:00:00+07:00 → PM2.5 = 16.0
2025-11-23 21:19:50,578 INFO: อัปเดต DB สำเร็จ: 2025-11-21 01:00:00+07:00 → PM2.5 = 13.5
2025-11-23 21:19:50,579 INFO: อัปเดต DB สำเร็จ: 2025-11-21 02:00:00+07:00 → PM2.5 = 9.3
2025-11-23 21:19:50,581 INFO: อัปเดต DB สำเร็จ: 2025-11-21 03:00:00+07:00 → PM2.5 = 16.2
2025-11-23 21:19:50,583 INFO: อัปเดต DB สำเร็จ: 2025-11-21 04:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:19:50,585 INFO: อัปเดต DB สำเร็จ: 2025-11-21 05:00:00+07:00 → PM2.5 = 17.2
2025-11-23 21:19:50,587 INFO: อัปเดต DB สำเร็จ: 2025-11-21 06:00:00+07:00 → PM2.5 = 18.0
2025-11-23 21:19:50,588 INFO: อัปเดต DB สำเร็จ: 2025-11-21 07:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:19:50,590 INFO: อัปเดต DB สำเร็จ: 2025-11-21 08:00:00+07:00 → PM2.5 = 14.6
2025-11-23 21:19:50,592 INFO: อัปเดต DB สำเร็จ: 2025-11-21 09:00:00+07:00 → PM2.5 = 20.8
2025-11-23 21:19:50,594 INFO: อัปเดต DB สำเร็จ: 2025-11-21 10:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:19:50,596 INFO: อัปเดต DB สำเร็จ: 2025-11-21 11:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:19:50,598 INFO: อัปเดต DB สำเร็จ: 2025-11-21 12:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:19:50,600 INFO: อัปเดต DB สำเร็จ: 2025-11-21 13:00:00+07:00 → PM2.5 = 8.5
2025-11-23 21:19:50,601 INFO: อัปเดต DB สำเร็จ: 2025-11-21 14:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:19:50,604 INFO: อัปเดต DB สำเร็จ: 2025-11-21 15:00:00+07:00 → PM2.5 = 17.6
2025-11-23 21:19:50,605 INFO: อัปเดต DB สำเร็จ: 2025-11-21 16:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:19:50,607 INFO: อัปเดต DB สำเร็จ: 2025-11-21 17:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:19:50,609 INFO: อัปเดต DB สำเร็จ: 2025-11-21 18:00:00+07:00 → PM2.5 = 19.4
2025-11-23 21:19:50,610 INFO: อัปเดต DB สำเร็จ: 2025-11-21 19:00:00+07:00 → PM2.5 = 19.2
2025-11-23 21:19:50,612 INFO: อัปเดต DB สำเร็จ: 2025-11-21 20:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:19:50,614 INFO: อัปเดต DB สำเร็จ: 2025-11-21 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 21:19:50,616 INFO: อัปเดต DB สำเร็จ: 2025-11-21 22:00:00+07:00 → PM2.5 = 22.8
2025-11-23 21:19:50,618 INFO: อัปเดต DB สำเร็จ: 2025-11-21 23:00:00+07:00 → PM2.5 = 19.2
2025-11-23 21:19:50,620 INFO: อัปเดต DB สำเร็จ: 2025-11-22 00:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:19:50,621 INFO: อัปเดต DB สำเร็จ: 2025-11-22 01:00:00+07:00 → PM2.5 = 14.8
2025-11-23 21:19:50,623 INFO: อัปเดต DB สำเร็จ: 2025-11-22 02:00:00+07:00 → PM2.5 = 11.0
2025-11-23 21:19:50,625 INFO: อัปเดต DB สำเร็จ: 2025-11-22 03:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:19:50,626 INFO: อัปเดต DB สำเร็จ: 2025-11-22 04:00:00+07:00 → PM2.5 = 13.3
2025-11-23 21:19:50,628 INFO: อัปเดต DB สำเร็จ: 2025-11-22 05:00:00+07:00 → PM2.5 = 14.3
2025-11-23 21:19:50,630 INFO: อัปเดต DB สำเร็จ: 2025-11-22 06:00:00+07:00 → PM2.5 = 22.1
2025-11-23 21:19:50,631 INFO: อัปเดต DB สำเร็จ: 2025-11-22 07:00:00+07:00 → PM2.5 = 18.8
2025-11-23 21:19:50,633 INFO: อัปเดต DB สำเร็จ: 2025-11-22 08:00:00+07:00 → PM2.5 = 20.6
2025-11-23 21:19:50,635 INFO: อัปเดต DB สำเร็จ: 2025-11-22 09:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:19:50,637 INFO: อัปเดต DB สำเร็จ: 2025-11-22 10:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:19:50,638 INFO: อัปเดต DB สำเร็จ: 2025-11-22 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 21:19:50,639 INFO: อัปเดต DB สำเร็จ: 2025-11-22 12:00:00+07:00 → PM2.5 = 6.8
2025-11-23 21:19:50,641 INFO: อัปเดต DB สำเร็จ: 2025-11-22 13:00:00+07:00 → PM2.5 = 7.3
2025-11-23 21:19:50,642 INFO: อัปเดต DB สำเร็จ: 2025-11-22 14:00:00+07:00 → PM2.5 = 7.8
2025-11-23 21:19:50,644 INFO: อัปเดต DB สำเร็จ: 2025-11-22 15:00:00+07:00 → PM2.5 = 8.9
2025-11-23 21:19:50,646 INFO: อัปเดต DB สำเร็จ: 2025-11-22 16:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:19:50,648 INFO: อัปเดต DB สำเร็จ: 2025-11-22 17:00:00+07:00 → PM2.5 = 18.2
2025-11-23 21:19:50,649 INFO: อัปเดต DB สำเร็จ: 2025-11-22 18:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:19:50,652 INFO: อัปเดต DB สำเร็จ: 2025-11-22 19:00:00+07:00 → PM2.5 = 14.9
2025-11-23 21:19:50,653 INFO: อัปเดต DB สำเร็จ: 2025-11-22 20:00:00+07:00 → PM2.5 = 22.7
2025-11-23 21:19:50,655 INFO: อัปเดต DB สำเร็จ: 2025-11-22 21:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:19:50,657 INFO: อัปเดต DB สำเร็จ: 2025-11-22 22:00:00+07:00 → PM2.5 = 26.4
2025-11-23 21:19:50,658 INFO: อัปเดต DB สำเร็จ: 2025-11-22 23:00:00+07:00 → PM2.5 = 24.0
2025-11-23 21:19:50,659 INFO: อัปเดต DB สำเร็จ: 2025-11-23 00:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:19:50,661 INFO: อัปเดต DB สำเร็จ: 2025-11-23 01:00:00+07:00 → PM2.5 = 17.4
2025-11-23 21:19:50,663 INFO: อัปเดต DB สำเร็จ: 2025-11-23 02:00:00+07:00 → PM2.5 = 20.2
2025-11-23 21:19:50,664 INFO: อัปเดต DB สำเร็จ: 2025-11-23 03:00:00+07:00 → PM2.5 = 22.8
2025-11-23 21:19:50,666 INFO: อัปเดต DB สำเร็จ: 2025-11-23 04:00:00+07:00 → PM2.5 = 21.1
2025-11-23 21:19:50,668 INFO: อัปเดต DB สำเร็จ: 2025-11-23 05:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:19:50,670 INFO: อัปเดต DB สำเร็จ: 2025-11-23 06:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:19:50,670 INFO: อัปเดต DB สำเร็จ: 2025-11-23 07:00:00+07:00 → PM2.5 = 22.1
2025-11-23 21:19:50,672 INFO: อัปเดต DB สำเร็จ: 2025-11-23 08:00:00+07:00 → PM2.5 = 20.2
2025-11-23 21:19:50,674 INFO: อัปเดต DB สำเร็จ: 2025-11-23 09:00:00+07:00 → PM2.5 = 26.5
2025-11-23 21:19:50,675 INFO: อัปเดต DB สำเร็จ: 2025-11-23 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:19:50,677 INFO: อัปเดต DB สำเร็จ: 2025-11-23 11:00:00+07:00 → PM2.5 = 16.3
2025-11-23 21:19:50,678 INFO: อัปเดต DB สำเร็จ: 2025-11-23 12:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:19:50,680 INFO: อัปเดต DB สำเร็จ: 2025-11-23 13:00:00+07:00 → PM2.5 = 15.3
2025-11-23 21:19:50,681 INFO: อัปเดต DB สำเร็จ: 2025-11-23 14:00:00+07:00 → PM2.5 = 11.5
2025-11-23 21:19:50,683 INFO: อัปเดต DB สำเร็จ: 2025-11-23 15:00:00+07:00 → PM2.5 = 16.5
2025-11-23 21:19:50,685 INFO: อัปเดต DB สำเร็จ: 2025-11-23 16:00:00+07:00 → PM2.5 = 16.6
2025-11-23 21:19:50,686 INFO: อัปเดต DB สำเร็จ: 2025-11-23 17:00:00+07:00 → PM2.5 = 15.3
2025-11-23 21:19:50,688 INFO: อัปเดต DB สำเร็จ: 2025-11-23 18:00:00+07:00 → PM2.5 = 16.3
2025-11-23 21:19:50,690 INFO: อัปเดต DB สำเร็จ: 2025-11-23 19:00:00+07:00 → PM2.5 = 16.1
2025-11-23 21:19:50,691 INFO: อัปเดต DB สำเร็จ: 2025-11-23 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:19:50,693 INFO: อัปเดต DB สำเร็จ: 2025-11-23 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 21:19:50,693 INFO: โหลด DB สำเร็จ
2025-11-23 21:19:50,695 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 21:19:50,698 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 21:19:50,698 INFO: Load to DB + Backup สำเร็จ
2025-11-23 21:19:50,698 INFO: === PIPELINE END ===

2025-11-23 21:20:10,149 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 21:20:10,153 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 21:20:10,155 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:20:10,156 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 21:20:10,156 INFO: Scheduler started
2025-11-23 21:20:10,157 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 21:20:10,157 INFO: === PIPELINE START ===
2025-11-23 21:20:10,157 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:20:10,888 INFO: ดึง 2025-11-23 20:00:00+07:00 - 2025-11-23 21:00:00+07:00 → 2 แถว
2025-11-23 21:20:10,896 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:20:10,896 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 21:20:10,896 INFO: Fetch สำเร็จ
2025-11-23 21:20:10,916 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-23 21:21:35,852 INFO: เติมข้อมูลย้อนหลังเสร็จ: +97 แถว จาก 49 ชั่วโมง
2025-11-23 21:21:35,855 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 202 แถว
2025-11-23 21:21:35,855 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 21:21:35,857 INFO: รวมเก่า 202 + ใหม่ 202 → 202 (เพิ่ม 0)
2025-11-23 21:21:35,859 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 21:21:35,859 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 21:21:35,870 INFO: เริ่ม clean ข้อมูล: 202 แถว
2025-11-23 21:21:35,887 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (202 แถว)
2025-11-23 21:21:35,890 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 21:21:35,919 INFO: เตรียมโหลด 202 แถว
2025-11-23 21:21:35,971 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-23 21:21:35,972 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-23 21:21:35,975 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-23 21:21:35,977 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-23 21:21:35,978 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-23 21:21:35,980 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-23 21:21:35,982 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-23 21:21:35,983 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-23 21:21:35,985 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-23 21:21:35,987 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-23 21:21:35,988 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-23 21:21:35,989 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-23 21:21:35,991 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:21:35,992 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-23 21:21:35,994 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-23 21:21:35,995 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:21:35,997 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-23 21:21:35,999 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-23 21:21:36,000 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-23 21:21:36,001 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-23 21:21:36,004 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-23 21:21:36,005 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-23 21:21:36,007 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:21:36,009 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:21:36,011 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-23 21:21:36,013 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:21:36,015 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:21:36,016 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:21:36,018 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:21:36,020 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-23 21:21:36,022 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:21:36,024 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-23 21:21:36,026 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-23 21:21:36,028 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-23 21:21:36,029 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-23 21:21:36,031 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:21:36,032 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-23 21:21:36,034 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 21:21:36,037 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-23 21:21:36,038 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-23 21:21:36,040 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-23 21:21:36,042 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-23 21:21:36,044 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-23 21:21:36,045 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-23 21:21:36,047 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:21:36,049 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-23 21:21:36,051 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-23 21:21:36,053 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-23 21:21:36,056 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:21:36,058 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-23 21:21:36,059 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-23 21:21:36,061 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:21:36,063 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-23 21:21:36,065 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:21:36,066 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-23 21:21:36,068 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-23 21:21:36,070 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-23 21:21:36,072 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:21:36,073 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-23 21:21:36,075 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:21:36,076 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-23 21:21:36,077 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-23 21:21:36,078 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-23 21:21:36,080 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-23 21:21:36,082 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-23 21:21:36,083 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-23 21:21:36,085 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-23 21:21:36,086 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-23 21:21:36,088 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-23 21:21:36,089 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-23 21:21:36,091 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:21:36,092 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-23 21:21:36,095 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-23 21:21:36,096 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:21:36,098 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-23 21:21:36,100 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-23 21:21:36,100 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-23 21:21:36,103 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-23 21:21:36,104 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-23 21:21:36,106 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-23 21:21:36,107 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-23 21:21:36,109 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 21:21:36,110 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-23 21:21:36,112 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:21:36,114 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-23 21:21:36,116 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:21:36,117 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:21:36,119 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-23 21:21:36,120 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-23 21:21:36,122 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:21:36,123 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-23 21:21:36,124 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-23 21:21:36,126 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-23 21:21:36,127 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-23 21:21:36,129 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-23 21:21:36,130 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-23 21:21:36,131 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-23 21:21:36,133 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-23 21:21:36,135 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-23 21:21:36,136 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-23 21:21:36,138 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-23 21:21:36,140 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-23 21:21:36,141 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-23 21:21:36,143 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-23 21:21:36,143 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:21:36,146 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-23 21:21:36,148 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-23 21:21:36,150 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-23 21:21:36,151 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:21:36,154 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-23 21:21:36,155 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-23 21:21:36,156 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-23 21:21:36,158 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-23 21:21:36,159 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-23 21:21:36,161 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-23 21:21:36,163 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-23 21:21:36,165 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-23 21:21:36,166 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-23 21:21:36,168 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-23 21:21:36,170 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-23 21:21:36,171 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-23 21:21:36,172 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-23 21:21:36,174 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-23 21:21:36,176 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-23 21:21:36,177 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-23 21:21:36,179 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-23 21:21:36,180 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-23 21:21:36,182 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:21:36,183 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-23 21:21:36,185 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 21:21:36,187 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-23 21:21:36,189 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:21:36,190 INFO: อัปเดต DB สำเร็จ: 2025-11-21 00:00:00+07:00 → PM2.5 = 16.0
2025-11-23 21:21:36,193 INFO: อัปเดต DB สำเร็จ: 2025-11-21 01:00:00+07:00 → PM2.5 = 13.5
2025-11-23 21:21:36,194 INFO: อัปเดต DB สำเร็จ: 2025-11-21 02:00:00+07:00 → PM2.5 = 9.3
2025-11-23 21:21:36,195 INFO: อัปเดต DB สำเร็จ: 2025-11-21 03:00:00+07:00 → PM2.5 = 16.2
2025-11-23 21:21:36,197 INFO: อัปเดต DB สำเร็จ: 2025-11-21 04:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:21:36,199 INFO: อัปเดต DB สำเร็จ: 2025-11-21 05:00:00+07:00 → PM2.5 = 17.2
2025-11-23 21:21:36,200 INFO: อัปเดต DB สำเร็จ: 2025-11-21 06:00:00+07:00 → PM2.5 = 18.0
2025-11-23 21:21:36,202 INFO: อัปเดต DB สำเร็จ: 2025-11-21 07:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:21:36,204 INFO: อัปเดต DB สำเร็จ: 2025-11-21 08:00:00+07:00 → PM2.5 = 14.6
2025-11-23 21:21:36,205 INFO: อัปเดต DB สำเร็จ: 2025-11-21 09:00:00+07:00 → PM2.5 = 20.8
2025-11-23 21:21:36,206 INFO: อัปเดต DB สำเร็จ: 2025-11-21 10:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:21:36,208 INFO: อัปเดต DB สำเร็จ: 2025-11-21 11:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:21:36,209 INFO: อัปเดต DB สำเร็จ: 2025-11-21 12:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:21:36,210 INFO: อัปเดต DB สำเร็จ: 2025-11-21 13:00:00+07:00 → PM2.5 = 8.5
2025-11-23 21:21:36,213 INFO: อัปเดต DB สำเร็จ: 2025-11-21 14:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:21:36,214 INFO: อัปเดต DB สำเร็จ: 2025-11-21 15:00:00+07:00 → PM2.5 = 17.6
2025-11-23 21:21:36,216 INFO: อัปเดต DB สำเร็จ: 2025-11-21 16:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:21:36,217 INFO: อัปเดต DB สำเร็จ: 2025-11-21 17:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:21:36,219 INFO: อัปเดต DB สำเร็จ: 2025-11-21 18:00:00+07:00 → PM2.5 = 19.4
2025-11-23 21:21:36,221 INFO: อัปเดต DB สำเร็จ: 2025-11-21 19:00:00+07:00 → PM2.5 = 19.2
2025-11-23 21:21:36,222 INFO: อัปเดต DB สำเร็จ: 2025-11-21 20:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:21:36,223 INFO: อัปเดต DB สำเร็จ: 2025-11-21 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 21:21:36,225 INFO: อัปเดต DB สำเร็จ: 2025-11-21 22:00:00+07:00 → PM2.5 = 22.8
2025-11-23 21:21:36,226 INFO: อัปเดต DB สำเร็จ: 2025-11-21 23:00:00+07:00 → PM2.5 = 19.2
2025-11-23 21:21:36,228 INFO: อัปเดต DB สำเร็จ: 2025-11-22 00:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:21:36,229 INFO: อัปเดต DB สำเร็จ: 2025-11-22 01:00:00+07:00 → PM2.5 = 14.8
2025-11-23 21:21:36,231 INFO: อัปเดต DB สำเร็จ: 2025-11-22 02:00:00+07:00 → PM2.5 = 11.0
2025-11-23 21:21:36,232 INFO: อัปเดต DB สำเร็จ: 2025-11-22 03:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:21:36,234 INFO: อัปเดต DB สำเร็จ: 2025-11-22 04:00:00+07:00 → PM2.5 = 13.3
2025-11-23 21:21:36,236 INFO: อัปเดต DB สำเร็จ: 2025-11-22 05:00:00+07:00 → PM2.5 = 14.3
2025-11-23 21:21:36,238 INFO: อัปเดต DB สำเร็จ: 2025-11-22 06:00:00+07:00 → PM2.5 = 22.1
2025-11-23 21:21:36,239 INFO: อัปเดต DB สำเร็จ: 2025-11-22 07:00:00+07:00 → PM2.5 = 18.8
2025-11-23 21:21:36,241 INFO: อัปเดต DB สำเร็จ: 2025-11-22 08:00:00+07:00 → PM2.5 = 20.6
2025-11-23 21:21:36,242 INFO: อัปเดต DB สำเร็จ: 2025-11-22 09:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:21:36,244 INFO: อัปเดต DB สำเร็จ: 2025-11-22 10:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:21:36,246 INFO: อัปเดต DB สำเร็จ: 2025-11-22 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 21:21:36,247 INFO: อัปเดต DB สำเร็จ: 2025-11-22 12:00:00+07:00 → PM2.5 = 6.8
2025-11-23 21:21:36,249 INFO: อัปเดต DB สำเร็จ: 2025-11-22 13:00:00+07:00 → PM2.5 = 7.3
2025-11-23 21:21:36,250 INFO: อัปเดต DB สำเร็จ: 2025-11-22 14:00:00+07:00 → PM2.5 = 7.8
2025-11-23 21:21:36,253 INFO: อัปเดต DB สำเร็จ: 2025-11-22 15:00:00+07:00 → PM2.5 = 8.9
2025-11-23 21:21:36,255 INFO: อัปเดต DB สำเร็จ: 2025-11-22 16:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:21:36,256 INFO: อัปเดต DB สำเร็จ: 2025-11-22 17:00:00+07:00 → PM2.5 = 18.2
2025-11-23 21:21:36,257 INFO: อัปเดต DB สำเร็จ: 2025-11-22 18:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:21:36,259 INFO: อัปเดต DB สำเร็จ: 2025-11-22 19:00:00+07:00 → PM2.5 = 14.9
2025-11-23 21:21:36,260 INFO: อัปเดต DB สำเร็จ: 2025-11-22 20:00:00+07:00 → PM2.5 = 22.7
2025-11-23 21:21:36,261 INFO: อัปเดต DB สำเร็จ: 2025-11-22 21:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:21:36,263 INFO: อัปเดต DB สำเร็จ: 2025-11-22 22:00:00+07:00 → PM2.5 = 26.4
2025-11-23 21:21:36,265 INFO: อัปเดต DB สำเร็จ: 2025-11-22 23:00:00+07:00 → PM2.5 = 24.0
2025-11-23 21:21:36,266 INFO: อัปเดต DB สำเร็จ: 2025-11-23 00:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:21:36,268 INFO: อัปเดต DB สำเร็จ: 2025-11-23 01:00:00+07:00 → PM2.5 = 17.4
2025-11-23 21:21:36,270 INFO: อัปเดต DB สำเร็จ: 2025-11-23 02:00:00+07:00 → PM2.5 = 20.2
2025-11-23 21:21:36,272 INFO: อัปเดต DB สำเร็จ: 2025-11-23 03:00:00+07:00 → PM2.5 = 22.8
2025-11-23 21:21:36,274 INFO: อัปเดต DB สำเร็จ: 2025-11-23 04:00:00+07:00 → PM2.5 = 21.1
2025-11-23 21:21:36,275 INFO: อัปเดต DB สำเร็จ: 2025-11-23 05:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:21:36,277 INFO: อัปเดต DB สำเร็จ: 2025-11-23 06:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:21:36,278 INFO: อัปเดต DB สำเร็จ: 2025-11-23 07:00:00+07:00 → PM2.5 = 22.1
2025-11-23 21:21:36,280 INFO: อัปเดต DB สำเร็จ: 2025-11-23 08:00:00+07:00 → PM2.5 = 20.2
2025-11-23 21:21:36,282 INFO: อัปเดต DB สำเร็จ: 2025-11-23 09:00:00+07:00 → PM2.5 = 26.5
2025-11-23 21:21:36,283 INFO: อัปเดต DB สำเร็จ: 2025-11-23 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:21:36,285 INFO: อัปเดต DB สำเร็จ: 2025-11-23 11:00:00+07:00 → PM2.5 = 16.3
2025-11-23 21:21:36,286 INFO: อัปเดต DB สำเร็จ: 2025-11-23 12:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:21:36,288 INFO: อัปเดต DB สำเร็จ: 2025-11-23 13:00:00+07:00 → PM2.5 = 15.3
2025-11-23 21:21:36,289 INFO: อัปเดต DB สำเร็จ: 2025-11-23 14:00:00+07:00 → PM2.5 = 11.5
2025-11-23 21:21:36,292 INFO: อัปเดต DB สำเร็จ: 2025-11-23 15:00:00+07:00 → PM2.5 = 16.5
2025-11-23 21:21:36,293 INFO: อัปเดต DB สำเร็จ: 2025-11-23 16:00:00+07:00 → PM2.5 = 16.6
2025-11-23 21:21:36,295 INFO: อัปเดต DB สำเร็จ: 2025-11-23 17:00:00+07:00 → PM2.5 = 15.3
2025-11-23 21:21:36,297 INFO: อัปเดต DB สำเร็จ: 2025-11-23 18:00:00+07:00 → PM2.5 = 16.3
2025-11-23 21:21:36,298 INFO: อัปเดต DB สำเร็จ: 2025-11-23 19:00:00+07:00 → PM2.5 = 16.1
2025-11-23 21:21:36,300 INFO: อัปเดต DB สำเร็จ: 2025-11-23 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:21:36,301 INFO: อัปเดต DB สำเร็จ: 2025-11-23 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 21:21:36,301 INFO: โหลด DB สำเร็จ
2025-11-23 21:21:36,304 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 21:21:36,306 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 21:21:36,307 INFO: Load to DB + Backup สำเร็จ
2025-11-23 21:21:36,307 INFO: === PIPELINE END ===

2025-11-23 21:28:32,022 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 21:28:32,027 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 21:28:32,029 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:28:32,030 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 21:28:32,030 INFO: Scheduler started
2025-11-23 21:28:32,030 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 21:28:32,030 INFO: === PIPELINE START ===
2025-11-23 21:28:32,030 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:28:32,774 INFO: ดึง 2025-11-23 20:00:00+07:00 - 2025-11-23 21:00:00+07:00 → 2 แถว
2025-11-23 21:28:32,781 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:28:32,782 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 21:28:32,782 INFO: Fetch สำเร็จ
2025-11-23 21:28:32,782 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 21:28:32,812 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 21:28:32,814 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 202 แถว
2025-11-23 21:28:32,815 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 21:28:32,817 INFO: รวมเก่า 202 + ใหม่ 202 → 202 (เพิ่ม 0)
2025-11-23 21:28:32,818 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 21:28:32,818 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 21:28:32,831 INFO: เริ่ม clean ข้อมูล: 202 แถว
2025-11-23 21:28:32,845 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (202 แถว)
2025-11-23 21:28:32,849 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 21:28:32,879 INFO: เตรียมโหลด 202 แถว
2025-11-23 21:28:32,930 INFO: อัปเดต DB สำเร็จ: 2025-11-13 22:00:00+07:00 → PM2.5 = 17.3
2025-11-23 21:28:32,932 INFO: อัปเดต DB สำเร็จ: 2025-11-13 23:00:00+07:00 → PM2.5 = 19.3
2025-11-23 21:28:32,935 INFO: อัปเดต DB สำเร็จ: 2025-11-14 00:00:00+07:00 → PM2.5 = 18.4
2025-11-23 21:28:32,936 INFO: อัปเดต DB สำเร็จ: 2025-11-14 01:00:00+07:00 → PM2.5 = 10.8
2025-11-23 21:28:32,938 INFO: อัปเดต DB สำเร็จ: 2025-11-14 02:00:00+07:00 → PM2.5 = 3.4
2025-11-23 21:28:32,939 INFO: อัปเดต DB สำเร็จ: 2025-11-14 03:00:00+07:00 → PM2.5 = 11.1
2025-11-23 21:28:32,941 INFO: อัปเดต DB สำเร็จ: 2025-11-14 04:00:00+07:00 → PM2.5 = 6.8
2025-11-23 21:28:32,943 INFO: อัปเดต DB สำเร็จ: 2025-11-14 05:00:00+07:00 → PM2.5 = 7.0
2025-11-23 21:28:32,945 INFO: อัปเดต DB สำเร็จ: 2025-11-14 06:00:00+07:00 → PM2.5 = 13.2
2025-11-23 21:28:32,946 INFO: อัปเดต DB สำเร็จ: 2025-11-14 07:00:00+07:00 → PM2.5 = 19.1
2025-11-23 21:28:32,948 INFO: อัปเดต DB สำเร็จ: 2025-11-14 08:00:00+07:00 → PM2.5 = 17.8
2025-11-23 21:28:32,949 INFO: อัปเดต DB สำเร็จ: 2025-11-14 09:00:00+07:00 → PM2.5 = 24.4
2025-11-23 21:28:32,950 INFO: อัปเดต DB สำเร็จ: 2025-11-14 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:28:32,952 INFO: อัปเดต DB สำเร็จ: 2025-11-14 11:00:00+07:00 → PM2.5 = 13.6
2025-11-23 21:28:32,953 INFO: อัปเดต DB สำเร็จ: 2025-11-14 12:00:00+07:00 → PM2.5 = 11.3
2025-11-23 21:28:32,955 INFO: อัปเดต DB สำเร็จ: 2025-11-14 13:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:28:32,957 INFO: อัปเดต DB สำเร็จ: 2025-11-14 14:00:00+07:00 → PM2.5 = 12.8
2025-11-23 21:28:32,958 INFO: อัปเดต DB สำเร็จ: 2025-11-14 15:00:00+07:00 → PM2.5 = 12.1
2025-11-23 21:28:32,960 INFO: อัปเดต DB สำเร็จ: 2025-11-14 16:00:00+07:00 → PM2.5 = 13.1
2025-11-23 21:28:32,961 INFO: อัปเดต DB สำเร็จ: 2025-11-14 17:00:00+07:00 → PM2.5 = 11.6
2025-11-23 21:28:32,964 INFO: อัปเดต DB สำเร็จ: 2025-11-14 18:00:00+07:00 → PM2.5 = 16.2
2025-11-23 21:28:32,965 INFO: อัปเดต DB สำเร็จ: 2025-11-14 19:00:00+07:00 → PM2.5 = 17.1
2025-11-23 21:28:32,967 INFO: อัปเดต DB สำเร็จ: 2025-11-14 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:28:32,969 INFO: อัปเดต DB สำเร็จ: 2025-11-14 21:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:28:32,970 INFO: อัปเดต DB สำเร็จ: 2025-11-14 22:00:00+07:00 → PM2.5 = 21.0
2025-11-23 21:28:32,972 INFO: อัปเดต DB สำเร็จ: 2025-11-14 23:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:28:32,974 INFO: อัปเดต DB สำเร็จ: 2025-11-15 00:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:28:32,975 INFO: อัปเดต DB สำเร็จ: 2025-11-15 01:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:28:32,977 INFO: อัปเดต DB สำเร็จ: 2025-11-15 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:28:32,979 INFO: อัปเดต DB สำเร็จ: 2025-11-15 03:00:00+07:00 → PM2.5 = 24.4
2025-11-23 21:28:32,980 INFO: อัปเดต DB สำเร็จ: 2025-11-15 04:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:28:32,982 INFO: อัปเดต DB สำเร็จ: 2025-11-15 05:00:00+07:00 → PM2.5 = 27.6
2025-11-23 21:28:32,983 INFO: อัปเดต DB สำเร็จ: 2025-11-15 06:00:00+07:00 → PM2.5 = 21.7
2025-11-23 21:28:32,986 INFO: อัปเดต DB สำเร็จ: 2025-11-15 07:00:00+07:00 → PM2.5 = 27.2
2025-11-23 21:28:32,987 INFO: อัปเดต DB สำเร็จ: 2025-11-15 08:00:00+07:00 → PM2.5 = 21.1
2025-11-23 21:28:32,989 INFO: อัปเดต DB สำเร็จ: 2025-11-15 09:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:28:32,991 INFO: อัปเดต DB สำเร็จ: 2025-11-15 10:00:00+07:00 → PM2.5 = 17.9
2025-11-23 21:28:32,992 INFO: อัปเดต DB สำเร็จ: 2025-11-15 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 21:28:32,994 INFO: อัปเดต DB สำเร็จ: 2025-11-15 12:00:00+07:00 → PM2.5 = 14.0
2025-11-23 21:28:32,995 INFO: อัปเดต DB สำเร็จ: 2025-11-15 13:00:00+07:00 → PM2.5 = 16.0
2025-11-23 21:28:32,997 INFO: อัปเดต DB สำเร็จ: 2025-11-15 14:00:00+07:00 → PM2.5 = 17.8
2025-11-23 21:28:32,999 INFO: อัปเดต DB สำเร็จ: 2025-11-15 15:00:00+07:00 → PM2.5 = 12.4
2025-11-23 21:28:33,000 INFO: อัปเดต DB สำเร็จ: 2025-11-15 16:00:00+07:00 → PM2.5 = 12.0
2025-11-23 21:28:33,002 INFO: อัปเดต DB สำเร็จ: 2025-11-15 17:00:00+07:00 → PM2.5 = 9.8
2025-11-23 21:28:33,004 INFO: อัปเดต DB สำเร็จ: 2025-11-15 18:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:28:33,005 INFO: อัปเดต DB สำเร็จ: 2025-11-15 19:00:00+07:00 → PM2.5 = 16.8
2025-11-23 21:28:33,007 INFO: อัปเดต DB สำเร็จ: 2025-11-15 20:00:00+07:00 → PM2.5 = 13.4
2025-11-23 21:28:33,008 INFO: อัปเดต DB สำเร็จ: 2025-11-15 21:00:00+07:00 → PM2.5 = 16.9
2025-11-23 21:28:33,010 INFO: อัปเดต DB สำเร็จ: 2025-11-15 22:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:28:33,012 INFO: อัปเดต DB สำเร็จ: 2025-11-15 23:00:00+07:00 → PM2.5 = 22.166666666666668
2025-11-23 21:28:33,013 INFO: อัปเดต DB สำเร็จ: 2025-11-16 00:00:00+07:00 → PM2.5 = 22.333333333333332
2025-11-23 21:28:33,015 INFO: อัปเดต DB สำเร็จ: 2025-11-16 01:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:28:33,016 INFO: อัปเดต DB สำเร็จ: 2025-11-16 02:00:00+07:00 → PM2.5 = 23.7
2025-11-23 21:28:33,018 INFO: อัปเดต DB สำเร็จ: 2025-11-16 03:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:28:33,020 INFO: อัปเดต DB สำเร็จ: 2025-11-16 04:00:00+07:00 → PM2.5 = 20.6
2025-11-23 21:28:33,021 INFO: อัปเดต DB สำเร็จ: 2025-11-16 05:00:00+07:00 → PM2.5 = 19.1
2025-11-23 21:28:33,023 INFO: อัปเดต DB สำเร็จ: 2025-11-16 06:00:00+07:00 → PM2.5 = 21.5
2025-11-23 21:28:33,024 INFO: อัปเดต DB สำเร็จ: 2025-11-16 07:00:00+07:00 → PM2.5 = 22.5
2025-11-23 21:28:33,026 INFO: อัปเดต DB สำเร็จ: 2025-11-16 08:00:00+07:00 → PM2.5 = 15.2
2025-11-23 21:28:33,028 INFO: อัปเดต DB สำเร็จ: 2025-11-16 09:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:28:33,029 INFO: อัปเดต DB สำเร็จ: 2025-11-16 10:00:00+07:00 → PM2.5 = 8.3
2025-11-23 21:28:33,030 INFO: อัปเดต DB สำเร็จ: 2025-11-16 11:00:00+07:00 → PM2.5 = 3.7
2025-11-23 21:28:33,032 INFO: อัปเดต DB สำเร็จ: 2025-11-16 12:00:00+07:00 → PM2.5 = 6.1
2025-11-23 21:28:33,034 INFO: อัปเดต DB สำเร็จ: 2025-11-16 13:00:00+07:00 → PM2.5 = 6.6
2025-11-23 21:28:33,036 INFO: อัปเดต DB สำเร็จ: 2025-11-16 14:00:00+07:00 → PM2.5 = 4.4
2025-11-23 21:28:33,038 INFO: อัปเดต DB สำเร็จ: 2025-11-16 15:00:00+07:00 → PM2.5 = 12.3
2025-11-23 21:28:33,040 INFO: อัปเดต DB สำเร็จ: 2025-11-16 16:00:00+07:00 → PM2.5 = 12.6
2025-11-23 21:28:33,041 INFO: อัปเดต DB สำเร็จ: 2025-11-16 17:00:00+07:00 → PM2.5 = 10.9
2025-11-23 21:28:33,043 INFO: อัปเดต DB สำเร็จ: 2025-11-16 18:00:00+07:00 → PM2.5 = 9.4
2025-11-23 21:28:33,044 INFO: อัปเดต DB สำเร็จ: 2025-11-16 19:00:00+07:00 → PM2.5 = 13.1
2025-11-23 21:28:33,046 INFO: อัปเดต DB สำเร็จ: 2025-11-16 20:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:28:33,047 INFO: อัปเดต DB สำเร็จ: 2025-11-16 21:00:00+07:00 → PM2.5 = 10.1
2025-11-23 21:28:33,049 INFO: อัปเดต DB สำเร็จ: 2025-11-16 22:00:00+07:00 → PM2.5 = 10.11
2025-11-23 21:28:33,050 INFO: อัปเดต DB สำเร็จ: 2025-11-18 13:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:28:33,051 INFO: อัปเดต DB สำเร็จ: 2025-11-18 14:00:00+07:00 → PM2.5 = 9.1
2025-11-23 21:28:33,053 INFO: อัปเดต DB สำเร็จ: 2025-11-18 15:00:00+07:00 → PM2.5 = 17.0
2025-11-23 21:28:33,055 INFO: อัปเดต DB สำเร็จ: 2025-11-18 16:00:00+07:00 → PM2.5 = 15.8
2025-11-23 21:28:33,057 INFO: อัปเดต DB สำเร็จ: 2025-11-18 17:00:00+07:00 → PM2.5 = 16.4
2025-11-23 21:28:33,058 INFO: อัปเดต DB สำเร็จ: 2025-11-18 18:00:00+07:00 → PM2.5 = 16.4
2025-11-23 21:28:33,060 INFO: อัปเดต DB สำเร็จ: 2025-11-18 19:00:00+07:00 → PM2.5 = 14.6
2025-11-23 21:28:33,061 INFO: อัปเดต DB สำเร็จ: 2025-11-18 20:00:00+07:00 → PM2.5 = 23.7
2025-11-23 21:28:33,064 INFO: อัปเดต DB สำเร็จ: 2025-11-18 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 21:28:33,066 INFO: อัปเดต DB สำเร็จ: 2025-11-18 22:00:00+07:00 → PM2.5 = 18.6
2025-11-23 21:28:33,068 INFO: อัปเดต DB สำเร็จ: 2025-11-18 23:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:28:33,069 INFO: อัปเดต DB สำเร็จ: 2025-11-19 00:00:00+07:00 → PM2.5 = 21.6
2025-11-23 21:28:33,071 INFO: อัปเดต DB สำเร็จ: 2025-11-19 01:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:28:33,073 INFO: อัปเดต DB สำเร็จ: 2025-11-19 02:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:28:33,074 INFO: อัปเดต DB สำเร็จ: 2025-11-19 03:00:00+07:00 → PM2.5 = 11.5
2025-11-23 21:28:33,076 INFO: อัปเดต DB สำเร็จ: 2025-11-19 04:00:00+07:00 → PM2.5 = 17.7
2025-11-23 21:28:33,078 INFO: อัปเดต DB สำเร็จ: 2025-11-19 05:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:28:33,080 INFO: อัปเดต DB สำเร็จ: 2025-11-19 06:00:00+07:00 → PM2.5 = 16.5
2025-11-23 21:28:33,082 INFO: อัปเดต DB สำเร็จ: 2025-11-19 07:00:00+07:00 → PM2.5 = 21.25
2025-11-23 21:28:33,084 INFO: อัปเดต DB สำเร็จ: 2025-11-19 08:00:00+07:00 → PM2.5 = 26.0
2025-11-23 21:28:33,086 INFO: อัปเดต DB สำเร็จ: 2025-11-19 09:00:00+07:00 → PM2.5 = 23.5
2025-11-23 21:28:33,088 INFO: อัปเดต DB สำเร็จ: 2025-11-19 10:00:00+07:00 → PM2.5 = 22.2
2025-11-23 21:28:33,090 INFO: อัปเดต DB สำเร็จ: 2025-11-19 11:00:00+07:00 → PM2.5 = 11.9
2025-11-23 21:28:33,091 INFO: อัปเดต DB สำเร็จ: 2025-11-19 12:00:00+07:00 → PM2.5 = 4.4
2025-11-23 21:28:33,093 INFO: อัปเดต DB สำเร็จ: 2025-11-19 13:00:00+07:00 → PM2.5 = 11.2
2025-11-23 21:28:33,096 INFO: อัปเดต DB สำเร็จ: 2025-11-19 14:00:00+07:00 → PM2.5 = 8.5
2025-11-23 21:28:33,098 INFO: อัปเดต DB สำเร็จ: 2025-11-19 15:00:00+07:00 → PM2.5 = 11.8
2025-11-23 21:28:33,100 INFO: อัปเดต DB สำเร็จ: 2025-11-19 16:00:00+07:00 → PM2.5 = 11.1
2025-11-23 21:28:33,101 INFO: อัปเดต DB สำเร็จ: 2025-11-19 17:00:00+07:00 → PM2.5 = 1.5
2025-11-23 21:28:33,103 INFO: อัปเดต DB สำเร็จ: 2025-11-19 18:00:00+07:00 → PM2.5 = 9.0
2025-11-23 21:28:33,106 INFO: อัปเดต DB สำเร็จ: 2025-11-19 19:00:00+07:00 → PM2.5 = 13.4
2025-11-23 21:28:33,107 INFO: อัปเดต DB สำเร็จ: 2025-11-19 20:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:28:33,109 INFO: อัปเดต DB สำเร็จ: 2025-11-19 21:00:00+07:00 → PM2.5 = 12.9
2025-11-23 21:28:33,112 INFO: อัปเดต DB สำเร็จ: 2025-11-19 22:00:00+07:00 → PM2.5 = 7.9
2025-11-23 21:28:33,113 INFO: อัปเดต DB สำเร็จ: 2025-11-19 23:00:00+07:00 → PM2.5 = 8.4
2025-11-23 21:28:33,115 INFO: อัปเดต DB สำเร็จ: 2025-11-20 00:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:28:33,117 INFO: อัปเดต DB สำเร็จ: 2025-11-20 01:00:00+07:00 → PM2.5 = 2.9
2025-11-23 21:28:33,120 INFO: อัปเดต DB สำเร็จ: 2025-11-20 02:00:00+07:00 → PM2.5 = 5.5
2025-11-23 21:28:33,124 INFO: อัปเดต DB สำเร็จ: 2025-11-20 03:00:00+07:00 → PM2.5 = 7.3
2025-11-23 21:28:33,126 INFO: อัปเดต DB สำเร็จ: 2025-11-20 04:00:00+07:00 → PM2.5 = 3.1
2025-11-23 21:28:33,130 INFO: อัปเดต DB สำเร็จ: 2025-11-20 05:00:00+07:00 → PM2.5 = 6.2
2025-11-23 21:28:33,132 INFO: อัปเดต DB สำเร็จ: 2025-11-20 06:00:00+07:00 → PM2.5 = 11.8
2025-11-23 21:28:33,135 INFO: อัปเดต DB สำเร็จ: 2025-11-20 07:00:00+07:00 → PM2.5 = 8.8
2025-11-23 21:28:33,138 INFO: อัปเดต DB สำเร็จ: 2025-11-20 08:00:00+07:00 → PM2.5 = 12.7
2025-11-23 21:28:33,140 INFO: อัปเดต DB สำเร็จ: 2025-11-20 09:00:00+07:00 → PM2.5 = 13.5
2025-11-23 21:28:33,142 INFO: อัปเดต DB สำเร็จ: 2025-11-20 10:00:00+07:00 → PM2.5 = 10.3
2025-11-23 21:28:33,144 INFO: อัปเดต DB สำเร็จ: 2025-11-20 11:00:00+07:00 → PM2.5 = 10.2
2025-11-23 21:28:33,146 INFO: อัปเดต DB สำเร็จ: 2025-11-20 12:00:00+07:00 → PM2.5 = 8.0
2025-11-23 21:28:33,148 INFO: อัปเดต DB สำเร็จ: 2025-11-20 13:00:00+07:00 → PM2.5 = 7.4
2025-11-23 21:28:33,152 INFO: อัปเดต DB สำเร็จ: 2025-11-20 14:00:00+07:00 → PM2.5 = 7.1
2025-11-23 21:28:33,153 INFO: อัปเดต DB สำเร็จ: 2025-11-20 15:00:00+07:00 → PM2.5 = 11.7
2025-11-23 21:28:33,155 INFO: อัปเดต DB สำเร็จ: 2025-11-20 16:00:00+07:00 → PM2.5 = 15.1
2025-11-23 21:28:33,158 INFO: อัปเดต DB สำเร็จ: 2025-11-20 17:00:00+07:00 → PM2.5 = 12.6
2025-11-23 21:28:33,159 INFO: อัปเดต DB สำเร็จ: 2025-11-20 18:00:00+07:00 → PM2.5 = 13.6
2025-11-23 21:28:33,160 INFO: อัปเดต DB สำเร็จ: 2025-11-20 19:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:28:33,162 INFO: อัปเดต DB สำเร็จ: 2025-11-20 20:00:00+07:00 → PM2.5 = 26.6
2025-11-23 21:28:33,164 INFO: อัปเดต DB สำเร็จ: 2025-11-20 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 21:28:33,165 INFO: อัปเดต DB สำเร็จ: 2025-11-20 22:00:00+07:00 → PM2.5 = 13.3
2025-11-23 21:28:33,167 INFO: อัปเดต DB สำเร็จ: 2025-11-20 23:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:28:33,168 INFO: อัปเดต DB สำเร็จ: 2025-11-21 00:00:00+07:00 → PM2.5 = 16.0
2025-11-23 21:28:33,170 INFO: อัปเดต DB สำเร็จ: 2025-11-21 01:00:00+07:00 → PM2.5 = 13.5
2025-11-23 21:28:33,171 INFO: อัปเดต DB สำเร็จ: 2025-11-21 02:00:00+07:00 → PM2.5 = 9.3
2025-11-23 21:28:33,174 INFO: อัปเดต DB สำเร็จ: 2025-11-21 03:00:00+07:00 → PM2.5 = 16.2
2025-11-23 21:28:33,175 INFO: อัปเดต DB สำเร็จ: 2025-11-21 04:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:28:33,177 INFO: อัปเดต DB สำเร็จ: 2025-11-21 05:00:00+07:00 → PM2.5 = 17.2
2025-11-23 21:28:33,178 INFO: อัปเดต DB สำเร็จ: 2025-11-21 06:00:00+07:00 → PM2.5 = 18.0
2025-11-23 21:28:33,180 INFO: อัปเดต DB สำเร็จ: 2025-11-21 07:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:28:33,181 INFO: อัปเดต DB สำเร็จ: 2025-11-21 08:00:00+07:00 → PM2.5 = 14.6
2025-11-23 21:28:33,183 INFO: อัปเดต DB สำเร็จ: 2025-11-21 09:00:00+07:00 → PM2.5 = 20.8
2025-11-23 21:28:33,185 INFO: อัปเดต DB สำเร็จ: 2025-11-21 10:00:00+07:00 → PM2.5 = 13.9
2025-11-23 21:28:33,186 INFO: อัปเดต DB สำเร็จ: 2025-11-21 11:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:28:33,188 INFO: อัปเดต DB สำเร็จ: 2025-11-21 12:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:28:33,190 INFO: อัปเดต DB สำเร็จ: 2025-11-21 13:00:00+07:00 → PM2.5 = 8.5
2025-11-23 21:28:33,192 INFO: อัปเดต DB สำเร็จ: 2025-11-21 14:00:00+07:00 → PM2.5 = 10.4
2025-11-23 21:28:33,194 INFO: อัปเดต DB สำเร็จ: 2025-11-21 15:00:00+07:00 → PM2.5 = 17.6
2025-11-23 21:28:33,195 INFO: อัปเดต DB สำเร็จ: 2025-11-21 16:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:28:33,197 INFO: อัปเดต DB สำเร็จ: 2025-11-21 17:00:00+07:00 → PM2.5 = 15.7
2025-11-23 21:28:33,198 INFO: อัปเดต DB สำเร็จ: 2025-11-21 18:00:00+07:00 → PM2.5 = 19.4
2025-11-23 21:28:33,201 INFO: อัปเดต DB สำเร็จ: 2025-11-21 19:00:00+07:00 → PM2.5 = 19.2
2025-11-23 21:28:33,202 INFO: อัปเดต DB สำเร็จ: 2025-11-21 20:00:00+07:00 → PM2.5 = 19.8
2025-11-23 21:28:33,203 INFO: อัปเดต DB สำเร็จ: 2025-11-21 21:00:00+07:00 → PM2.5 = 20.0
2025-11-23 21:28:33,205 INFO: อัปเดต DB สำเร็จ: 2025-11-21 22:00:00+07:00 → PM2.5 = 22.8
2025-11-23 21:28:33,207 INFO: อัปเดต DB สำเร็จ: 2025-11-21 23:00:00+07:00 → PM2.5 = 19.2
2025-11-23 21:28:33,208 INFO: อัปเดต DB สำเร็จ: 2025-11-22 00:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:28:33,210 INFO: อัปเดต DB สำเร็จ: 2025-11-22 01:00:00+07:00 → PM2.5 = 14.8
2025-11-23 21:28:33,212 INFO: อัปเดต DB สำเร็จ: 2025-11-22 02:00:00+07:00 → PM2.5 = 11.0
2025-11-23 21:28:33,213 INFO: อัปเดต DB สำเร็จ: 2025-11-22 03:00:00+07:00 → PM2.5 = 15.5
2025-11-23 21:28:33,215 INFO: อัปเดต DB สำเร็จ: 2025-11-22 04:00:00+07:00 → PM2.5 = 13.3
2025-11-23 21:28:33,217 INFO: อัปเดต DB สำเร็จ: 2025-11-22 05:00:00+07:00 → PM2.5 = 14.3
2025-11-23 21:28:33,219 INFO: อัปเดต DB สำเร็จ: 2025-11-22 06:00:00+07:00 → PM2.5 = 22.1
2025-11-23 21:28:33,220 INFO: อัปเดต DB สำเร็จ: 2025-11-22 07:00:00+07:00 → PM2.5 = 18.8
2025-11-23 21:28:33,221 INFO: อัปเดต DB สำเร็จ: 2025-11-22 08:00:00+07:00 → PM2.5 = 20.6
2025-11-23 21:28:33,224 INFO: อัปเดต DB สำเร็จ: 2025-11-22 09:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:28:33,225 INFO: อัปเดต DB สำเร็จ: 2025-11-22 10:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:28:33,226 INFO: อัปเดต DB สำเร็จ: 2025-11-22 11:00:00+07:00 → PM2.5 = 9.9
2025-11-23 21:28:33,228 INFO: อัปเดต DB สำเร็จ: 2025-11-22 12:00:00+07:00 → PM2.5 = 6.8
2025-11-23 21:28:33,230 INFO: อัปเดต DB สำเร็จ: 2025-11-22 13:00:00+07:00 → PM2.5 = 7.3
2025-11-23 21:28:33,232 INFO: อัปเดต DB สำเร็จ: 2025-11-22 14:00:00+07:00 → PM2.5 = 7.8
2025-11-23 21:28:33,234 INFO: อัปเดต DB สำเร็จ: 2025-11-22 15:00:00+07:00 → PM2.5 = 8.9
2025-11-23 21:28:33,236 INFO: อัปเดต DB สำเร็จ: 2025-11-22 16:00:00+07:00 → PM2.5 = 14.4
2025-11-23 21:28:33,238 INFO: อัปเดต DB สำเร็จ: 2025-11-22 17:00:00+07:00 → PM2.5 = 18.2
2025-11-23 21:28:33,240 INFO: อัปเดต DB สำเร็จ: 2025-11-22 18:00:00+07:00 → PM2.5 = 10.5
2025-11-23 21:28:33,241 INFO: อัปเดต DB สำเร็จ: 2025-11-22 19:00:00+07:00 → PM2.5 = 14.9
2025-11-23 21:28:33,243 INFO: อัปเดต DB สำเร็จ: 2025-11-22 20:00:00+07:00 → PM2.5 = 22.7
2025-11-23 21:28:33,245 INFO: อัปเดต DB สำเร็จ: 2025-11-22 21:00:00+07:00 → PM2.5 = 20.9
2025-11-23 21:28:33,246 INFO: อัปเดต DB สำเร็จ: 2025-11-22 22:00:00+07:00 → PM2.5 = 26.4
2025-11-23 21:28:33,249 INFO: อัปเดต DB สำเร็จ: 2025-11-22 23:00:00+07:00 → PM2.5 = 24.0
2025-11-23 21:28:33,250 INFO: อัปเดต DB สำเร็จ: 2025-11-23 00:00:00+07:00 → PM2.5 = 15.4
2025-11-23 21:28:33,252 INFO: อัปเดต DB สำเร็จ: 2025-11-23 01:00:00+07:00 → PM2.5 = 17.4
2025-11-23 21:28:33,254 INFO: อัปเดต DB สำเร็จ: 2025-11-23 02:00:00+07:00 → PM2.5 = 20.2
2025-11-23 21:28:33,256 INFO: อัปเดต DB สำเร็จ: 2025-11-23 03:00:00+07:00 → PM2.5 = 22.8
2025-11-23 21:28:33,257 INFO: อัปเดต DB สำเร็จ: 2025-11-23 04:00:00+07:00 → PM2.5 = 21.1
2025-11-23 21:28:33,259 INFO: อัปเดต DB สำเร็จ: 2025-11-23 05:00:00+07:00 → PM2.5 = 22.0
2025-11-23 21:28:33,261 INFO: อัปเดต DB สำเร็จ: 2025-11-23 06:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:28:33,263 INFO: อัปเดต DB สำเร็จ: 2025-11-23 07:00:00+07:00 → PM2.5 = 22.1
2025-11-23 21:28:33,265 INFO: อัปเดต DB สำเร็จ: 2025-11-23 08:00:00+07:00 → PM2.5 = 20.2
2025-11-23 21:28:33,267 INFO: อัปเดต DB สำเร็จ: 2025-11-23 09:00:00+07:00 → PM2.5 = 26.5
2025-11-23 21:28:33,269 INFO: อัปเดต DB สำเร็จ: 2025-11-23 10:00:00+07:00 → PM2.5 = 20.3
2025-11-23 21:28:33,270 INFO: อัปเดต DB สำเร็จ: 2025-11-23 11:00:00+07:00 → PM2.5 = 16.3
2025-11-23 21:28:33,273 INFO: อัปเดต DB สำเร็จ: 2025-11-23 12:00:00+07:00 → PM2.5 = 19.0
2025-11-23 21:28:33,275 INFO: อัปเดต DB สำเร็จ: 2025-11-23 13:00:00+07:00 → PM2.5 = 15.3
2025-11-23 21:28:33,277 INFO: อัปเดต DB สำเร็จ: 2025-11-23 14:00:00+07:00 → PM2.5 = 11.5
2025-11-23 21:28:33,279 INFO: อัปเดต DB สำเร็จ: 2025-11-23 15:00:00+07:00 → PM2.5 = 16.5
2025-11-23 21:28:33,280 INFO: อัปเดต DB สำเร็จ: 2025-11-23 16:00:00+07:00 → PM2.5 = 16.6
2025-11-23 21:28:33,282 INFO: อัปเดต DB สำเร็จ: 2025-11-23 17:00:00+07:00 → PM2.5 = 15.3
2025-11-23 21:28:33,284 INFO: อัปเดต DB สำเร็จ: 2025-11-23 18:00:00+07:00 → PM2.5 = 16.3
2025-11-23 21:28:33,286 INFO: อัปเดต DB สำเร็จ: 2025-11-23 19:00:00+07:00 → PM2.5 = 16.1
2025-11-23 21:28:33,287 INFO: อัปเดต DB สำเร็จ: 2025-11-23 20:00:00+07:00 → PM2.5 = 19.6
2025-11-23 21:28:33,289 INFO: อัปเดต DB สำเร็จ: 2025-11-23 21:00:00+07:00 → PM2.5 = 23.3
2025-11-23 21:28:33,289 INFO: โหลด DB สำเร็จ
2025-11-23 21:28:33,292 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 21:28:33,295 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 21:28:33,296 INFO: Load to DB + Backup สำเร็จ
2025-11-23 21:28:33,296 INFO: === PIPELINE END ===

2025-11-23 21:47:56,616 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 21:47:56,622 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 21:47:56,624 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:47:56,625 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 21:47:56,625 INFO: Scheduler started
2025-11-23 21:47:56,625 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 21:47:56,625 INFO: === PIPELINE START ===
2025-11-23 21:47:56,626 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:47:57,321 INFO: ดึง 2025-11-23 20:00:00+07:00 - 2025-11-23 21:00:00+07:00 → 2 แถว
2025-11-23 21:47:57,330 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:47:57,330 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 21:47:57,330 INFO: Fetch สำเร็จ
2025-11-23 21:47:57,331 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 21:47:57,359 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 21:47:57,360 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 202 แถว
2025-11-23 21:47:57,361 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 21:47:57,363 INFO: รวมเก่า 202 + ใหม่ 202 → 202 (เพิ่ม 0)
2025-11-23 21:47:57,365 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 21:47:57,365 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 21:47:57,376 INFO: เริ่ม clean ข้อมูล: 202 แถว
2025-11-23 21:47:57,388 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (202 แถว)
2025-11-23 21:47:57,392 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 21:47:57,421 INFO: เตรียมโหลด 202 แถว
2025-11-23 21:47:57,704 INFO: โหลด DB สำเร็จ
2025-11-23 21:47:57,706 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 21:47:57,708 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 21:47:57,708 INFO: Load to DB + Backup สำเร็จ
2025-11-23 21:47:57,708 INFO: === PIPELINE END ===

2025-11-23 21:57:29,346 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 21:57:29,351 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 21:57:29,352 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:57:29,353 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 21:57:29,353 INFO: Scheduler started
2025-11-23 21:57:29,354 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 21:57:29,354 INFO: === PIPELINE START ===
2025-11-23 21:57:29,354 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:57:30,083 INFO: ดึง 2025-11-23 20:00:00+07:00 - 2025-11-23 21:00:00+07:00 → 2 แถว
2025-11-23 21:57:30,092 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:57:30,093 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 21:57:30,093 INFO: Fetch สำเร็จ
2025-11-23 21:57:30,093 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 21:57:30,120 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 21:57:30,122 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 202 แถว
2025-11-23 21:57:30,123 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 21:57:30,125 INFO: รวมเก่า 202 + ใหม่ 202 → 202 (เพิ่ม 0)
2025-11-23 21:57:30,126 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 21:57:30,127 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 21:57:30,139 INFO: เริ่ม clean ข้อมูล: 202 แถว
2025-11-23 21:57:30,151 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (202 แถว)
2025-11-23 21:57:30,155 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 21:57:30,184 INFO: เตรียมโหลด 202 แถว
2025-11-23 21:57:30,541 INFO: โหลด DB สำเร็จ
2025-11-23 21:57:30,543 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 21:57:30,546 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 21:57:30,546 INFO: Load to DB + Backup สำเร็จ
2025-11-23 21:57:30,547 INFO: === PIPELINE END ===

2025-11-23 21:58:13,521 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 21:58:13,526 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 21:58:13,528 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:58:13,528 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 21:58:13,528 INFO: Scheduler started
2025-11-23 21:58:13,529 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 21:58:13,529 INFO: === PIPELINE START ===
2025-11-23 21:58:13,529 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:58:14,242 INFO: ดึง 2025-11-23 20:00:00+07:00 - 2025-11-23 21:00:00+07:00 → 2 แถว
2025-11-23 21:58:14,250 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:58:14,250 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 21:58:14,250 INFO: Fetch สำเร็จ
2025-11-23 21:58:14,251 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 21:58:14,278 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 21:58:14,279 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 202 แถว
2025-11-23 21:58:14,280 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 21:58:14,282 INFO: รวมเก่า 202 + ใหม่ 202 → 202 (เพิ่ม 0)
2025-11-23 21:58:14,283 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 21:58:14,284 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 21:58:14,295 INFO: เริ่ม clean ข้อมูล: 202 แถว
2025-11-23 21:58:14,308 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (202 แถว)
2025-11-23 21:58:14,311 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 21:58:14,340 INFO: เตรียมโหลด 202 แถว
2025-11-23 21:58:14,649 INFO: โหลด DB สำเร็จ
2025-11-23 21:58:14,652 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 21:58:14,654 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 21:58:14,654 INFO: Load to DB + Backup สำเร็จ
2025-11-23 21:58:14,654 INFO: === PIPELINE END ===

2025-11-23 21:58:39,943 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 21:58:39,949 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 21:58:39,951 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:58:39,953 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 21:58:39,953 INFO: Scheduler started
2025-11-23 21:58:39,953 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 21:58:39,953 INFO: === PIPELINE START ===
2025-11-23 21:58:39,954 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 21:58:40,702 INFO: ดึง 2025-11-23 20:00:00+07:00 - 2025-11-23 21:00:00+07:00 → 2 แถว
2025-11-23 21:58:40,710 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 21:58:40,711 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 21:58:40,711 INFO: Fetch สำเร็จ
2025-11-23 21:58:40,711 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 21:58:40,743 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 21:58:40,745 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 202 แถว
2025-11-23 21:58:40,746 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 21:58:40,748 INFO: รวมเก่า 202 + ใหม่ 202 → 202 (เพิ่ม 0)
2025-11-23 21:58:40,752 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 21:58:40,752 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 21:58:40,765 INFO: เริ่ม clean ข้อมูล: 202 แถว
2025-11-23 21:58:40,780 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (202 แถว)
2025-11-23 21:58:40,784 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 12:00:00          56.3           19.0       1.6 151.9       28.1    46.1     1014.6
2025-11-23 21:58:40,813 INFO: เตรียมโหลด 202 แถว
2025-11-23 21:58:41,121 INFO: โหลด DB สำเร็จ
2025-11-23 21:58:41,123 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 21:58:41,126 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 21:58:41,126 INFO: Load to DB + Backup สำเร็จ
2025-11-23 21:58:41,126 INFO: === PIPELINE END ===

2025-11-23 22:05:00,008 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 23:05:00 +07)" (scheduled at 2025-11-23 22:05:00+07:00)
2025-11-23 22:05:00,010 INFO: === PIPELINE START ===
2025-11-23 22:05:00,012 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:05:00,714 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:05:00,719 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:05:00,719 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:05:00,719 INFO: Fetch สำเร็จ
2025-11-23 22:05:00,720 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:05:00,747 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:05:00,750 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:05:00,750 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:05:00,752 INFO: รวมเก่า 202 + ใหม่ 203 → 203 (เพิ่ม 1)
2025-11-23 22:05:00,754 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:05:00,754 INFO: Format สำเร็จ: +1 แถว
2025-11-23 22:05:00,765 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:05:00,776 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:05:00,778 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           23.3       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:05:00,781 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:05:01,009 INFO: โหลด DB สำเร็จ
2025-11-23 22:05:01,011 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 22:05:01,014 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 22:05:01,014 INFO: Load to DB + Backup สำเร็จ
2025-11-23 22:05:01,014 INFO: === PIPELINE END ===

2025-11-23 22:05:01,014 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-23 23:05:00 +07)" executed successfully
2025-11-23 22:07:22,122 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 22:07:22,128 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:07:22,129 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:07:22,130 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:07:22,130 INFO: Scheduler started
2025-11-23 22:07:22,130 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 22:07:22,130 INFO: === PIPELINE START ===
2025-11-23 22:07:22,131 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:07:22,849 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:07:22,856 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:07:22,857 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:07:22,857 INFO: Fetch สำเร็จ
2025-11-23 22:07:22,857 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:07:22,895 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:07:22,897 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:07:22,898 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:07:22,900 INFO: รวมเก่า 203 + ใหม่ 203 → 203 (เพิ่ม 0)
2025-11-23 22:07:22,902 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:07:22,902 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 22:07:22,913 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:07:22,924 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:07:22,928 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:07:22,959 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:07:24,849 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 22:07:24,855 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:07:24,856 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:07:24,858 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:07:24,858 INFO: Scheduler started
2025-11-23 22:07:24,858 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 22:07:24,858 INFO: === PIPELINE START ===
2025-11-23 22:07:24,858 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:07:25,536 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:07:25,543 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:07:25,544 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:07:25,544 INFO: Fetch สำเร็จ
2025-11-23 22:07:25,544 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:07:25,571 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:07:25,572 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:07:25,573 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:07:25,575 INFO: รวมเก่า 203 + ใหม่ 203 → 203 (เพิ่ม 0)
2025-11-23 22:07:25,576 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:07:25,576 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 22:07:25,587 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:07:25,600 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:07:25,603 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:07:25,631 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:07:25,929 INFO: โหลด DB สำเร็จ
2025-11-23 22:07:25,931 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 22:07:25,934 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 22:07:25,934 INFO: Load to DB + Backup สำเร็จ
2025-11-23 22:07:25,934 INFO: === PIPELINE END ===

2025-11-23 22:15:52,186 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 22:15:52,193 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:15:52,194 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:15:52,195 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:15:52,195 INFO: Scheduler started
2025-11-23 22:15:52,195 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 22:15:52,195 INFO: === PIPELINE START ===
2025-11-23 22:15:52,195 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:15:52,968 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:15:52,976 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:15:52,977 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:15:52,977 INFO: Fetch สำเร็จ
2025-11-23 22:15:52,977 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:15:53,009 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:15:53,010 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:15:53,011 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:15:53,013 INFO: รวมเก่า 203 + ใหม่ 203 → 203 (เพิ่ม 0)
2025-11-23 22:15:53,015 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:15:53,016 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 22:15:53,028 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:15:53,041 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:15:53,046 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:15:53,077 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:15:53,420 INFO: โหลด DB สำเร็จ
2025-11-23 22:15:53,422 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 22:15:53,426 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 22:15:53,426 INFO: Load to DB + Backup สำเร็จ
2025-11-23 22:15:53,426 INFO: === PIPELINE END ===

2025-11-23 22:18:10,574 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 22:18:10,580 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:18:10,582 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:18:10,583 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:18:10,583 INFO: Scheduler started
2025-11-23 22:18:10,583 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 22:18:10,583 INFO: === PIPELINE START ===
2025-11-23 22:18:10,583 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:18:11,348 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:18:11,356 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:18:11,356 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:18:11,356 INFO: Fetch สำเร็จ
2025-11-23 22:18:11,356 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:18:11,383 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:18:11,385 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:18:11,385 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:18:11,387 INFO: รวมเก่า 203 + ใหม่ 203 → 203 (เพิ่ม 0)
2025-11-23 22:18:11,389 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:18:11,389 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 22:18:11,400 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:18:11,413 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:18:11,417 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:18:11,447 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:18:11,792 INFO: โหลด DB สำเร็จ
2025-11-23 22:18:11,795 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 22:18:11,797 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 22:18:11,797 INFO: Load to DB + Backup สำเร็จ
2025-11-23 22:18:11,798 INFO: === PIPELINE END ===

2025-11-23 22:22:21,434 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 22:22:21,440 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:22:21,441 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:22:21,442 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:22:21,443 INFO: Scheduler started
2025-11-23 22:22:21,443 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 22:22:21,443 INFO: === PIPELINE START ===
2025-11-23 22:22:21,443 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:22:22,200 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:22:22,210 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:22:22,211 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:22:22,212 INFO: Fetch สำเร็จ
2025-11-23 22:22:22,212 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:22:22,246 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:22:22,248 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:22:22,248 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:22:22,250 INFO: รวมเก่า 203 + ใหม่ 203 → 203 (เพิ่ม 0)
2025-11-23 22:22:22,252 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:22:22,252 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 22:22:22,264 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:22:22,277 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:22:22,283 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:22:22,312 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:22:22,662 INFO: โหลด DB สำเร็จ
2025-11-23 22:22:22,664 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 22:22:22,667 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 22:22:22,667 INFO: Load to DB + Backup สำเร็จ
2025-11-23 22:22:22,668 INFO: === PIPELINE END ===

2025-11-23 22:22:39,726 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 22:22:39,730 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:22:39,731 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:22:39,732 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:22:39,732 INFO: Scheduler started
2025-11-23 22:22:39,733 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 22:22:39,733 INFO: === PIPELINE START ===
2025-11-23 22:22:39,733 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:22:40,476 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:22:40,490 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:22:40,491 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:22:40,491 INFO: Fetch สำเร็จ
2025-11-23 22:22:40,491 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:22:40,532 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:22:40,534 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:22:40,536 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:22:40,540 INFO: รวมเก่า 203 + ใหม่ 203 → 203 (เพิ่ม 0)
2025-11-23 22:22:40,542 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:22:40,543 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 22:22:40,561 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:22:40,572 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:22:40,576 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:22:40,604 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:22:40,958 INFO: โหลด DB สำเร็จ
2025-11-23 22:22:40,960 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 22:22:40,962 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 22:22:40,963 INFO: Load to DB + Backup สำเร็จ
2025-11-23 22:22:40,963 INFO: === PIPELINE END ===

2025-11-23 22:23:41,718 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 22:23:41,722 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:23:41,724 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:23:41,725 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:23:41,725 INFO: Scheduler started
2025-11-23 22:23:41,725 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 22:23:41,726 INFO: === PIPELINE START ===
2025-11-23 22:23:41,726 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:23:42,413 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:23:42,421 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:23:42,422 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:23:42,422 INFO: Fetch สำเร็จ
2025-11-23 22:23:42,422 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:23:42,448 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:23:42,450 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:23:42,451 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:23:42,453 INFO: รวมเก่า 203 + ใหม่ 203 → 203 (เพิ่ม 0)
2025-11-23 22:23:42,455 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:23:42,455 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 22:23:42,467 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:23:42,480 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:23:42,484 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:23:42,513 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:23:42,861 INFO: โหลด DB สำเร็จ
2025-11-23 22:23:42,864 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 22:23:42,867 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 22:23:42,867 INFO: Load to DB + Backup สำเร็จ
2025-11-23 22:23:42,867 INFO: === PIPELINE END ===

2025-11-23 22:23:47,451 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 22:23:47,454 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:23:47,456 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:23:47,457 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:23:47,457 INFO: Scheduler started
2025-11-23 22:23:47,457 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 22:23:47,457 INFO: === PIPELINE START ===
2025-11-23 22:23:47,457 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:23:48,154 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:23:48,162 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:23:48,163 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:23:48,163 INFO: Fetch สำเร็จ
2025-11-23 22:23:48,163 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:23:48,190 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:23:48,192 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:23:48,192 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:23:48,195 INFO: รวมเก่า 203 + ใหม่ 203 → 203 (เพิ่ม 0)
2025-11-23 22:23:48,197 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:23:48,197 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 22:23:48,208 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:23:48,220 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:23:48,224 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:23:48,252 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:23:50,209 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 22:23:50,213 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:23:50,214 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:23:50,214 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:23:50,214 INFO: Scheduler started
2025-11-23 22:23:50,216 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 22:23:50,216 INFO: === PIPELINE START ===
2025-11-23 22:23:50,216 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:23:50,919 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:23:50,926 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:23:50,927 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:23:50,927 INFO: Fetch สำเร็จ
2025-11-23 22:23:50,927 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:23:50,955 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:23:50,956 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:23:50,957 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:23:50,959 INFO: รวมเก่า 203 + ใหม่ 203 → 203 (เพิ่ม 0)
2025-11-23 22:23:50,961 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:23:50,961 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 22:23:50,974 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:23:50,986 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:23:50,990 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:23:51,018 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:23:51,380 INFO: โหลด DB สำเร็จ
2025-11-23 22:23:51,383 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 22:23:51,386 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 22:23:51,386 INFO: Load to DB + Backup สำเร็จ
2025-11-23 22:23:51,386 INFO: === PIPELINE END ===

2025-11-23 22:27:38,183 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 22:27:38,187 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:27:38,187 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:27:38,189 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:27:38,190 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:27:38,190 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:27:38,190 INFO: Scheduler started
2025-11-23 22:27:38,191 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 22:27:38,191 INFO: === PIPELINE START ===
2025-11-23 22:27:38,191 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:27:38,939 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:27:38,947 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:27:38,948 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:27:38,948 INFO: Fetch สำเร็จ
2025-11-23 22:27:38,948 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:27:38,977 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:27:38,979 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:27:38,979 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:27:38,981 INFO: รวมเก่า 203 + ใหม่ 203 → 203 (เพิ่ม 0)
2025-11-23 22:27:38,982 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:27:38,983 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 22:27:38,995 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:27:39,007 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:27:39,011 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:27:39,040 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:27:39,320 INFO: โหลด DB สำเร็จ
2025-11-23 22:27:39,322 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 22:27:39,325 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 22:27:39,325 INFO: Load to DB + Backup สำเร็จ
2025-11-23 22:27:39,325 INFO: === PIPELINE END ===

2025-11-23 22:31:39,846 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 22:31:39,850 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:31:39,850 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:31:39,852 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:31:39,853 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:31:39,854 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:31:39,854 INFO: Scheduler started
2025-11-23 22:31:39,854 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 22:31:39,854 INFO: === PIPELINE START ===
2025-11-23 22:31:39,854 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:31:40,565 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:31:40,575 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:31:40,577 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:31:40,577 INFO: Fetch สำเร็จ
2025-11-23 22:31:40,577 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:31:40,604 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:31:40,606 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:31:40,607 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:31:40,608 INFO: รวมเก่า 203 + ใหม่ 203 → 203 (เพิ่ม 0)
2025-11-23 22:31:40,609 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:31:40,609 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 22:31:40,621 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:31:40,633 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:31:40,637 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:31:40,665 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:31:40,959 INFO: โหลด DB สำเร็จ
2025-11-23 22:31:40,961 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 22:31:40,963 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 22:31:40,963 INFO: Load to DB + Backup สำเร็จ
2025-11-23 22:31:40,963 INFO: === PIPELINE END ===

2025-11-23 22:36:03,643 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 22:36:03,647 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:36:03,647 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 22:36:03,648 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:36:03,650 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:36:03,650 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 22:36:03,651 INFO: Scheduler started
2025-11-23 22:36:03,651 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 22:36:03,651 INFO: === PIPELINE START ===
2025-11-23 22:36:03,651 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 22:36:04,374 INFO: ดึง 2025-11-23 21:00:00+07:00 - 2025-11-23 22:00:00+07:00 → 2 แถว
2025-11-23 22:36:04,382 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 22:36:04,382 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 22:36:04,382 INFO: Fetch สำเร็จ
2025-11-23 22:36:04,383 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 22:36:04,411 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 22:36:04,413 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 203 แถว
2025-11-23 22:36:04,413 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 22:36:04,415 INFO: รวมเก่า 203 + ใหม่ 203 → 203 (เพิ่ม 0)
2025-11-23 22:36:04,417 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 22:36:04,418 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 22:36:04,429 INFO: เริ่ม clean ข้อมูล: 203 แถว
2025-11-23 22:36:04,446 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (203 แถว)
2025-11-23 22:36:04,450 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 13:00:00          55.1           15.3       1.2 134.2       28.8    44.5     1013.6
2025-11-23 22:36:04,480 INFO: เตรียมโหลด 203 แถว
2025-11-23 22:36:04,825 INFO: โหลด DB สำเร็จ
2025-11-23 22:36:04,828 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 22:36:04,832 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 22:36:04,832 INFO: Load to DB + Backup สำเร็จ
2025-11-23 22:36:04,832 INFO: === PIPELINE END ===

2025-11-23 23:05:00,003 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-24 00:05:00 +07)" (scheduled at 2025-11-23 23:05:00+07:00)
2025-11-23 23:05:00,004 INFO: === PIPELINE START ===
2025-11-23 23:05:00,004 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 23:05:00,725 INFO: ดึง 2025-11-23 22:00:00+07:00 - 2025-11-23 23:00:00+07:00 → 2 แถว
2025-11-23 23:05:00,731 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 23:05:00,731 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 23:05:00,731 INFO: Fetch สำเร็จ
2025-11-23 23:05:00,732 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 23:05:00,766 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 23:05:00,768 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 204 แถว
2025-11-23 23:05:00,769 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 23:05:00,770 INFO: รวมเก่า 203 + ใหม่ 204 → 204 (เพิ่ม 1)
2025-11-23 23:05:00,772 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 23:05:00,772 INFO: Format สำเร็จ: +1 แถว
2025-11-23 23:05:00,784 INFO: เริ่ม clean ข้อมูล: 204 แถว
2025-11-23 23:05:00,799 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (204 แถว)
2025-11-23 23:05:00,801 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 23:00:00          51.7           22.4       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 23:05:00,803 INFO: เตรียมโหลด 204 แถว
2025-11-23 23:05:01,094 INFO: โหลด DB สำเร็จ
2025-11-23 23:05:01,097 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 23:05:01,099 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 23:05:01,099 INFO: Load to DB + Backup สำเร็จ
2025-11-23 23:05:01,099 INFO: === PIPELINE END ===

2025-11-23 23:05:01,099 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-24 00:05:00 +07)" executed successfully
2025-11-23 23:15:00,006 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='15'], next run at: 2025-11-24 00:15:00 +07)" (scheduled at 2025-11-23 23:15:00+07:00)
2025-11-23 23:15:00,008 INFO: === PIPELINE START ===
2025-11-23 23:15:00,008 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 23:15:00,787 INFO: ดึง 2025-11-23 22:00:00+07:00 - 2025-11-23 23:00:00+07:00 → 2 แถว
2025-11-23 23:15:00,795 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 23:15:00,796 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 23:15:00,796 INFO: Fetch สำเร็จ
2025-11-23 23:15:00,796 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 23:15:00,821 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 23:15:00,822 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 204 แถว
2025-11-23 23:15:00,823 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 23:15:00,825 INFO: รวมเก่า 204 + ใหม่ 204 → 204 (เพิ่ม 0)
2025-11-23 23:15:00,826 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 23:15:00,826 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 23:15:00,838 INFO: เริ่ม clean ข้อมูล: 204 แถว
2025-11-23 23:15:00,849 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (204 แถว)
2025-11-23 23:15:00,852 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 23:15:00,853 INFO: เตรียมโหลด 204 แถว
2025-11-23 23:15:01,094 INFO: โหลด DB สำเร็จ
2025-11-23 23:15:01,096 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 23:15:01,100 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 23:15:01,100 INFO: Load to DB + Backup สำเร็จ
2025-11-23 23:15:01,100 INFO: === PIPELINE END ===

2025-11-23 23:15:01,100 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='15'], next run at: 2025-11-24 00:15:00 +07)" executed successfully
2025-11-23 23:42:03,557 INFO: โหลดโมเดลสำเร็จ: models\xgboost_pm25_best.json
2025-11-23 23:42:03,558 INFO: โหลด scaler สำเร็จ: models\pm25_scaler.pkl → 7 features
2025-11-23 23:42:05,558 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 23:42:05,562 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 23:42:05,563 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 23:42:05,564 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 23:42:05,565 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 23:42:05,565 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 23:42:05,566 INFO: Scheduler started
2025-11-23 23:42:05,566 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 23:42:05,566 INFO: === PIPELINE START ===
2025-11-23 23:42:05,566 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 23:42:06,294 INFO: ดึง 2025-11-23 22:00:00+07:00 - 2025-11-23 23:00:00+07:00 → 2 แถว
2025-11-23 23:42:06,305 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 23:42:06,306 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 23:42:06,306 INFO: Fetch สำเร็จ
2025-11-23 23:42:06,306 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 23:42:06,332 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 23:42:06,335 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 204 แถว
2025-11-23 23:42:06,336 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 23:42:06,337 INFO: รวมเก่า 204 + ใหม่ 204 → 204 (เพิ่ม 0)
2025-11-23 23:42:06,339 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 23:42:06,339 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 23:42:06,351 INFO: เริ่ม clean ข้อมูล: 204 แถว
2025-11-23 23:42:06,362 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (204 แถว)
2025-11-23 23:42:06,366 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 23:42:06,396 INFO: เตรียมโหลด 204 แถว
2025-11-23 23:42:06,685 INFO: โหลด DB สำเร็จ
2025-11-23 23:42:06,688 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 23:42:06,691 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 23:42:06,691 INFO: Load to DB + Backup สำเร็จ
2025-11-23 23:42:06,691 INFO: === PIPELINE END ===

2025-11-23 23:42:29,432 INFO: โหลดโมเดลสำเร็จ: models\xgboost_pm25_best.json
2025-11-23 23:42:29,433 INFO: โหลด scaler สำเร็จ: models\pm25_scaler.pkl → 7 features
2025-11-23 23:42:41,947 ERROR: Predict error
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 128, in predict_next_24h
    data = df[FEATURES_ORDER].values.astype(float)
           ~~^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\core\frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\core\indexes\base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\core\indexes\base.py", line 6261, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['PM10 (µg/m³)', 'WS (m/s)', 'WD', 'Temp (°C)', 'RH (%)', 'BP (mBar)',\n       'PM2.5 (µg/m³)'],\n      dtype='object')] are in the [columns]"
2025-11-23 23:43:06,532 INFO: MODEL loaded. expected features (metadata): 168
2025-11-23 23:43:06,536 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 23:43:06,536 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 23:43:06,537 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 23:43:06,538 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 23:43:06,539 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 23:43:06,539 INFO: Scheduler started
2025-11-23 23:43:06,539 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-23 23:43:06,539 INFO: === PIPELINE START ===
2025-11-23 23:43:06,539 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 23:43:07,396 INFO: ดึง 2025-11-23 22:00:00+07:00 - 2025-11-23 23:00:00+07:00 → 2 แถว
2025-11-23 23:43:07,405 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 23:43:07,405 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 23:43:07,406 INFO: Fetch สำเร็จ
2025-11-23 23:43:07,406 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 23:43:07,433 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 23:43:07,435 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 204 แถว
2025-11-23 23:43:07,436 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 23:43:07,438 INFO: รวมเก่า 204 + ใหม่ 204 → 204 (เพิ่ม 0)
2025-11-23 23:43:07,440 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 23:43:07,440 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 23:43:07,456 INFO: เริ่ม clean ข้อมูล: 204 แถว
2025-11-23 23:43:07,468 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (204 แถว)
2025-11-23 23:43:07,472 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 23:43:07,516 INFO: เตรียมโหลด 204 แถว
2025-11-23 23:43:07,899 INFO: โหลด DB สำเร็จ
2025-11-23 23:43:07,901 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 23:43:07,904 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 23:43:07,904 INFO: Load to DB + Backup สำเร็จ
2025-11-23 23:43:07,904 INFO: === PIPELINE END ===

2025-11-23 23:44:30,497 INFO: โหลดโมเดลสำเร็จ: models\xgboost_pm25_best.json
2025-11-23 23:44:30,498 INFO: โหลด scaler สำเร็จ: models\pm25_scaler.pkl → 7 features
2025-11-23 23:44:47,537 INFO: โหลดโมเดลสำเร็จ: models\xgboost_pm25_best.json
2025-11-23 23:44:47,538 INFO: โหลด scaler สำเร็จ: models\pm25_scaler.pkl → 7 features
2025-11-23 23:46:04,091 INFO: โหลดโมเดลสำเร็จ: models\xgboost_pm25_best.json
2025-11-23 23:46:04,092 INFO: โหลด scaler สำเร็จ: models\pm25_scaler.pkl → 7 features
2025-11-23 23:50:56,480 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-23 23:50:56,481 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-23 23:50:56,485 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 23:50:56,485 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 23:50:56,496 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 23:50:56,497 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 23:50:56,497 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 23:50:56,497 INFO: Scheduler started
2025-11-23 23:50:56,498 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-23 23:50:56,498 INFO: === PIPELINE START ===
2025-11-23 23:50:56,498 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 23:50:57,277 INFO: ดึง 2025-11-23 22:00:00+07:00 - 2025-11-23 23:00:00+07:00 → 2 แถว
2025-11-23 23:50:57,287 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 23:50:57,288 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 23:50:57,288 INFO: Fetch สำเร็จ
2025-11-23 23:50:57,289 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 23:50:57,316 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 23:50:57,318 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 204 แถว
2025-11-23 23:50:57,319 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 23:50:57,321 INFO: รวมเก่า 204 + ใหม่ 204 → 204 (เพิ่ม 0)
2025-11-23 23:50:57,323 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 23:50:57,323 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 23:50:57,334 INFO: เริ่ม clean ข้อมูล: 204 แถว
2025-11-23 23:50:57,345 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (204 แถว)
2025-11-23 23:50:57,349 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 23:50:57,379 INFO: เตรียมโหลด 204 แถว
2025-11-23 23:50:57,708 INFO: โหลด DB สำเร็จ
2025-11-23 23:50:57,711 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 23:50:57,713 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 23:50:57,713 INFO: Load to DB + Backup สำเร็จ
2025-11-23 23:50:57,713 INFO: === PIPELINE END ===

2025-11-23 23:51:43,085 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-23 23:51:43,086 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-23 23:51:43,090 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 23:51:43,090 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 23:51:43,092 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 23:51:43,093 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 23:51:43,093 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 23:51:43,093 INFO: Scheduler started
2025-11-23 23:51:43,093 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-23 23:51:43,094 INFO: === PIPELINE START ===
2025-11-23 23:51:43,094 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 23:51:43,894 INFO: ดึง 2025-11-23 22:00:00+07:00 - 2025-11-23 23:00:00+07:00 → 2 แถว
2025-11-23 23:51:43,902 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 23:51:43,903 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 23:51:43,903 INFO: Fetch สำเร็จ
2025-11-23 23:51:43,903 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 23:51:43,931 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 23:51:43,932 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 204 แถว
2025-11-23 23:51:43,933 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 23:51:43,936 INFO: รวมเก่า 204 + ใหม่ 204 → 204 (เพิ่ม 0)
2025-11-23 23:51:43,937 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 23:51:43,937 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 23:51:43,948 INFO: เริ่ม clean ข้อมูล: 204 แถว
2025-11-23 23:51:43,960 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (204 แถว)
2025-11-23 23:51:43,964 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 23:51:43,992 INFO: เตรียมโหลด 204 แถว
2025-11-23 23:51:44,281 INFO: โหลด DB สำเร็จ
2025-11-23 23:51:44,283 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 23:51:44,286 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 23:51:44,287 INFO: Load to DB + Backup สำเร็จ
2025-11-23 23:51:44,287 INFO: === PIPELINE END ===

2025-11-23 23:52:18,972 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-23 23:52:18,973 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-23 23:52:18,977 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 23:52:18,977 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-23 23:52:18,979 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 23:52:18,980 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 23:52:18,980 INFO: Added job "run_pipeline" to job store "default"
2025-11-23 23:52:18,980 INFO: Scheduler started
2025-11-23 23:52:18,980 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-23 23:52:18,980 INFO: === PIPELINE START ===
2025-11-23 23:52:18,980 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-23 23:52:19,746 INFO: ดึง 2025-11-23 22:00:00+07:00 - 2025-11-23 23:00:00+07:00 → 2 แถว
2025-11-23 23:52:19,754 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-23 23:52:19,754 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-23 23:52:19,754 INFO: Fetch สำเร็จ
2025-11-23 23:52:19,754 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-23 23:52:19,783 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-23 23:52:19,784 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 204 แถว
2025-11-23 23:52:19,785 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-23 23:52:19,788 INFO: รวมเก่า 204 + ใหม่ 204 → 204 (เพิ่ม 0)
2025-11-23 23:52:19,789 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-23 23:52:19,789 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-23 23:52:19,802 INFO: เริ่ม clean ข้อมูล: 204 แถว
2025-11-23 23:52:19,816 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (204 แถว)
2025-11-23 23:52:19,820 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-23 23:52:19,854 INFO: เตรียมโหลด 204 แถว
2025-11-23 23:52:20,200 INFO: โหลด DB สำเร็จ
2025-11-23 23:52:20,203 INFO: Backup สำเร็จ: data\backups\2025-11-23.csv
2025-11-23 23:52:20,206 INFO: อัพเดท latest.csv สำเร็จ
2025-11-23 23:52:20,206 INFO: Load to DB + Backup สำเร็จ
2025-11-23 23:52:20,207 INFO: === PIPELINE END ===

2025-11-23 23:52:21,350 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-23 23:52:21,352 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-23 23:52:21,354 INFO: ค่าฝุ่นปัจจุบัน: 24.2 µg/m³ → AQI 48 (ดี)
2025-11-23 23:52:21,355 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-23 23:52:21,356 INFO: เริ่ม autoregressive prediction...
2025-11-23 23:52:21,369 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 22.4 µg/m³ → AQI 44 (ดี)
2025-11-23 23:52:21,369 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 00:00:18,400 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 00:00:18,401 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 00:00:18,404 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:00:18,404 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:00:18,406 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:00:18,407 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:00:18,407 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:00:18,407 INFO: Scheduler started
2025-11-24 00:00:18,407 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 00:00:18,407 INFO: === PIPELINE START ===
2025-11-24 00:00:18,408 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:00:19,145 INFO: ดึง 2025-11-23 23:00:00+07:00 - 2025-11-24 00:00:00+07:00 → 1 แถว
2025-11-24 00:00:19,153 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-24 00:00:19,153 INFO: สำเร็จ: อัปเดต/เพิ่ม 1 แถว
2025-11-24 00:00:19,154 INFO: Fetch สำเร็จ
2025-11-24 00:00:19,154 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 00:00:19,180 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 00:00:19,182 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 204 แถว
2025-11-24 00:00:19,182 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 00:00:19,185 INFO: รวมเก่า 204 + ใหม่ 204 → 204 (เพิ่ม 0)
2025-11-24 00:00:19,186 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 00:00:19,186 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 00:00:19,198 INFO: เริ่ม clean ข้อมูล: 204 แถว
2025-11-24 00:00:19,210 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (204 แถว)
2025-11-24 00:00:19,214 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-23 14:00:00          50.3           11.5       1.2 128.9       29.7    42.2     1012.7
2025-11-24 00:00:19,243 INFO: เตรียมโหลด 204 แถว
2025-11-24 00:00:19,541 INFO: โหลด DB สำเร็จ
2025-11-24 00:00:19,544 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 00:00:19,546 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 00:00:19,547 INFO: Load to DB + Backup สำเร็จ
2025-11-24 00:00:19,547 INFO: === PIPELINE END ===

2025-11-24 00:00:21,510 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 00:00:21,513 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 00:00:21,514 INFO: ค่าฝุ่นปัจจุบัน: 24.2 µg/m³ → AQI 48 (ดี)
2025-11-24 00:00:21,515 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 00:00:21,515 INFO: เริ่ม autoregressive prediction...
2025-11-24 00:00:21,527 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 22.4 µg/m³ → AQI 44 (ดี)
2025-11-24 00:00:21,527 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 00:05:00,008 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-24 01:05:00 +07)" (scheduled at 2025-11-24 00:05:00+07:00)
2025-11-24 00:05:00,009 INFO: === PIPELINE START ===
2025-11-24 00:05:00,010 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:05:00,795 INFO: ดึง 2025-11-23 23:00:00+07:00 - 2025-11-24 00:00:00+07:00 → 2 แถว
2025-11-24 00:05:00,801 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 00:05:00,801 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 00:05:00,802 INFO: Fetch สำเร็จ
2025-11-24 00:05:00,802 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 00:05:00,829 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 00:05:00,830 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 205 แถว
2025-11-24 00:05:00,832 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 00:05:00,834 INFO: รวมเก่า 204 + ใหม่ 205 → 205 (เพิ่ม 1)
2025-11-24 00:05:00,835 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 00:05:00,836 INFO: Format สำเร็จ: +1 แถว
2025-11-24 00:05:00,848 INFO: เริ่ม clean ข้อมูล: 205 แถว
2025-11-24 00:05:00,858 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (205 แถว)
2025-11-24 00:05:00,860 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 00:00:00          50.1           24.2       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-24 00:05:00,862 INFO: เตรียมโหลด 205 แถว
2025-11-24 00:05:01,168 INFO: โหลด DB สำเร็จ
2025-11-24 00:05:01,171 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 00:05:01,173 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 00:05:01,173 INFO: Load to DB + Backup สำเร็จ
2025-11-24 00:05:01,173 INFO: === PIPELINE END ===

2025-11-24 00:05:01,173 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-24 01:05:00 +07)" executed successfully
2025-11-24 00:05:34,093 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 00:05:34,094 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 00:05:34,098 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:05:34,099 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:05:34,100 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:05:34,101 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:05:34,101 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:05:34,101 INFO: Scheduler started
2025-11-24 00:05:34,102 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 00:05:34,102 INFO: === PIPELINE START ===
2025-11-24 00:05:34,102 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:05:34,864 INFO: ดึง 2025-11-23 23:00:00+07:00 - 2025-11-24 00:00:00+07:00 → 2 แถว
2025-11-24 00:05:34,873 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 00:05:34,874 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 00:05:34,874 INFO: Fetch สำเร็จ
2025-11-24 00:05:34,874 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 00:05:34,903 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 00:05:34,904 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 205 แถว
2025-11-24 00:05:34,905 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 00:05:34,907 INFO: รวมเก่า 205 + ใหม่ 205 → 205 (เพิ่ม 0)
2025-11-24 00:05:34,909 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 00:05:34,909 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 00:05:34,921 INFO: เริ่ม clean ข้อมูล: 205 แถว
2025-11-24 00:05:34,935 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (205 แถว)
2025-11-24 00:05:34,938 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 00:00:00          50.1           24.2       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-24 00:05:34,970 INFO: เตรียมโหลด 205 แถว
2025-11-24 00:05:35,276 INFO: โหลด DB สำเร็จ
2025-11-24 00:05:35,278 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 00:05:35,281 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 00:05:35,281 INFO: Load to DB + Backup สำเร็จ
2025-11-24 00:05:35,281 INFO: === PIPELINE END ===

2025-11-24 00:05:37,827 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 00:05:37,830 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 00:05:37,832 INFO: ค่าฝุ่นปัจจุบัน: 24.2 µg/m³ → AQI 48 (ดี)
2025-11-24 00:05:37,833 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 00:05:37,833 INFO: เริ่ม autoregressive prediction...
2025-11-24 00:05:37,843 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 23.5 µg/m³ → AQI 46 (ดี)
2025-11-24 00:05:37,844 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 00:05:48,779 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 00:05:48,780 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 00:05:48,781 INFO: ค่าฝุ่นปัจจุบัน: 24.2 µg/m³ → AQI 48 (ดี)
2025-11-24 00:05:48,782 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 00:05:48,782 INFO: เริ่ม autoregressive prediction...
2025-11-24 00:05:48,795 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 23.5 µg/m³ → AQI 46 (ดี)
2025-11-24 00:05:48,795 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 00:27:06,413 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 00:27:06,414 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 00:27:06,417 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:27:06,417 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:27:06,419 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:27:06,420 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:27:06,420 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:27:06,420 INFO: Scheduler started
2025-11-24 00:27:06,420 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 00:27:06,421 INFO: === PIPELINE START ===
2025-11-24 00:27:06,421 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:27:07,193 INFO: ดึง 2025-11-23 23:00:00+07:00 - 2025-11-24 00:00:00+07:00 → 2 แถว
2025-11-24 00:27:07,200 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 00:27:07,201 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 00:27:07,201 INFO: Fetch สำเร็จ
2025-11-24 00:27:07,201 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 00:27:07,232 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 00:27:07,233 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 205 แถว
2025-11-24 00:27:07,234 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 00:27:07,236 INFO: รวมเก่า 205 + ใหม่ 205 → 205 (เพิ่ม 0)
2025-11-24 00:27:07,237 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 00:27:07,237 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 00:27:07,249 INFO: เริ่ม clean ข้อมูล: 205 แถว
2025-11-24 00:27:07,261 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (205 แถว)
2025-11-24 00:27:07,264 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-24 00:27:07,293 INFO: เตรียมโหลด 205 แถว
2025-11-24 00:27:07,577 INFO: โหลด DB สำเร็จ
2025-11-24 00:27:07,580 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 00:27:07,582 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 00:27:07,582 INFO: Load to DB + Backup สำเร็จ
2025-11-24 00:27:07,582 INFO: === PIPELINE END ===

2025-11-24 00:27:10,843 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 00:27:10,846 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 00:27:10,849 INFO: ค่าฝุ่นปัจจุบัน: 26.3 µg/m³ → AQI 56 (ปานกลาง)
2025-11-24 00:27:10,849 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 00:27:10,851 INFO: เริ่ม autoregressive prediction...
2025-11-24 00:27:10,860 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 23.5 µg/m³ → AQI 46 (ดี)
2025-11-24 00:27:10,861 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 00:27:19,845 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 00:27:19,847 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 00:27:19,848 INFO: ค่าฝุ่นปัจจุบัน: 26.3 µg/m³ → AQI 56 (ปานกลาง)
2025-11-24 00:27:19,849 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 00:27:19,849 INFO: เริ่ม autoregressive prediction...
2025-11-24 00:27:19,859 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 23.5 µg/m³ → AQI 46 (ดี)
2025-11-24 00:27:19,859 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 00:28:49,155 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 00:28:49,156 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 00:28:49,160 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:28:49,160 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:28:49,163 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:28:49,164 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:28:49,164 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:28:49,164 INFO: Scheduler started
2025-11-24 00:28:49,164 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 00:28:49,165 INFO: === PIPELINE START ===
2025-11-24 00:28:49,165 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:28:49,885 INFO: ดึง 2025-11-23 23:00:00+07:00 - 2025-11-24 00:00:00+07:00 → 2 แถว
2025-11-24 00:28:49,896 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 00:28:49,896 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 00:28:49,896 INFO: Fetch สำเร็จ
2025-11-24 00:28:49,897 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 00:28:49,926 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 00:28:49,928 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 205 แถว
2025-11-24 00:28:49,928 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 00:28:49,930 INFO: รวมเก่า 205 + ใหม่ 205 → 205 (เพิ่ม 0)
2025-11-24 00:28:49,933 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 00:28:49,933 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 00:28:49,944 INFO: เริ่ม clean ข้อมูล: 205 แถว
2025-11-24 00:28:49,957 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (205 แถว)
2025-11-24 00:28:49,960 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-24 00:28:49,989 INFO: เตรียมโหลด 205 แถว
2025-11-24 00:28:50,286 INFO: โหลด DB สำเร็จ
2025-11-24 00:28:50,288 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 00:28:50,290 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 00:28:50,291 INFO: Load to DB + Backup สำเร็จ
2025-11-24 00:28:50,291 INFO: === PIPELINE END ===

2025-11-24 00:28:57,424 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 00:28:57,427 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 00:28:57,429 INFO: ค่าฝุ่นปัจจุบัน: 26.3 µg/m³ → AQI 56 (ปานกลาง)
2025-11-24 00:28:57,430 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 00:28:57,430 INFO: เริ่ม autoregressive prediction...
2025-11-24 00:28:57,442 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 23.5 µg/m³ → AQI 46 (ดี)
2025-11-24 00:28:57,443 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 00:30:19,561 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 00:30:19,562 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 00:30:19,566 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:30:19,566 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:30:19,568 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:30:19,569 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:30:19,569 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:30:19,569 INFO: Scheduler started
2025-11-24 00:30:19,569 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 00:30:19,569 INFO: === PIPELINE START ===
2025-11-24 00:30:19,569 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:30:20,268 INFO: ดึง 2025-11-23 23:00:00+07:00 - 2025-11-24 00:00:00+07:00 → 2 แถว
2025-11-24 00:30:20,277 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 00:30:20,277 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 00:30:20,277 INFO: Fetch สำเร็จ
2025-11-24 00:30:20,278 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 00:30:20,308 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 00:30:20,310 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 205 แถว
2025-11-24 00:30:20,312 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 00:30:20,314 INFO: รวมเก่า 205 + ใหม่ 205 → 205 (เพิ่ม 0)
2025-11-24 00:30:20,315 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 00:30:20,316 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 00:30:20,327 INFO: เริ่ม clean ข้อมูล: 205 แถว
2025-11-24 00:30:20,340 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (205 แถว)
2025-11-24 00:30:20,344 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-24 00:30:20,371 INFO: เตรียมโหลด 205 แถว
2025-11-24 00:30:20,703 INFO: โหลด DB สำเร็จ
2025-11-24 00:30:20,706 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 00:30:20,709 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 00:30:20,709 INFO: Load to DB + Backup สำเร็จ
2025-11-24 00:30:20,709 INFO: === PIPELINE END ===

2025-11-24 00:30:24,405 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 00:30:24,408 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 00:30:24,410 INFO: ค่าฝุ่นปัจจุบัน: 26.3 µg/m³ → AQI 56 (ปานกลาง)
2025-11-24 00:30:24,411 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 00:30:24,411 INFO: เริ่ม autoregressive prediction...
2025-11-24 00:30:24,420 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 23.5 µg/m³ → AQI 46 (ดี)
2025-11-24 00:30:24,421 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 00:43:34,431 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 00:43:34,431 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 00:43:34,435 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:43:34,435 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:43:34,437 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:43:34,438 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:43:34,438 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:43:34,438 INFO: Scheduler started
2025-11-24 00:43:34,439 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 00:43:34,439 INFO: === PIPELINE START ===
2025-11-24 00:43:34,439 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:43:35,386 INFO: ดึง 2025-11-23 23:00:00+07:00 - 2025-11-24 00:00:00+07:00 → 2 แถว
2025-11-24 00:43:35,394 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 00:43:35,394 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 00:43:35,394 INFO: Fetch สำเร็จ
2025-11-24 00:43:35,395 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 00:43:35,424 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 00:43:35,425 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 205 แถว
2025-11-24 00:43:35,426 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 00:43:35,428 INFO: รวมเก่า 205 + ใหม่ 205 → 205 (เพิ่ม 0)
2025-11-24 00:43:35,429 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 00:43:35,429 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 00:43:35,442 INFO: เริ่ม clean ข้อมูล: 205 แถว
2025-11-24 00:43:35,455 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (205 แถว)
2025-11-24 00:43:35,459 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-24 00:43:35,487 INFO: เตรียมโหลด 205 แถว
2025-11-24 00:43:35,830 INFO: โหลด DB สำเร็จ
2025-11-24 00:43:35,833 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 00:43:35,835 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 00:43:35,835 INFO: Load to DB + Backup สำเร็จ
2025-11-24 00:43:35,835 INFO: === PIPELINE END ===

2025-11-24 00:43:37,599 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 00:43:37,603 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 00:43:37,605 INFO: ค่าฝุ่นปัจจุบัน: 26.3 µg/m³ → AQI 56 (ปานกลาง)
2025-11-24 00:43:37,607 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 00:43:37,608 INFO: เริ่ม autoregressive prediction...
2025-11-24 00:43:37,621 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 23.5 µg/m³ → AQI 46 (ดี)
2025-11-24 00:43:37,621 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 00:56:48,775 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 00:56:48,776 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 00:56:48,776 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 00:56:48,776 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scalers.pkl
2025-11-24 00:56:48,777 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 00:56:48,777 INFO: [DEBUG] ไม่สามารถอ่าน mean_/scale_ ได้: 'MinMaxScaler' object has no attribute 'mean_'
2025-11-24 00:56:48,780 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:56:48,780 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:56:48,782 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:56:48,783 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:56:48,783 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:56:48,783 INFO: Scheduler started
2025-11-24 00:56:48,783 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 00:56:48,783 INFO: === PIPELINE START ===
2025-11-24 00:56:48,784 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:56:49,533 INFO: ดึง 2025-11-23 23:00:00+07:00 - 2025-11-24 00:00:00+07:00 → 2 แถว
2025-11-24 00:56:49,541 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 00:56:49,541 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 00:56:49,541 INFO: Fetch สำเร็จ
2025-11-24 00:56:49,542 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 00:56:49,573 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 00:56:49,575 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 205 แถว
2025-11-24 00:56:49,575 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 00:56:49,578 INFO: รวมเก่า 205 + ใหม่ 205 → 205 (เพิ่ม 0)
2025-11-24 00:56:49,580 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 00:56:49,580 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 00:56:49,595 INFO: เริ่ม clean ข้อมูล: 205 แถว
2025-11-24 00:56:49,607 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (205 แถว)
2025-11-24 00:56:49,612 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-24 00:56:49,653 INFO: เตรียมโหลด 205 แถว
2025-11-24 00:56:49,948 INFO: โหลด DB สำเร็จ
2025-11-24 00:56:49,950 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 00:56:49,953 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 00:56:49,953 INFO: Load to DB + Backup สำเร็จ
2025-11-24 00:56:49,953 INFO: === PIPELINE END ===

2025-11-24 00:57:04,325 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 00:57:04,328 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 00:57:04,330 INFO: ค่าฝุ่นปัจจุบัน: 26.3 µg/m³ → AQI 56 (ปานกลาง)
2025-11-24 00:57:04,332 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 00:57:04,332 INFO: เริ่ม autoregressive prediction...
2025-11-24 00:57:04,340 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 23.5 µg/m³ → AQI 46 (ดี)
2025-11-24 00:57:04,341 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 00:57:55,510 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 00:57:55,511 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 00:57:55,511 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 00:57:55,511 INFO: [DEBUG] ไม่สามารถอ่าน mean_/scale_ ได้: 'MinMaxScaler' object has no attribute 'mean_'
2025-11-24 00:57:55,514 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:57:55,515 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 00:57:55,516 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:57:55,517 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:57:55,518 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 00:57:55,518 INFO: Scheduler started
2025-11-24 00:57:55,518 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 00:57:55,518 INFO: === PIPELINE START ===
2025-11-24 00:57:55,518 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 00:57:56,256 INFO: ดึง 2025-11-23 23:00:00+07:00 - 2025-11-24 00:00:00+07:00 → 2 แถว
2025-11-24 00:57:56,263 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 00:57:56,263 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 00:57:56,263 INFO: Fetch สำเร็จ
2025-11-24 00:57:56,263 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 00:57:56,293 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 00:57:56,294 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 205 แถว
2025-11-24 00:57:56,295 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 00:57:56,297 INFO: รวมเก่า 205 + ใหม่ 205 → 205 (เพิ่ม 0)
2025-11-24 00:57:56,299 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 00:57:56,299 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 00:57:56,311 INFO: เริ่ม clean ข้อมูล: 205 แถว
2025-11-24 00:57:56,324 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (205 แถว)
2025-11-24 00:57:56,327 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-24 00:57:56,356 INFO: เตรียมโหลด 205 แถว
2025-11-24 00:57:56,665 INFO: โหลด DB สำเร็จ
2025-11-24 00:57:56,668 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 00:57:56,671 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 00:57:56,671 INFO: Load to DB + Backup สำเร็จ
2025-11-24 00:57:56,671 INFO: === PIPELINE END ===

2025-11-24 00:58:19,928 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 00:58:19,931 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 00:58:19,933 INFO: ค่าฝุ่นปัจจุบัน: 26.3 µg/m³ → AQI 56 (ปานกลาง)
2025-11-24 00:58:19,934 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 00:58:19,934 INFO: เริ่ม autoregressive prediction...
2025-11-24 00:58:19,946 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 23.5 µg/m³ → AQI 46 (ดี)
2025-11-24 00:58:19,946 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 01:00:00,081 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 01:00:00,082 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 01:00:00,082 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scalers.pkl
2025-11-24 01:00:00,083 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 01:00:00,083 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 01:00:00,083 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 01:00:00,083 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 01:00:00,083 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 01:00:00,086 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:00:00,087 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:00:00,088 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:00:00,089 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:00:00,089 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:00:00,089 INFO: Scheduler started
2025-11-24 01:00:00,089 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 01:00:00,089 INFO: === PIPELINE START ===
2025-11-24 01:00:00,089 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:00:00,885 INFO: ดึง 2025-11-24 00:00:00+07:00 - 2025-11-24 01:00:00+07:00 → 1 แถว
2025-11-24 01:00:00,893 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-24 01:00:00,893 INFO: สำเร็จ: อัปเดต/เพิ่ม 1 แถว
2025-11-24 01:00:00,893 INFO: Fetch สำเร็จ
2025-11-24 01:00:00,893 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 01:00:00,919 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 01:00:00,922 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 205 แถว
2025-11-24 01:00:00,923 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 01:00:00,925 INFO: รวมเก่า 205 + ใหม่ 205 → 205 (เพิ่ม 0)
2025-11-24 01:00:00,926 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 01:00:00,927 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 01:00:00,938 INFO: เริ่ม clean ข้อมูล: 205 แถว
2025-11-24 01:00:00,949 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (205 แถว)
2025-11-24 01:00:00,953 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-24 01:00:00,981 INFO: เตรียมโหลด 205 แถว
2025-11-24 01:00:01,273 INFO: โหลด DB สำเร็จ
2025-11-24 01:00:01,276 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 01:00:01,279 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 01:00:01,279 INFO: Load to DB + Backup สำเร็จ
2025-11-24 01:00:01,279 INFO: === PIPELINE END ===

2025-11-24 01:00:11,615 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 01:00:11,616 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 01:00:11,616 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 01:00:11,617 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 01:00:11,617 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 01:00:11,617 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 01:00:11,617 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 01:00:11,621 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:00:11,621 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:00:11,623 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:00:11,623 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:00:11,623 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:00:11,624 INFO: Scheduler started
2025-11-24 01:00:11,624 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 01:00:11,624 INFO: === PIPELINE START ===
2025-11-24 01:00:11,624 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:00:12,361 INFO: ดึง 2025-11-24 00:00:00+07:00 - 2025-11-24 01:00:00+07:00 → 1 แถว
2025-11-24 01:00:12,369 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 1 แถว (ทับค่าจริงทันที)
2025-11-24 01:00:12,369 INFO: สำเร็จ: อัปเดต/เพิ่ม 1 แถว
2025-11-24 01:00:12,370 INFO: Fetch สำเร็จ
2025-11-24 01:00:12,370 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 01:00:12,398 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 01:00:12,399 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 205 แถว
2025-11-24 01:00:12,399 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 01:00:12,403 INFO: รวมเก่า 205 + ใหม่ 205 → 205 (เพิ่ม 0)
2025-11-24 01:00:12,404 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 01:00:12,404 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 01:00:12,416 INFO: เริ่ม clean ข้อมูล: 205 แถว
2025-11-24 01:00:12,428 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (205 แถว)
2025-11-24 01:00:12,431 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-23 15:00:00          54.6           16.5       1.1 124.0       29.7    43.1     1012.1
2025-11-24 01:00:12,460 INFO: เตรียมโหลด 205 แถว
2025-11-24 01:00:12,751 INFO: โหลด DB สำเร็จ
2025-11-24 01:00:12,754 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 01:00:12,756 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 01:00:12,756 INFO: Load to DB + Backup สำเร็จ
2025-11-24 01:00:12,757 INFO: === PIPELINE END ===

2025-11-24 01:14:12,688 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 01:14:12,689 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 01:14:12,689 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 01:14:12,689 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 01:14:12,689 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 01:14:12,689 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 01:14:12,689 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 01:14:25,853 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 01:14:25,854 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 01:14:25,854 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 01:14:25,854 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 01:14:25,854 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 01:14:25,855 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 01:14:25,855 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 01:14:25,858 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:14:25,858 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:14:25,859 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:14:25,860 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:14:25,860 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:14:25,860 INFO: Scheduler started
2025-11-24 01:14:25,862 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 01:14:25,862 INFO: === PIPELINE START ===
2025-11-24 01:14:25,862 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:14:26,624 INFO: ดึง 2025-11-24 00:00:00+07:00 - 2025-11-24 01:00:00+07:00 → 2 แถว
2025-11-24 01:14:26,631 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 01:14:26,632 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 01:14:26,632 INFO: Fetch สำเร็จ
2025-11-24 01:14:26,632 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 01:14:26,659 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 01:14:26,661 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 206 แถว
2025-11-24 01:14:26,662 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 01:14:26,664 INFO: รวมเก่า 205 + ใหม่ 206 → 206 (เพิ่ม 1)
2025-11-24 01:14:26,665 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 01:14:26,665 INFO: Format สำเร็จ: +1 แถว
2025-11-24 01:14:26,678 INFO: เริ่ม clean ข้อมูล: 206 แถว
2025-11-24 01:14:26,691 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (206 แถว)
2025-11-24 01:14:26,695 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-24 01:14:26,726 INFO: เตรียมโหลด 206 แถว
2025-11-24 01:14:27,042 INFO: โหลด DB สำเร็จ
2025-11-24 01:14:27,045 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 01:14:27,047 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 01:14:27,048 INFO: Load to DB + Backup สำเร็จ
2025-11-24 01:14:27,048 INFO: === PIPELINE END ===

2025-11-24 01:15:00,007 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='15'], next run at: 2025-11-24 02:15:00 +07)" (scheduled at 2025-11-24 01:15:00+07:00)
2025-11-24 01:15:00,008 INFO: === PIPELINE START ===
2025-11-24 01:15:00,008 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:15:00,815 INFO: ดึง 2025-11-24 00:00:00+07:00 - 2025-11-24 01:00:00+07:00 → 2 แถว
2025-11-24 01:15:00,820 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 01:15:00,820 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 01:15:00,820 INFO: Fetch สำเร็จ
2025-11-24 01:15:00,821 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 01:15:00,850 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 01:15:00,852 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 206 แถว
2025-11-24 01:15:00,853 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 01:15:00,855 INFO: รวมเก่า 206 + ใหม่ 206 → 206 (เพิ่ม 0)
2025-11-24 01:15:00,857 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 01:15:00,857 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 01:15:00,871 INFO: เริ่ม clean ข้อมูล: 206 แถว
2025-11-24 01:15:00,887 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (206 แถว)
2025-11-24 01:15:00,890 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-24 01:15:00,893 INFO: เตรียมโหลด 206 แถว
2025-11-24 01:15:01,245 INFO: โหลด DB สำเร็จ
2025-11-24 01:15:01,247 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 01:15:01,250 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 01:15:01,250 INFO: Load to DB + Backup สำเร็จ
2025-11-24 01:15:01,250 INFO: === PIPELINE END ===

2025-11-24 01:15:01,251 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='15'], next run at: 2025-11-24 02:15:00 +07)" executed successfully
2025-11-24 01:15:08,916 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 01:15:08,919 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 01:15:08,920 INFO: ค่าฝุ่นปัจจุบัน: 27.5 µg/m³ → AQI 61 (ปานกลาง)
2025-11-24 01:15:08,921 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 01:15:08,921 INFO: เริ่ม autoregressive prediction...
2025-11-24 01:15:08,932 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 24.8 µg/m³ → AQI 50 (ดี)
2025-11-24 01:15:08,932 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 01:20:40,669 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 01:20:40,670 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 01:20:40,670 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 01:20:40,670 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 01:20:40,670 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 01:20:40,670 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 01:20:40,670 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 01:20:40,675 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:20:40,675 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:20:40,676 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:20:40,677 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:20:40,677 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:20:40,678 INFO: Scheduler started
2025-11-24 01:20:40,678 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 01:20:40,678 INFO: === PIPELINE START ===
2025-11-24 01:20:40,678 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:20:41,415 INFO: ดึง 2025-11-24 00:00:00+07:00 - 2025-11-24 01:00:00+07:00 → 2 แถว
2025-11-24 01:20:41,425 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 01:20:41,426 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 01:20:41,426 INFO: Fetch สำเร็จ
2025-11-24 01:20:41,426 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 01:20:41,456 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 01:20:41,458 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 206 แถว
2025-11-24 01:20:41,459 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 01:20:41,461 INFO: รวมเก่า 206 + ใหม่ 206 → 206 (เพิ่ม 0)
2025-11-24 01:20:41,463 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 01:20:41,463 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 01:20:41,474 INFO: เริ่ม clean ข้อมูล: 206 แถว
2025-11-24 01:20:41,485 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (206 แถว)
2025-11-24 01:20:41,489 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-24 01:20:41,519 INFO: เตรียมโหลด 206 แถว
2025-11-24 01:20:41,788 INFO: โหลด DB สำเร็จ
2025-11-24 01:20:41,789 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 01:20:41,792 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 01:20:41,792 INFO: Load to DB + Backup สำเร็จ
2025-11-24 01:20:41,792 INFO: === PIPELINE END ===

2025-11-24 01:32:10,424 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 01:32:10,425 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 01:32:10,426 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 01:32:10,426 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 01:32:10,426 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 01:32:10,426 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 01:32:10,426 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 01:32:10,431 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:32:10,431 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:32:10,432 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:32:10,433 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:32:10,434 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:32:10,434 INFO: Scheduler started
2025-11-24 01:32:10,434 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 01:32:10,434 INFO: === PIPELINE START ===
2025-11-24 01:32:10,434 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:32:11,162 INFO: ดึง 2025-11-24 00:00:00+07:00 - 2025-11-24 01:00:00+07:00 → 2 แถว
2025-11-24 01:32:11,170 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 01:32:11,171 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 01:32:11,171 INFO: Fetch สำเร็จ
2025-11-24 01:32:11,171 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 01:32:11,198 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 01:32:11,200 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 206 แถว
2025-11-24 01:32:11,201 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 01:32:11,204 INFO: รวมเก่า 206 + ใหม่ 206 → 206 (เพิ่ม 0)
2025-11-24 01:32:11,205 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 01:32:11,205 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 01:32:11,218 INFO: เริ่ม clean ข้อมูล: 206 แถว
2025-11-24 01:32:11,231 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (206 แถว)
2025-11-24 01:32:11,235 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-24 01:32:11,266 INFO: เตรียมโหลด 206 แถว
2025-11-24 01:32:11,636 INFO: โหลด DB สำเร็จ
2025-11-24 01:32:11,638 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 01:32:11,641 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 01:32:11,641 INFO: Load to DB + Backup สำเร็จ
2025-11-24 01:32:11,641 INFO: === PIPELINE END ===

2025-11-24 01:32:13,908 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 01:32:13,910 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 01:32:13,910 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 01:32:13,910 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 01:32:13,911 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 01:32:13,911 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 01:32:13,911 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 01:32:13,916 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:32:13,916 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:32:13,918 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:32:13,919 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:32:13,919 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:32:13,919 INFO: Scheduler started
2025-11-24 01:32:13,919 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 01:32:13,919 INFO: === PIPELINE START ===
2025-11-24 01:32:13,919 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:32:14,640 INFO: ดึง 2025-11-24 00:00:00+07:00 - 2025-11-24 01:00:00+07:00 → 2 แถว
2025-11-24 01:32:14,648 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 01:32:14,648 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 01:32:14,648 INFO: Fetch สำเร็จ
2025-11-24 01:32:14,648 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 01:32:14,677 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 01:32:14,679 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 206 แถว
2025-11-24 01:32:14,679 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 01:32:14,682 INFO: รวมเก่า 206 + ใหม่ 206 → 206 (เพิ่ม 0)
2025-11-24 01:32:14,683 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 01:32:14,684 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 01:32:14,695 INFO: เริ่ม clean ข้อมูล: 206 แถว
2025-11-24 01:32:14,709 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (206 แถว)
2025-11-24 01:32:14,712 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-24 01:32:14,742 INFO: เตรียมโหลด 206 แถว
2025-11-24 01:32:17,424 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 01:32:17,425 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 01:32:17,425 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 01:32:17,426 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scalers.pkl
2025-11-24 01:32:17,426 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 01:32:17,426 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 01:32:17,426 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 01:32:17,426 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 01:32:17,426 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 01:32:17,430 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:32:17,430 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:32:17,432 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:32:17,433 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:32:17,433 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:32:17,433 INFO: Scheduler started
2025-11-24 01:32:17,433 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 01:32:17,434 INFO: === PIPELINE START ===
2025-11-24 01:32:17,434 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:32:18,153 INFO: ดึง 2025-11-24 00:00:00+07:00 - 2025-11-24 01:00:00+07:00 → 2 แถว
2025-11-24 01:32:18,159 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 01:32:18,160 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 01:32:18,160 INFO: Fetch สำเร็จ
2025-11-24 01:32:18,160 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 01:32:18,187 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 01:32:18,189 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 206 แถว
2025-11-24 01:32:18,189 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 01:32:18,192 INFO: รวมเก่า 206 + ใหม่ 206 → 206 (เพิ่ม 0)
2025-11-24 01:32:18,193 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 01:32:18,193 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 01:32:18,205 INFO: เริ่ม clean ข้อมูล: 206 แถว
2025-11-24 01:32:18,217 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (206 แถว)
2025-11-24 01:32:18,221 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-24 01:32:18,252 INFO: เตรียมโหลด 206 แถว
2025-11-24 01:32:18,571 INFO: โหลด DB สำเร็จ
2025-11-24 01:32:18,574 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 01:32:18,577 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 01:32:18,577 INFO: Load to DB + Backup สำเร็จ
2025-11-24 01:32:18,577 INFO: === PIPELINE END ===

2025-11-24 01:35:08,058 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 01:35:08,060 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 01:35:08,060 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 01:35:08,060 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scalers.pkl
2025-11-24 01:35:08,060 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 01:35:08,060 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 01:35:08,060 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 01:35:08,060 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 01:35:08,060 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 01:35:08,065 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:35:08,066 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:35:08,067 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:35:08,069 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:35:08,069 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:35:08,069 INFO: Scheduler started
2025-11-24 01:35:08,069 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 01:35:08,069 INFO: === PIPELINE START ===
2025-11-24 01:35:08,070 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:35:08,819 INFO: ดึง 2025-11-24 00:00:00+07:00 - 2025-11-24 01:00:00+07:00 → 2 แถว
2025-11-24 01:35:08,827 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 01:35:08,827 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 01:35:08,828 INFO: Fetch สำเร็จ
2025-11-24 01:35:08,828 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 01:35:08,856 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 01:35:08,858 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 206 แถว
2025-11-24 01:35:08,859 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 01:35:08,861 INFO: รวมเก่า 206 + ใหม่ 206 → 206 (เพิ่ม 0)
2025-11-24 01:35:08,863 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 01:35:08,863 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 01:35:08,875 INFO: เริ่ม clean ข้อมูล: 206 แถว
2025-11-24 01:35:08,888 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (206 แถว)
2025-11-24 01:35:08,892 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-24 01:35:08,923 INFO: เตรียมโหลด 206 แถว
2025-11-24 01:35:10,952 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 01:35:10,953 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 01:35:10,953 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 01:35:10,953 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scalers.pkl
2025-11-24 01:35:10,953 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 01:35:10,953 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 01:35:10,953 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 01:35:10,954 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 01:35:10,954 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 01:35:10,958 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:35:10,958 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:35:10,960 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:35:10,962 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:35:10,962 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:35:10,962 INFO: Scheduler started
2025-11-24 01:35:10,962 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 01:35:10,962 INFO: === PIPELINE START ===
2025-11-24 01:35:10,962 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:35:11,710 INFO: ดึง 2025-11-24 00:00:00+07:00 - 2025-11-24 01:00:00+07:00 → 2 แถว
2025-11-24 01:35:11,718 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 01:35:11,718 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 01:35:11,718 INFO: Fetch สำเร็จ
2025-11-24 01:35:11,718 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 01:35:11,747 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 01:35:11,748 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 206 แถว
2025-11-24 01:35:11,749 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 01:35:11,751 INFO: รวมเก่า 206 + ใหม่ 206 → 206 (เพิ่ม 0)
2025-11-24 01:35:11,753 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 01:35:11,753 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 01:35:11,764 INFO: เริ่ม clean ข้อมูล: 206 แถว
2025-11-24 01:35:11,777 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (206 แถว)
2025-11-24 01:35:11,781 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-24 01:35:11,811 INFO: เตรียมโหลด 206 แถว
2025-11-24 01:35:12,085 INFO: โหลด DB สำเร็จ
2025-11-24 01:35:12,087 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 01:35:12,090 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 01:35:12,090 INFO: Load to DB + Backup สำเร็จ
2025-11-24 01:35:12,090 INFO: === PIPELINE END ===

2025-11-24 01:35:14,757 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 01:35:14,759 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 01:35:14,762 INFO: ค่าฝุ่นปัจจุบัน: 27.5 µg/m³ → AQI 61 (ปานกลาง)
2025-11-24 01:35:14,763 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 01:35:14,764 INFO: [PREDICT] current_pm25 = 27.5, raw_pred = 24.8
2025-11-24 01:35:14,764 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 24.8 µg/m³ → AQI 50 (ดี)
2025-11-24 01:35:14,764 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 01:35:29,073 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 01:35:29,074 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 01:35:29,075 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 01:35:29,075 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scalers.pkl
2025-11-24 01:35:29,075 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 01:35:29,075 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 01:35:29,075 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 01:35:29,075 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 01:35:29,075 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 01:35:29,080 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:35:29,080 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 01:35:29,082 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:35:29,083 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:35:29,083 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 01:35:29,083 INFO: Scheduler started
2025-11-24 01:35:29,083 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 01:35:29,084 INFO: === PIPELINE START ===
2025-11-24 01:35:29,084 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 01:35:29,814 INFO: ดึง 2025-11-24 00:00:00+07:00 - 2025-11-24 01:00:00+07:00 → 2 แถว
2025-11-24 01:35:29,824 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 01:35:29,825 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 01:35:29,825 INFO: Fetch สำเร็จ
2025-11-24 01:35:29,825 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 01:35:29,854 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 01:35:29,857 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 206 แถว
2025-11-24 01:35:29,857 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 01:35:29,859 INFO: รวมเก่า 206 + ใหม่ 206 → 206 (เพิ่ม 0)
2025-11-24 01:35:29,861 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 01:35:29,861 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 01:35:29,873 INFO: เริ่ม clean ข้อมูล: 206 แถว
2025-11-24 01:35:29,886 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (206 แถว)
2025-11-24 01:35:29,890 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-23 17:00:00          45.6           15.3       0.9 126.7       29.3    44.7     1011.7
2025-11-23 16:00:00          54.1           16.6       1.0 138.1       29.9    42.9     1011.8
2025-11-24 01:35:29,920 INFO: เตรียมโหลด 206 แถว
2025-11-24 01:35:30,234 INFO: โหลด DB สำเร็จ
2025-11-24 01:35:30,236 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 01:35:30,238 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 01:35:30,240 INFO: Load to DB + Backup สำเร็จ
2025-11-24 01:35:30,240 INFO: === PIPELINE END ===

2025-11-24 01:36:40,586 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 01:36:40,590 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 01:36:40,593 INFO: ค่าฝุ่นปัจจุบัน: 27.5 µg/m³ → AQI 61 (ปานกลาง)
2025-11-24 01:36:40,594 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 01:36:40,594 INFO: เริ่ม autoregressive prediction...
2025-11-24 01:36:40,603 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 24.8 µg/m³ → AQI 50 (ดี)
2025-11-24 01:36:40,603 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 14:51:50,996 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 14:51:51,007 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 14:51:51,007 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 14:51:51,008 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scalers.pkl
2025-11-24 14:51:51,008 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 14:51:51,008 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 14:51:51,008 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 14:51:51,008 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 14:51:51,008 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 14:51:51,015 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 14:51:51,015 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 14:51:51,019 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 14:51:51,020 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 14:51:51,020 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 14:51:51,021 INFO: Scheduler started
2025-11-24 14:51:51,021 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 14:51:51,021 INFO: === PIPELINE START ===
2025-11-24 14:51:51,021 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 14:51:51,859 INFO: ดึง 2025-11-24 13:00:00+07:00 - 2025-11-24 14:00:00+07:00 → 2 แถว
2025-11-24 14:51:51,919 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 14:51:51,920 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 14:51:51,920 INFO: Fetch สำเร็จ
2025-11-24 14:51:51,920 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 14:51:51,969 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 14:51:51,972 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 208 แถว
2025-11-24 14:51:51,973 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 14:51:51,985 INFO: รวมเก่า 206 + ใหม่ 208 → 208 (เพิ่ม 2)
2025-11-24 14:51:51,987 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 14:51:51,987 INFO: Format สำเร็จ: +2 แถว
2025-11-24 14:51:51,999 INFO: เริ่ม clean ข้อมูล: 208 แถว
2025-11-24 14:51:52,027 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (208 แถว)
2025-11-24 14:51:52,032 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 14:00:00          40.4           12.9       0.9 134.6       30.6    42.9     1011.2
2025-11-24 13:00:00          45.7           10.9       0.9 131.2       29.8    45.0     1012.1
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-23 18:00:00          50.6           16.3       0.8 132.5       28.4    47.3     1011.8
2025-11-24 14:51:54,491 INFO: เตรียมโหลด 208 แถว
2025-11-24 14:51:55,231 INFO: โหลด DB สำเร็จ
2025-11-24 14:51:55,236 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 14:51:55,244 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 14:51:55,244 INFO: Load to DB + Backup สำเร็จ
2025-11-24 14:51:55,245 INFO: === PIPELINE END ===

2025-11-24 14:52:03,365 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 14:52:03,375 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 14:52:03,379 INFO: ค่าฝุ่นปัจจุบัน: 12.9 µg/m³ → AQI 22 (ดีมาก)
2025-11-24 14:52:03,380 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 14:52:03,381 INFO: เริ่ม autoregressive prediction...
2025-11-24 14:52:03,412 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 21.6 µg/m³ → AQI 42 (ดี)
2025-11-24 14:52:03,412 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 15:17:43,472 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 15:17:43,474 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 15:17:43,474 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 15:17:43,475 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scalers.pkl
2025-11-24 15:17:43,475 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 15:17:43,475 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 15:17:43,475 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 15:17:43,475 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 15:17:43,475 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 15:17:43,479 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:17:43,479 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:17:43,482 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:17:43,483 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:17:43,483 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:17:43,483 INFO: Scheduler started
2025-11-24 15:17:43,483 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 15:17:43,484 INFO: === PIPELINE START ===
2025-11-24 15:17:43,484 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:17:44,238 INFO: ดึง 2025-11-24 14:00:00+07:00 - 2025-11-24 15:00:00+07:00 → 2 แถว
2025-11-24 15:17:44,262 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 15:17:44,262 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 15:17:44,262 INFO: Fetch สำเร็จ
2025-11-24 15:17:44,262 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 15:17:44,313 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 15:17:44,315 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 209 แถว
2025-11-24 15:17:44,316 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 15:17:44,330 INFO: รวมเก่า 208 + ใหม่ 209 → 209 (เพิ่ม 1)
2025-11-24 15:17:44,332 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 15:17:44,332 INFO: Format สำเร็จ: +1 แถว
2025-11-24 15:17:44,343 INFO: เริ่ม clean ข้อมูล: 209 แถว
2025-11-24 15:17:44,357 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (209 แถว)
2025-11-24 15:17:44,360 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 15:00:00          50.2           10.5       1.0 148.5       31.4    40.5     1010.5
2025-11-24 14:00:00          40.4           12.9       0.9 134.6       30.6    42.9     1011.2
2025-11-24 13:00:00          45.7           10.9       0.9 131.2       29.8    45.0     1012.1
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-24 15:17:44,990 INFO: เตรียมโหลด 209 แถว
2025-11-24 15:17:45,320 INFO: โหลด DB สำเร็จ
2025-11-24 15:17:45,323 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 15:17:45,325 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 15:17:45,325 INFO: Load to DB + Backup สำเร็จ
2025-11-24 15:17:45,325 INFO: === PIPELINE END ===

2025-11-24 15:21:24,191 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 15:21:24,192 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 15:21:24,192 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 15:21:24,192 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scaler.pkl
2025-11-24 15:21:24,192 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 15:21:24,192 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 15:21:24,192 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 15:21:24,192 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 15:21:24,193 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 15:21:24,196 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:21:24,197 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:21:24,198 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:21:24,199 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:21:24,200 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:21:24,200 INFO: Scheduler started
2025-11-24 15:21:24,200 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 15:21:24,200 INFO: === PIPELINE START ===
2025-11-24 15:21:24,200 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:21:24,955 INFO: ดึง 2025-11-24 14:00:00+07:00 - 2025-11-24 15:00:00+07:00 → 2 แถว
2025-11-24 15:21:24,963 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 15:21:24,964 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 15:21:24,964 INFO: Fetch สำเร็จ
2025-11-24 15:21:24,964 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 15:21:24,990 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 15:21:24,992 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 209 แถว
2025-11-24 15:21:24,993 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 15:21:24,995 INFO: รวมเก่า 209 + ใหม่ 209 → 209 (เพิ่ม 0)
2025-11-24 15:21:24,996 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 15:21:24,998 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 15:21:25,008 INFO: เริ่ม clean ข้อมูล: 209 แถว
2025-11-24 15:21:25,019 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (209 แถว)
2025-11-24 15:21:25,023 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 15:00:00          50.2           10.5       1.0 148.5       31.4    40.5     1010.5
2025-11-24 14:00:00          40.4           12.9       0.9 134.6       30.6    42.9     1011.2
2025-11-24 13:00:00          45.7           10.9       0.9 131.2       29.8    45.0     1012.1
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-24 15:21:25,050 INFO: เตรียมโหลด 209 แถว
2025-11-24 15:21:25,334 INFO: โหลด DB สำเร็จ
2025-11-24 15:21:25,337 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 15:21:25,340 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 15:21:25,340 INFO: Load to DB + Backup สำเร็จ
2025-11-24 15:21:25,340 INFO: === PIPELINE END ===

2025-11-24 15:21:30,018 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 15:21:30,022 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 15:21:30,024 INFO: ค่าฝุ่นปัจจุบัน: 10.5 µg/m³ → AQI 18 (ดีมาก)
2025-11-24 15:21:30,025 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 15:21:30,025 INFO: เริ่ม autoregressive prediction...
2025-11-24 15:21:30,035 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 20.9 µg/m³ → AQI 40 (ดี)
2025-11-24 15:21:30,036 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 15:30:02,250 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 15:30:02,251 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 15:30:02,251 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 15:30:02,252 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scaler.pkl
2025-11-24 15:30:02,252 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 15:30:02,252 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 15:30:02,252 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 15:30:02,252 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 15:30:02,252 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 182.100000
2025-11-24 15:30:02,256 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:30:02,256 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:30:02,259 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:30:02,260 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:30:02,260 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:30:02,260 INFO: Scheduler started
2025-11-24 15:30:02,261 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 15:30:02,261 INFO: === PIPELINE START ===
2025-11-24 15:30:02,261 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:30:03,171 INFO: ดึง 2025-11-24 14:00:00+07:00 - 2025-11-24 15:00:00+07:00 → 2 แถว
2025-11-24 15:30:03,179 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 15:30:03,180 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 15:30:03,181 INFO: Fetch สำเร็จ
2025-11-24 15:30:03,181 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 15:30:03,212 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 15:30:03,214 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 209 แถว
2025-11-24 15:30:03,214 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 15:30:03,216 INFO: รวมเก่า 209 + ใหม่ 209 → 209 (เพิ่ม 0)
2025-11-24 15:30:03,218 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 15:30:03,218 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 15:30:03,230 INFO: เริ่ม clean ข้อมูล: 209 แถว
2025-11-24 15:30:03,242 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (209 แถว)
2025-11-24 15:30:03,246 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 15:00:00          50.2           10.5       1.0 148.5       31.4    40.5     1010.5
2025-11-24 14:00:00          40.4           12.9       0.9 134.6       30.6    42.9     1011.2
2025-11-24 13:00:00          45.7           10.9       0.9 131.2       29.8    45.0     1012.1
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-24 15:30:03,277 INFO: เตรียมโหลด 209 แถว
2025-11-24 15:30:03,636 INFO: โหลด DB สำเร็จ
2025-11-24 15:30:03,639 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 15:30:03,642 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 15:30:03,642 INFO: Load to DB + Backup สำเร็จ
2025-11-24 15:30:03,642 INFO: === PIPELINE END ===

2025-11-24 15:32:43,423 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 15:32:43,424 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 15:32:43,424 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 15:32:43,424 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scaler.pkl
2025-11-24 15:32:43,424 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 15:32:43,424 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 15:32:43,424 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 15:32:43,425 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 15:32:43,425 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 163.800000
2025-11-24 15:32:43,429 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:32:43,429 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:32:43,431 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:32:43,432 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:32:43,432 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:32:43,432 INFO: Scheduler started
2025-11-24 15:32:43,432 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 15:32:43,433 INFO: === PIPELINE START ===
2025-11-24 15:32:43,433 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:32:44,157 INFO: ดึง 2025-11-24 14:00:00+07:00 - 2025-11-24 15:00:00+07:00 → 2 แถว
2025-11-24 15:32:44,166 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 15:32:44,168 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 15:32:44,169 INFO: Fetch สำเร็จ
2025-11-24 15:32:44,169 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 15:32:44,198 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 15:32:44,199 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 209 แถว
2025-11-24 15:32:44,200 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 15:32:44,202 INFO: รวมเก่า 209 + ใหม่ 209 → 209 (เพิ่ม 0)
2025-11-24 15:32:44,203 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 15:32:44,203 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 15:32:44,215 INFO: เริ่ม clean ข้อมูล: 209 แถว
2025-11-24 15:32:44,227 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (209 แถว)
2025-11-24 15:32:44,231 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 15:00:00          50.2           10.5       1.0 148.5       31.4    40.5     1010.5
2025-11-24 14:00:00          40.4           12.9       0.9 134.6       30.6    42.9     1011.2
2025-11-24 13:00:00          45.7           10.9       0.9 131.2       29.8    45.0     1012.1
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-24 15:32:44,259 INFO: เตรียมโหลด 209 แถว
2025-11-24 15:32:44,536 INFO: โหลด DB สำเร็จ
2025-11-24 15:32:44,538 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 15:32:44,540 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 15:32:44,541 INFO: Load to DB + Backup สำเร็จ
2025-11-24 15:32:44,541 INFO: === PIPELINE END ===

2025-11-24 15:34:03,618 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 15:34:03,621 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 15:34:03,623 INFO: ค่าฝุ่นปัจจุบัน: 10.5 µg/m³ → AQI 18 (ดีมาก)
2025-11-24 15:34:03,624 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 15:34:03,624 INFO: เริ่ม autoregressive prediction...
2025-11-24 15:34:03,634 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 19.8 µg/m³ → AQI 38 (ดี)
2025-11-24 15:34:03,635 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 15:40:21,786 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 15:40:21,788 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 15:40:21,790 INFO: ค่าฝุ่นปัจจุบัน: 10.5 µg/m³ → AQI 18 (ดีมาก)
2025-11-24 15:40:21,791 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 15:40:21,791 INFO: เริ่ม autoregressive prediction...
2025-11-24 15:40:21,800 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 19.8 µg/m³ → AQI 38 (ดี)
2025-11-24 15:40:21,800 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 15:40:22,690 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 15:40:22,692 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 15:40:22,693 INFO: ค่าฝุ่นปัจจุบัน: 10.5 µg/m³ → AQI 18 (ดีมาก)
2025-11-24 15:40:22,694 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 15:40:22,694 INFO: เริ่ม autoregressive prediction...
2025-11-24 15:40:22,709 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 19.8 µg/m³ → AQI 38 (ดี)
2025-11-24 15:40:22,709 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 15:45:53,007 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 15:45:53,009 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 15:45:53,010 INFO: ค่าฝุ่นปัจจุบัน: 10.5 µg/m³ → AQI 18 (ดีมาก)
2025-11-24 15:45:53,011 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 15:45:53,011 INFO: เริ่ม autoregressive prediction...
2025-11-24 15:45:53,024 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 19.8 µg/m³ → AQI 38 (ดี)
2025-11-24 15:45:53,024 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 15:53:11,292 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 15:53:11,294 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 15:53:11,294 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 15:53:11,294 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scaler.pkl
2025-11-24 15:53:11,294 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 15:53:11,294 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 15:53:11,294 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 15:53:11,294 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 15:53:11,294 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 163.800000
2025-11-24 15:53:11,299 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:53:11,299 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:53:11,301 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:53:11,302 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:53:11,302 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:53:11,302 INFO: Scheduler started
2025-11-24 15:53:11,302 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 15:53:11,303 INFO: === PIPELINE START ===
2025-11-24 15:53:11,303 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:53:12,129 INFO: ดึง 2025-11-24 14:00:00+07:00 - 2025-11-24 15:00:00+07:00 → 2 แถว
2025-11-24 15:53:12,137 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 15:53:12,137 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 15:53:12,138 INFO: Fetch สำเร็จ
2025-11-24 15:53:12,138 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 15:53:12,173 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 15:53:12,175 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 209 แถว
2025-11-24 15:53:12,176 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 15:53:12,178 INFO: รวมเก่า 209 + ใหม่ 209 → 209 (เพิ่ม 0)
2025-11-24 15:53:12,180 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 15:53:12,180 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 15:53:12,192 INFO: เริ่ม clean ข้อมูล: 209 แถว
2025-11-24 15:53:12,204 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (209 แถว)
2025-11-24 15:53:12,206 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 15:00:00          50.2           10.5       1.0 148.5       31.4    40.5     1010.5
2025-11-24 14:00:00          40.4           12.9       0.9 134.6       30.6    42.9     1011.2
2025-11-24 13:00:00          45.7           10.9       0.9 131.2       29.8    45.0     1012.1
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-24 15:53:12,236 INFO: เตรียมโหลด 209 แถว
2025-11-24 15:53:12,557 INFO: โหลด DB สำเร็จ
2025-11-24 15:53:12,560 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 15:53:12,563 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 15:53:12,564 INFO: Load to DB + Backup สำเร็จ
2025-11-24 15:53:12,564 INFO: === PIPELINE END ===

2025-11-24 15:53:20,004 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 15:53:20,005 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 15:53:20,005 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 15:53:20,005 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scaler.pkl
2025-11-24 15:53:20,005 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 15:53:20,005 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 15:53:20,006 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 15:53:20,006 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 15:53:20,006 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 163.800000
2025-11-24 15:53:20,011 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:53:20,011 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:53:20,013 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:53:20,014 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:53:20,014 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:53:20,014 INFO: Scheduler started
2025-11-24 15:53:20,014 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 15:53:20,014 INFO: === PIPELINE START ===
2025-11-24 15:53:20,015 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:53:20,755 INFO: ดึง 2025-11-24 14:00:00+07:00 - 2025-11-24 15:00:00+07:00 → 2 แถว
2025-11-24 15:53:20,763 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 15:53:20,764 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 15:53:20,764 INFO: Fetch สำเร็จ
2025-11-24 15:53:20,764 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 15:53:20,793 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 15:53:20,795 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 209 แถว
2025-11-24 15:53:20,796 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 15:53:20,799 INFO: รวมเก่า 209 + ใหม่ 209 → 209 (เพิ่ม 0)
2025-11-24 15:53:20,800 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 15:53:20,801 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 15:53:20,813 INFO: เริ่ม clean ข้อมูล: 209 แถว
2025-11-24 15:53:20,825 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (209 แถว)
2025-11-24 15:53:20,829 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 15:00:00          50.2           10.5       1.0 148.5       31.4    40.5     1010.5
2025-11-24 14:00:00          40.4           12.9       0.9 134.6       30.6    42.9     1011.2
2025-11-24 13:00:00          45.7           10.9       0.9 131.2       29.8    45.0     1012.1
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-24 15:53:20,859 INFO: เตรียมโหลด 209 แถว
2025-11-24 15:53:21,321 INFO: โหลด DB สำเร็จ
2025-11-24 15:53:21,323 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 15:53:21,326 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 15:53:21,327 INFO: Load to DB + Backup สำเร็จ
2025-11-24 15:53:21,327 INFO: === PIPELINE END ===

2025-11-24 15:53:23,453 INFO: [MODEL] โหลดสำเร็จ → คาดหวัง 168 features
2025-11-24 15:53:23,454 INFO: [SCALER] โหลดสำเร็จ → 7 features (ต้องเป็น 168)
2025-11-24 15:53:23,454 INFO: [DEBUG] MODEL_PATH = C:\Pm2_5\models\xgboost_pm25_best.json
2025-11-24 15:53:23,454 INFO: [DEBUG] SCALER_PATH = C:\Pm2_5\models\pm25_scaler.pkl
2025-11-24 15:53:23,454 INFO: [DEBUG] SCALER class = MinMaxScaler
2025-11-24 15:53:23,454 INFO: [DEBUG] SCALER.n_features_in_ = 7
2025-11-24 15:53:23,455 INFO: [DEBUG] MinMaxScaler.feature_range = (0, 1)
2025-11-24 15:53:23,455 INFO: [DEBUG] MinMaxScaler.data_min_ (last feature) = 0.000000
2025-11-24 15:53:23,455 INFO: [DEBUG] MinMaxScaler.data_max_ (last feature) = 163.800000
2025-11-24 15:53:23,460 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:53:23,460 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-24 15:53:23,462 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:53:23,463 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:53:23,463 INFO: Added job "run_pipeline" to job store "default"
2025-11-24 15:53:23,463 INFO: Scheduler started
2025-11-24 15:53:23,463 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5 และ 15
2025-11-24 15:53:23,464 INFO: === PIPELINE START ===
2025-11-24 15:53:23,464 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 15:53:24,218 INFO: ดึง 2025-11-24 14:00:00+07:00 - 2025-11-24 15:00:00+07:00 → 2 แถว
2025-11-24 15:53:24,227 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 15:53:24,227 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 15:53:24,228 INFO: Fetch สำเร็จ
2025-11-24 15:53:24,228 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 15:53:24,256 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 15:53:24,257 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 209 แถว
2025-11-24 15:53:24,258 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 15:53:24,260 INFO: รวมเก่า 209 + ใหม่ 209 → 209 (เพิ่ม 0)
2025-11-24 15:53:24,262 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 15:53:24,262 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 15:53:24,274 INFO: เริ่ม clean ข้อมูล: 209 แถว
2025-11-24 15:53:24,287 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (209 แถว)
2025-11-24 15:53:24,292 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 15:00:00          50.2           10.5       1.0 148.5       31.4    40.5     1010.5
2025-11-24 14:00:00          40.4           12.9       0.9 134.6       30.6    42.9     1011.2
2025-11-24 13:00:00          45.7           10.9       0.9 131.2       29.8    45.0     1012.1
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-23 19:00:00          51.0           16.1       0.6 131.8       27.7    49.6     1012.4
2025-11-24 15:53:24,321 INFO: เตรียมโหลด 209 แถว
2025-11-24 15:53:24,627 INFO: โหลด DB สำเร็จ
2025-11-24 15:53:24,629 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 15:53:24,631 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 15:53:24,631 INFO: Load to DB + Backup สำเร็จ
2025-11-24 15:53:24,632 INFO: === PIPELINE END ===

2025-11-24 15:53:43,049 INFO: === เริ่มพยากรณ์ฝุ่น PM2.5 ล่วงหน้า 24 ชั่วโมง ===
2025-11-24 15:53:43,053 INFO: ดึงข้อมูลจาก DB สำเร็จ → 200 แถว
2025-11-24 15:53:43,055 INFO: ค่าฝุ่นปัจจุบัน: 10.5 µg/m³ → AQI 18 (ดีมาก)
2025-11-24 15:53:43,055 INFO: สเกลข้อมูลสำเร็จ → shape: (200, 7)
2025-11-24 15:53:43,056 INFO: เริ่ม autoregressive prediction...
2025-11-24 15:53:43,057 INFO: [DEBUG] INPUT_TO_MODEL (X_recent) = [[2.16115702e-01 1.97160883e-04 3.37867851e-01 2.31000000e-01
  6.07307278e-02 9.92019704e-01 1.28815629e-01 2.34297521e-01
  2.95741325e-04 3.45641310e-01 2.31000000e-01 5.91634832e-02
  9.92216749e-01 1.34310134e-01 2.01239669e-01 5.91482650e-04
  3.65907829e-01 2.33000000e-01 5.68126163e-02 9.92512315e-01
  1.19658120e-01 2.17355372e-01 7.88643533e-04 3.92004442e-01
  2.33000000e-01 5.70085219e-02 9.92906404e-01 1.34920635e-01
  1.99586777e-01 7.88643533e-04 3.87007218e-01 2.39000000e-01
  5.60289940e-02 9.93497537e-01 1.23321123e-01 2.06198347e-01
  9.85804416e-04 3.98112160e-01 2.49000000e-01 5.28945048e-02
  9.94285714e-01 1.61782662e-01 2.52479339e-01 9.85804416e-04
  3.91726818e-01 2.62000000e-01 4.94661573e-02 9.94581281e-01
  1.23931624e-01 2.48347107e-01 1.08438486e-03 4.04775125e-01
  2.74000000e-01 4.68214321e-02 9.94482759e-01 9.95115995e-02
  2.32644628e-01 1.57728707e-03 4.21710161e-01 2.81000000e-01
  4.51562347e-02 9.93694581e-01 1.15995116e-01 2.27685950e-01
  1.18296530e-03 3.72570794e-01 2.88000000e-01 4.35889901e-02
  9.92709360e-01 9.34065934e-02 2.07851240e-01 1.18296530e-03
  3.57856746e-01 2.97000000e-01 4.13360760e-02 9.91822660e-01
  7.02075702e-02 2.25619835e-01 1.08438486e-03 3.44253193e-01
  2.97000000e-01 4.22176511e-02 9.91231527e-01 1.00732601e-01
  2.23553719e-01 9.85804416e-04 3.83398112e-01 2.99000000e-01
  4.20217455e-02 9.90935961e-01 1.01343101e-01 1.88429752e-01
  8.87223975e-04 3.51749028e-01 2.93000000e-01 4.37848957e-02
  9.90837438e-01 9.34065934e-02 2.09090909e-01 7.88643533e-04
  3.67851194e-01 2.84000000e-01 4.63316681e-02 9.90935961e-01
  9.95115995e-02 2.10743802e-01 5.91482650e-04 3.65907829e-01
  2.77000000e-01 4.85845822e-02 9.91527094e-01 9.82905983e-02
  2.10743802e-01 3.94321767e-04 3.28706274e-01 2.71000000e-01
  5.12293075e-02 9.92118227e-01 1.19658120e-01 2.07024793e-01
  5.91482650e-04 3.49250416e-01 2.68000000e-01 5.27965521e-02
  9.92413793e-01 1.42246642e-01 1.95041322e-01 6.90063091e-04
  3.83675736e-01 2.68000000e-01 5.33842688e-02 9.92413793e-01
  1.36752137e-01 2.13636364e-01 5.91482650e-04 3.68684064e-01
  2.61000000e-01 5.79880498e-02 9.92315271e-01 1.47741148e-01
  2.07024793e-01 7.88643533e-04 3.81454747e-01 2.59000000e-01
  6.02409639e-02 9.92019704e-01 1.60561661e-01 2.06611570e-01
  5.91482650e-04 3.71182676e-01 2.55000000e-01 6.18082084e-02
  9.91921182e-01 1.67887668e-01 1.88842975e-01 8.87223975e-04
  3.64242088e-01 2.98000000e-01 4.40787540e-02 9.91231527e-01
  6.65445665e-02 1.66942149e-01 8.87223975e-04 3.73681288e-01
  3.06000000e-01 4.20217455e-02 9.90344828e-01 7.87545788e-02]]
2025-11-24 15:53:43,068 INFO: พยากรณ์สำเร็จ! สูงสุด 24 ชม. = 19.8 µg/m³ → AQI 38 (ดี)
2025-11-24 15:53:43,068 INFO: === พยากรณ์ 24 ชม. เสร็จสิ้น ===

2025-11-24 16:05:00,013 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-24 17:05:00 +07)" (scheduled at 2025-11-24 16:05:00+07:00)
2025-11-24 16:05:00,013 INFO: === PIPELINE START ===
2025-11-24 16:05:00,013 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 16:05:00,802 INFO: ดึง 2025-11-24 15:00:00+07:00 - 2025-11-24 16:00:00+07:00 → 2 แถว
2025-11-24 16:05:00,808 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 16:05:00,809 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 16:05:00,809 INFO: Fetch สำเร็จ
2025-11-24 16:05:00,809 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 16:05:00,838 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 16:05:00,840 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 210 แถว
2025-11-24 16:05:00,841 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 16:05:00,843 INFO: รวมเก่า 209 + ใหม่ 210 → 210 (เพิ่ม 1)
2025-11-24 16:05:00,845 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 16:05:00,845 INFO: Format สำเร็จ: +1 แถว
2025-11-24 16:05:00,859 INFO: เริ่ม clean ข้อมูล: 210 แถว
2025-11-24 16:05:00,870 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (210 แถว)
2025-11-24 16:05:00,873 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 16:00:00          51.0           10.5       1.0 146.6       31.5    40.8     1010.0
2025-11-24 15:00:00          50.2           10.5       1.0 148.5       31.4    40.5     1010.5
2025-11-24 14:00:00          40.4           12.9       0.9 134.6       30.6    42.9     1011.2
2025-11-24 13:00:00          45.7           10.9       0.9 131.2       29.8    45.0     1012.1
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-24 16:05:00,875 INFO: เตรียมโหลด 210 แถว
2025-11-24 16:05:01,158 INFO: โหลด DB สำเร็จ
2025-11-24 16:05:01,161 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 16:05:01,163 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 16:05:01,163 INFO: Load to DB + Backup สำเร็จ
2025-11-24 16:05:01,163 INFO: === PIPELINE END ===

2025-11-24 16:05:01,163 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-24 17:05:00 +07)" executed successfully
2025-11-24 16:15:00,010 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='15'], next run at: 2025-11-24 17:15:00 +07)" (scheduled at 2025-11-24 16:15:00+07:00)
2025-11-24 16:15:00,011 INFO: === PIPELINE START ===
2025-11-24 16:15:00,011 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (uvicorn mode)
2025-11-24 16:15:00,751 INFO: ดึง 2025-11-24 15:00:00+07:00 - 2025-11-24 16:00:00+07:00 → 2 แถว
2025-11-24 16:15:00,757 INFO: อัปเดต raw file สำเร็จ → อัปเดต/เพิ่ม 2 แถว (ทับค่าจริงทันที)
2025-11-24 16:15:00,758 INFO: สำเร็จ: อัปเดต/เพิ่ม 2 แถว
2025-11-24 16:15:00,758 INFO: Fetch สำเร็จ
2025-11-24 16:15:00,758 INFO: ไม่พบไฟล์ clean → ใช้ master แทน: data\staging\raw_airbkk.csv
2025-11-24 16:15:00,787 WARNING: parse Date_Time จากไฟล์อ้างอิงไม่ได้ → ข้ามการเติมย้อนหลัง
2025-11-24 16:15:00,788 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 210 แถว
2025-11-24 16:15:00,789 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-24 16:15:00,791 INFO: รวมเก่า 210 + ใหม่ 210 → 210 (เพิ่ม 0)
2025-11-24 16:15:00,792 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-24 16:15:00,793 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-24 16:15:00,804 INFO: เริ่ม clean ข้อมูล: 210 แถว
2025-11-24 16:15:00,815 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (210 แถว)
2025-11-24 16:15:00,819 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-24 16:00:00          51.0           14.8       1.0 146.6       31.5    40.8     1010.0
2025-11-24 15:00:00          50.2           10.5       1.0 148.5       31.4    40.5     1010.5
2025-11-24 14:00:00          40.4           12.9       0.9 134.6       30.6    42.9     1011.2
2025-11-24 13:00:00          45.7           10.9       0.9 131.2       29.8    45.0     1012.1
2025-11-24 01:00:00          50.0           27.5       0.6 133.7       25.5    63.1     1012.8
2025-11-24 00:00:00          50.1           26.3       0.8 137.4       25.9    61.5     1012.9
2025-11-23 23:00:00          51.7           24.2       0.6 132.8       26.1    59.2     1013.2
2025-11-23 22:00:00          47.2           22.4       0.7 138.2       26.8    54.5     1013.3
2025-11-23 21:00:00          50.1           23.3       0.6 125.8       26.8    53.9     1013.3
2025-11-23 20:00:00          51.0           19.6       0.4 118.4       27.1    52.3     1013.0
2025-11-24 16:15:00,821 INFO: เตรียมโหลด 210 แถว
2025-11-24 16:15:01,076 INFO: โหลด DB สำเร็จ
2025-11-24 16:15:01,078 INFO: Backup สำเร็จ: data\backups\2025-11-24.csv
2025-11-24 16:15:01,081 INFO: อัพเดท latest.csv สำเร็จ
2025-11-24 16:15:01,081 INFO: Load to DB + Backup สำเร็จ
2025-11-24 16:15:01,081 INFO: === PIPELINE END ===

2025-11-24 16:15:01,081 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='15'], next run at: 2025-11-24 17:15:00 +07)" executed successfully
