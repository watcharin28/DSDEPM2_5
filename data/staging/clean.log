2025-11-15 21:50:25,054 INFO: อ่านไฟล์: data\staging\formatted_air.csv
2025-11-15 21:50:25,064 INFO: อ่านข้อมูล: 2 แถว
2025-11-15 21:50:25,070 INFO: หลังแปลงตัวเลข - missing:
PM10 (µg/m³)     0
PM2.5 (µg/m³)    0
WS (m/s)         0
Temp (°C)        0
RH (%)           0
BP (mBar)        0
dtype: int64
2025-11-15 21:50:25,075 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (2 แถว)
2025-11-15 21:50:25,077 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)  Temp (°C)  RH (%)  BP (mBar)
2025-11-15 21:00:00          52.4           16.9       0.3       27.7    43.7     1014.2
2025-11-15 20:00:00          44.1           13.4       0.4       28.3    41.2     1013.5
2025-11-15 22:08:42,332 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:08:42,333 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:08:42,333 INFO: Scheduler started
2025-11-15 22:08:42,333 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:08:42,333 INFO: === PIPELINE START ===
2025-11-15 22:08:43,022 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:08:43,029 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:08:43,030 INFO: สำเร็จ: เพิ่ม 1 แถว
2025-11-15 22:08:43,030 INFO: Fetch สำเร็จ
2025-11-15 22:08:43,041 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:08:43,042 INFO: เลือกคอลัมน์: 7 คอลัมน์
2025-11-15 22:08:43,045 INFO: รวมเก่า 2 + ใหม่ 3 → 3 (เพิ่ม 1)
2025-11-15 22:08:43,045 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:08:43,046 INFO: Format สำเร็จ: เพิ่ม 1 แถว
2025-11-15 22:08:43,055 INFO: เริ่ม clean ข้อมูล: 3 แถว
2025-11-15 22:08:43,065 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (3 แถว)
2025-11-15 22:08:43,067 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)  Temp (°C)  RH (%)  BP (mBar)
2025-11-15 22:00:00          53.0           22.0       0.4       27.8    45.2     1014.5
2025-11-15 21:00:00          52.4           16.9       0.3       27.7    43.7     1014.2
2025-11-15 20:00:00          44.1           13.4       0.4       28.3    41.2     1013.5
2025-11-15 22:08:43,067 INFO: Clean สำเร็จ
2025-11-15 22:08:43,093 INFO: เตรียมโหลด 3 แถว
2025-11-15 22:08:43,096 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:08:42.330146+07:00)
2025-11-15 22:08:43,097 INFO: === PIPELINE START ===
2025-11-15 22:08:43,792 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:08:43,794 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:08:43,795 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:08:43,795 INFO: Fetch สำเร็จ
2025-11-15 22:08:43,796 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:08:43,797 INFO: เลือกคอลัมน์: 7 คอลัมน์
2025-11-15 22:08:43,799 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:08:43,800 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:08:43,800 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:08:43,800 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:08:43,851 ERROR: Load ล้มเหลว: [WinError 1314] A required privilege is not held by the client: '2025-11-15.csv' -> 'data\\backups\\latest.csv'
2025-11-15 22:08:56,770 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:08:56,771 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:08:56,772 INFO: Scheduler started
2025-11-15 22:08:56,772 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:08:56,772 INFO: === PIPELINE START ===
2025-11-15 22:08:57,472 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:08:57,478 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:08:57,479 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:08:57,479 INFO: Fetch สำเร็จ
2025-11-15 22:08:57,480 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:08:57,481 INFO: เลือกคอลัมน์: 7 คอลัมน์
2025-11-15 22:08:57,484 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:08:57,486 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:08:57,487 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:08:57,487 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:08:56.768037+07:00)
2025-11-15 22:08:57,487 INFO: === PIPELINE START ===
2025-11-15 22:08:58,180 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:08:58,182 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:08:58,183 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:08:58,183 INFO: Fetch สำเร็จ
2025-11-15 22:08:58,184 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:08:58,185 INFO: เลือกคอลัมน์: 7 คอลัมน์
2025-11-15 22:08:58,187 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:08:58,188 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:08:58,188 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:08:58,188 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:10:43,362 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:10:43,363 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:10:43,363 INFO: Scheduler started
2025-11-15 22:10:43,364 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:10:43,364 INFO: === PIPELINE START ===
2025-11-15 22:10:44,090 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:10:44,096 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:10:44,096 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:10:44,096 INFO: Fetch สำเร็จ
2025-11-15 22:10:44,098 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:10:44,098 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:10:44,102 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:10:44,104 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:10:44,104 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:10:44,104 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:10:43.359727+07:00)
2025-11-15 22:10:44,104 INFO: === PIPELINE START ===
2025-11-15 22:10:44,827 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:10:44,830 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:10:44,830 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:10:44,830 INFO: Fetch สำเร็จ
2025-11-15 22:10:44,832 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:10:44,832 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:10:44,845 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:10:44,846 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:10:44,846 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:10:44,846 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:12:03,723 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:12:03,726 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:12:03,726 INFO: Scheduler started
2025-11-15 22:12:03,726 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:12:03,726 INFO: === PIPELINE START ===
2025-11-15 22:12:04,465 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:12:04,470 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:12:04,471 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:12:04,471 INFO: Fetch สำเร็จ
2025-11-15 22:12:04,472 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:12:04,473 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:12:04,477 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:12:04,479 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:12:04,479 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:12:04,479 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:12:03.721516+07:00)
2025-11-15 22:12:04,479 INFO: === PIPELINE START ===
2025-11-15 22:12:05,202 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:12:05,205 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:12:05,205 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:12:05,206 INFO: Fetch สำเร็จ
2025-11-15 22:12:05,207 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:12:05,207 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:12:05,211 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:12:05,212 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:12:05,212 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:12:05,212 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:12:33,646 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:12:33,649 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:12:33,649 INFO: Scheduler started
2025-11-15 22:12:33,649 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:12:33,649 INFO: === PIPELINE START ===
2025-11-15 22:12:34,449 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:12:34,454 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:12:34,455 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:12:34,455 INFO: Fetch สำเร็จ
2025-11-15 22:12:34,456 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:12:34,457 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:12:34,460 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:12:34,462 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:12:34,462 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:12:34,462 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:12:33.644933+07:00)
2025-11-15 22:12:34,462 INFO: === PIPELINE START ===
2025-11-15 22:12:35,173 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:12:35,180 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:12:35,180 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:12:35,181 INFO: Fetch สำเร็จ
2025-11-15 22:12:35,182 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:12:35,183 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:12:35,186 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:12:35,187 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:12:35,188 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:12:35,188 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:15:11,220 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:15:11,221 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:15:11,221 INFO: Scheduler started
2025-11-15 22:15:11,223 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:15:11,223 INFO: === PIPELINE START ===
2025-11-15 22:15:11,891 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:15:11,901 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:15:11,901 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:15:11,902 INFO: Fetch สำเร็จ
2025-11-15 22:15:11,902 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:15:11,903 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:15:11,907 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:15:11,909 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:15:11,909 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:15:11,909 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:15:11.218672+07:00)
2025-11-15 22:15:11,910 INFO: === PIPELINE START ===
2025-11-15 22:15:12,576 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:15:12,583 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:15:12,583 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:15:12,583 INFO: Fetch สำเร็จ
2025-11-15 22:15:12,585 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:15:12,585 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:15:12,588 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:15:12,589 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:15:12,589 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:15:12,589 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:18:04,801 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:18:04,802 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:18:04,802 INFO: Scheduler started
2025-11-15 22:18:04,802 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:18:04,803 INFO: === PIPELINE START ===
2025-11-15 22:18:08,317 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:18:08,323 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:18:08,323 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:18:08,323 INFO: Fetch สำเร็จ
2025-11-15 22:18:08,324 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:18:08,325 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:18:08,328 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:18:08,331 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:18:08,331 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:18:08,331 WARNING: Run time of job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" was missed by 0:00:03.532946
2025-11-15 22:24:19,655 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:24:19,656 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:24:19,656 INFO: Scheduler started
2025-11-15 22:24:19,656 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:24:19,657 INFO: === PIPELINE START ===
2025-11-15 22:24:20,370 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:24:20,376 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:24:20,377 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:24:20,377 INFO: Fetch สำเร็จ
2025-11-15 22:24:20,378 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:24:20,379 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:24:20,382 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:24:20,384 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:24:20,384 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:24:20,385 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:24:19.652625+07:00)
2025-11-15 22:24:20,385 INFO: === PIPELINE START ===
2025-11-15 22:24:21,111 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:24:21,114 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:24:21,114 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:24:21,114 INFO: Fetch สำเร็จ
2025-11-15 22:24:21,115 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:24:21,115 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:24:21,119 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:24:21,121 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:24:21,121 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:24:21,121 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:29:35,352 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:29:35,354 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:29:35,354 INFO: Scheduler started
2025-11-15 22:29:35,354 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:29:35,354 INFO: === PIPELINE START ===
2025-11-15 22:29:36,061 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:29:36,065 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:29:36,065 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:29:36,065 INFO: Fetch สำเร็จ
2025-11-15 22:29:36,069 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:29:36,069 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:29:36,072 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:29:36,074 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:29:36,074 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:29:36,074 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:29:35.350473+07:00)
2025-11-15 22:29:36,075 INFO: === PIPELINE START ===
2025-11-15 22:29:36,751 INFO: ดึงข้อมูล 15/11/2025 21:00 - 15/11/2025 22:00 → 2 แถว
2025-11-15 22:29:36,755 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:29:36,756 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:29:36,756 INFO: Fetch สำเร็จ
2025-11-15 22:29:36,758 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:29:36,758 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:29:36,760 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:29:36,761 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:29:36,761 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:29:36,762 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:30:45,882 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:30:45,884 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:30:45,884 INFO: Scheduler started
2025-11-15 22:30:45,884 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:30:45,884 INFO: === PIPELINE START ===
2025-11-15 22:30:46,621 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:30:46,627 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:46,630 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:46,631 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:30:46,631 INFO: Fetch สำเร็จ
2025-11-15 22:30:46,632 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:30:46,633 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:30:46,635 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:30:46,638 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:30:46,638 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:30:46,638 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:30:45.878542+07:00)
2025-11-15 22:30:46,639 INFO: === PIPELINE START ===
2025-11-15 22:30:47,359 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:30:47,363 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:47,365 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:47,366 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:30:47,366 INFO: Fetch สำเร็จ
2025-11-15 22:30:47,367 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:30:47,368 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:30:47,370 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:30:47,371 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:30:47,372 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:30:47,372 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:30:48,751 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:30:48,752 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:30:48,752 INFO: Scheduler started
2025-11-15 22:30:48,754 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:30:48,754 INFO: === PIPELINE START ===
2025-11-15 22:30:49,450 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:30:49,457 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:49,460 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:49,460 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:30:49,460 INFO: Fetch สำเร็จ
2025-11-15 22:30:49,461 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:30:49,462 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:30:49,464 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:30:49,466 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:30:49,466 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:30:49,467 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:30:48.750834+07:00)
2025-11-15 22:30:49,467 INFO: === PIPELINE START ===
2025-11-15 22:30:50,180 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:30:50,182 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:50,187 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:30:50,187 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:30:50,188 INFO: Fetch สำเร็จ
2025-11-15 22:30:50,189 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:30:50,189 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:30:50,191 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:30:50,192 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:30:50,193 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:30:50,193 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:31:20,344 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:31:20,346 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:31:20,346 INFO: Scheduler started
2025-11-15 22:31:20,346 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:31:20,347 INFO: === PIPELINE START ===
2025-11-15 22:31:21,056 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:31:21,061 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:31:21,065 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:31:21,066 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:31:21,066 INFO: Fetch สำเร็จ
2025-11-15 22:31:21,067 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:31:21,068 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:31:21,070 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:31:21,072 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:31:21,072 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:31:21,072 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:31:20.342781+07:00)
2025-11-15 22:31:21,072 INFO: === PIPELINE START ===
2025-11-15 22:31:21,746 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:31:21,752 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:31:21,756 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:31:21,757 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:31:21,757 INFO: Fetch สำเร็จ
2025-11-15 22:31:21,759 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:31:21,759 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:31:21,762 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:31:21,763 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:31:21,763 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:31:21,763 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:32:46,631 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:32:46,633 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:32:46,633 INFO: Scheduler started
2025-11-15 22:32:46,633 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:32:46,633 INFO: === PIPELINE START ===
2025-11-15 22:32:47,359 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:32:47,374 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:32:47,375 INFO: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-15 22:32:47,385 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:32:47,385 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:32:47,386 INFO: Fetch สำเร็จ
2025-11-15 22:32:47,386 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:32:47,388 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:32:47,391 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:32:47,392 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:32:47,392 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:32:47,393 INFO: Running job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" (scheduled at 2025-11-15 22:32:46.629310+07:00)
2025-11-15 22:32:47,393 INFO: === PIPELINE START ===
2025-11-15 22:32:48,108 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:32:48,113 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:32:48,116 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:32:48,116 INFO: สำเร็จ: เพิ่ม 0 แถว
2025-11-15 22:32:48,116 INFO: Fetch สำเร็จ
2025-11-15 22:32:48,117 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 3 แถว
2025-11-15 22:32:48,118 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:32:48,120 INFO: รวมเก่า 3 + ใหม่ 3 → 3 (เพิ่ม 0)
2025-11-15 22:32:48,121 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:32:48,121 INFO: ไม่มีข้อมูลใหม่ใน format
2025-11-15 22:32:48,121 INFO: Job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" executed successfully
2025-11-15 22:45:37,078 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:45:37,080 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:45:37,080 INFO: Scheduler started
2025-11-15 22:45:37,080 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:45:37,081 INFO: === PIPELINE START ===
2025-11-15 22:45:37,814 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:45:37,827 ERROR: ดึงข้อมูลล้มเหลว
Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 206, in main
    added = append_to_master_no_dup(df_new)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 102, in append_to_master_no_dup
    df_master = pd.read_csv(master_file, dtype=str, encoding="utf-8-sig")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file
2025-11-15 22:45:37,852 ERROR: Error running job run_pipeline
Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 206, in main
    added = append_to_master_no_dup(df_new)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 102, in append_to_master_no_dup
    df_master = pd.read_csv(master_file, dtype=str, encoding="utf-8-sig")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 216, in main
    sys.exit(1)
SystemExit: 1

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\asyncio.py", line 35, in callback
    events = f.result()
             ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 161, in run_coroutine_job
    async def run_coroutine_job(job, jobstore_alias, run_times, logger_name):
asyncio.exceptions.CancelledError
2025-11-15 22:45:37,877 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:22> exception=SystemExit(1)>
Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 206, in main
    added = append_to_master_no_dup(df_new)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 102, in append_to_master_no_dup
    df_master = pd.read_csv(master_file, dtype=str, encoding="utf-8-sig")
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\readers.py", line 1898, in _make_engine
    return mapping[engine](f, **self.options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\pandas\io\parsers\c_parser_wrapper.py", line 93, in __init__
    self._reader = parsers.TextReader(src, **kwds)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/parsers.pyx", line 581, in pandas._libs.parsers.TextReader.__cinit__
pandas.errors.EmptyDataError: No columns to parse from file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 216, in main
    sys.exit(1)
SystemExit: 1
2025-11-15 22:48:38,832 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:48:38,834 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:48:38,834 INFO: Scheduler started
2025-11-15 22:48:38,834 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:48:38,834 INFO: === PIPELINE START ===
2025-11-15 22:48:39,577 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:48:39,581 WARNING: ไฟล์ data\staging\raw_airbkk.csv ว่าง → เขียนทับ
2025-11-15 22:48:39,584 INFO: สำเร็จ: เพิ่ม 2 แถว
2025-11-15 22:48:39,599 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 22:48:39,599 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 22:00:00+07:00 → 2025-11-15 22:00:00+07:00
2025-11-15 22:48:50,279 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:48:50,280 INFO: เติม 2025-11-13 22:00 → +0
2025-11-15 22:49:01,993 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:49:01,993 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 22:49:13,668 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:49:13,668 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 22:49:25,410 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:49:25,411 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 22:49:37,132 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:49:37,133 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 22:49:48,852 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:49:48,852 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 22:50:00,551 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:50:00,551 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 22:50:12,265 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:50:12,265 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 22:50:23,988 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:50:23,989 INFO: เติม 2025-11-14 06:00 → +0
2025-11-15 22:50:35,700 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:50:35,700 INFO: เติม 2025-11-14 07:00 → +0
2025-11-15 22:50:47,489 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:50:47,489 INFO: เติม 2025-11-14 08:00 → +0
2025-11-15 22:50:59,318 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:50:59,318 INFO: เติม 2025-11-14 09:00 → +0
2025-11-15 22:51:11,037 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:51:11,037 INFO: เติม 2025-11-14 10:00 → +0
2025-11-15 22:51:22,853 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:51:22,853 INFO: เติม 2025-11-14 11:00 → +0
2025-11-15 22:51:34,597 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:51:34,597 INFO: เติม 2025-11-14 12:00 → +0
2025-11-15 22:51:46,320 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:51:46,321 INFO: เติม 2025-11-14 13:00 → +0
2025-11-15 22:51:58,070 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:51:58,071 INFO: เติม 2025-11-14 14:00 → +0
2025-11-15 22:52:09,749 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:52:09,749 INFO: เติม 2025-11-14 15:00 → +0
2025-11-15 22:52:21,521 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:52:21,521 INFO: เติม 2025-11-14 16:00 → +0
2025-11-15 22:52:33,261 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:52:33,262 INFO: เติม 2025-11-14 17:00 → +0
2025-11-15 22:52:44,949 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:52:44,949 INFO: เติม 2025-11-14 18:00 → +0
2025-11-15 22:52:56,672 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:52:56,672 INFO: เติม 2025-11-14 19:00 → +0
2025-11-15 22:53:08,394 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:53:08,395 INFO: เติม 2025-11-14 20:00 → +0
2025-11-15 22:53:20,129 ERROR: ล็อกไฟล์ล้มเหลว - มี process อื่นรันอยู่
2025-11-15 22:53:20,130 INFO: เติม 2025-11-14 21:00 → +0
2025-11-15 22:53:49,827 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:53:49,828 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:53:49,829 INFO: Scheduler started
2025-11-15 22:53:49,829 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:53:49,829 INFO: === PIPELINE START ===
2025-11-15 22:53:50,552 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:53:50,564 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:53:50,564 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 22:53:50,567 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 22:53:50,567 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 22:00:00+07:00 → 2025-11-15 22:00:00+07:00
2025-11-15 22:53:51,267 INFO: เพิ่ม 2 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:53:51,268 INFO: เติม 2025-11-13 22:00 → +2
2025-11-15 22:53:52,999 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:53:52,999 INFO: เติม 2025-11-13 23:00 → +1
2025-11-15 22:53:54,719 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:53:54,719 INFO: เติม 2025-11-14 00:00 → +1
2025-11-15 22:53:56,404 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:53:56,404 INFO: เติม 2025-11-14 01:00 → +1
2025-11-15 22:53:58,120 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:53:58,121 INFO: เติม 2025-11-14 02:00 → +1
2025-11-15 22:53:59,827 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:53:59,828 INFO: เติม 2025-11-14 03:00 → +1
2025-11-15 22:54:01,522 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:01,522 INFO: เติม 2025-11-14 04:00 → +1
2025-11-15 22:54:03,263 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:03,264 INFO: เติม 2025-11-14 05:00 → +1
2025-11-15 22:54:04,958 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:04,958 INFO: เติม 2025-11-14 06:00 → +1
2025-11-15 22:54:06,658 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:06,658 INFO: เติม 2025-11-14 07:00 → +1
2025-11-15 22:54:08,388 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:08,388 INFO: เติม 2025-11-14 08:00 → +1
2025-11-15 22:54:10,094 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:10,094 INFO: เติม 2025-11-14 09:00 → +1
2025-11-15 22:54:11,777 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:11,778 INFO: เติม 2025-11-14 10:00 → +1
2025-11-15 22:54:13,540 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:13,540 INFO: เติม 2025-11-14 11:00 → +1
2025-11-15 22:54:15,225 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:15,226 INFO: เติม 2025-11-14 12:00 → +1
2025-11-15 22:54:16,911 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:16,912 INFO: เติม 2025-11-14 13:00 → +1
2025-11-15 22:54:18,580 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:18,580 INFO: เติม 2025-11-14 14:00 → +1
2025-11-15 22:54:20,266 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:20,266 INFO: เติม 2025-11-14 15:00 → +1
2025-11-15 22:54:21,979 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:21,980 INFO: เติม 2025-11-14 16:00 → +1
2025-11-15 22:54:23,680 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:23,680 INFO: เติม 2025-11-14 17:00 → +1
2025-11-15 22:54:25,394 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:25,395 INFO: เติม 2025-11-14 18:00 → +1
2025-11-15 22:54:27,089 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:27,090 INFO: เติม 2025-11-14 19:00 → +1
2025-11-15 22:54:28,785 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:28,785 INFO: เติม 2025-11-14 20:00 → +1
2025-11-15 22:54:30,508 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:30,508 INFO: เติม 2025-11-14 21:00 → +1
2025-11-15 22:54:32,259 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:32,260 INFO: เติม 2025-11-14 22:00 → +1
2025-11-15 22:54:33,960 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:33,960 INFO: เติม 2025-11-14 23:00 → +1
2025-11-15 22:54:35,691 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:35,691 INFO: เติม 2025-11-15 00:00 → +1
2025-11-15 22:54:37,384 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:37,386 INFO: เติม 2025-11-15 01:00 → +1
2025-11-15 22:54:39,073 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:39,073 INFO: เติม 2025-11-15 02:00 → +1
2025-11-15 22:54:40,756 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:40,756 INFO: เติม 2025-11-15 03:00 → +1
2025-11-15 22:54:42,461 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:42,462 INFO: เติม 2025-11-15 04:00 → +1
2025-11-15 22:54:44,152 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:44,153 INFO: เติม 2025-11-15 05:00 → +1
2025-11-15 22:54:45,843 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:45,844 INFO: เติม 2025-11-15 06:00 → +1
2025-11-15 22:54:47,524 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:47,524 INFO: เติม 2025-11-15 07:00 → +1
2025-11-15 22:54:49,257 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:49,258 INFO: เติม 2025-11-15 08:00 → +1
2025-11-15 22:54:50,941 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:50,942 INFO: เติม 2025-11-15 09:00 → +1
2025-11-15 22:54:52,708 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:52,709 INFO: เติม 2025-11-15 10:00 → +1
2025-11-15 22:54:54,418 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:54,419 INFO: เติม 2025-11-15 11:00 → +1
2025-11-15 22:54:56,164 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:56,164 INFO: เติม 2025-11-15 12:00 → +1
2025-11-15 22:54:57,905 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:57,906 INFO: เติม 2025-11-15 13:00 → +1
2025-11-15 22:54:59,646 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:54:59,646 INFO: เติม 2025-11-15 14:00 → +1
2025-11-15 22:55:01,375 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:55:01,376 INFO: เติม 2025-11-15 15:00 → +1
2025-11-15 22:55:03,104 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:55:03,105 INFO: เติม 2025-11-15 16:00 → +1
2025-11-15 22:55:05,468 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:55:05,469 INFO: เติม 2025-11-15 17:00 → +1
2025-11-15 22:55:07,201 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:55:07,202 INFO: เติม 2025-11-15 18:00 → +1
2025-11-15 22:55:08,948 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 22:55:08,948 INFO: เติม 2025-11-15 19:00 → +1
2025-11-15 22:55:10,678 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:55:10,679 INFO: เติม 2025-11-15 20:00 → +0
2025-11-15 22:55:12,546 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:55:12,546 INFO: เติม 2025-11-15 21:00 → +0
2025-11-15 22:55:13,547 INFO: เติมข้อมูลย้อนหลังเสร็จ: +47 แถว
2025-11-15 22:55:13,547 INFO: Fetch สำเร็จ
2025-11-15 22:55:13,549 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 49 แถว
2025-11-15 22:55:13,550 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 22:55:13,550 INFO: สร้างไฟล์ formatted ใหม่
2025-11-15 22:55:13,552 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 22:55:13,552 INFO: Format สำเร็จ: เพิ่ม 49 แถว
2025-11-15 22:55:13,567 INFO: เริ่ม clean ข้อมูล: 49 แถว
2025-11-15 22:55:13,578 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (49 แถว)
2025-11-15 22:55:13,583 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-15 22:00:00          53.0           22.0       0.4 162.5       27.8    45.2     1014.5
2025-11-15 21:00:00          52.4           16.9       0.3 134.5       27.7    43.7     1014.2
2025-11-15 20:00:00          44.1           13.4       0.4 135.4       28.3    41.2     1013.5
2025-11-15 19:00:00          45.4           16.8       0.5 168.3       29.2    36.9     1012.7
2025-11-15 18:00:00          37.2           14.4       1.0 177.0       29.9    33.7     1012.1
2025-11-15 17:00:00          40.1            9.8       1.0 179.4       30.6    31.5     1011.5
2025-11-15 16:00:00          42.3           12.0       1.5 186.1       31.0    30.5     1011.5
2025-11-15 15:00:00          47.1           12.4       1.1 171.7       31.4    29.0     1011.8
2025-11-15 14:00:00          48.2           17.8       1.3 155.1       30.9    32.3     1012.5
2025-11-15 13:00:00          50.7           16.0       0.9 133.9       30.1    38.0     1013.5
2025-11-15 22:55:13,583 INFO: Clean สำเร็จ
2025-11-15 22:55:13,611 INFO: เตรียมโหลด 49 แถว
2025-11-15 22:55:13,617 WARNING: Run time of job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" was missed by 0:01:23.793007
2025-11-15 22:55:13,725 ERROR: Load ล้มเหลว: [WinError 1314] A required privilege is not held by the client: '2025-11-15.csv' -> 'data\\backups\\latest.csv'
2025-11-15 22:58:09,676 INFO: หยุดด้วย Ctrl+C
2025-11-15 22:58:10,827 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:58:10,829 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:58:10,829 INFO: Scheduler started
2025-11-15 22:58:10,829 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:58:10,830 INFO: === PIPELINE START ===
2025-11-15 22:58:11,525 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:58:11,531 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:11,531 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 22:58:11,535 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 22:58:11,535 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 22:00:00+07:00 → 2025-11-15 22:00:00+07:00
2025-11-15 22:58:12,252 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:12,252 INFO: เติม 2025-11-13 22:00 → +0
2025-11-15 22:58:13,976 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:13,977 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 22:58:15,854 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:15,855 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 22:58:17,594 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:17,594 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 22:58:19,334 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:19,334 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 22:58:21,052 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:21,053 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 22:58:22,812 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:22,813 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 22:58:24,508 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:24,509 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 22:58:26,204 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:26,205 INFO: เติม 2025-11-14 06:00 → +0
2025-11-15 22:58:27,937 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:27,938 INFO: เติม 2025-11-14 07:00 → +0
2025-11-15 22:58:29,412 INFO: หยุดด้วย Ctrl+C
2025-11-15 22:58:29,470 ERROR: Error running job run_pipeline
Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in send
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in <listcomp>
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 265, in resolve_redirects
    resp = self.send(
           ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 565, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1378, in getresponse
    response.begin()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1311, in recv_into
    return self.read(nbytes, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1167, in read
    return self._sslobj.read(len, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\asyncio.py", line 35, in callback
    events = f.result()
             ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 161, in run_coroutine_job
    async def run_coroutine_job(job, jobstore_alias, run_times, logger_name):
asyncio.exceptions.CancelledError
2025-11-15 22:58:29,501 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:22> exception=SystemExit(0)>
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in send
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in <listcomp>
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 265, in resolve_redirects
    resp = self.send(
           ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 565, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1378, in getresponse
    response.begin()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1311, in recv_into
    return self.read(nbytes, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1167, in read
    return self._sslobj.read(len, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0
2025-11-15 22:58:30,701 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:58:30,703 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:58:30,703 INFO: Scheduler started
2025-11-15 22:58:30,703 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:58:30,703 INFO: === PIPELINE START ===
2025-11-15 22:58:31,397 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:58:31,404 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:31,404 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 22:58:31,407 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 22:58:31,407 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 22:00:00+07:00 → 2025-11-15 22:00:00+07:00
2025-11-15 22:58:32,146 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:32,147 INFO: เติม 2025-11-13 22:00 → +0
2025-11-15 22:58:33,869 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:33,870 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 22:58:35,598 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:35,599 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 22:58:35,683 INFO: หยุดด้วย Ctrl+C
2025-11-15 22:58:35,695 ERROR: Error running job run_pipeline
Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 224, in fill_missing_hours
    time.sleep(1)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\asyncio.py", line 35, in callback
    events = f.result()
             ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 161, in run_coroutine_job
    async def run_coroutine_job(job, jobstore_alias, run_times, logger_name):
asyncio.exceptions.CancelledError
2025-11-15 22:58:35,725 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:22> exception=SystemExit(0)>
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 224, in fill_missing_hours
    time.sleep(1)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0
2025-11-15 22:58:36,833 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 22:58:36,834 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 22:58:36,835 INFO: Scheduler started
2025-11-15 22:58:36,835 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 22:58:36,835 INFO: === PIPELINE START ===
2025-11-15 22:58:37,513 INFO: ดึง 2025-11-15 21:00:00+07:00 - 2025-11-15 22:00:00+07:00 → 2 แถว
2025-11-15 22:58:37,521 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:37,522 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 22:58:37,525 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 22:58:37,525 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 22:00:00+07:00 → 2025-11-15 22:00:00+07:00
2025-11-15 22:58:38,247 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:38,247 INFO: เติม 2025-11-13 22:00 → +0
2025-11-15 22:58:39,971 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:39,971 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 22:58:41,691 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:41,691 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 22:58:43,450 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:43,451 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 22:58:45,180 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:45,181 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 22:58:46,929 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:46,929 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 22:58:48,641 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:48,641 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 22:58:50,367 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:50,367 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 22:58:52,145 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:52,145 INFO: เติม 2025-11-14 06:00 → +0
2025-11-15 22:58:53,854 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:53,855 INFO: เติม 2025-11-14 07:00 → +0
2025-11-15 22:58:55,551 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:55,552 INFO: เติม 2025-11-14 08:00 → +0
2025-11-15 22:58:57,264 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:57,264 INFO: เติม 2025-11-14 09:00 → +0
2025-11-15 22:58:58,958 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:58:58,958 INFO: เติม 2025-11-14 10:00 → +0
2025-11-15 22:59:00,664 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:00,664 INFO: เติม 2025-11-14 11:00 → +0
2025-11-15 22:59:02,376 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:02,376 INFO: เติม 2025-11-14 12:00 → +0
2025-11-15 22:59:04,075 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:04,076 INFO: เติม 2025-11-14 13:00 → +0
2025-11-15 22:59:05,804 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:05,805 INFO: เติม 2025-11-14 14:00 → +0
2025-11-15 22:59:07,476 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:07,477 INFO: เติม 2025-11-14 15:00 → +0
2025-11-15 22:59:09,190 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:09,190 INFO: เติม 2025-11-14 16:00 → +0
2025-11-15 22:59:10,887 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:10,888 INFO: เติม 2025-11-14 17:00 → +0
2025-11-15 22:59:12,625 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:12,625 INFO: เติม 2025-11-14 18:00 → +0
2025-11-15 22:59:14,415 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:14,415 INFO: เติม 2025-11-14 19:00 → +0
2025-11-15 22:59:16,111 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:16,111 INFO: เติม 2025-11-14 20:00 → +0
2025-11-15 22:59:17,797 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:17,797 INFO: เติม 2025-11-14 21:00 → +0
2025-11-15 22:59:19,504 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:19,504 INFO: เติม 2025-11-14 22:00 → +0
2025-11-15 22:59:21,193 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:21,193 INFO: เติม 2025-11-14 23:00 → +0
2025-11-15 22:59:22,879 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:22,880 INFO: เติม 2025-11-15 00:00 → +0
2025-11-15 22:59:24,689 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:24,690 INFO: เติม 2025-11-15 01:00 → +0
2025-11-15 22:59:26,440 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:26,440 INFO: เติม 2025-11-15 02:00 → +0
2025-11-15 22:59:28,630 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:28,631 INFO: เติม 2025-11-15 03:00 → +0
2025-11-15 22:59:30,405 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:30,405 INFO: เติม 2025-11-15 04:00 → +0
2025-11-15 22:59:32,127 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:32,128 INFO: เติม 2025-11-15 05:00 → +0
2025-11-15 22:59:33,915 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:33,916 INFO: เติม 2025-11-15 06:00 → +0
2025-11-15 22:59:35,724 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:35,725 INFO: เติม 2025-11-15 07:00 → +0
2025-11-15 22:59:37,462 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:37,463 INFO: เติม 2025-11-15 08:00 → +0
2025-11-15 22:59:39,161 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:39,161 INFO: เติม 2025-11-15 09:00 → +0
2025-11-15 22:59:40,948 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:40,948 INFO: เติม 2025-11-15 10:00 → +0
2025-11-15 22:59:42,667 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:42,669 INFO: เติม 2025-11-15 11:00 → +0
2025-11-15 22:59:44,559 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:44,560 INFO: เติม 2025-11-15 12:00 → +0
2025-11-15 22:59:46,489 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:46,489 INFO: เติม 2025-11-15 13:00 → +0
2025-11-15 22:59:48,223 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:48,223 INFO: เติม 2025-11-15 14:00 → +0
2025-11-15 22:59:49,924 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:49,924 INFO: เติม 2025-11-15 15:00 → +0
2025-11-15 22:59:51,635 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:51,636 INFO: เติม 2025-11-15 16:00 → +0
2025-11-15 22:59:53,339 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:53,340 INFO: เติม 2025-11-15 17:00 → +0
2025-11-15 22:59:55,071 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:55,071 INFO: เติม 2025-11-15 18:00 → +0
2025-11-15 22:59:56,790 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:56,797 INFO: เติม 2025-11-15 19:00 → +0
2025-11-15 22:59:58,588 INFO: ไม่มีข้อมูลใหม่
2025-11-15 22:59:58,589 INFO: เติม 2025-11-15 20:00 → +0
2025-11-15 23:00:00,290 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:00,290 INFO: เติม 2025-11-15 21:00 → +0
2025-11-15 23:00:01,296 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-15 23:00:01,296 INFO: Fetch สำเร็จ
2025-11-15 23:00:01,300 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:00:01,301 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:00:02,001 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:02,002 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 23:00:03,685 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:03,686 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 23:00:05,415 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:05,417 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 23:00:07,155 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:07,156 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 23:00:08,875 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:08,875 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 23:00:10,605 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:10,605 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 23:00:12,368 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:12,368 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 23:00:14,082 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:14,083 INFO: เติม 2025-11-14 06:00 → +0
2025-11-15 23:00:15,782 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:15,783 INFO: เติม 2025-11-14 07:00 → +0
2025-11-15 23:00:17,493 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:17,494 INFO: เติม 2025-11-14 08:00 → +0
2025-11-15 23:00:19,234 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:19,234 INFO: เติม 2025-11-14 09:00 → +0
2025-11-15 23:00:20,967 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:20,967 INFO: เติม 2025-11-14 10:00 → +0
2025-11-15 23:00:22,744 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:22,744 INFO: เติม 2025-11-14 11:00 → +0
2025-11-15 23:00:24,446 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:24,446 INFO: เติม 2025-11-14 12:00 → +0
2025-11-15 23:00:26,220 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:26,221 INFO: เติม 2025-11-14 13:00 → +0
2025-11-15 23:00:27,934 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:27,935 INFO: เติม 2025-11-14 14:00 → +0
2025-11-15 23:00:29,657 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:29,657 INFO: เติม 2025-11-14 15:00 → +0
2025-11-15 23:00:31,409 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:31,409 INFO: เติม 2025-11-14 16:00 → +0
2025-11-15 23:00:33,161 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:33,161 INFO: เติม 2025-11-14 17:00 → +0
2025-11-15 23:00:34,967 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:34,967 INFO: เติม 2025-11-14 18:00 → +0
2025-11-15 23:00:36,679 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:36,679 INFO: เติม 2025-11-14 19:00 → +0
2025-11-15 23:00:38,419 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:38,419 INFO: เติม 2025-11-14 20:00 → +0
2025-11-15 23:00:40,130 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:40,131 INFO: เติม 2025-11-14 21:00 → +0
2025-11-15 23:00:41,875 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:41,875 INFO: เติม 2025-11-14 22:00 → +0
2025-11-15 23:00:43,605 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:43,605 INFO: เติม 2025-11-14 23:00 → +0
2025-11-15 23:00:45,326 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:45,326 INFO: เติม 2025-11-15 00:00 → +0
2025-11-15 23:00:47,094 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:47,094 INFO: เติม 2025-11-15 01:00 → +0
2025-11-15 23:00:48,906 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:48,907 INFO: เติม 2025-11-15 02:00 → +0
2025-11-15 23:00:50,621 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:50,621 INFO: เติม 2025-11-15 03:00 → +0
2025-11-15 23:00:52,380 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:52,380 INFO: เติม 2025-11-15 04:00 → +0
2025-11-15 23:00:54,145 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:54,145 INFO: เติม 2025-11-15 05:00 → +0
2025-11-15 23:00:55,840 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:55,842 INFO: เติม 2025-11-15 06:00 → +0
2025-11-15 23:00:57,571 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:57,571 INFO: เติม 2025-11-15 07:00 → +0
2025-11-15 23:00:59,271 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:00:59,271 INFO: เติม 2025-11-15 08:00 → +0
2025-11-15 23:01:00,977 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:00,977 INFO: เติม 2025-11-15 09:00 → +0
2025-11-15 23:01:02,694 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:02,694 INFO: เติม 2025-11-15 10:00 → +0
2025-11-15 23:01:04,440 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:04,440 INFO: เติม 2025-11-15 11:00 → +0
2025-11-15 23:01:06,228 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:06,229 INFO: เติม 2025-11-15 12:00 → +0
2025-11-15 23:01:07,930 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:07,931 INFO: เติม 2025-11-15 13:00 → +0
2025-11-15 23:01:09,637 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:09,637 INFO: เติม 2025-11-15 14:00 → +0
2025-11-15 23:01:11,350 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:11,351 INFO: เติม 2025-11-15 15:00 → +0
2025-11-15 23:01:13,058 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:13,058 INFO: เติม 2025-11-15 16:00 → +0
2025-11-15 23:01:14,778 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:14,778 INFO: เติม 2025-11-15 17:00 → +0
2025-11-15 23:01:16,500 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:16,500 INFO: เติม 2025-11-15 18:00 → +0
2025-11-15 23:01:18,213 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:18,214 INFO: เติม 2025-11-15 19:00 → +0
2025-11-15 23:01:19,948 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:19,948 INFO: เติม 2025-11-15 20:00 → +0
2025-11-15 23:01:21,661 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:01:21,662 INFO: เติม 2025-11-15 21:00 → +0
2025-11-15 23:01:23,380 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-15 23:01:23,381 INFO: เติม 2025-11-15 22:00 → +1
2025-11-15 23:01:24,381 INFO: เติมข้อมูลย้อนหลังเสร็จ: +1 แถว
2025-11-15 23:01:24,381 INFO: เติมข้อมูลย้อนหลัง: +1 แถว
2025-11-15 23:01:24,385 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 50 แถว
2025-11-15 23:01:24,387 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-15 23:01:24,390 INFO: รวมเก่า 49 + ใหม่ 50 → 50 (เพิ่ม 1)
2025-11-15 23:01:24,391 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-15 23:01:24,391 INFO: Format สำเร็จ: เพิ่ม 1 แถว
2025-11-15 23:01:24,403 INFO: เริ่ม clean ข้อมูล: 50 แถว
2025-11-15 23:01:24,414 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (50 แถว)
2025-11-15 23:01:24,418 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-15 23:00:00          56.7           22.0       0.5 180.5       27.4    48.0     1014.7
2025-11-15 22:00:00          53.0           22.0       0.4 162.5       27.8    45.2     1014.5
2025-11-15 21:00:00          52.4           16.9       0.3 134.5       27.7    43.7     1014.2
2025-11-15 20:00:00          44.1           13.4       0.4 135.4       28.3    41.2     1013.5
2025-11-15 19:00:00          45.4           16.8       0.5 168.3       29.2    36.9     1012.7
2025-11-15 18:00:00          37.2           14.4       1.0 177.0       29.9    33.7     1012.1
2025-11-15 17:00:00          40.1            9.8       1.0 179.4       30.6    31.5     1011.5
2025-11-15 16:00:00          42.3           12.0       1.5 186.1       31.0    30.5     1011.5
2025-11-15 15:00:00          47.1           12.4       1.1 171.7       31.4    29.0     1011.8
2025-11-15 14:00:00          48.2           17.8       1.3 155.1       30.9    32.3     1012.5
2025-11-15 23:01:24,419 INFO: Clean สำเร็จ
2025-11-15 23:01:24,445 INFO: เตรียมโหลด 50 แถว
2025-11-15 23:01:24,450 WARNING: Run time of job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-15 23:05:00 +07)" was missed by 0:02:47.619987
2025-11-15 23:01:24,543 ERROR: Load ล้มเหลว: [WinError 1314] A required privilege is not held by the client: '2025-11-15.csv' -> 'data\\backups\\latest.csv'
2025-11-15 23:03:35,225 INFO: หยุดด้วย Ctrl+C
2025-11-15 23:03:36,444 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:03:36,446 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:03:36,447 INFO: Scheduler started
2025-11-15 23:03:36,447 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:03:36,447 INFO: === PIPELINE START ===
2025-11-15 23:03:37,218 INFO: ดึง 2025-11-15 22:00:00+07:00 - 2025-11-15 23:00:00+07:00 → 2 แถว
2025-11-15 23:03:37,224 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:37,224 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 23:03:37,227 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:03:37,228 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:03:37,974 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:37,974 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 23:03:39,680 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:39,681 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 23:03:41,378 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:41,378 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 23:03:43,083 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:43,084 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 23:03:44,769 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:44,770 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 23:03:46,487 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:46,488 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 23:03:48,219 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:48,220 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 23:03:49,456 INFO: หยุดด้วย Ctrl+C
2025-11-15 23:03:49,469 ERROR: Error running job run_pipeline
Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
               ^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\util\ssl_.py", line 458, in ssl_wrap_socket
    context.load_verify_locations(ca_certs, ca_cert_dir, ca_cert_data)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\asyncio.py", line 35, in callback
    events = f.result()
             ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 161, in run_coroutine_job
    async def run_coroutine_job(job, jobstore_alias, run_times, logger_name):
asyncio.exceptions.CancelledError
2025-11-15 23:03:49,498 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:22> exception=SystemExit(0)>
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
               ^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\util\ssl_.py", line 458, in ssl_wrap_socket
    context.load_verify_locations(ca_certs, ca_cert_dir, ca_cert_data)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0
2025-11-15 23:03:55,713 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:03:55,715 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:03:55,715 INFO: Scheduler started
2025-11-15 23:03:55,715 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:03:55,716 INFO: === PIPELINE START ===
2025-11-15 23:03:56,413 INFO: ดึง 2025-11-15 22:00:00+07:00 - 2025-11-15 23:00:00+07:00 → 2 แถว
2025-11-15 23:03:56,422 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:03:56,422 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 23:03:56,427 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:03:56,427 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:03:56,653 INFO: หยุดด้วย Ctrl+C
2025-11-15 23:03:56,665 ERROR: Error running job run_pipeline
Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
               ^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\util\ssl_.py", line 458, in ssl_wrap_socket
    context.load_verify_locations(ca_certs, ca_cert_dir, ca_cert_data)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\asyncio.py", line 35, in callback
    events = f.result()
             ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 161, in run_coroutine_job
    async def run_coroutine_job(job, jobstore_alias, run_times, logger_name):
asyncio.exceptions.CancelledError
2025-11-15 23:03:56,689 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:22> exception=SystemExit(0)>
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 27, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in main
    fill_missing_hours(lookback_hours=48)
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 790, in connect
    sock_and_verified = _ssl_wrap_socket_and_match_hostname(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 969, in _ssl_wrap_socket_and_match_hostname
    ssl_sock = ssl_wrap_socket(
               ^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\util\ssl_.py", line 458, in ssl_wrap_socket
    context.load_verify_locations(ca_certs, ca_cert_dir, ca_cert_data)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0
2025-11-15 23:04:00,552 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:04:00,554 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:04:00,554 INFO: Scheduler started
2025-11-15 23:04:00,555 INFO: Pipeline scheduler started (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:04:00,555 INFO: === PIPELINE START ===
2025-11-15 23:04:01,275 INFO: ดึง 2025-11-15 22:00:00+07:00 - 2025-11-15 23:00:00+07:00 → 2 แถว
2025-11-15 23:04:01,280 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:01,281 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 23:04:01,285 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:04:01,285 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:04:01,985 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:01,986 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 23:04:03,665 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:03,665 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 23:04:05,349 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:05,350 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 23:04:07,055 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:07,056 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 23:04:08,765 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:08,765 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 23:04:10,646 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:10,646 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 23:04:12,339 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:12,340 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 23:04:14,065 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:14,065 INFO: เติม 2025-11-14 06:00 → +0
2025-11-15 23:04:15,797 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:15,797 INFO: เติม 2025-11-14 07:00 → +0
2025-11-15 23:04:17,621 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:17,622 INFO: เติม 2025-11-14 08:00 → +0
2025-11-15 23:04:19,359 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:19,360 INFO: เติม 2025-11-14 09:00 → +0
2025-11-15 23:04:21,100 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:21,101 INFO: เติม 2025-11-14 10:00 → +0
2025-11-15 23:04:22,837 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:22,838 INFO: เติม 2025-11-14 11:00 → +0
2025-11-15 23:04:24,552 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:24,552 INFO: เติม 2025-11-14 12:00 → +0
2025-11-15 23:04:26,263 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:26,263 INFO: เติม 2025-11-14 13:00 → +0
2025-11-15 23:04:27,991 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:27,991 INFO: เติม 2025-11-14 14:00 → +0
2025-11-15 23:04:29,723 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:29,724 INFO: เติม 2025-11-14 15:00 → +0
2025-11-15 23:04:31,425 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:31,425 INFO: เติม 2025-11-14 16:00 → +0
2025-11-15 23:04:33,114 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:33,114 INFO: เติม 2025-11-14 17:00 → +0
2025-11-15 23:04:34,838 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:34,839 INFO: เติม 2025-11-14 18:00 → +0
2025-11-15 23:04:36,518 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:36,518 INFO: เติม 2025-11-14 19:00 → +0
2025-11-15 23:04:38,212 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:38,212 INFO: เติม 2025-11-14 20:00 → +0
2025-11-15 23:04:39,907 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:39,908 INFO: เติม 2025-11-14 21:00 → +0
2025-11-15 23:04:41,600 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:41,601 INFO: เติม 2025-11-14 22:00 → +0
2025-11-15 23:04:43,584 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:43,584 INFO: เติม 2025-11-14 23:00 → +0
2025-11-15 23:04:45,337 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:45,337 INFO: เติม 2025-11-15 00:00 → +0
2025-11-15 23:04:47,121 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:47,122 INFO: เติม 2025-11-15 01:00 → +0
2025-11-15 23:04:48,963 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:48,963 INFO: เติม 2025-11-15 02:00 → +0
2025-11-15 23:04:50,711 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:50,712 INFO: เติม 2025-11-15 03:00 → +0
2025-11-15 23:04:52,465 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:52,466 INFO: เติม 2025-11-15 04:00 → +0
2025-11-15 23:04:54,239 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:54,241 INFO: เติม 2025-11-15 05:00 → +0
2025-11-15 23:04:55,935 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:55,936 INFO: เติม 2025-11-15 06:00 → +0
2025-11-15 23:04:57,615 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:57,617 INFO: เติม 2025-11-15 07:00 → +0
2025-11-15 23:04:59,343 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:04:59,344 INFO: เติม 2025-11-15 08:00 → +0
2025-11-15 23:05:01,092 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:01,092 INFO: เติม 2025-11-15 09:00 → +0
2025-11-15 23:05:02,909 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:02,909 INFO: เติม 2025-11-15 10:00 → +0
2025-11-15 23:05:04,892 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:04,894 INFO: เติม 2025-11-15 11:00 → +0
2025-11-15 23:05:06,832 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:06,832 INFO: เติม 2025-11-15 12:00 → +0
2025-11-15 23:05:08,919 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:08,920 INFO: เติม 2025-11-15 13:00 → +0
2025-11-15 23:05:11,253 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:11,253 INFO: เติม 2025-11-15 14:00 → +0
2025-11-15 23:05:13,009 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:13,009 INFO: เติม 2025-11-15 15:00 → +0
2025-11-15 23:05:15,313 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:15,314 INFO: เติม 2025-11-15 16:00 → +0
2025-11-15 23:05:17,455 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:17,456 INFO: เติม 2025-11-15 17:00 → +0
2025-11-15 23:05:19,900 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:19,900 INFO: เติม 2025-11-15 18:00 → +0
2025-11-15 23:05:22,484 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:22,485 INFO: เติม 2025-11-15 19:00 → +0
2025-11-15 23:05:25,042 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:25,043 INFO: เติม 2025-11-15 20:00 → +0
2025-11-15 23:05:27,383 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:27,383 INFO: เติม 2025-11-15 21:00 → +0
2025-11-15 23:05:29,847 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:29,847 INFO: เติม 2025-11-15 22:00 → +0
2025-11-15 23:05:30,848 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-15 23:05:30,848 INFO: Fetch สำเร็จ
2025-11-15 23:05:30,852 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:05:30,852 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:05:32,220 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:32,221 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 23:05:35,404 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:35,405 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 23:05:40,992 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:40,993 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 23:05:43,149 INFO: หยุดด้วย Ctrl+C
2025-11-15 23:05:43,177 ERROR: Error running job run_pipeline
Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 30, in run_pipeline
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in send
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in <listcomp>
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 265, in resolve_redirects
    resp = self.send(
           ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 565, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1378, in getresponse
    response.begin()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1311, in recv_into
    return self.read(nbytes, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1167, in read
    return self._sslobj.read(len, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\asyncio.py", line 35, in callback
    events = f.result()
             ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 161, in run_coroutine_job
    async def run_coroutine_job(job, jobstore_alias, run_times, logger_name):
asyncio.exceptions.CancelledError
2025-11-15 23:05:43,181 WARNING: Run time of job "run_pipeline (trigger: cron[minute='5'], next run at: 2025-11-16 00:05:00 +07)" was missed by 0:00:43.181800
2025-11-15 23:05:43,241 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:22> exception=SystemExit(0)>
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 30, in run_pipeline
  File "C:\Pm2_5\tasks\fetch_api.py", line 213, in fill_missing_hours
    arr, _, _ = fetch_api_data(start=current, end=next_hour)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 56, in fetch_api_data
    session.get("https://official.airbkk.com/airbkk/th/report", timeout=15)
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 602, in get
    return self.request("GET", url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in send
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 724, in <listcomp>
    history = [resp for resp in gen]
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 265, in resolve_redirects
    resp = self.send(
           ^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connectionpool.py", line 534, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\urllib3\connection.py", line 565, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1378, in getresponse
    response.begin()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 318, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1311, in recv_into
    return self.read(nbytes, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\ssl.py", line 1167, in read
    return self._sslobj.read(len, buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0
2025-11-15 23:05:46,351 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:05:46,355 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:05:46,355 INFO: Scheduler started
2025-11-15 23:05:46,355 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:05:46,355 INFO: === PIPELINE START ===
2025-11-15 23:05:48,049 INFO: ดึง 2025-11-15 22:00:00+07:00 - 2025-11-15 23:00:00+07:00 → 2 แถว
2025-11-15 23:05:48,059 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:48,060 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 23:05:48,068 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:05:48,068 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:05:49,895 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:49,895 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 23:05:52,674 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:52,674 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 23:05:55,133 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:55,134 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 23:05:57,722 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:05:57,723 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 23:06:01,062 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:01,062 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 23:06:03,325 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:03,327 INFO: เติม 2025-11-14 04:00 → +0
2025-11-15 23:06:06,780 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:06,781 INFO: เติม 2025-11-14 05:00 → +0
2025-11-15 23:06:09,351 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:09,352 INFO: เติม 2025-11-14 06:00 → +0
2025-11-15 23:06:11,910 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:11,911 INFO: เติม 2025-11-14 07:00 → +0
2025-11-15 23:06:13,859 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:13,859 INFO: เติม 2025-11-14 08:00 → +0
2025-11-15 23:06:16,115 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:16,116 INFO: เติม 2025-11-14 09:00 → +0
2025-11-15 23:06:18,851 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:18,851 INFO: เติม 2025-11-14 10:00 → +0
2025-11-15 23:06:21,760 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:21,761 INFO: เติม 2025-11-14 11:00 → +0
2025-11-15 23:06:23,865 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:23,865 INFO: เติม 2025-11-14 12:00 → +0
2025-11-15 23:06:26,225 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:26,226 INFO: เติม 2025-11-14 13:00 → +0
2025-11-15 23:06:28,174 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:28,174 INFO: เติม 2025-11-14 14:00 → +0
2025-11-15 23:06:30,411 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:30,412 INFO: เติม 2025-11-14 15:00 → +0
2025-11-15 23:06:32,413 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:32,414 INFO: เติม 2025-11-14 16:00 → +0
2025-11-15 23:06:34,385 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:34,386 INFO: เติม 2025-11-14 17:00 → +0
2025-11-15 23:06:36,614 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:36,614 INFO: เติม 2025-11-14 18:00 → +0
2025-11-15 23:06:38,760 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:38,761 INFO: เติม 2025-11-14 19:00 → +0
2025-11-15 23:06:40,725 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:40,725 INFO: เติม 2025-11-14 20:00 → +0
2025-11-15 23:06:42,866 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:42,867 INFO: เติม 2025-11-14 21:00 → +0
2025-11-15 23:06:45,073 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:45,073 INFO: เติม 2025-11-14 22:00 → +0
2025-11-15 23:06:46,929 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:46,930 INFO: เติม 2025-11-14 23:00 → +0
2025-11-15 23:06:48,782 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:48,782 INFO: เติม 2025-11-15 00:00 → +0
2025-11-15 23:06:50,756 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:50,757 INFO: เติม 2025-11-15 01:00 → +0
2025-11-15 23:06:52,934 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:52,935 INFO: เติม 2025-11-15 02:00 → +0
2025-11-15 23:06:54,685 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:54,685 INFO: เติม 2025-11-15 03:00 → +0
2025-11-15 23:06:56,570 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:56,570 INFO: เติม 2025-11-15 04:00 → +0
2025-11-15 23:06:58,388 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:06:58,388 INFO: เติม 2025-11-15 05:00 → +0
2025-11-15 23:07:00,523 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:00,524 INFO: เติม 2025-11-15 06:00 → +0
2025-11-15 23:07:02,243 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:02,244 INFO: เติม 2025-11-15 07:00 → +0
2025-11-15 23:07:04,039 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:04,039 INFO: เติม 2025-11-15 08:00 → +0
2025-11-15 23:07:05,773 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:05,773 INFO: เติม 2025-11-15 09:00 → +0
2025-11-15 23:07:07,458 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:07,458 INFO: เติม 2025-11-15 10:00 → +0
2025-11-15 23:07:09,187 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:09,188 INFO: เติม 2025-11-15 11:00 → +0
2025-11-15 23:07:10,893 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:10,893 INFO: เติม 2025-11-15 12:00 → +0
2025-11-15 23:07:12,632 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:12,633 INFO: เติม 2025-11-15 13:00 → +0
2025-11-15 23:07:14,389 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:14,389 INFO: เติม 2025-11-15 14:00 → +0
2025-11-15 23:07:16,232 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:16,232 INFO: เติม 2025-11-15 15:00 → +0
2025-11-15 23:07:17,949 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:17,949 INFO: เติม 2025-11-15 16:00 → +0
2025-11-15 23:07:19,656 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:19,656 INFO: เติม 2025-11-15 17:00 → +0
2025-11-15 23:07:21,375 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:21,375 INFO: เติม 2025-11-15 18:00 → +0
2025-11-15 23:07:23,068 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:23,069 INFO: เติม 2025-11-15 19:00 → +0
2025-11-15 23:07:24,832 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:24,832 INFO: เติม 2025-11-15 20:00 → +0
2025-11-15 23:07:26,547 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:26,548 INFO: เติม 2025-11-15 21:00 → +0
2025-11-15 23:07:28,304 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:28,304 INFO: เติม 2025-11-15 22:00 → +0
2025-11-15 23:07:29,305 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-15 23:07:29,305 INFO: Fetch สำเร็จ
2025-11-15 23:07:29,307 INFO: ไฟล์ว่าง → เติมข้อมูลใหม่
2025-11-15 23:07:29,307 INFO: เติมข้อมูลย้อนหลัง: 2025-11-13 23:00:00+07:00 → 2025-11-15 23:00:00+07:00
2025-11-15 23:07:30,021 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:30,021 INFO: เติม 2025-11-13 23:00 → +0
2025-11-15 23:07:31,787 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:31,788 INFO: เติม 2025-11-14 00:00 → +0
2025-11-15 23:07:33,629 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:33,630 INFO: เติม 2025-11-14 01:00 → +0
2025-11-15 23:07:35,451 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:35,451 INFO: เติม 2025-11-14 02:00 → +0
2025-11-15 23:07:37,183 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:07:37,184 INFO: เติม 2025-11-14 03:00 → +0
2025-11-15 23:07:37,489 INFO: หยุดด้วย Ctrl+C
2025-11-15 23:07:37,521 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:32> exception=SystemExit(0)>
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 314, in _bootstrap
    self.run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 640, in run_until_complete
    self.run_forever()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 607, in run_forever
    self._run_once()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 1922, in _run_once
    handle._run()
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Pm2_5\app\main.py", line 41, in run_pipeline
    added = fill_missing_hours(lookback_hours=48)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 224, in fill_missing_hours
    time.sleep(1)
  File "C:\Pm2_5\tasks\fetch_api.py", line 18, in signal_handler
    sys.exit(0)
SystemExit: 0
2025-11-15 23:22:29,297 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:22:29,299 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:22:29,299 INFO: Scheduler started
2025-11-15 23:22:29,299 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:22:29,299 INFO: === PIPELINE START ===
2025-11-15 23:22:29,299 ERROR: Fetch/Fill ล้มเหลว: 
2025-11-15 23:25:19,629 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:25:19,630 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:25:19,630 INFO: Scheduler started
2025-11-15 23:25:19,631 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:25:19,631 INFO: === PIPELINE START ===
2025-11-15 23:25:19,631 ERROR: Fetch/Fill ล้มเหลว: 
2025-11-15 23:30:12,122 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:30:12,123 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:30:12,123 INFO: Scheduler started
2025-11-15 23:30:12,124 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:30:12,124 INFO: === PIPELINE START ===
2025-11-15 23:30:12,124 ERROR: Fetch/Fill ล้มเหลว: NotImplementedError: 
2025-11-15 23:30:12,124 ERROR: Task exception was never retrieved
future: <Task finished name='Task-3' coro=<run_pipeline() done, defined at C:\Pm2_5\app\main.py:32> exception=NameError("name 'traceback' is not defined")>
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 39, in run_pipeline
    setup_signal_handlers()
  File "C:\Pm2_5\tasks\fetch_api.py", line 26, in setup_signal_handlers
    loop.add_signal_handler(sig, lambda: shutdown_event.set())
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 574, in add_signal_handler
    raise NotImplementedError
NotImplementedError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 51, in run_pipeline
    logging.error(f"Traceback:\n{traceback.format_exc()}")
                                 ^^^^^^^^^
NameError: name 'traceback' is not defined
2025-11-15 23:30:43,309 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:30:43,311 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:30:43,311 INFO: Scheduler started
2025-11-15 23:30:43,312 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:30:43,312 INFO: === PIPELINE START ===
2025-11-15 23:30:43,312 ERROR: Fetch/Fill ล้มเหลว: NotImplementedError: 
2025-11-15 23:30:43,314 ERROR: Traceback:
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 40, in run_pipeline
    setup_signal_handlers()
  File "C:\Pm2_5\tasks\fetch_api.py", line 26, in setup_signal_handlers
    loop.add_signal_handler(sig, lambda: shutdown_event.set())
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\events.py", line 574, in add_signal_handler
    raise NotImplementedError
NotImplementedError

2025-11-15 23:48:09,012 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-15 23:48:09,013 INFO: Added job "run_pipeline" to job store "default"
2025-11-15 23:48:09,014 INFO: Scheduler started
2025-11-15 23:48:09,014 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-15 23:48:09,014 INFO: === PIPELINE START ===
2025-11-15 23:48:09,014 INFO: ตั้งค่า signal handler สำเร็จ (Windows/Linux)
2025-11-15 23:48:09,014 INFO: ตั้งค่า signal handler สำเร็จ (Windows/Linux)
2025-11-15 23:48:10,243 INFO: ดึง 2025-11-15 22:00:00+07:00 - 2025-11-15 23:00:00+07:00 → 2 แถว
2025-11-15 23:48:10,249 INFO: ไม่มีข้อมูลใหม่
2025-11-15 23:48:10,249 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-15 23:48:10,249 ERROR: ดึงข้อมูลล้มเหลว
Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 262, in main
    asyncio.run(fill_missing_hours(lookback_hours=48))
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 186, in run
    raise RuntimeError(
RuntimeError: asyncio.run() cannot be called from a running event loop
2025-11-15 23:48:10,250 ERROR: Fetch/Fill ล้มเหลว: RuntimeError: asyncio.run() cannot be called from a running event loop
2025-11-15 23:48:10,250 ERROR: Traceback:
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 43, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 262, in main
    asyncio.run(fill_missing_hours(lookback_hours=48))
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 186, in run
    raise RuntimeError(
RuntimeError: asyncio.run() cannot be called from a running event loop

2025-11-15 23:55:22,306 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:58:57,980 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:00,372 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:01,459 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:01,567 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:01,785 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:01,893 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,002 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,220 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,328 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,437 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,546 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,764 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,872 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:02,980 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:03,199 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:03,308 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-15 23:59:03,416 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:05:00,014 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-16 01:05:00 +07)" (scheduled at 2025-11-16 00:05:00+07:00)
2025-11-16 00:05:00,016 INFO: === PIPELINE START ===
2025-11-16 00:05:00,016 INFO: ตั้งค่า signal handler สำเร็จ (Windows/Linux)
2025-11-16 00:05:00,016 INFO: ตั้งค่า signal handler สำเร็จ (Windows/Linux)
2025-11-16 00:05:01,125 INFO: ดึง 2025-11-15 23:00:00+07:00 - 2025-11-16 00:00:00+07:00 → 2 แถว
2025-11-16 00:05:01,133 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 00:05:01,133 INFO: สำเร็จ: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-16 00:05:01,133 ERROR: ดึงข้อมูลล้มเหลว
Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 262, in main
    # ห้าม asyncio.run() ที่นี่!
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 186, in run
    raise RuntimeError(
RuntimeError: asyncio.run() cannot be called from a running event loop
2025-11-16 00:05:01,148 ERROR: Fetch/Fill ล้มเหลว: RuntimeError: asyncio.run() cannot be called from a running event loop
2025-11-16 00:05:01,150 ERROR: Traceback:
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 43, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 262, in main
    # ห้าม asyncio.run() ที่นี่!
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 186, in run
    raise RuntimeError(
RuntimeError: asyncio.run() cannot be called from a running event loop

2025-11-16 00:05:01,151 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-16 01:05:00 +07)" executed successfully
2025-11-16 00:22:02,312 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:05,683 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:05,898 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:06,877 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:07,096 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:07,204 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:07,312 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:22:07,418 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:12,007 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:12,658 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:12,877 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:12,987 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,206 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,315 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,423 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,642 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,751 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,859 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:30:13,968 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:54,304 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:54,851 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:54,959 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:55,178 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:55,287 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:55,396 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:55,942 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:56,051 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:56,160 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:56,270 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:56,379 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:56,487 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:43:56,596 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:41,219 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:41,652 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:41,760 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:41,869 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:42,087 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:42,196 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:42,303 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:42,522 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:42,631 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,175 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,285 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,393 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,501 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,612 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,721 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,828 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:43,938 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:44,046 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:44,155 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:44,265 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:44,374 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:44,483 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 00:53:44,592 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:07:20,226 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:07:20,227 INFO: ตั้งค่า signal handler สำเร็จ (Windows/Linux)
2025-11-16 01:07:20,228 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:07:20,228 INFO: Scheduler started
2025-11-16 01:07:20,228 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:07:20,228 INFO: === PIPELINE START ===
2025-11-16 01:07:20,229 INFO: ตั้งค่า signal handler สำเร็จ (Windows/Linux)
2025-11-16 01:07:20,984 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:07:20,994 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 01:07:20,994 INFO: สำเร็จ: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-16 01:07:20,994 INFO: Fetch สำเร็จ
2025-11-16 01:07:21,018 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:07:21,739 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:21,740 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:07:23,457 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:23,458 INFO: เติม 2025-11-14 02:00 → +0
2025-11-16 01:07:25,166 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:25,166 INFO: เติม 2025-11-14 03:00 → +0
2025-11-16 01:07:26,927 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:26,927 INFO: เติม 2025-11-14 04:00 → +0
2025-11-16 01:07:28,678 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:28,678 INFO: เติม 2025-11-14 05:00 → +0
2025-11-16 01:07:30,396 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:30,396 INFO: เติม 2025-11-14 06:00 → +0
2025-11-16 01:07:32,095 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:32,096 INFO: เติม 2025-11-14 07:00 → +0
2025-11-16 01:07:33,906 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:07:33,911 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:07:33,911 INFO: เติม 2025-11-14 08:00 → +0
2025-11-16 01:07:33,911 INFO: หยุด fill_missing_hours เนื่องจาก Ctrl+C
2025-11-16 01:07:33,911 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-16 01:07:33,911 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-16 01:07:33,912 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 52 แถว
2025-11-16 01:07:33,913 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-16 01:07:33,915 INFO: รวมเก่า 50 + ใหม่ 52 → 52 (เพิ่ม 2)
2025-11-16 01:07:33,916 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-16 01:07:33,916 INFO: Format สำเร็จ: +2 แถว
2025-11-16 01:07:33,932 INFO: อ่าน formatted: 52 แถว
2025-11-16 01:07:33,932 INFO: เริ่ม clean ข้อมูล: 52 แถว
2025-11-16 01:07:33,942 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (52 แถว)
2025-11-16 01:07:33,945 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-16 01:00:00          49.5      22.500000       0.2  90.4       25.6    58.4     1013.9
2025-11-16 00:00:00          56.1      22.333333       0.3 172.8       26.7    51.8     1014.6
2025-11-15 23:00:00          56.7      22.166667       0.5 180.5       27.4    48.0     1014.7
2025-11-15 22:00:00          53.0      22.000000       0.4 162.5       27.8    45.2     1014.5
2025-11-15 21:00:00          52.4      16.900000       0.3 134.5       27.7    43.7     1014.2
2025-11-15 20:00:00          44.1      13.400000       0.4 135.4       28.3    41.2     1013.5
2025-11-15 19:00:00          45.4      16.800000       0.5 168.3       29.2    36.9     1012.7
2025-11-15 18:00:00          37.2      14.400000       1.0 177.0       29.9    33.7     1012.1
2025-11-15 17:00:00          40.1       9.800000       1.0 179.4       30.6    31.5     1011.5
2025-11-15 16:00:00          42.3      12.000000       1.5 186.1       31.0    30.5     1011.5
2025-11-16 01:07:33,946 INFO: Clean สำเร็จ: 52 แถว
2025-11-16 01:07:33,976 INFO: เตรียมโหลด 52 แถว
2025-11-16 01:07:34,084 INFO: โหลด DB สำเร็จ
2025-11-16 01:07:34,086 INFO: Backup สำเร็จ: data\backups\2025-11-16.csv
2025-11-16 01:07:34,088 INFO: อัพเดท latest.csv สำเร็จ
2025-11-16 01:07:34,088 INFO: Load to DB + Backup สำเร็จ
2025-11-16 01:07:34,088 INFO: === PIPELINE END ===
2025-11-16 01:07:54,975 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:08:01,069 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:10,914 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:11,569 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:11,672 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:11,895 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:11,999 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:12,108 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:12,327 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:12,429 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:12,536 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:12,749 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:16:12,857 INFO: ได้รับสัญญาณหยุด (Ctrl+C) → กำลังปิดอย่างสงบ...
2025-11-16 01:19:01,859 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:19:01,860 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:19:01,861 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:19:01,861 INFO: Scheduler started
2025-11-16 01:19:01,861 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:19:01,861 INFO: === PIPELINE START ===
2025-11-16 01:19:01,862 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:19:02,573 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:19:02,575 ERROR: ดึงข้อมูลล้มเหลว
Traceback (most recent call last):
  File "C:\Pm2_5\tasks\fetch_api.py", line 289, in main
    added = append_to_master_no_dup(df_new)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 125, in append_to_master_no_dup
    lock = FileLock(LOCK_FILE)
           ^^^^^^^^
NameError: name 'FileLock' is not defined
2025-11-16 01:19:02,575 ERROR: Fetch/Fill ล้มเหลว: NameError: name 'FileLock' is not defined
2025-11-16 01:19:02,576 ERROR: Traceback:
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 39, in run_pipeline
    fetch_main()
  File "C:\Pm2_5\tasks\fetch_api.py", line 289, in main
    added = append_to_master_no_dup(df_new)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 125, in append_to_master_no_dup
    lock = FileLock(LOCK_FILE)
           ^^^^^^^^
NameError: name 'FileLock' is not defined

2025-11-16 01:19:30,664 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:19:30,665 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:19:30,665 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:19:30,665 INFO: Scheduler started
2025-11-16 01:19:30,665 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:19:30,665 INFO: === PIPELINE START ===
2025-11-16 01:19:30,665 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:19:31,348 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:19:31,355 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:31,355 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-16 01:19:31,355 INFO: Fetch สำเร็จ
2025-11-16 01:19:31,364 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:19:32,026 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:32,027 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:19:33,693 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:33,693 INFO: เติม 2025-11-14 02:00 → +0
2025-11-16 01:19:35,411 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:35,411 INFO: เติม 2025-11-14 03:00 → +0
2025-11-16 01:19:37,113 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:37,114 INFO: เติม 2025-11-14 04:00 → +0
2025-11-16 01:19:38,789 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:38,790 INFO: เติม 2025-11-14 05:00 → +0
2025-11-16 01:19:40,489 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:40,489 INFO: เติม 2025-11-14 06:00 → +0
2025-11-16 01:19:42,180 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:42,180 INFO: เติม 2025-11-14 07:00 → +0
2025-11-16 01:19:43,905 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:43,906 INFO: เติม 2025-11-14 08:00 → +0
2025-11-16 01:19:45,572 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:45,572 INFO: เติม 2025-11-14 09:00 → +0
2025-11-16 01:19:47,260 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:47,260 INFO: เติม 2025-11-14 10:00 → +0
2025-11-16 01:19:48,992 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:48,992 INFO: เติม 2025-11-14 11:00 → +0
2025-11-16 01:19:50,696 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:50,698 INFO: เติม 2025-11-14 12:00 → +0
2025-11-16 01:19:52,481 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:52,481 INFO: เติม 2025-11-14 13:00 → +0
2025-11-16 01:19:54,187 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:54,187 INFO: เติม 2025-11-14 14:00 → +0
2025-11-16 01:19:55,864 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:55,864 INFO: เติม 2025-11-14 15:00 → +0
2025-11-16 01:19:57,566 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:57,567 INFO: เติม 2025-11-14 16:00 → +0
2025-11-16 01:19:59,262 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:19:59,263 INFO: เติม 2025-11-14 17:00 → +0
2025-11-16 01:20:00,985 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:00,987 INFO: เติม 2025-11-14 18:00 → +0
2025-11-16 01:20:02,692 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:02,692 INFO: เติม 2025-11-14 19:00 → +0
2025-11-16 01:20:04,380 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:04,380 INFO: เติม 2025-11-14 20:00 → +0
2025-11-16 01:20:06,053 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:06,054 INFO: เติม 2025-11-14 21:00 → +0
2025-11-16 01:20:07,762 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:07,762 INFO: เติม 2025-11-14 22:00 → +0
2025-11-16 01:20:09,426 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:09,427 INFO: เติม 2025-11-14 23:00 → +0
2025-11-16 01:20:11,146 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:11,146 INFO: เติม 2025-11-15 00:00 → +0
2025-11-16 01:20:12,825 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:12,826 INFO: เติม 2025-11-15 01:00 → +0
2025-11-16 01:20:14,556 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:14,556 INFO: เติม 2025-11-15 02:00 → +0
2025-11-16 01:20:16,226 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:16,227 INFO: เติม 2025-11-15 03:00 → +0
2025-11-16 01:20:17,922 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:17,922 INFO: เติม 2025-11-15 04:00 → +0
2025-11-16 01:20:19,657 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:19,658 INFO: เติม 2025-11-15 05:00 → +0
2025-11-16 01:20:21,337 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:20:21,337 INFO: เติม 2025-11-15 06:00 → +0
2025-11-16 01:27:33,992 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:27:33,992 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:27:33,996 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:27:33,996 INFO: Scheduler started
2025-11-16 01:27:33,996 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:27:33,996 INFO: === PIPELINE START ===
2025-11-16 01:27:33,996 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:27:34,718 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:27:34,729 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:34,730 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-16 01:27:34,730 INFO: Fetch สำเร็จ
2025-11-16 01:27:34,740 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:27:35,561 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:35,563 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:27:37,325 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:37,326 INFO: เติม 2025-11-14 02:00 → +0
2025-11-16 01:27:39,064 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:39,065 INFO: เติม 2025-11-14 03:00 → +0
2025-11-16 01:27:40,824 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:40,824 INFO: เติม 2025-11-14 04:00 → +0
2025-11-16 01:27:42,544 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:42,544 INFO: เติม 2025-11-14 05:00 → +0
2025-11-16 01:27:44,277 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:44,277 INFO: เติม 2025-11-14 06:00 → +0
2025-11-16 01:27:46,012 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:46,012 INFO: เติม 2025-11-14 07:00 → +0
2025-11-16 01:27:47,748 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:47,748 INFO: เติม 2025-11-14 08:00 → +0
2025-11-16 01:27:49,510 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:49,512 INFO: เติม 2025-11-14 09:00 → +0
2025-11-16 01:27:51,289 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:51,290 INFO: เติม 2025-11-14 10:00 → +0
2025-11-16 01:27:53,000 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:53,002 INFO: เติม 2025-11-14 11:00 → +0
2025-11-16 01:27:54,738 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:54,739 INFO: เติม 2025-11-14 12:00 → +0
2025-11-16 01:27:56,482 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:56,482 INFO: เติม 2025-11-14 13:00 → +0
2025-11-16 01:27:58,214 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:58,215 INFO: เติม 2025-11-14 14:00 → +0
2025-11-16 01:27:59,935 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:27:59,935 INFO: เติม 2025-11-14 15:00 → +0
2025-11-16 01:28:01,629 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:01,630 INFO: เติม 2025-11-14 16:00 → +0
2025-11-16 01:28:03,347 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:03,347 INFO: เติม 2025-11-14 17:00 → +0
2025-11-16 01:28:05,034 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:05,034 INFO: เติม 2025-11-14 18:00 → +0
2025-11-16 01:28:06,759 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:06,760 INFO: เติม 2025-11-14 19:00 → +0
2025-11-16 01:28:08,500 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:08,500 INFO: เติม 2025-11-14 20:00 → +0
2025-11-16 01:28:10,195 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:10,195 INFO: เติม 2025-11-14 21:00 → +0
2025-11-16 01:28:11,890 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:11,891 INFO: เติม 2025-11-14 22:00 → +0
2025-11-16 01:28:13,592 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:13,593 INFO: เติม 2025-11-14 23:00 → +0
2025-11-16 01:28:15,303 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:15,304 INFO: เติม 2025-11-15 00:00 → +0
2025-11-16 01:28:17,099 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:17,099 INFO: เติม 2025-11-15 01:00 → +0
2025-11-16 01:28:18,804 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:18,805 INFO: เติม 2025-11-15 02:00 → +0
2025-11-16 01:28:20,555 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:20,555 INFO: เติม 2025-11-15 03:00 → +0
2025-11-16 01:28:22,264 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:22,264 INFO: เติม 2025-11-15 04:00 → +0
2025-11-16 01:28:23,966 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:23,967 INFO: เติม 2025-11-15 05:00 → +0
2025-11-16 01:28:25,715 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:25,716 INFO: เติม 2025-11-15 06:00 → +0
2025-11-16 01:28:27,443 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:27,444 INFO: เติม 2025-11-15 07:00 → +0
2025-11-16 01:28:29,104 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:29,105 INFO: เติม 2025-11-15 08:00 → +0
2025-11-16 01:28:30,784 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:30,785 INFO: เติม 2025-11-15 09:00 → +0
2025-11-16 01:28:32,504 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:32,505 INFO: เติม 2025-11-15 10:00 → +0
2025-11-16 01:28:34,218 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:34,219 INFO: เติม 2025-11-15 11:00 → +0
2025-11-16 01:28:35,900 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:35,902 INFO: เติม 2025-11-15 12:00 → +0
2025-11-16 01:28:37,588 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:37,589 INFO: เติม 2025-11-15 13:00 → +0
2025-11-16 01:28:39,317 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:39,317 INFO: เติม 2025-11-15 14:00 → +0
2025-11-16 01:28:40,995 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:40,995 INFO: เติม 2025-11-15 15:00 → +0
2025-11-16 01:28:42,678 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:42,678 INFO: เติม 2025-11-15 16:00 → +0
2025-11-16 01:28:44,705 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:28:44,706 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:44,706 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:28:44,707 INFO: Scheduler started
2025-11-16 01:28:44,707 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:28:44,707 INFO: === PIPELINE START ===
2025-11-16 01:28:44,707 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:45,403 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:28:45,409 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:45,410 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-16 01:28:45,410 INFO: Fetch สำเร็จ
2025-11-16 01:28:45,417 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:28:46,091 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:46,091 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:28:47,088 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:28:47,089 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:47,090 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:28:47,090 INFO: Scheduler started
2025-11-16 01:28:47,090 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:28:47,090 INFO: === PIPELINE START ===
2025-11-16 01:28:47,090 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:47,777 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:28:47,784 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:47,785 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-16 01:28:47,785 INFO: Fetch สำเร็จ
2025-11-16 01:28:47,792 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:28:48,486 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:48,487 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:28:49,580 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:28:49,582 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:49,582 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:28:49,583 INFO: Scheduler started
2025-11-16 01:28:49,583 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:28:49,583 INFO: === PIPELINE START ===
2025-11-16 01:28:49,583 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:50,287 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:28:50,295 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:50,296 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-16 01:28:50,296 INFO: Fetch สำเร็จ
2025-11-16 01:28:50,301 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:28:51,042 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:51,042 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:28:52,023 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 01:28:52,024 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:52,025 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 01:28:52,025 INFO: Scheduler started
2025-11-16 01:28:52,025 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 01:28:52,025 INFO: === PIPELINE START ===
2025-11-16 01:28:52,026 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 01:28:52,695 INFO: ดึง 2025-11-16 00:00:00+07:00 - 2025-11-16 01:00:00+07:00 → 2 แถว
2025-11-16 01:28:52,704 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:52,704 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-16 01:28:52,705 INFO: Fetch สำเร็จ
2025-11-16 01:28:52,711 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 01:28:53,388 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:53,388 INFO: เติม 2025-11-14 01:00 → +0
2025-11-16 01:28:55,126 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:55,127 INFO: เติม 2025-11-14 02:00 → +0
2025-11-16 01:28:56,830 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:56,830 INFO: เติม 2025-11-14 03:00 → +0
2025-11-16 01:28:58,548 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:28:58,549 INFO: เติม 2025-11-14 04:00 → +0
2025-11-16 01:29:00,226 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:00,227 INFO: เติม 2025-11-14 05:00 → +0
2025-11-16 01:29:01,922 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:01,923 INFO: เติม 2025-11-14 06:00 → +0
2025-11-16 01:29:03,684 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:03,685 INFO: เติม 2025-11-14 07:00 → +0
2025-11-16 01:29:05,352 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:05,353 INFO: เติม 2025-11-14 08:00 → +0
2025-11-16 01:29:07,038 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:07,038 INFO: เติม 2025-11-14 09:00 → +0
2025-11-16 01:29:08,709 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:08,709 INFO: เติม 2025-11-14 10:00 → +0
2025-11-16 01:29:10,359 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:10,360 INFO: เติม 2025-11-14 11:00 → +0
2025-11-16 01:29:12,062 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:12,062 INFO: เติม 2025-11-14 12:00 → +0
2025-11-16 01:29:13,730 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:13,732 INFO: เติม 2025-11-14 13:00 → +0
2025-11-16 01:29:15,396 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:15,397 INFO: เติม 2025-11-14 14:00 → +0
2025-11-16 01:29:17,080 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:17,080 INFO: เติม 2025-11-14 15:00 → +0
2025-11-16 01:29:18,781 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:18,781 INFO: เติม 2025-11-14 16:00 → +0
2025-11-16 01:29:20,538 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:20,538 INFO: เติม 2025-11-14 17:00 → +0
2025-11-16 01:29:22,213 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:22,214 INFO: เติม 2025-11-14 18:00 → +0
2025-11-16 01:29:23,917 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:23,918 INFO: เติม 2025-11-14 19:00 → +0
2025-11-16 01:29:25,620 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:25,622 INFO: เติม 2025-11-14 20:00 → +0
2025-11-16 01:29:27,280 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:27,281 INFO: เติม 2025-11-14 21:00 → +0
2025-11-16 01:29:29,014 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:29,014 INFO: เติม 2025-11-14 22:00 → +0
2025-11-16 01:29:30,725 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:30,725 INFO: เติม 2025-11-14 23:00 → +0
2025-11-16 01:29:32,414 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:32,414 INFO: เติม 2025-11-15 00:00 → +0
2025-11-16 01:29:34,126 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:34,126 INFO: เติม 2025-11-15 01:00 → +0
2025-11-16 01:29:35,859 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:35,860 INFO: เติม 2025-11-15 02:00 → +0
2025-11-16 01:29:37,599 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:37,599 INFO: เติม 2025-11-15 03:00 → +0
2025-11-16 01:29:39,327 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:39,328 INFO: เติม 2025-11-15 04:00 → +0
2025-11-16 01:29:41,159 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:41,160 INFO: เติม 2025-11-15 05:00 → +0
2025-11-16 01:29:42,855 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:42,856 INFO: เติม 2025-11-15 06:00 → +0
2025-11-16 01:29:44,570 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:44,570 INFO: เติม 2025-11-15 07:00 → +0
2025-11-16 01:29:46,245 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:46,245 INFO: เติม 2025-11-15 08:00 → +0
2025-11-16 01:29:47,933 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:47,933 INFO: เติม 2025-11-15 09:00 → +0
2025-11-16 01:29:49,646 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:49,646 INFO: เติม 2025-11-15 10:00 → +0
2025-11-16 01:29:51,358 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:51,359 INFO: เติม 2025-11-15 11:00 → +0
2025-11-16 01:29:53,089 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:53,090 INFO: เติม 2025-11-15 12:00 → +0
2025-11-16 01:29:54,831 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:54,831 INFO: เติม 2025-11-15 13:00 → +0
2025-11-16 01:29:56,528 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:56,529 INFO: เติม 2025-11-15 14:00 → +0
2025-11-16 01:29:58,257 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:58,257 INFO: เติม 2025-11-15 15:00 → +0
2025-11-16 01:29:59,989 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:29:59,990 INFO: เติม 2025-11-15 16:00 → +0
2025-11-16 01:30:01,757 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:01,758 INFO: เติม 2025-11-15 17:00 → +0
2025-11-16 01:30:03,461 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:03,461 INFO: เติม 2025-11-15 18:00 → +0
2025-11-16 01:30:05,208 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:05,209 INFO: เติม 2025-11-15 19:00 → +0
2025-11-16 01:30:06,907 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:06,907 INFO: เติม 2025-11-15 20:00 → +0
2025-11-16 01:30:08,621 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:08,622 INFO: เติม 2025-11-15 21:00 → +0
2025-11-16 01:30:10,353 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:10,353 INFO: เติม 2025-11-15 22:00 → +0
2025-11-16 01:30:12,044 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:12,044 INFO: เติม 2025-11-15 23:00 → +0
2025-11-16 01:30:13,786 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:13,787 INFO: เติม 2025-11-16 00:00 → +0
2025-11-16 01:30:15,514 INFO: ไม่มีข้อมูลใหม่
2025-11-16 01:30:15,514 INFO: เติม 2025-11-16 01:00 → +0
2025-11-16 01:30:16,522 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-16 01:30:16,524 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-16 01:30:16,530 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 52 แถว
2025-11-16 01:30:16,532 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-16 01:30:16,535 INFO: รวมเก่า 52 + ใหม่ 52 → 52 (เพิ่ม 0)
2025-11-16 01:30:16,538 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-16 01:30:16,539 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-16 21:24:21,822 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-16 21:24:21,824 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 21:24:21,826 INFO: Added job "run_pipeline" to job store "default"
2025-11-16 21:24:21,826 INFO: Scheduler started
2025-11-16 21:24:21,826 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-16 21:24:21,826 INFO: === PIPELINE START ===
2025-11-16 21:24:21,826 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 21:24:22,605 INFO: ดึง 2025-11-16 20:00:00+07:00 - 2025-11-16 21:00:00+07:00 → 2 แถว
2025-11-16 21:24:22,634 INFO: เพิ่ม 2 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:24:22,634 INFO: สำเร็จ: เพิ่ม 2 แถว (ปัจจุบัน)
2025-11-16 21:24:22,634 INFO: Fetch สำเร็จ
2025-11-16 21:24:22,663 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 21:24:23,384 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:23,385 INFO: เติม 2025-11-14 21:00 → +0
2025-11-16 21:24:25,065 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:25,065 INFO: เติม 2025-11-14 22:00 → +0
2025-11-16 21:24:26,750 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:26,750 INFO: เติม 2025-11-14 23:00 → +0
2025-11-16 21:24:28,450 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:28,451 INFO: เติม 2025-11-15 00:00 → +0
2025-11-16 21:24:30,216 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:30,217 INFO: เติม 2025-11-15 01:00 → +0
2025-11-16 21:24:31,938 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:31,939 INFO: เติม 2025-11-15 02:00 → +0
2025-11-16 21:24:33,612 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:33,613 INFO: เติม 2025-11-15 03:00 → +0
2025-11-16 21:24:35,376 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:35,376 INFO: เติม 2025-11-15 04:00 → +0
2025-11-16 21:24:37,116 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:37,116 INFO: เติม 2025-11-15 05:00 → +0
2025-11-16 21:24:38,884 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:38,884 INFO: เติม 2025-11-15 06:00 → +0
2025-11-16 21:24:40,580 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:40,580 INFO: เติม 2025-11-15 07:00 → +0
2025-11-16 21:24:42,313 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:42,314 INFO: เติม 2025-11-15 08:00 → +0
2025-11-16 21:24:43,983 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:43,983 INFO: เติม 2025-11-15 09:00 → +0
2025-11-16 21:24:45,769 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:45,769 INFO: เติม 2025-11-15 10:00 → +0
2025-11-16 21:24:47,482 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:47,482 INFO: เติม 2025-11-15 11:00 → +0
2025-11-16 21:24:49,181 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:49,181 INFO: เติม 2025-11-15 12:00 → +0
2025-11-16 21:24:50,917 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:50,917 INFO: เติม 2025-11-15 13:00 → +0
2025-11-16 21:24:52,657 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:52,657 INFO: เติม 2025-11-15 14:00 → +0
2025-11-16 21:24:54,376 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:54,376 INFO: เติม 2025-11-15 15:00 → +0
2025-11-16 21:24:56,103 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:56,104 INFO: เติม 2025-11-15 16:00 → +0
2025-11-16 21:24:57,846 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:57,846 INFO: เติม 2025-11-15 17:00 → +0
2025-11-16 21:24:59,538 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:24:59,538 INFO: เติม 2025-11-15 18:00 → +0
2025-11-16 21:25:01,283 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:01,284 INFO: เติม 2025-11-15 19:00 → +0
2025-11-16 21:25:03,013 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:03,013 INFO: เติม 2025-11-15 20:00 → +0
2025-11-16 21:25:04,757 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:04,759 INFO: เติม 2025-11-15 21:00 → +0
2025-11-16 21:25:06,467 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:06,469 INFO: เติม 2025-11-15 22:00 → +0
2025-11-16 21:25:08,217 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:08,217 INFO: เติม 2025-11-15 23:00 → +0
2025-11-16 21:25:09,880 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:09,880 INFO: เติม 2025-11-16 00:00 → +0
2025-11-16 21:25:11,550 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:11,551 INFO: เติม 2025-11-16 01:00 → +1
2025-11-16 21:25:13,250 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:13,251 INFO: เติม 2025-11-16 02:00 → +1
2025-11-16 21:25:15,006 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:15,006 INFO: เติม 2025-11-16 03:00 → +1
2025-11-16 21:25:16,728 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:16,729 INFO: เติม 2025-11-16 04:00 → +1
2025-11-16 21:25:18,483 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:18,483 INFO: เติม 2025-11-16 05:00 → +1
2025-11-16 21:25:20,309 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:20,309 INFO: เติม 2025-11-16 06:00 → +1
2025-11-16 21:25:22,021 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:22,022 INFO: เติม 2025-11-16 07:00 → +1
2025-11-16 21:25:23,757 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:23,757 INFO: เติม 2025-11-16 08:00 → +1
2025-11-16 21:25:25,475 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:25,476 INFO: เติม 2025-11-16 09:00 → +1
2025-11-16 21:25:27,219 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:27,219 INFO: เติม 2025-11-16 10:00 → +1
2025-11-16 21:25:28,932 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:28,933 INFO: เติม 2025-11-16 11:00 → +1
2025-11-16 21:25:30,686 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:30,686 INFO: เติม 2025-11-16 12:00 → +1
2025-11-16 21:25:32,429 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:32,429 INFO: เติม 2025-11-16 13:00 → +1
2025-11-16 21:25:34,164 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:34,165 INFO: เติม 2025-11-16 14:00 → +1
2025-11-16 21:25:35,917 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:35,918 INFO: เติม 2025-11-16 15:00 → +1
2025-11-16 21:25:37,642 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:37,643 INFO: เติม 2025-11-16 16:00 → +1
2025-11-16 21:25:39,375 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:39,375 INFO: เติม 2025-11-16 17:00 → +1
2025-11-16 21:25:41,104 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 21:25:41,105 INFO: เติม 2025-11-16 18:00 → +1
2025-11-16 21:25:42,857 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:42,857 INFO: เติม 2025-11-16 19:00 → +0
2025-11-16 21:25:44,584 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:44,585 INFO: เติม 2025-11-16 20:00 → +0
2025-11-16 21:25:46,272 INFO: ไม่มีข้อมูลใหม่
2025-11-16 21:25:46,272 INFO: เติม 2025-11-16 21:00 → +0
2025-11-16 21:25:47,284 INFO: เติมข้อมูลย้อนหลังเสร็จ: +18 แถว
2025-11-16 21:25:47,284 INFO: เติมข้อมูลย้อนหลัง: +18 แถว
2025-11-16 21:25:47,286 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 72 แถว
2025-11-16 21:25:47,287 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-16 21:25:47,304 INFO: รวมเก่า 52 + ใหม่ 72 → 72 (เพิ่ม 20)
2025-11-16 21:25:47,306 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-16 21:25:47,306 INFO: Format สำเร็จ: +20 แถว
2025-11-16 21:25:47,317 INFO: อ่าน formatted: 72 แถว
2025-11-16 21:25:47,317 INFO: เริ่ม clean ข้อมูล: 72 แถว
2025-11-16 21:25:47,329 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (72 แถว)
2025-11-16 21:25:47,333 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-16 21:00:00          43.7           10.1       1.1 191.5       29.1    53.4     1013.9
2025-11-16 20:00:00          38.7           15.5       0.6 194.1       29.9    50.3     1013.1
2025-11-16 19:00:00          35.1           13.1       0.9 192.1       30.5    47.6     1012.4
2025-11-16 18:00:00          36.0            9.4       0.9 188.1       30.9    46.3     1011.8
2025-11-16 17:00:00          35.9           10.9       1.1 177.7       31.6    42.8     1011.2
2025-11-16 16:00:00          34.9           12.6       0.8 160.1       32.2    40.3     1011.2
2025-11-16 15:00:00          32.7           12.3       0.9 175.1       32.3    40.1     1011.6
2025-11-16 14:00:00          28.5            4.4       1.0 172.7       31.9    41.3     1012.5
2025-11-16 13:00:00          36.1            6.6       1.0 170.4       31.3    42.5     1013.7
2025-11-16 12:00:00          37.1            6.1       1.0 169.6       30.5    44.0     1014.8
2025-11-16 21:25:47,333 INFO: Clean สำเร็จ: 72 แถว
2025-11-16 21:25:49,152 INFO: เตรียมโหลด 72 แถว
2025-11-16 21:25:49,336 INFO: โหลด DB สำเร็จ
2025-11-16 21:25:49,338 INFO: Backup สำเร็จ: data\backups\2025-11-16.csv
2025-11-16 21:25:49,340 INFO: อัพเดท latest.csv สำเร็จ
2025-11-16 21:25:49,341 INFO: Load to DB + Backup สำเร็จ
2025-11-16 21:25:49,341 INFO: === PIPELINE END ===
2025-11-16 22:05:00,008 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-16 23:05:00 +07)" (scheduled at 2025-11-16 22:05:00+07:00)
2025-11-16 22:05:00,009 INFO: === PIPELINE START ===
2025-11-16 22:05:00,009 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-16 22:05:00,765 INFO: ดึง 2025-11-16 21:00:00+07:00 - 2025-11-16 22:00:00+07:00 → 2 แถว
2025-11-16 22:05:00,769 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-16 22:05:00,769 INFO: สำเร็จ: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-16 22:05:00,770 INFO: Fetch สำเร็จ
2025-11-16 22:05:00,785 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-16 22:05:01,473 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:01,474 INFO: เติม 2025-11-14 22:00 → +0
2025-11-16 22:05:03,173 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:03,174 INFO: เติม 2025-11-14 23:00 → +0
2025-11-16 22:05:04,845 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:04,846 INFO: เติม 2025-11-15 00:00 → +0
2025-11-16 22:05:06,539 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:06,540 INFO: เติม 2025-11-15 01:00 → +0
2025-11-16 22:05:08,235 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:08,236 INFO: เติม 2025-11-15 02:00 → +0
2025-11-16 22:05:10,161 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:10,161 INFO: เติม 2025-11-15 03:00 → +0
2025-11-16 22:05:11,883 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:11,883 INFO: เติม 2025-11-15 04:00 → +0
2025-11-16 22:05:13,577 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:13,578 INFO: เติม 2025-11-15 05:00 → +0
2025-11-16 22:05:15,279 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:15,279 INFO: เติม 2025-11-15 06:00 → +0
2025-11-16 22:05:17,015 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:17,015 INFO: เติม 2025-11-15 07:00 → +0
2025-11-16 22:05:18,700 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:18,700 INFO: เติม 2025-11-15 08:00 → +0
2025-11-16 22:05:20,417 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:20,418 INFO: เติม 2025-11-15 09:00 → +0
2025-11-16 22:05:22,150 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:22,150 INFO: เติม 2025-11-15 10:00 → +0
2025-11-16 22:05:23,841 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:23,841 INFO: เติม 2025-11-15 11:00 → +0
2025-11-16 22:05:25,505 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:25,506 INFO: เติม 2025-11-15 12:00 → +0
2025-11-16 22:05:27,215 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:27,215 INFO: เติม 2025-11-15 13:00 → +0
2025-11-16 22:05:28,898 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:28,898 INFO: เติม 2025-11-15 14:00 → +0
2025-11-16 22:05:30,618 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:30,619 INFO: เติม 2025-11-15 15:00 → +0
2025-11-16 22:05:32,341 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:32,342 INFO: เติม 2025-11-15 16:00 → +0
2025-11-16 22:05:34,030 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:34,031 INFO: เติม 2025-11-15 17:00 → +0
2025-11-16 22:05:35,719 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:35,719 INFO: เติม 2025-11-15 18:00 → +0
2025-11-16 22:05:37,417 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:37,418 INFO: เติม 2025-11-15 19:00 → +0
2025-11-16 22:05:39,146 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:39,147 INFO: เติม 2025-11-15 20:00 → +0
2025-11-16 22:05:40,858 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:40,859 INFO: เติม 2025-11-15 21:00 → +0
2025-11-16 22:05:42,597 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:42,597 INFO: เติม 2025-11-15 22:00 → +0
2025-11-16 22:05:44,409 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:44,409 INFO: เติม 2025-11-15 23:00 → +0
2025-11-16 22:05:46,139 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:46,139 INFO: เติม 2025-11-16 00:00 → +0
2025-11-16 22:05:47,869 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:47,869 INFO: เติม 2025-11-16 01:00 → +0
2025-11-16 22:05:49,560 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:49,561 INFO: เติม 2025-11-16 02:00 → +0
2025-11-16 22:05:51,231 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:51,231 INFO: เติม 2025-11-16 03:00 → +0
2025-11-16 22:05:52,911 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:52,912 INFO: เติม 2025-11-16 04:00 → +0
2025-11-16 22:05:54,626 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:54,626 INFO: เติม 2025-11-16 05:00 → +0
2025-11-16 22:05:56,327 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:56,327 INFO: เติม 2025-11-16 06:00 → +0
2025-11-16 22:05:58,024 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:58,025 INFO: เติม 2025-11-16 07:00 → +0
2025-11-16 22:05:59,734 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:05:59,735 INFO: เติม 2025-11-16 08:00 → +0
2025-11-16 22:06:01,485 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:01,485 INFO: เติม 2025-11-16 09:00 → +0
2025-11-16 22:06:03,249 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:03,249 INFO: เติม 2025-11-16 10:00 → +0
2025-11-16 22:06:04,954 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:04,955 INFO: เติม 2025-11-16 11:00 → +0
2025-11-16 22:06:06,665 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:06,666 INFO: เติม 2025-11-16 12:00 → +0
2025-11-16 22:06:08,387 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:08,387 INFO: เติม 2025-11-16 13:00 → +0
2025-11-16 22:06:10,152 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:10,153 INFO: เติม 2025-11-16 14:00 → +0
2025-11-16 22:06:11,857 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:11,858 INFO: เติม 2025-11-16 15:00 → +0
2025-11-16 22:06:13,563 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:13,564 INFO: เติม 2025-11-16 16:00 → +0
2025-11-16 22:06:15,285 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:15,286 INFO: เติม 2025-11-16 17:00 → +0
2025-11-16 22:06:16,977 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:16,978 INFO: เติม 2025-11-16 18:00 → +0
2025-11-16 22:06:18,734 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:18,734 INFO: เติม 2025-11-16 19:00 → +0
2025-11-16 22:06:20,435 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:20,435 INFO: เติม 2025-11-16 20:00 → +0
2025-11-16 22:06:22,120 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:22,121 INFO: เติม 2025-11-16 21:00 → +0
2025-11-16 22:06:23,829 INFO: ไม่มีข้อมูลใหม่
2025-11-16 22:06:23,830 INFO: เติม 2025-11-16 22:00 → +0
2025-11-16 22:06:24,836 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-16 22:06:24,836 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-16 22:06:24,838 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 73 แถว
2025-11-16 22:06:24,838 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-16 22:06:24,840 INFO: รวมเก่า 72 + ใหม่ 73 → 73 (เพิ่ม 1)
2025-11-16 22:06:24,841 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-16 22:06:24,842 INFO: Format สำเร็จ: +1 แถว
2025-11-16 22:06:24,853 INFO: อ่าน formatted: 73 แถว
2025-11-16 22:06:24,854 INFO: เริ่ม clean ข้อมูล: 73 แถว
2025-11-16 22:06:24,863 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (73 แถว)
2025-11-16 22:06:24,865 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-16 22:00:00          40.3           10.1       1.3 187.4       27.9    59.6     1014.3
2025-11-16 21:00:00          43.7           10.1       1.1 191.5       29.1    53.4     1013.9
2025-11-16 20:00:00          38.7           15.5       0.6 194.1       29.9    50.3     1013.1
2025-11-16 19:00:00          35.1           13.1       0.9 192.1       30.5    47.6     1012.4
2025-11-16 18:00:00          36.0            9.4       0.9 188.1       30.9    46.3     1011.8
2025-11-16 17:00:00          35.9           10.9       1.1 177.7       31.6    42.8     1011.2
2025-11-16 16:00:00          34.9           12.6       0.8 160.1       32.2    40.3     1011.2
2025-11-16 15:00:00          32.7           12.3       0.9 175.1       32.3    40.1     1011.6
2025-11-16 14:00:00          28.5            4.4       1.0 172.7       31.9    41.3     1012.5
2025-11-16 13:00:00          36.1            6.6       1.0 170.4       31.3    42.5     1013.7
2025-11-16 22:06:24,866 INFO: Clean สำเร็จ: 73 แถว
2025-11-16 22:06:24,868 INFO: เตรียมโหลด 73 แถว
2025-11-16 22:06:24,942 INFO: โหลด DB สำเร็จ
2025-11-16 22:06:24,943 INFO: Backup สำเร็จ: data\backups\2025-11-16.csv
2025-11-16 22:06:24,945 INFO: อัพเดท latest.csv สำเร็จ
2025-11-16 22:06:24,945 INFO: Load to DB + Backup สำเร็จ
2025-11-16 22:06:24,945 INFO: === PIPELINE END ===
2025-11-16 22:06:24,945 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-16 23:05:00 +07)" executed successfully
2025-11-20 13:37:11,514 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 13:37:11,516 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 13:37:11,517 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 13:37:11,517 INFO: Scheduler started
2025-11-20 13:37:11,517 INFO: Scheduler เริ่มแล้ว (ทุกชั่วโมง นาทีที่ 5)
2025-11-20 13:37:11,517 INFO: === PIPELINE START ===
2025-11-20 13:37:11,517 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 13:37:12,327 INFO: ดึง 2025-11-20 12:00:00+07:00 - 2025-11-20 13:00:00+07:00 → 2 แถว
2025-11-20 13:37:12,363 INFO: เพิ่ม 2 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:12,364 INFO: สำเร็จ: เพิ่ม 2 แถว (ปัจจุบัน)
2025-11-20 13:37:12,364 INFO: Fetch สำเร็จ
2025-11-20 13:37:12,392 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 13:37:13,123 INFO: เพิ่ม 2 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:13,124 INFO: เติม 2025-11-18 13:00 → +2
2025-11-20 13:37:14,857 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:14,857 INFO: เติม 2025-11-18 14:00 → +1
2025-11-20 13:37:16,527 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:16,527 INFO: เติม 2025-11-18 15:00 → +1
2025-11-20 13:37:18,257 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:18,258 INFO: เติม 2025-11-18 16:00 → +1
2025-11-20 13:37:19,967 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:19,967 INFO: เติม 2025-11-18 17:00 → +1
2025-11-20 13:37:21,679 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:21,679 INFO: เติม 2025-11-18 18:00 → +1
2025-11-20 13:37:23,386 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:23,387 INFO: เติม 2025-11-18 19:00 → +1
2025-11-20 13:37:25,115 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:25,115 INFO: เติม 2025-11-18 20:00 → +1
2025-11-20 13:37:26,758 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:26,758 INFO: เติม 2025-11-18 21:00 → +1
2025-11-20 13:37:28,483 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:28,483 INFO: เติม 2025-11-18 22:00 → +1
2025-11-20 13:37:30,210 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:30,211 INFO: เติม 2025-11-18 23:00 → +1
2025-11-20 13:37:31,869 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:31,869 INFO: เติม 2025-11-19 00:00 → +1
2025-11-20 13:37:33,622 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:33,622 INFO: เติม 2025-11-19 01:00 → +1
2025-11-20 13:37:35,338 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:35,338 INFO: เติม 2025-11-19 02:00 → +1
2025-11-20 13:37:37,020 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:37,020 INFO: เติม 2025-11-19 03:00 → +1
2025-11-20 13:37:38,725 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:38,725 INFO: เติม 2025-11-19 04:00 → +1
2025-11-20 13:37:40,413 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:40,413 INFO: เติม 2025-11-19 05:00 → +1
2025-11-20 13:37:42,090 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:42,090 INFO: เติม 2025-11-19 06:00 → +1
2025-11-20 13:37:43,816 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:43,817 INFO: เติม 2025-11-19 07:00 → +1
2025-11-20 13:37:45,505 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:45,505 INFO: เติม 2025-11-19 08:00 → +1
2025-11-20 13:37:47,191 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:47,191 INFO: เติม 2025-11-19 09:00 → +1
2025-11-20 13:37:49,288 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:49,288 INFO: เติม 2025-11-19 10:00 → +1
2025-11-20 13:37:51,026 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:51,027 INFO: เติม 2025-11-19 11:00 → +1
2025-11-20 13:37:52,756 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:52,756 INFO: เติม 2025-11-19 12:00 → +1
2025-11-20 13:37:54,466 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:54,467 INFO: เติม 2025-11-19 13:00 → +1
2025-11-20 13:37:56,177 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:56,179 INFO: เติม 2025-11-19 14:00 → +1
2025-11-20 13:37:57,908 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:57,910 INFO: เติม 2025-11-19 15:00 → +1
2025-11-20 13:37:59,661 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:37:59,661 INFO: เติม 2025-11-19 16:00 → +1
2025-11-20 13:38:01,351 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:01,352 INFO: เติม 2025-11-19 17:00 → +1
2025-11-20 13:38:03,082 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:03,083 INFO: เติม 2025-11-19 18:00 → +1
2025-11-20 13:38:04,769 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:04,770 INFO: เติม 2025-11-19 19:00 → +1
2025-11-20 13:38:06,473 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:06,474 INFO: เติม 2025-11-19 20:00 → +1
2025-11-20 13:38:08,189 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:08,189 INFO: เติม 2025-11-19 21:00 → +1
2025-11-20 13:38:09,896 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:09,896 INFO: เติม 2025-11-19 22:00 → +1
2025-11-20 13:38:11,587 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:11,588 INFO: เติม 2025-11-19 23:00 → +1
2025-11-20 13:38:13,300 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:13,300 INFO: เติม 2025-11-20 00:00 → +1
2025-11-20 13:38:15,039 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:15,040 INFO: เติม 2025-11-20 01:00 → +1
2025-11-20 13:38:16,697 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:16,698 INFO: เติม 2025-11-20 02:00 → +1
2025-11-20 13:38:18,405 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:18,405 INFO: เติม 2025-11-20 03:00 → +1
2025-11-20 13:38:20,124 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:20,125 INFO: เติม 2025-11-20 04:00 → +1
2025-11-20 13:38:21,835 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:21,836 INFO: เติม 2025-11-20 05:00 → +1
2025-11-20 13:38:23,535 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:23,536 INFO: เติม 2025-11-20 06:00 → +1
2025-11-20 13:38:25,265 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:25,265 INFO: เติม 2025-11-20 07:00 → +1
2025-11-20 13:38:26,992 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:26,993 INFO: เติม 2025-11-20 08:00 → +1
2025-11-20 13:38:28,682 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:28,683 INFO: เติม 2025-11-20 09:00 → +1
2025-11-20 13:38:30,398 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 13:38:30,398 INFO: เติม 2025-11-20 10:00 → +1
2025-11-20 13:38:32,062 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:38:32,062 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 13:38:33,750 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:38:33,750 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 13:38:35,469 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:38:35,470 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 13:38:36,493 INFO: เติมข้อมูลย้อนหลังเสร็จ: +47 แถว
2025-11-20 13:38:36,493 INFO: เติมข้อมูลย้อนหลัง: +47 แถว
2025-11-20 13:38:36,495 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 122 แถว
2025-11-20 13:38:36,495 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 13:38:36,513 INFO: รวมเก่า 73 + ใหม่ 122 → 122 (เพิ่ม 49)
2025-11-20 13:38:36,515 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 13:38:36,515 INFO: Format สำเร็จ: +49 แถว
2025-11-20 13:38:36,525 INFO: อ่าน formatted: 122 แถว
2025-11-20 13:38:36,526 INFO: เริ่ม clean ข้อมูล: 122 แถว
2025-11-20 13:38:36,539 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (122 แถว)
2025-11-20 13:38:36,544 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 04:00:00          28.9            3.1       0.7 138.8       23.8    51.0     1013.5
2025-11-20 13:38:36,544 INFO: Clean สำเร็จ: 122 แถว
2025-11-20 13:38:37,890 INFO: เตรียมโหลด 122 แถว
2025-11-20 13:38:38,276 INFO: โหลด DB สำเร็จ
2025-11-20 13:38:38,279 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 13:38:38,282 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 13:38:38,283 INFO: Load to DB + Backup สำเร็จ
2025-11-20 13:38:38,283 INFO: === PIPELINE END ===
2025-11-20 13:52:33,858 ERROR: โหลดโมเดลล้มเหลว: No module named 'xgboost'
2025-11-20 13:52:33,862 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 13:52:33,864 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 13:52:33,865 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 13:52:33,865 INFO: Scheduler started
2025-11-20 13:52:33,866 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 13:52:33,866 INFO: === PIPELINE START ===
2025-11-20 13:52:33,866 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 13:52:34,641 INFO: ดึง 2025-11-20 12:00:00+07:00 - 2025-11-20 13:00:00+07:00 → 2 แถว
2025-11-20 13:52:34,646 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:34,646 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 13:52:34,647 INFO: Fetch สำเร็จ
2025-11-20 13:52:34,653 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 13:52:35,317 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:35,317 INFO: เติม 2025-11-18 13:00 → +0
2025-11-20 13:52:36,995 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:36,995 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 13:52:39,643 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:39,644 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 13:52:41,358 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:41,360 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 13:52:43,067 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:43,067 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 13:52:44,696 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:44,697 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 13:52:46,417 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:46,417 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 13:52:48,107 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:48,108 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 13:52:49,857 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:49,858 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 13:52:51,563 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:51,564 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 13:52:53,241 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:53,242 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 13:52:54,891 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:54,891 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 13:52:56,597 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:56,599 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 13:52:58,332 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:52:58,334 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 13:53:00,056 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:00,057 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 13:53:01,764 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:01,765 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 13:53:03,521 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:03,522 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 13:53:05,244 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:05,245 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 13:53:06,937 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:06,937 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 13:53:08,713 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:08,713 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 13:53:10,402 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:10,402 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 13:53:12,067 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:12,068 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 13:53:13,743 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:13,743 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 13:53:15,482 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:15,483 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 13:53:17,216 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:17,216 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 13:53:18,954 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:18,955 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 13:53:20,707 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:20,707 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 13:53:22,625 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:22,627 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 13:53:24,366 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:24,367 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 13:53:26,093 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:26,093 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 13:53:27,838 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:27,838 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 13:53:29,573 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:29,574 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 13:53:31,289 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:31,290 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 13:53:33,097 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:33,098 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 13:53:34,825 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:34,827 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 13:53:36,561 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:36,561 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 13:53:38,272 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:38,272 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 13:53:39,999 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:40,000 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 13:53:41,780 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:41,781 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 13:53:43,542 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:43,543 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 13:53:45,274 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:45,275 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 13:53:47,015 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:47,016 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 13:53:48,708 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:48,708 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 13:53:50,450 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:50,450 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 13:53:52,167 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:52,167 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 13:53:53,890 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:53,890 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 13:53:55,629 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:55,630 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 13:53:57,345 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:57,345 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 13:53:59,093 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:53:59,093 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 13:54:00,092 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 13:54:00,092 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 13:54:00,094 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 122 แถว
2025-11-20 13:54:00,094 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 13:54:00,096 INFO: รวมเก่า 122 + ใหม่ 122 → 122 (เพิ่ม 0)
2025-11-20 13:54:00,099 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 13:54:00,099 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 13:54:00,101 INFO: เริ่ม clean ข้อมูล: 122 แถว
2025-11-20 13:54:00,113 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (122 แถว)
2025-11-20 13:54:00,117 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 04:00:00          28.9            3.1       0.7 138.8       23.8    51.0     1013.5
2025-11-20 13:54:00,147 INFO: เตรียมโหลด 122 แถว
2025-11-20 13:54:00,322 INFO: โหลด DB สำเร็จ
2025-11-20 13:54:00,324 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 13:54:00,327 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 13:54:00,328 INFO: Load to DB + Backup สำเร็จ
2025-11-20 13:54:00,328 INFO: === PIPELINE END ===

2025-11-20 13:59:04,027 ERROR: โหลดโมเดลล้มเหลว: No module named 'xgboost'
2025-11-20 13:59:04,031 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 13:59:04,032 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 13:59:04,033 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 13:59:04,033 INFO: Scheduler started
2025-11-20 13:59:04,033 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 13:59:04,033 INFO: === PIPELINE START ===
2025-11-20 13:59:04,034 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 13:59:04,753 INFO: ดึง 2025-11-20 12:00:00+07:00 - 2025-11-20 13:00:00+07:00 → 2 แถว
2025-11-20 13:59:04,765 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:04,766 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 13:59:04,766 INFO: Fetch สำเร็จ
2025-11-20 13:59:04,779 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 13:59:05,449 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:05,449 INFO: เติม 2025-11-18 13:00 → +0
2025-11-20 13:59:07,173 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:07,174 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 13:59:08,898 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:08,898 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 13:59:10,621 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:10,622 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 13:59:12,310 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:12,311 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 13:59:14,012 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:14,013 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 13:59:15,769 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:15,770 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 13:59:17,534 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:17,535 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 13:59:19,206 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:19,207 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 13:59:20,895 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:20,895 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 13:59:22,585 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:22,585 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 13:59:24,247 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:24,248 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 13:59:25,968 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:25,969 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 13:59:27,723 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:27,724 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 13:59:29,416 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:29,416 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 13:59:31,120 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:31,120 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 13:59:32,850 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:32,850 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 13:59:34,508 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:34,509 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 13:59:36,252 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:36,253 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 13:59:37,957 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:37,957 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 13:59:39,639 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:39,640 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 13:59:41,348 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:41,348 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 13:59:43,033 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:43,034 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 13:59:44,689 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:44,689 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 13:59:46,374 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:46,374 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 13:59:48,109 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:48,110 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 13:59:49,779 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:49,779 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 13:59:51,475 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:51,475 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 13:59:53,190 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:53,190 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 13:59:54,894 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:54,895 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 13:59:56,602 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:56,603 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 13:59:58,306 INFO: ไม่มีข้อมูลใหม่
2025-11-20 13:59:58,306 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:00:00,059 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:00,060 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:00:01,766 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:01,766 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:00:03,485 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:03,485 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:00:05,179 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:05,180 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:00:06,845 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:06,845 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:00:08,585 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:08,585 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:00:10,382 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:10,383 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:00:12,120 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:12,121 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:00:13,871 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:13,871 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:00:15,634 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:15,634 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:00:17,372 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:17,372 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:00:19,115 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:19,115 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:00:20,837 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:20,837 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:00:22,650 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:22,651 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:00:24,360 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:24,360 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:00:26,114 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:00:26,115 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:00:27,823 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 14:00:27,824 INFO: เติม 2025-11-20 13:00 → +1
2025-11-20 14:00:28,838 INFO: เติมข้อมูลย้อนหลังเสร็จ: +1 แถว
2025-11-20 14:00:28,838 INFO: เติมข้อมูลย้อนหลัง: +1 แถว
2025-11-20 14:00:28,840 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:00:28,841 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:00:28,843 INFO: รวมเก่า 122 + ใหม่ 123 → 123 (เพิ่ม 1)
2025-11-20 14:00:28,844 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:00:28,844 INFO: Format สำเร็จ: +1 แถว
2025-11-20 14:00:28,860 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:00:28,878 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:00:28,882 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:00:28,915 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:00:29,135 INFO: โหลด DB สำเร็จ
2025-11-20 14:00:29,137 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:00:29,140 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:00:29,140 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:00:29,140 INFO: === PIPELINE END ===

2025-11-20 14:02:34,312 ERROR: โหลดโมเดลล้มเหลว: No module named 'xgboost'
2025-11-20 14:02:34,316 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:02:34,317 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:02:34,318 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:02:34,318 INFO: Scheduler started
2025-11-20 14:02:34,318 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:02:34,318 INFO: === PIPELINE START ===
2025-11-20 14:02:34,318 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:02:35,029 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:02:35,035 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:35,035 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:02:35,035 INFO: Fetch สำเร็จ
2025-11-20 14:02:35,044 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:02:35,731 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:35,732 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:02:37,534 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:37,535 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:02:39,412 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:39,412 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:02:41,108 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:41,108 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:02:42,862 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:42,863 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:02:45,059 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:45,059 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:02:46,762 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:46,762 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:02:48,494 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:48,494 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:02:51,394 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:51,395 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:02:53,101 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:53,102 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:02:54,845 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:54,846 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:02:56,571 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:56,572 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:02:58,435 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:02:58,436 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:03:00,132 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:00,132 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:03:01,946 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:01,946 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:03:03,717 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:03,717 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:03:05,502 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:05,503 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:03:07,235 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:07,236 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:03:08,903 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:08,903 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:03:10,582 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:10,582 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:03:12,264 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:12,264 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:03:14,005 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:14,005 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:03:15,682 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:15,682 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:03:17,440 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:17,440 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:03:19,132 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:19,132 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:03:20,854 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:20,855 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:03:22,553 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:22,555 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:03:24,241 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:24,242 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:03:25,891 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:25,892 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:03:27,602 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:27,603 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:03:29,342 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:29,343 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:03:31,515 ERROR: โหลดโมเดลล้มเหลว: No module named 'xgboost'
2025-11-20 14:03:31,520 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:03:31,522 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:03:31,522 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:03:31,523 INFO: Scheduler started
2025-11-20 14:03:31,523 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:03:31,523 INFO: === PIPELINE START ===
2025-11-20 14:03:31,523 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:03:32,223 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:03:32,228 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:32,229 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:03:32,229 INFO: Fetch สำเร็จ
2025-11-20 14:03:32,236 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:03:32,884 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:32,884 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:03:34,588 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:34,589 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:03:36,532 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:36,532 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:03:38,230 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:38,231 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:03:39,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:39,929 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:03:41,715 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:41,716 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:03:43,431 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:43,431 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:03:45,084 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:45,084 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:03:46,762 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:46,762 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:03:48,473 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:48,474 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:03:50,213 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:50,213 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:03:51,990 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:51,990 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:03:53,654 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:53,655 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:03:55,352 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:55,353 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:03:57,087 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:57,088 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:03:58,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:03:58,821 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:04:00,506 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:00,508 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:04:02,262 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:02,263 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:04:03,996 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:03,996 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:04:05,730 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:05,730 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:04:07,422 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:07,422 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:04:09,294 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:09,295 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:04:11,046 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:11,047 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:04:12,761 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:12,762 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:04:14,490 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:14,490 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:04:38,169 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:04:38,175 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:04:38,176 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:04:38,178 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:04:38,178 INFO: Scheduler started
2025-11-20 14:04:38,178 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:04:38,179 INFO: === PIPELINE START ===
2025-11-20 14:04:38,179 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:04:38,912 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:04:38,918 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:38,919 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:04:38,919 INFO: Fetch สำเร็จ
2025-11-20 14:04:38,926 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:04:40,031 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:40,031 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:04:41,736 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:41,736 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:04:43,474 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:43,475 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:04:45,141 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:45,141 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:04:46,851 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:46,851 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:04:48,563 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:48,563 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:04:48,579 ERROR: /predict error: 500: คอลัมน์หาย: ['PM2.5', 'Temp', 'RH', 'WS']
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 180, in predict_next_24h
    raise HTTPException(status_code=500, detail=f"คอลัมน์หาย: {missing}")
fastapi.exceptions.HTTPException: 500: คอลัมน์หาย: ['PM2.5', 'Temp', 'RH', 'WS']

2025-11-20 14:04:50,223 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:50,224 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:04:51,916 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:51,917 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:04:53,644 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:53,645 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:04:55,320 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:55,320 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:04:56,999 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:57,000 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:04:58,692 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:04:58,693 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:05:00,367 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:00,367 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:05:00,368 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 15:05:00 +07)" (scheduled at 2025-11-20 14:05:00+07:00)
2025-11-20 14:05:00,368 INFO: === PIPELINE START ===
2025-11-20 14:05:00,368 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:05:01,044 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:05:01,047 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:01,047 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:05:01,047 INFO: Fetch สำเร็จ
2025-11-20 14:05:01,052 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:05:01,713 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:01,714 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:05:02,405 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:02,405 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:05:03,400 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:03,401 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:05:04,090 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:04,091 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:05:05,113 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:05,114 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:05:05,788 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:05,789 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:05:06,948 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:06,948 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:05:07,612 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:07,613 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:05:08,648 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:08,649 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:05:09,320 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:09,320 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:05:10,332 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:10,333 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:05:11,016 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:11,016 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:05:12,025 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:12,025 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:05:12,722 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:12,723 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:05:13,754 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:13,754 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:05:14,484 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:14,485 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:05:15,441 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:15,441 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:05:16,181 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:16,181 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:05:17,169 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:17,170 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:05:17,869 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:17,870 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:05:18,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:18,928 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:05:19,628 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:19,628 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:05:20,649 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:20,650 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:05:21,375 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:21,376 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:05:22,376 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:22,376 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:05:23,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:23,080 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:05:24,112 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:24,112 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:05:24,776 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:24,778 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:05:25,813 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:25,814 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:05:26,577 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:26,577 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:05:27,537 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:27,538 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:05:28,327 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:28,328 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:05:29,262 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:29,262 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:05:30,048 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:30,048 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:05:31,001 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:31,001 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:05:31,770 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:31,770 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:05:32,782 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:32,783 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:05:33,502 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:33,503 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:05:34,485 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:34,486 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:05:35,198 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:35,198 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:05:36,200 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:36,201 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:05:36,922 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:36,922 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:05:37,913 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:37,914 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:05:38,646 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:38,647 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:05:39,700 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:39,701 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:05:40,436 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:40,437 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:05:41,503 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:41,504 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:05:42,198 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:42,199 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:05:43,273 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:43,274 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:05:44,032 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:44,032 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:05:45,017 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:45,017 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:05:45,696 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:45,697 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:05:46,726 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:46,727 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:05:47,438 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:47,439 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:05:48,467 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:48,468 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:05:49,425 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:49,425 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:05:50,229 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:50,229 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:05:51,192 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:51,193 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:05:51,954 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:51,954 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:05:52,883 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:52,884 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:05:53,677 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:53,678 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:05:54,639 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:54,640 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:05:55,432 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:55,432 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:05:56,436 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:56,438 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:05:57,153 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:57,154 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:05:58,179 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:58,180 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:05:58,927 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:58,928 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:05:59,924 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:05:59,924 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:06:00,646 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:00,647 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:06:01,648 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:01,648 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:06:02,345 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:02,345 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:06:03,369 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:03,369 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:06:04,066 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:04,067 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:06:04,384 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:06:04,384 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:06:04,389 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:06:04,389 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:06:04,392 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:06:04,394 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:06:04,395 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:06:04,396 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:06:04,408 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:06:04,412 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:06:04,439 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:06:04,597 INFO: โหลด DB สำเร็จ
2025-11-20 14:06:04,599 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:06:04,601 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:06:04,601 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:06:04,601 INFO: === PIPELINE END ===

2025-11-20 14:06:05,831 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:05,832 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:06:07,545 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:07,545 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:06:09,275 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:09,276 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:06:10,997 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:10,997 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:06:12,725 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:12,726 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:06:14,445 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:14,446 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:06:16,203 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:16,203 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:06:17,922 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:17,922 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:06:19,684 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:19,685 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:06:21,431 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:21,431 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:06:23,120 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:23,120 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:06:24,872 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:06:24,873 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:06:25,876 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:06:25,876 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:06:25,879 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:06:25,880 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:06:25,882 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:06:25,884 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:06:25,884 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:06:25,886 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:06:25,898 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:06:25,901 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:06:25,903 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:06:26,070 INFO: โหลด DB สำเร็จ
2025-11-20 14:06:26,073 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:06:26,076 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:06:26,076 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:06:26,076 INFO: === PIPELINE END ===

2025-11-20 14:06:26,076 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 15:05:00 +07)" executed successfully
2025-11-20 14:08:59,753 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:08:59,759 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:08:59,761 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:08:59,762 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:08:59,762 INFO: Scheduler started
2025-11-20 14:08:59,762 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:08:59,762 INFO: === PIPELINE START ===
2025-11-20 14:08:59,762 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:09:00,480 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:09:00,485 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:00,485 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:09:00,486 INFO: Fetch สำเร็จ
2025-11-20 14:09:00,495 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:09:01,168 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:01,168 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:09:02,949 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:02,949 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:09:04,666 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:04,666 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:09:06,412 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:06,413 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:09:08,088 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:08,088 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:09:09,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:09,822 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:09:11,542 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:11,542 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:09:13,310 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:13,311 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:09:14,151 ERROR: /predict error: Feature shape mismatch, expected: 168, got 5
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 187, in predict_next_24h
    pred = MODEL.predict(current_input.reshape(1, -1))[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 2865, in inplace_predict
    raise ValueError(
ValueError: Feature shape mismatch, expected: 168, got 5

2025-11-20 14:09:15,035 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:15,036 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:09:16,712 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:16,712 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:09:18,453 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:18,454 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:09:20,247 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:20,248 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:09:21,955 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:21,955 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:09:23,663 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:23,664 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:09:25,309 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:25,309 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:09:27,037 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:27,037 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:09:28,785 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:28,785 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:09:30,485 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:30,486 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:09:32,231 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:32,232 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:09:33,941 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:33,941 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:09:35,635 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:35,636 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:09:37,396 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:37,396 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:09:39,103 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:39,104 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:09:40,799 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:40,800 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:09:42,519 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:42,519 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:09:44,243 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:44,244 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:09:46,024 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:46,024 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:09:47,736 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:47,736 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:09:49,441 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:49,442 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:09:51,139 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:51,139 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:09:52,896 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:52,896 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:09:54,588 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:54,588 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:09:56,294 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:56,295 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:09:58,037 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:58,037 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:09:59,692 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:09:59,692 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:10:01,364 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:01,364 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:10:03,105 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:03,107 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:10:04,909 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:04,910 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:10:06,600 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:06,601 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:10:09,156 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:09,157 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:10:10,806 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:10,806 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:10:12,582 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:12,582 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:10:14,308 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:14,309 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:10:16,063 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:16,063 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:10:17,840 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:17,841 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:10:19,558 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:19,559 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:10:21,248 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:21,248 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:10:22,962 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:22,963 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:10:24,695 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:10:24,696 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:10:25,670 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:10:25,670 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:10:25,672 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:10:25,673 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:10:25,675 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:10:25,677 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:10:25,677 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:10:25,679 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:10:25,690 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:10:25,694 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:10:25,731 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:10:25,896 INFO: โหลด DB สำเร็จ
2025-11-20 14:10:25,899 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:10:25,901 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:10:25,901 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:10:25,901 INFO: === PIPELINE END ===

2025-11-20 14:13:44,635 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:13:44,641 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:13:44,642 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:13:44,643 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:13:44,643 INFO: Scheduler started
2025-11-20 14:13:44,644 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:13:44,644 INFO: === PIPELINE START ===
2025-11-20 14:13:44,644 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:13:45,355 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:13:45,361 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:45,361 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:13:45,361 INFO: Fetch สำเร็จ
2025-11-20 14:13:45,372 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:13:46,074 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:46,074 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:13:47,765 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:47,766 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:13:49,680 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:49,681 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:13:51,461 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:51,462 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:13:53,225 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:53,226 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:13:53,755 ERROR: /predict error: name 'text' is not defined
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 171, in predict_next_24h
    query = text("""
            ^^^^
NameError: name 'text' is not defined

2025-11-20 14:13:54,934 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:54,935 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:13:56,644 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:56,645 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:13:58,402 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:13:58,402 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:14:00,136 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:00,136 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:14:01,872 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:01,873 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:14:03,556 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:03,556 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:14:05,274 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:05,274 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:14:07,092 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:07,092 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:14:08,828 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:08,828 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:14:10,571 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:10,572 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:14:12,291 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:12,292 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:14:14,025 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:14,025 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:14:15,622 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:14:15,627 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:14:15,628 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:14:15,630 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:14:15,630 INFO: Scheduler started
2025-11-20 14:14:15,630 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:14:15,630 INFO: === PIPELINE START ===
2025-11-20 14:14:15,630 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:14:16,368 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:14:16,374 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:16,374 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:14:16,374 INFO: Fetch สำเร็จ
2025-11-20 14:14:16,385 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:14:17,135 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:17,136 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:14:17,240 ERROR: /predict error: 500: Feature mismatch: ได้ 62, ต้องการ 168
Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 241, in predict_next_24h
    raise HTTPException(status_code=500,
fastapi.exceptions.HTTPException: 500: Feature mismatch: ได้ 62, ต้องการ 168

2025-11-20 14:14:18,943 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:18,943 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:14:20,653 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:20,653 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:14:22,424 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:22,424 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:14:24,166 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:24,166 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:14:25,914 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:25,914 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:14:27,562 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:27,562 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:14:29,309 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:29,310 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:14:31,013 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:31,013 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:14:32,707 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:32,708 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:14:34,428 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:34,429 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:14:36,167 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:36,168 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:14:37,893 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:37,894 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:14:39,659 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:39,660 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:14:41,393 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:41,394 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:14:43,134 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:43,135 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:14:44,903 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:44,903 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:14:46,633 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:46,634 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:14:48,389 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:48,389 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:14:50,158 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:50,159 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:14:51,945 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:51,945 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:14:53,664 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:53,665 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:14:55,386 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:55,387 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:14:57,105 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:57,105 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:14:58,803 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:14:58,803 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:15:00,508 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:00,508 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:15:02,238 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:02,238 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:15:04,063 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:04,064 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:15:05,761 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:05,762 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:15:07,481 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:07,482 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:15:09,300 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:09,300 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:15:11,062 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:11,063 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:15:12,795 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:12,796 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:15:14,537 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:14,537 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:15:16,323 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:16,323 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:15:18,048 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:18,048 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:15:19,825 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:19,825 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:15:21,614 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:21,615 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:15:23,356 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:23,357 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:15:25,037 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:25,037 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:15:26,701 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:26,702 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:15:28,454 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:28,454 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:15:30,156 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:30,158 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:15:31,884 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:31,884 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:15:33,657 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:33,658 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:15:35,401 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:35,401 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:15:37,189 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:37,190 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:15:38,881 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:38,882 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:15:40,602 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:15:40,603 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:15:41,625 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:15:41,625 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:15:41,626 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:15:41,628 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:15:41,630 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:15:41,632 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:15:41,632 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:15:41,634 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:15:41,647 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:15:41,651 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:15:41,682 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:15:41,819 INFO: โหลด DB สำเร็จ
2025-11-20 14:15:41,821 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:15:41,823 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:15:41,823 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:15:41,823 INFO: === PIPELINE END ===

2025-11-20 14:16:43,366 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:16:43,372 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:16:43,374 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:16:43,375 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:16:43,375 INFO: Scheduler started
2025-11-20 14:16:43,376 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:16:43,376 INFO: === PIPELINE START ===
2025-11-20 14:16:43,376 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:16:44,132 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:16:44,155 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:44,155 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:16:44,156 INFO: Fetch สำเร็จ
2025-11-20 14:16:44,169 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:16:44,872 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:44,873 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:16:46,635 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:46,636 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:16:48,401 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:48,401 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:16:50,136 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:50,136 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:16:52,095 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:52,095 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:16:53,853 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:53,853 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:16:55,641 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:55,642 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:16:57,376 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:57,378 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:16:59,240 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:16:59,241 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:17:00,940 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:00,941 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:17:02,679 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:02,680 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:17:04,480 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:04,480 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:17:06,291 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:06,292 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:17:08,020 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:08,021 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:17:09,752 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:09,753 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:17:11,531 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:11,532 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:17:13,249 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:13,249 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:17:14,979 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:14,981 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:17:16,711 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:16,711 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:17:18,428 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:18,428 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:17:20,158 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:20,158 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:17:21,869 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:21,869 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:17:23,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:23,821 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:17:25,562 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:25,563 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:17:27,258 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:27,258 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:17:29,046 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:29,048 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:17:30,898 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:30,898 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:17:32,657 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:32,657 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:17:34,348 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:34,349 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:17:36,070 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:36,071 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:17:37,826 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:37,827 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:17:39,548 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:39,548 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:17:41,279 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:41,279 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:17:42,950 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:42,950 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:17:44,675 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:44,675 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:17:46,390 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:46,391 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:17:48,175 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:48,176 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:17:49,876 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:49,876 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:17:51,632 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:51,633 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:17:53,370 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:53,371 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:17:55,113 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:55,114 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:17:56,830 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:56,831 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:17:58,573 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:17:58,574 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:18:00,302 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:18:00,303 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:18:02,077 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:18:02,077 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:18:03,807 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:18:03,807 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:18:05,507 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:18:05,507 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:18:07,241 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:18:07,242 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:18:08,959 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:18:08,959 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:18:09,967 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:18:09,969 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:18:09,971 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:18:09,971 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:18:09,986 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:18:09,989 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:18:09,989 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:18:09,991 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:18:10,005 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:18:10,013 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:18:11,980 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:18:12,111 INFO: โหลด DB สำเร็จ
2025-11-20 14:18:12,113 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:18:12,115 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:18:12,115 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:18:12,115 INFO: === PIPELINE END ===

2025-11-20 14:21:01,819 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:21:01,832 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:21:01,833 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:21:01,834 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:21:01,835 INFO: Scheduler started
2025-11-20 14:21:01,835 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:21:01,835 INFO: === PIPELINE START ===
2025-11-20 14:21:01,835 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:21:02,532 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:21:02,538 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:02,539 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:21:02,539 INFO: Fetch สำเร็จ
2025-11-20 14:21:02,547 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:21:03,243 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:03,244 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:21:03,400 ERROR: /predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 217, in predict_next_24h
    raise HTTPException(500, f"Feature ไม่ครบ: ได้ {X.shape[1]}, ต้องการ 168")
fastapi.exceptions.HTTPException: 500: Feature ไม่ครบ: ได้ 160, ต้องการ 168

2025-11-20 14:21:04,980 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:04,980 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:21:06,696 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:06,698 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:21:08,429 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:08,429 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:21:10,146 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:10,146 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:21:11,868 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:11,868 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:21:13,571 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:13,572 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:21:15,308 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:15,309 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:21:17,052 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:17,053 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:21:18,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:18,822 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:21:20,625 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:20,626 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:21:22,463 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:22,464 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:21:24,200 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:24,202 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:21:26,212 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:26,213 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:21:27,924 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:27,925 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:21:29,645 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:29,645 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:21:31,452 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:31,453 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:21:33,152 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:33,153 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:21:35,339 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:35,340 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:21:37,070 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:37,071 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:21:38,854 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:38,854 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:21:40,578 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:40,579 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:21:42,288 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:42,289 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:21:44,120 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:44,121 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:21:45,840 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:45,841 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:21:47,602 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:47,603 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:21:49,338 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:49,338 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:21:51,088 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:51,088 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:21:52,800 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:52,800 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:21:54,506 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:54,506 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:21:56,303 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:56,303 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:21:57,996 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:58,002 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:21:59,772 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:21:59,773 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:22:01,493 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:01,493 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:22:03,169 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:03,169 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:22:04,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:04,929 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:22:06,619 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:06,620 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:22:08,306 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:08,306 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:22:10,015 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:10,016 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:22:11,754 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:11,754 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:22:13,511 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:13,511 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:22:15,232 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:15,232 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:22:17,034 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:17,035 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:22:18,829 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:18,830 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:22:20,705 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:20,705 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:22:22,445 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:22,446 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:22:24,219 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:24,220 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:22:26,009 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:26,009 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:22:27,760 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:22:27,760 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:22:28,780 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:22:28,780 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:22:28,782 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:22:28,783 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:22:28,785 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:22:28,787 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:22:28,787 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:22:28,789 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:22:28,800 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:22:28,803 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:22:28,831 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:22:28,956 INFO: โหลด DB สำเร็จ
2025-11-20 14:22:28,958 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:22:28,961 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:22:28,961 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:22:28,961 INFO: === PIPELINE END ===

2025-11-20 14:26:20,763 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:26:20,768 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:26:20,769 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:26:20,771 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:26:20,776 INFO: Scheduler started
2025-11-20 14:26:20,778 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:26:20,779 INFO: === PIPELINE START ===
2025-11-20 14:26:20,779 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:26:21,562 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:26:21,569 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:21,570 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:26:21,570 INFO: Fetch สำเร็จ
2025-11-20 14:26:21,578 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:26:22,374 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:22,374 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:26:22,471 ERROR: /predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 195, in predict_next_24h
    pred = max(0, float(MODEL.predict(current)[0]))
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 2865, in inplace_predict
    raise ValueError(
ValueError: Feature shape mismatch, expected: 168, got 34

2025-11-20 14:26:24,104 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:24,105 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:26:25,856 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:25,858 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:26:27,587 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:27,589 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:26:29,333 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:29,333 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:26:31,085 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:31,086 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:26:32,843 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:32,844 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:26:34,627 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:34,628 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:26:36,428 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:36,428 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:26:38,205 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:38,206 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:26:39,991 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:39,992 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:26:41,701 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:41,701 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:26:43,490 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:43,490 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:26:45,193 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:45,194 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:26:46,977 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:46,978 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:26:48,715 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:48,715 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:26:50,437 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:50,437 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:26:52,139 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:52,140 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:26:53,981 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:53,982 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:26:55,727 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:55,727 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:26:57,503 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:57,504 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:26:59,244 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:26:59,245 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:27:01,043 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:01,043 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:27:02,871 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:02,872 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:27:04,618 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:04,618 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:27:06,421 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:06,421 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:27:08,175 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:08,175 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:27:09,932 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:09,933 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:27:11,697 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:11,698 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:27:13,430 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:13,430 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:27:15,165 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:15,165 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:27:16,952 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:16,952 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:27:18,699 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:27:18,704 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:27:18,706 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:27:18,708 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:27:18,708 INFO: Scheduler started
2025-11-20 14:27:18,709 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:27:18,709 INFO: === PIPELINE START ===
2025-11-20 14:27:18,709 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:27:19,476 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:27:19,482 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:19,482 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:27:19,482 INFO: Fetch สำเร็จ
2025-11-20 14:27:19,495 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:27:20,234 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:20,235 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:27:20,358 ERROR: /predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 202, in predict_next_24h
    raise HTTPException(500, f"Feature mismatch: ได้ {len(latest)-2}, ต้องการ {expected_features}")
fastapi.exceptions.HTTPException: 500: Feature mismatch: ได้ 159, ต้องการ 168

2025-11-20 14:27:21,940 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:21,941 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:27:23,704 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:23,704 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:27:25,422 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:25,422 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:27:27,168 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:27,168 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:27:28,856 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:28,857 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:27:30,614 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:30,615 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:27:32,322 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:32,323 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:27:34,060 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:34,061 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:27:35,800 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:35,800 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:27:37,486 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:37,487 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:27:39,172 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:39,173 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:27:40,868 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:40,868 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:27:42,505 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:42,506 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:27:44,241 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:44,241 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:27:45,931 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:45,931 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:27:47,676 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:47,677 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:27:49,496 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:49,498 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:27:51,312 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:51,312 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:27:52,988 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:52,989 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:27:54,643 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:54,644 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:27:56,382 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:56,383 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:27:58,092 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:58,093 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:27:59,805 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:27:59,806 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:28:01,569 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:01,570 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:28:03,260 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:03,261 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:28:05,009 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:05,009 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:28:06,794 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:06,795 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:28:08,492 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:08,492 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:28:10,189 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:10,189 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:28:11,881 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:11,882 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:28:13,565 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:13,565 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:28:15,245 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:15,245 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:28:16,952 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:16,953 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:28:18,636 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:18,636 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:28:20,356 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:20,356 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:28:22,034 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:22,034 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:28:23,865 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:23,865 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:28:25,574 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:25,575 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:28:27,312 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:27,312 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:28:28,982 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:28,984 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:28:30,691 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:30,691 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:28:32,483 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:32,483 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:28:34,146 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:34,147 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:28:35,833 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:35,833 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:28:37,568 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:37,568 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:28:39,241 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:39,242 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:28:40,911 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:40,911 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:28:42,615 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:28:42,616 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:28:43,598 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:28:43,598 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:28:43,600 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:28:43,601 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:28:43,604 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:28:43,606 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:28:43,606 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:28:43,611 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:28:43,623 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:28:43,628 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:28:43,656 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:28:43,790 INFO: โหลด DB สำเร็จ
2025-11-20 14:28:43,792 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:28:43,794 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:28:43,794 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:28:43,794 INFO: === PIPELINE END ===

2025-11-20 14:30:03,522 INFO: XGBoost Model โหลดสำเร็จ: C:\Pm2_5\models\xgboost_pm25_best.pkl
2025-11-20 14:30:03,527 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:30:03,529 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:30:03,530 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:30:03,530 INFO: Scheduler started
2025-11-20 14:30:03,530 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:30:03,530 INFO: === PIPELINE START ===
2025-11-20 14:30:03,530 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:30:04,289 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:30:04,298 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:04,298 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:30:04,298 INFO: Fetch สำเร็จ
2025-11-20 14:30:04,306 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:30:05,022 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:05,023 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:30:06,784 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:06,785 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:30:08,453 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:08,454 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:30:10,197 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:10,197 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:30:11,987 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:11,987 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:30:13,700 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:13,700 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:30:15,473 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:15,474 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:30:17,220 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:17,220 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:30:19,015 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:19,015 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:30:20,865 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:20,865 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:30:22,551 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:22,552 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:30:24,274 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:24,274 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:30:26,012 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:26,013 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:30:27,775 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:27,776 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:30:27,894 ERROR: Predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 212, in predict_next_24h
    raise HTTPException(500, f"Feature ยังขาดอีก {missing} ตัว (ตอนนี้ได้ {actual_features}/168)")
fastapi.exceptions.HTTPException: 500: Feature ยังขาดอีก 2 ตัว (ตอนนี้ได้ 166/168)

2025-11-20 14:30:29,449 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:29,450 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:30:31,225 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:31,226 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:30:32,955 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:32,955 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:30:34,631 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:34,631 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:30:36,409 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:36,410 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:30:38,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:38,080 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:30:39,814 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:39,814 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:30:41,907 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:41,909 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:30:43,597 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:43,598 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:30:45,301 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:45,302 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:30:47,235 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:47,236 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:30:48,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:48,929 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:30:50,626 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:50,626 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:30:52,346 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:52,346 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:30:54,052 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:54,052 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:30:55,726 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:55,727 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:30:57,451 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:57,452 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:30:59,232 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:30:59,233 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:31:00,884 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:00,885 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:31:02,705 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:02,706 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:31:04,403 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:04,403 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:31:06,102 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:06,103 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:31:07,836 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:07,837 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:31:09,544 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:09,545 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:31:11,254 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:11,254 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:31:13,054 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:13,055 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:31:14,773 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:14,773 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:31:16,484 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:16,485 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:31:18,144 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:18,144 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:31:19,888 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:19,888 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:31:21,597 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:21,598 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:31:23,340 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:23,341 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:31:25,165 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:25,166 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:31:26,882 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:26,883 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:31:28,653 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:31:28,654 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:31:29,635 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:31:29,635 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:31:29,638 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:31:29,639 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:31:29,641 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:31:29,644 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:31:29,645 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:31:29,647 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:31:29,660 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:31:29,666 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:31:29,710 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:31:29,925 INFO: โหลด DB สำเร็จ
2025-11-20 14:31:29,927 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:31:29,929 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:31:29,929 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:31:29,929 INFO: === PIPELINE END ===

2025-11-20 14:35:55,815 ERROR: Predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 212, in predict_next_24h
    raise HTTPException(500, f"Feature ยังขาดอีก {missing} ตัว (ตอนนี้ได้ {actual_features}/168)")
fastapi.exceptions.HTTPException: 500: Feature ยังขาดอีก 2 ตัว (ตอนนี้ได้ 166/168)

2025-11-20 14:36:46,340 WARNING: ไม่พบโมเดลที่ models/xgboost_pm25_best.pkl → /predict จะไม่ทำงาน
2025-11-20 14:36:46,345 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:36:46,346 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:36:46,347 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:36:46,347 INFO: Scheduler started
2025-11-20 14:36:46,347 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:36:46,348 INFO: === PIPELINE START ===
2025-11-20 14:36:46,348 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:36:47,164 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:36:47,170 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:47,170 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:36:47,171 INFO: Fetch สำเร็จ
2025-11-20 14:36:47,185 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:36:47,932 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:47,933 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:36:49,610 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:49,610 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:36:51,340 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:51,340 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:36:53,036 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:53,037 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:36:54,710 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:54,711 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:36:56,448 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:56,449 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:36:58,243 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:58,244 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:36:59,985 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:36:59,985 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:37:01,666 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:01,666 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:37:03,454 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:03,455 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:37:05,182 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:05,182 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:37:06,921 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:06,922 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:37:08,673 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:08,674 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:37:10,434 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:10,434 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:37:12,253 WARNING: ไม่พบโมเดลที่ models/xgboost_pm25_best.pkl → /predict จะไม่ทำงาน
2025-11-20 14:37:12,258 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:37:12,259 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:37:12,261 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:37:12,261 INFO: Scheduler started
2025-11-20 14:37:12,261 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:37:12,261 INFO: === PIPELINE START ===
2025-11-20 14:37:12,261 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:37:12,951 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:37:12,956 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:12,957 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:37:12,957 INFO: Fetch สำเร็จ
2025-11-20 14:37:12,966 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:37:13,654 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:13,655 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:37:15,351 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:15,352 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:37:17,027 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:17,027 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:37:18,786 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:18,786 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:37:20,483 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:20,483 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:37:22,216 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:22,216 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:37:23,952 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:23,953 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:37:25,663 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:25,664 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:37:27,313 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:27,314 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:37:28,988 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:28,988 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:37:30,719 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:30,720 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:37:32,447 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:32,448 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:37:34,231 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:34,232 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:37:35,993 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:35,994 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:37:37,752 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:37,752 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:37:39,496 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:39,497 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:37:41,265 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:41,265 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:37:42,969 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:42,970 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:37:44,695 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:44,696 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:37:46,376 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:46,376 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:37:48,139 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:48,140 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:37:49,890 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:49,891 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:37:51,609 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:51,610 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:37:53,286 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:53,286 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:37:54,981 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:54,982 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:37:56,675 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:37:56,675 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:38:06,756 WARNING: ไม่พบโมเดลที่ models/xgboost_pm25_best.pkl → /predict จะไม่ทำงาน
2025-11-20 14:38:06,759 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:38:06,760 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:38:06,761 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:38:06,761 INFO: Scheduler started
2025-11-20 14:38:06,761 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:38:06,761 INFO: === PIPELINE START ===
2025-11-20 14:38:06,761 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:38:07,437 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:38:07,444 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:07,445 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:38:07,446 INFO: Fetch สำเร็จ
2025-11-20 14:38:07,456 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:38:08,128 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:08,129 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:38:09,831 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:09,831 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:38:11,520 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:11,520 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:38:13,250 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:13,251 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:38:14,905 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:14,905 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:38:16,606 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:16,608 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:38:18,368 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:18,369 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:38:20,073 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:20,074 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:38:21,786 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:21,787 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:38:23,483 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:23,484 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:38:25,167 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:25,169 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:38:26,880 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:26,881 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:38:28,588 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:28,588 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:38:30,281 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:30,282 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:38:31,935 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:31,936 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:38:33,619 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:33,620 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:38:35,320 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:35,322 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:38:37,019 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:37,020 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:38:38,720 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:38,721 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:38:40,425 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:40,425 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:38:42,103 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:42,104 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:38:43,784 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:43,784 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:38:45,427 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:45,428 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:38:47,141 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:47,141 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:38:48,854 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:48,855 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:38:50,608 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:50,608 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:38:52,279 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:52,279 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:38:54,076 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:54,077 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:38:55,789 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:55,789 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:38:57,470 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:57,470 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:38:59,199 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:38:59,200 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:39:00,970 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:00,970 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:39:02,708 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:02,709 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:39:04,443 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:04,443 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:39:06,110 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:06,111 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:39:07,847 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:07,847 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:39:09,606 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:09,608 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:39:11,310 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:11,311 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:39:13,037 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:13,040 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:39:14,787 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:14,787 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:39:16,434 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:16,435 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:39:18,163 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:18,164 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:39:19,863 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:19,864 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:39:21,586 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:21,586 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:39:23,308 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:23,309 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:39:25,025 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:25,026 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:39:26,758 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:26,759 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:39:28,433 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:28,434 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:39:30,103 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:30,104 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:39:31,088 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:39:31,088 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:39:31,091 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:39:31,092 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:39:31,094 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:39:31,096 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:39:31,096 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:39:31,098 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:39:31,110 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:39:31,114 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:39:31,144 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:39:31,316 INFO: โหลด DB สำเร็จ
2025-11-20 14:39:31,318 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:39:31,320 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:39:31,320 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:39:31,321 INFO: === PIPELINE END ===

2025-11-20 14:39:49,882 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:39:49,883 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:39:49,884 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:39:49,884 INFO: Scheduler started
2025-11-20 14:39:49,885 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:39:49,885 INFO: === PIPELINE START ===
2025-11-20 14:39:49,885 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:39:50,614 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:39:50,622 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:50,622 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:39:50,623 INFO: Fetch สำเร็จ
2025-11-20 14:39:50,629 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:39:51,356 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:51,356 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:39:53,022 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:53,023 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:39:54,692 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:54,692 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:39:56,421 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:56,421 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:39:58,149 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:58,149 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:39:59,809 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:39:59,809 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:40:01,553 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:01,553 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:40:03,284 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:03,285 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:40:04,944 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:04,944 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:40:06,644 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:06,644 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:40:08,360 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:08,360 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:40:10,052 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:10,052 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:40:11,742 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:11,742 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:40:13,415 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:13,416 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:40:15,110 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:15,110 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:40:16,948 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:16,948 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:40:18,654 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:18,654 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:40:20,394 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:20,396 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:40:22,138 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:22,139 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:40:23,940 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:23,941 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:40:25,663 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:25,663 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:40:27,334 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:27,335 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:40:29,033 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:29,034 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:40:30,748 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:30,748 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:40:32,533 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:32,534 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:40:34,216 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:34,216 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:40:35,914 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:35,914 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:40:37,582 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:37,582 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:40:39,281 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:39,281 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:40:40,942 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:40,942 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:40:42,608 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:42,609 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:40:44,294 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:44,295 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:40:46,018 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:46,018 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:40:47,714 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:47,714 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:40:49,414 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:49,415 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:40:51,125 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:51,126 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:40:52,823 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:52,824 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:40:54,517 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:54,518 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:40:56,269 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:56,270 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:40:57,962 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:57,963 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:40:59,690 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:40:59,690 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:41:01,414 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:01,415 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:41:03,137 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:03,138 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:41:04,809 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:04,809 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:41:06,512 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:06,512 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:41:08,226 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:08,226 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:41:09,929 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:09,929 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:41:11,644 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:11,644 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:41:13,324 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:13,324 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:41:14,332 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:41:14,332 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:41:14,333 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:41:14,334 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:41:14,336 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:41:14,339 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:41:14,339 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:41:14,341 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:41:14,351 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:41:14,355 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:41:14,382 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:41:14,543 INFO: โหลด DB สำเร็จ
2025-11-20 14:41:14,545 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:41:14,546 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:41:14,547 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:41:14,547 INFO: === PIPELINE END ===

2025-11-20 14:41:44,653 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:41:44,654 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:41:44,655 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:41:44,655 INFO: Scheduler started
2025-11-20 14:41:44,656 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:41:44,656 INFO: === PIPELINE START ===
2025-11-20 14:41:44,656 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:41:45,347 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:41:45,357 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:45,358 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:41:45,358 INFO: Fetch สำเร็จ
2025-11-20 14:41:45,364 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:41:46,058 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:46,058 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:41:47,811 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:47,812 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:41:49,444 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:49,445 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:41:51,130 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:51,131 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:41:52,849 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:52,849 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:41:54,530 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:54,530 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:41:56,193 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:56,194 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:41:57,836 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:57,836 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:41:59,526 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:41:59,527 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:42:01,245 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:01,246 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:42:02,992 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:02,993 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:42:04,699 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:04,700 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:42:06,415 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:06,416 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:42:08,125 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:08,126 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:42:09,838 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:09,838 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:42:11,527 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:11,527 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:42:13,220 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:13,220 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:42:14,922 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:14,922 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:42:16,642 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:16,643 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:42:18,314 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:18,315 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:42:20,019 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:20,019 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:42:21,703 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:21,704 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:42:23,453 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:23,454 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:42:25,126 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:25,126 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:42:26,857 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:26,857 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:42:28,547 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:28,547 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:42:30,240 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:30,240 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:42:31,916 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:31,917 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:42:33,677 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:42:33,679 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:42:33,679 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:42:33,680 INFO: Scheduler started
2025-11-20 14:42:33,680 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:42:33,680 INFO: === PIPELINE START ===
2025-11-20 14:42:33,680 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:42:34,377 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:42:34,383 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:34,384 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:42:34,384 INFO: Fetch สำเร็จ
2025-11-20 14:42:34,392 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:42:35,076 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:35,077 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:42:36,481 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:42:36,482 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:42:36,483 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:42:36,483 INFO: Scheduler started
2025-11-20 14:42:36,483 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:42:36,484 INFO: === PIPELINE START ===
2025-11-20 14:42:36,484 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:42:37,216 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:42:37,222 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:37,223 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:42:37,223 INFO: Fetch สำเร็จ
2025-11-20 14:42:37,231 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:42:37,961 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:37,962 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:42:39,693 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:39,694 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:42:41,406 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:41,407 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:42:43,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:43,081 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:42:44,767 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:44,767 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:42:46,484 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:46,484 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:42:48,191 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:48,192 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:42:49,827 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:49,827 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:42:51,519 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:51,520 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:42:53,194 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:53,195 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:42:54,852 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:54,853 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:42:56,554 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:56,555 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:42:58,230 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:58,230 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:42:59,905 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:42:59,905 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:43:01,563 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:01,563 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:43:03,251 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:03,252 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:43:04,958 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:04,958 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:43:06,737 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:06,739 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:43:08,422 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:08,423 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:43:10,104 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:10,104 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:43:11,770 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:11,771 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:43:13,449 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:13,450 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:43:15,138 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:15,139 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:43:16,882 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:16,883 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:43:18,586 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:18,587 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:43:20,287 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:20,288 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:43:22,032 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:22,033 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:43:23,722 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:23,723 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:43:25,446 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:25,446 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:43:27,178 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:27,178 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:43:28,872 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:28,873 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:43:30,611 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:30,611 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:43:32,288 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:32,288 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:43:33,988 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:33,988 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:43:35,660 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:35,660 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:43:37,392 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:37,393 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:43:39,098 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:39,099 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:43:40,797 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:40,797 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:43:42,514 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:42,515 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:43:44,327 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:44,327 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:43:46,083 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:46,083 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:43:47,787 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:47,788 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:43:50,023 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:43:50,025 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:43:50,026 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:43:50,026 INFO: Scheduler started
2025-11-20 14:43:50,026 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:43:50,026 INFO: === PIPELINE START ===
2025-11-20 14:43:50,026 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:43:50,738 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:43:50,743 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:50,743 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:43:50,743 INFO: Fetch สำเร็จ
2025-11-20 14:43:50,750 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:43:51,428 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:51,428 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:43:53,124 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:53,124 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:43:54,871 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:54,872 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:43:56,623 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:56,623 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:43:58,338 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:43:58,338 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:44:00,058 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:00,058 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:44:01,798 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:01,798 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:44:03,713 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:03,713 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:44:05,447 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:05,447 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:44:07,133 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:07,133 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:44:08,833 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:08,833 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:44:10,563 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:10,564 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:44:12,234 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:12,234 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:44:13,981 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:13,981 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:44:15,632 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:15,633 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:44:17,368 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:17,369 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:44:19,169 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:19,169 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:44:20,874 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:20,875 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:44:22,580 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:22,581 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:44:24,289 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:24,290 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:44:26,015 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:26,016 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:44:27,714 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:27,714 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:44:29,458 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:29,458 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:44:31,139 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:31,139 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:44:32,876 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:32,876 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:44:34,559 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:34,559 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:44:36,219 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:36,219 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:44:37,926 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:37,927 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:44:39,592 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:39,592 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:44:41,257 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:41,257 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:44:42,889 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:42,890 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:44:44,604 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:44,605 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:44:46,265 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:46,265 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:44:47,971 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:47,971 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:44:49,666 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:49,667 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:44:51,300 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:51,301 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:44:52,972 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:52,973 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:44:54,675 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:54,676 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:44:56,356 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:56,356 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:44:58,014 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:58,014 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:44:59,696 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:44:59,696 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:45:01,364 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:01,368 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:45:03,024 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:03,024 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:45:33,927 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:45:33,930 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:45:33,931 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:45:33,931 INFO: Scheduler started
2025-11-20 14:45:33,931 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:45:33,932 INFO: === PIPELINE START ===
2025-11-20 14:45:33,932 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:45:34,719 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:45:34,724 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:34,725 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:45:34,725 INFO: Fetch สำเร็จ
2025-11-20 14:45:34,732 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:45:35,393 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:35,393 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:45:37,062 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:37,062 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:45:37,820 ERROR: Predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 207, in predict_next_24h
    pred = max(0, MODEL.predict(current_features)[0])
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\sklearn.py", line 1443, in predict
    predts = self.get_booster().inplace_predict(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Pm2_5\venv\Lib\site-packages\xgboost\core.py", line 2865, in inplace_predict
    raise ValueError(
ValueError: Feature shape mismatch, expected: 168, got 30

2025-11-20 14:45:38,736 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:38,737 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:45:40,387 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:40,387 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:45:42,046 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:42,047 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:45:43,740 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:43,740 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:45:45,368 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:45,368 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:45:47,075 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:47,075 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:45:48,766 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:48,766 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:45:50,464 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:50,465 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:45:52,193 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:52,194 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:45:53,852 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:53,852 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:45:55,629 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:55,629 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:45:57,343 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:57,343 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:45:59,085 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:45:59,085 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:46:00,820 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:00,820 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:46:02,508 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:02,509 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:46:04,256 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:04,257 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:46:06,060 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:06,060 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:46:07,771 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:07,772 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:46:09,528 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:09,528 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:46:11,311 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:11,311 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:46:13,021 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:13,021 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:46:14,809 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:14,809 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:46:16,537 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:16,538 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:46:18,270 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:18,271 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:46:20,033 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:20,034 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:46:21,816 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:21,816 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:46:23,488 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:23,488 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:46:25,183 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:25,184 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:46:26,904 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:26,904 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:46:28,634 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:28,634 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:46:30,383 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:30,383 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:46:32,151 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:32,152 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:46:33,877 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:33,877 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:46:35,587 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:35,588 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:46:37,331 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:37,331 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:46:39,030 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:39,030 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:46:40,744 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:40,744 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:46:42,451 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:42,452 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:46:44,142 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:44,142 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:46:45,817 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:45,818 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:46:47,494 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:47,495 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:46:49,221 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:49,221 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:46:50,910 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:50,911 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:46:52,583 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:52,584 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:46:54,342 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:54,342 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:46:56,042 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:56,043 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:46:57,782 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:46:57,783 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:46:58,799 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:46:58,799 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:46:58,800 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:46:58,801 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:46:58,803 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:46:58,805 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:46:58,806 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:46:58,807 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:46:58,818 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:46:58,822 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:46:58,850 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:46:59,026 INFO: โหลด DB สำเร็จ
2025-11-20 14:46:59,029 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:46:59,035 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:46:59,035 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:46:59,036 INFO: === PIPELINE END ===

2025-11-20 14:47:30,328 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:47:30,330 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:47:30,331 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:47:30,331 INFO: Scheduler started
2025-11-20 14:47:30,332 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:47:30,332 INFO: === PIPELINE START ===
2025-11-20 14:47:30,332 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:47:31,009 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:47:31,015 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:31,016 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:47:31,016 INFO: Fetch สำเร็จ
2025-11-20 14:47:31,022 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:47:31,697 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:31,698 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:47:33,409 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:33,409 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:47:34,403 ERROR: Predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 205, in predict_next_24h
    raise HTTPException(500, f"Feature mismatch: ได้ {X.shape[1]}, ต้องการ 168")
fastapi.exceptions.HTTPException: 500: Feature mismatch: ได้ 161, ต้องการ 168

2025-11-20 14:47:35,069 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:35,070 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:47:36,770 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:36,771 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:47:38,452 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:38,453 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:47:40,143 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:40,144 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:47:41,840 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:41,841 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:47:43,542 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:43,543 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:47:45,251 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:45,252 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:47:46,966 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:46,966 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:47:48,713 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:48,713 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:47:50,537 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:50,537 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:47:52,270 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:52,271 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:47:53,952 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:53,952 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:47:55,645 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:55,645 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:47:57,423 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:57,423 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:47:59,116 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:47:59,116 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:48:00,839 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:00,840 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:48:02,570 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:02,571 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:48:04,309 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:04,310 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:48:05,991 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:05,992 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:48:07,694 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:07,695 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:48:09,365 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:09,365 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:48:11,046 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:11,046 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:48:12,767 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:12,767 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:48:14,478 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:14,479 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:48:16,173 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:16,174 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:48:17,949 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:17,950 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:48:19,636 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:19,637 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:48:21,410 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:21,410 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:48:23,060 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:23,061 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:48:24,764 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:24,764 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:48:26,453 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:26,453 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:48:28,148 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:28,148 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:48:29,863 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:29,864 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:48:31,542 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:31,543 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:48:33,239 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:33,239 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:48:34,942 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:34,943 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:48:36,635 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:36,636 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:48:38,322 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:38,323 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:48:40,021 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:40,022 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:48:42,615 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:48:42,618 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:48:42,619 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:48:42,620 INFO: Scheduler started
2025-11-20 14:48:42,620 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:48:42,620 INFO: === PIPELINE START ===
2025-11-20 14:48:42,620 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:48:43,333 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:48:43,338 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:43,338 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:48:43,339 INFO: Fetch สำเร็จ
2025-11-20 14:48:43,345 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:48:44,001 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:44,002 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:48:45,681 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:45,681 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:48:45,770 ERROR: Predict error: Traceback (most recent call last):
  File "C:\Pm2_5\app\main.py", line 222, in predict_next_24h
    raise HTTPException(500, f"Feature mismatch: ได้ {feature_count}, ต้องการ 168")
fastapi.exceptions.HTTPException: 500: Feature mismatch: ได้ 172, ต้องการ 168

2025-11-20 14:48:47,369 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:47,370 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:48:49,112 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:49,113 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:48:50,763 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:50,764 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:48:52,470 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:52,471 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:48:54,215 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:54,216 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:48:55,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:55,929 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:48:57,614 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:57,614 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:48:59,293 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:48:59,293 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:49:00,986 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:00,986 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:49:02,663 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:02,663 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:49:04,334 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:04,334 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:49:05,993 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:05,993 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:49:07,685 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:07,686 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:49:09,361 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:09,362 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:49:11,044 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:11,044 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:49:12,735 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:12,737 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:49:14,436 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:14,436 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:49:16,124 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:16,125 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:49:17,812 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:17,813 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:49:19,524 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:19,525 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:49:21,255 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:21,255 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:49:22,949 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:22,950 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:49:24,666 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:24,666 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:49:26,353 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:26,354 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:49:28,114 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:28,115 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 14:49:29,784 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:29,785 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 14:49:31,444 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:31,445 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 14:49:33,148 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:33,149 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 14:49:34,900 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:34,900 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 14:49:36,596 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:36,596 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 14:49:38,366 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:38,367 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 14:49:40,088 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:40,088 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 14:49:41,788 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:41,788 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 14:49:43,449 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:43,450 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 14:49:45,136 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:45,138 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 14:49:46,836 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:46,837 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 14:49:48,571 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:48,572 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 14:49:50,342 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:50,343 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 14:49:52,067 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:52,068 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 14:49:53,789 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:53,790 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 14:49:55,513 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:55,514 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 14:49:57,227 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:57,228 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 14:49:58,939 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:49:58,939 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 14:50:00,676 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:50:00,677 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 14:50:02,358 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:50:02,359 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 14:50:04,055 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:50:04,056 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 14:50:05,767 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:50:05,768 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 14:50:06,761 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 14:50:06,761 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 14:50:06,763 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 123 แถว
2025-11-20 14:50:06,764 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 14:50:06,765 INFO: รวมเก่า 123 + ใหม่ 123 → 123 (เพิ่ม 0)
2025-11-20 14:50:06,768 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 14:50:06,768 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 14:50:06,771 INFO: เริ่ม clean ข้อมูล: 123 แถว
2025-11-20 14:50:06,782 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (123 แถว)
2025-11-20 14:50:06,786 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 05:00:00          24.4            6.2       0.8 134.4       23.5    51.0     1013.9
2025-11-20 14:50:06,814 INFO: เตรียมโหลด 123 แถว
2025-11-20 14:50:06,930 INFO: โหลด DB สำเร็จ
2025-11-20 14:50:06,931 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 14:50:06,934 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 14:50:06,934 INFO: Load to DB + Backup สำเร็จ
2025-11-20 14:50:06,934 INFO: === PIPELINE END ===

2025-11-20 14:59:12,717 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 14:59:12,725 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 14:59:12,726 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:59:12,728 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 14:59:12,728 INFO: Scheduler started
2025-11-20 14:59:12,728 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 14:59:12,728 INFO: === PIPELINE START ===
2025-11-20 14:59:12,729 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 14:59:13,497 INFO: ดึง 2025-11-20 13:00:00+07:00 - 2025-11-20 14:00:00+07:00 → 2 แถว
2025-11-20 14:59:13,502 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:13,503 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 14:59:13,503 INFO: Fetch สำเร็จ
2025-11-20 14:59:13,511 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 14:59:14,195 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:14,195 INFO: เติม 2025-11-18 14:00 → +0
2025-11-20 14:59:15,859 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:15,859 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 14:59:17,539 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:17,540 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 14:59:19,335 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:19,336 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 14:59:21,035 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:21,036 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 14:59:22,714 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:22,714 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 14:59:24,415 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:24,415 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 14:59:26,114 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:26,115 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 14:59:27,769 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:27,769 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 14:59:29,540 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:29,541 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 14:59:31,232 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:31,233 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 14:59:32,934 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:32,935 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 14:59:34,626 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:34,627 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 14:59:36,328 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:36,328 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 14:59:38,019 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:38,019 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 14:59:39,736 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:39,736 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 14:59:41,487 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:41,488 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 14:59:43,157 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:43,157 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 14:59:44,801 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:44,801 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 14:59:46,500 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:46,501 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 14:59:48,200 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:48,200 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 14:59:48,400 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 14:59:48,400 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 14:59:49,907 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:49,907 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 14:59:51,615 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:51,617 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 14:59:53,338 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:53,338 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 14:59:55,055 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:55,055 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 14:59:56,748 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:56,749 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 14:59:58,450 INFO: ไม่มีข้อมูลใหม่
2025-11-20 14:59:58,450 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 15:00:00,154 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:00,154 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 15:00:01,822 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:01,822 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 15:00:03,523 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:03,523 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 15:00:05,253 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:05,253 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 15:00:07,043 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:07,043 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 15:00:08,776 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:08,776 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 15:00:10,481 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:10,482 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 15:00:12,255 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:12,255 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 15:00:13,967 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:13,967 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 15:00:15,691 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:15,691 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 15:00:17,414 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:17,414 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 15:00:19,098 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:19,098 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 15:00:21,101 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:21,102 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 15:00:22,767 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:22,767 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 15:00:24,465 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:24,465 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 15:00:26,213 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:26,214 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 15:00:27,904 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:27,904 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 15:00:29,594 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:29,594 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 15:00:31,264 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:31,264 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 15:00:33,204 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:33,205 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 15:00:34,888 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:00:34,889 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 15:00:36,666 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 15:00:36,667 INFO: เติม 2025-11-20 14:00 → +1
2025-11-20 15:00:37,684 INFO: เติมข้อมูลย้อนหลังเสร็จ: +1 แถว
2025-11-20 15:00:37,685 INFO: เติมข้อมูลย้อนหลัง: +1 แถว
2025-11-20 15:00:37,688 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 124 แถว
2025-11-20 15:00:37,690 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 15:00:37,695 INFO: รวมเก่า 123 + ใหม่ 124 → 124 (เพิ่ม 1)
2025-11-20 15:00:37,696 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 15:00:37,697 INFO: Format สำเร็จ: +1 แถว
2025-11-20 15:00:37,708 INFO: เริ่ม clean ข้อมูล: 124 แถว
2025-11-20 15:00:37,720 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (124 แถว)
2025-11-20 15:00:37,723 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 15:00:37,750 INFO: เตรียมโหลด 124 แถว
2025-11-20 15:00:37,872 INFO: โหลด DB สำเร็จ
2025-11-20 15:00:37,873 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 15:00:37,875 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 15:00:37,875 INFO: Load to DB + Backup สำเร็จ
2025-11-20 15:00:37,875 INFO: === PIPELINE END ===

2025-11-20 15:05:00,022 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 16:05:00 +07)" (scheduled at 2025-11-20 15:05:00+07:00)
2025-11-20 15:05:00,023 INFO: === PIPELINE START ===
2025-11-20 15:05:00,023 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:05:00,725 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:05:00,729 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:00,730 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:05:00,730 INFO: Fetch สำเร็จ
2025-11-20 15:05:00,734 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:05:01,419 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:01,419 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:05:03,178 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:03,179 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:05:04,905 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:04,905 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:05:06,604 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:06,605 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:05:08,283 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:08,284 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:05:10,124 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:10,124 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:05:11,912 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:11,913 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:05:13,606 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:13,607 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:05:15,294 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:15,295 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:05:17,059 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:17,060 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:05:18,773 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:18,774 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:05:20,493 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:20,493 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:05:22,264 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:22,264 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:05:23,995 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:23,997 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:05:25,702 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:25,703 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:05:27,405 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:27,405 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:05:29,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:29,081 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:05:30,091 ERROR: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 16:05:00 +07)" raised an exception
Traceback (most recent call last):
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\uvicorn\_compat.py", line 30, in asyncio_run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\runners.py", line 123, in run
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Pm2_5\venv\Lib\site-packages\apscheduler\executors\base.py", line 181, in run_coroutine_job
    retval = await job.func(*job.args, **job.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\app\main.py", line 97, in run_pipeline
    added = await fill_missing_hours(lookback_hours=48)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Pm2_5\tasks\fetch_api.py", line 251, in fill_missing_hours
    await asyncio.sleep(1)
  File "C:\Users\phon5\AppData\Local\Programs\Python\Python311\Lib\asyncio\tasks.py", line 649, in sleep
    return await future
           ^^^^^^^^^^^^
asyncio.exceptions.CancelledError
2025-11-20 15:05:32,082 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 15:05:32,089 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 15:05:32,090 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:05:32,091 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 15:05:32,092 INFO: Scheduler started
2025-11-20 15:05:32,092 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 15:05:32,092 INFO: === PIPELINE START ===
2025-11-20 15:05:32,092 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:05:32,815 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:05:32,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:32,821 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:05:32,822 INFO: Fetch สำเร็จ
2025-11-20 15:05:32,828 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:05:33,672 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:33,672 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:05:35,419 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:35,420 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:05:36,308 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:05:36,308 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:05:37,554 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:37,554 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:05:39,268 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:39,268 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:05:41,006 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:41,006 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:05:42,824 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:42,824 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:05:44,539 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:44,539 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:05:46,213 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:46,213 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:05:48,128 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:48,129 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:05:49,832 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:49,833 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:05:51,569 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:51,570 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:05:53,267 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:53,268 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:05:55,096 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:55,096 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:05:56,800 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:56,801 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:05:58,526 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:05:58,527 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:06:00,194 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:00,194 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:06:01,931 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:01,931 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:06:03,673 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:03,674 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 15:06:05,533 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:05,534 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 15:06:07,206 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:07,207 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 15:06:08,885 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:08,887 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 15:06:10,613 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:10,613 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 15:06:12,315 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:12,317 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 15:06:13,969 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:13,969 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 15:06:15,713 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:15,713 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 15:06:17,447 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:17,447 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 15:06:19,190 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:19,191 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 15:06:20,925 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:20,926 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 15:06:22,680 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:22,681 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 15:06:24,380 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:24,381 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 15:06:26,103 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:26,104 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 15:06:27,810 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:27,810 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 15:06:29,508 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:29,508 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 15:06:31,226 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:31,227 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 15:06:32,953 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:32,954 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 15:06:34,629 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:34,629 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 15:06:36,325 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:36,325 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 15:06:38,036 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:38,036 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 15:06:39,725 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:39,726 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 15:06:41,434 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:41,434 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 15:06:43,197 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:43,198 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 15:06:44,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:44,928 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 15:06:46,656 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:46,657 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 15:06:48,343 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:48,344 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 15:06:50,109 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:50,110 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 15:06:51,818 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:51,819 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 15:06:53,571 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:53,571 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 15:06:55,315 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:55,315 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 15:06:57,102 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:06:57,102 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 15:06:58,106 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 15:06:58,106 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 15:06:58,108 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 124 แถว
2025-11-20 15:06:58,108 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 15:06:58,110 INFO: รวมเก่า 124 + ใหม่ 124 → 124 (เพิ่ม 0)
2025-11-20 15:06:58,112 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 15:06:58,113 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 15:06:58,115 INFO: เริ่ม clean ข้อมูล: 124 แถว
2025-11-20 15:06:58,127 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (124 แถว)
2025-11-20 15:06:58,131 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 15:06:58,160 INFO: เตรียมโหลด 124 แถว
2025-11-20 15:06:58,293 INFO: โหลด DB สำเร็จ
2025-11-20 15:06:58,295 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 15:06:58,298 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 15:06:58,299 INFO: Load to DB + Backup สำเร็จ
2025-11-20 15:06:58,299 INFO: === PIPELINE END ===

2025-11-20 15:12:43,720 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:12:43,720 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:38:08,642 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 15:38:08,649 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 15:38:08,652 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:38:08,653 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 15:38:08,653 INFO: Scheduler started
2025-11-20 15:38:08,653 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 15:38:08,654 INFO: === PIPELINE START ===
2025-11-20 15:38:08,654 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:38:09,368 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:38:09,375 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:09,376 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:38:09,376 INFO: Fetch สำเร็จ
2025-11-20 15:38:09,384 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:38:10,067 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:10,068 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:38:11,756 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:11,756 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:38:13,497 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:13,497 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:38:14,281 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:38:14,282 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:38:15,232 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:15,232 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:38:16,942 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:16,942 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:38:18,622 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:18,622 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:38:20,391 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:20,392 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:38:22,124 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:22,124 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:38:23,826 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:23,826 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:38:25,535 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:25,536 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:38:27,351 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:27,351 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:38:29,073 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:29,073 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:38:30,780 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:30,780 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:38:32,435 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:32,435 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:38:34,116 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:34,117 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:38:35,801 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:35,801 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:38:37,479 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:37,479 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:38:39,182 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:39,183 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 15:38:40,880 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:40,881 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 15:38:42,592 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:42,592 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 15:38:44,337 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:44,337 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 15:38:46,044 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:46,045 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 15:38:47,747 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:47,748 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 15:38:49,464 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:49,465 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 15:38:51,206 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:51,207 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 15:38:52,928 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:52,929 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 15:38:54,618 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:54,618 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 15:38:56,370 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:56,371 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 15:38:58,107 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:58,107 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 15:38:59,858 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:38:59,859 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 15:39:01,587 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:01,588 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 15:39:03,293 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:03,293 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 15:39:05,030 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:05,030 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 15:39:06,813 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:06,814 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 15:39:08,479 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:08,480 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 15:39:10,173 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:10,173 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 15:39:11,868 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:11,868 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 15:39:13,565 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:13,565 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 15:39:15,216 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:15,216 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 15:39:16,946 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:16,947 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 15:39:18,628 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:18,628 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 15:39:20,320 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:20,320 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 15:39:22,019 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:22,020 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 15:39:23,712 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:23,713 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 15:39:25,446 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:25,447 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 15:39:27,159 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:27,160 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 15:39:28,834 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:28,835 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 15:39:30,545 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:30,546 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 15:39:32,254 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:32,255 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 15:39:33,251 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 15:39:33,251 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 15:39:33,253 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 124 แถว
2025-11-20 15:39:33,254 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 15:39:33,255 INFO: รวมเก่า 124 + ใหม่ 124 → 124 (เพิ่ม 0)
2025-11-20 15:39:33,257 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 15:39:33,258 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 15:39:33,260 INFO: เริ่ม clean ข้อมูล: 124 แถว
2025-11-20 15:39:33,272 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (124 แถว)
2025-11-20 15:39:33,275 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 15:39:33,314 INFO: เตรียมโหลด 124 แถว
2025-11-20 15:39:33,465 INFO: โหลด DB สำเร็จ
2025-11-20 15:39:33,467 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 15:39:33,469 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 15:39:33,470 INFO: Load to DB + Backup สำเร็จ
2025-11-20 15:39:33,470 INFO: === PIPELINE END ===

2025-11-20 15:39:49,933 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 15:39:49,939 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 15:39:49,941 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:39:49,941 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 15:39:49,943 INFO: Scheduler started
2025-11-20 15:39:49,943 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 15:39:49,943 INFO: === PIPELINE START ===
2025-11-20 15:39:49,943 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:39:50,710 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:39:50,715 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:50,717 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:39:50,717 INFO: Fetch สำเร็จ
2025-11-20 15:39:50,725 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:39:51,396 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:51,397 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:39:51,500 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:39:51,500 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:39:53,120 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:53,121 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:39:54,809 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:54,809 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:39:56,527 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:56,528 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:39:58,180 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:58,181 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:39:59,892 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:39:59,893 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:40:01,624 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:01,624 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:40:03,349 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:03,350 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:40:05,081 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:05,082 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:40:06,788 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:06,789 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:40:08,461 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:08,461 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:40:10,180 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:10,181 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:40:11,915 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:11,915 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:40:13,592 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:13,592 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:40:15,301 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:15,302 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:40:17,016 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:17,017 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:40:18,736 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:18,738 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:40:20,422 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:20,423 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 15:40:22,399 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 15:40:22,405 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 15:40:22,406 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:40:22,407 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 15:40:22,407 INFO: Scheduler started
2025-11-20 15:40:22,408 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 15:40:22,408 INFO: === PIPELINE START ===
2025-11-20 15:40:22,408 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:40:23,113 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:40:23,119 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:23,119 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:40:23,119 INFO: Fetch สำเร็จ
2025-11-20 15:40:23,126 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:40:23,905 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:23,905 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:40:24,400 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:40:24,400 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:40:25,683 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:25,684 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:40:27,394 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:27,394 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:40:29,103 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:29,104 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:40:30,777 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:30,778 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:40:32,454 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:32,455 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:40:34,177 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:34,177 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:40:35,888 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:35,889 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:40:37,604 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:37,604 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:40:39,327 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:39,328 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:40:41,085 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:41,085 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:40:42,832 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:42,833 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:40:44,570 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:44,570 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:40:46,326 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:46,327 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:40:48,063 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:48,064 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:40:49,819 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:49,819 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:40:51,462 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:51,463 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:40:53,211 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:53,212 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 15:40:54,987 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:54,988 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 15:40:56,728 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:56,729 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 15:40:58,457 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:40:58,457 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 15:41:00,176 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:00,177 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 15:41:01,957 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:01,957 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 15:41:03,639 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:03,640 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 15:41:05,382 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:05,382 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 15:41:07,091 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:07,091 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 15:41:08,835 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:08,835 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 15:41:10,536 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:10,536 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 15:41:12,196 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:12,196 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 15:41:13,894 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:13,895 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 15:41:15,569 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:15,570 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 15:41:17,242 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:17,243 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 15:41:18,929 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:18,929 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 15:41:20,634 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:20,636 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 15:41:22,353 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:22,354 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 15:41:24,030 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:24,030 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 15:41:25,718 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:25,719 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 15:41:27,412 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:27,412 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 15:41:29,116 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:29,117 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 15:41:30,802 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:30,803 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 15:41:32,489 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:32,490 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 15:41:34,130 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:34,131 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 15:41:35,805 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:35,805 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 15:41:37,500 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:37,501 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 15:41:39,234 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:39,235 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 15:41:40,903 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:40,903 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 15:41:42,655 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:42,655 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 15:41:44,376 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:44,376 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 15:41:46,092 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:41:46,092 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 15:41:47,112 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 15:41:47,112 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 15:41:47,115 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 124 แถว
2025-11-20 15:41:47,115 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 15:41:47,118 INFO: รวมเก่า 124 + ใหม่ 124 → 124 (เพิ่ม 0)
2025-11-20 15:41:47,119 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 15:41:47,120 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 15:41:47,121 INFO: เริ่ม clean ข้อมูล: 124 แถว
2025-11-20 15:41:47,132 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (124 แถว)
2025-11-20 15:41:47,136 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 15:41:47,163 INFO: เตรียมโหลด 124 แถว
2025-11-20 15:41:47,283 INFO: โหลด DB สำเร็จ
2025-11-20 15:41:47,285 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 15:41:47,287 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 15:41:47,287 INFO: Load to DB + Backup สำเร็จ
2025-11-20 15:41:47,287 INFO: === PIPELINE END ===

2025-11-20 15:42:44,552 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 15:42:44,559 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 15:42:44,561 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:42:44,562 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 15:42:44,562 INFO: Scheduler started
2025-11-20 15:42:44,562 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 15:42:44,562 INFO: === PIPELINE START ===
2025-11-20 15:42:44,563 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:42:45,327 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:42:45,334 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:45,334 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:42:45,336 INFO: Fetch สำเร็จ
2025-11-20 15:42:45,344 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:42:46,069 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:46,070 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:42:46,185 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:42:46,185 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:42:46,261 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:42:46,261 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:42:47,827 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:47,828 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:42:49,594 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:49,594 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:42:51,334 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:51,335 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:42:53,042 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:53,043 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:42:54,752 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:54,753 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:42:56,450 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:56,451 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:42:58,197 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:58,198 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:42:59,947 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:42:59,948 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:43:01,702 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:01,703 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:43:03,423 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:03,424 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:43:05,154 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:05,155 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:43:06,879 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:06,880 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:43:08,605 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:08,606 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:43:10,335 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:10,335 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:43:12,053 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:12,054 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:43:13,767 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:13,768 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:43:15,514 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:15,514 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 15:43:17,293 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:17,293 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 15:43:19,016 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:19,016 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 15:43:20,720 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:20,721 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 15:43:22,526 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:22,528 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 15:43:24,375 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:24,376 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 15:43:26,121 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:26,122 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 15:43:27,842 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:27,843 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 15:43:29,574 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:29,574 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 15:43:31,257 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:31,257 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 15:43:32,993 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:32,993 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 15:43:34,703 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:34,703 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 15:43:36,428 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:36,428 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 15:43:38,145 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:38,145 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 15:43:39,876 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:39,876 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 15:43:41,604 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:41,605 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 15:43:43,390 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:43,391 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 15:43:45,139 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:45,140 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 15:43:46,924 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:46,925 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 15:43:48,751 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:48,752 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 15:43:50,504 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:50,505 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 15:43:52,471 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:52,472 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 15:43:54,330 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:54,330 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 15:43:56,169 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:56,169 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 15:43:57,948 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:57,949 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 15:43:59,684 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:43:59,684 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 15:44:01,460 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:44:01,460 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 15:44:03,181 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:44:03,182 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 15:44:05,037 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:44:05,038 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 15:44:06,841 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:44:06,842 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 15:44:08,639 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:44:08,640 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 15:44:10,417 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:44:10,418 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 15:44:11,444 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 15:44:11,444 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 15:44:11,446 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 124 แถว
2025-11-20 15:44:11,447 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 15:44:11,448 INFO: รวมเก่า 124 + ใหม่ 124 → 124 (เพิ่ม 0)
2025-11-20 15:44:11,451 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 15:44:11,451 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 15:44:11,453 INFO: เริ่ม clean ข้อมูล: 124 แถว
2025-11-20 15:44:11,465 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (124 แถว)
2025-11-20 15:44:11,470 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 15:44:11,499 INFO: เตรียมโหลด 124 แถว
2025-11-20 15:44:11,636 INFO: โหลด DB สำเร็จ
2025-11-20 15:44:11,637 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 15:44:11,639 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 15:44:11,639 INFO: Load to DB + Backup สำเร็จ
2025-11-20 15:44:11,640 INFO: === PIPELINE END ===

2025-11-20 15:51:22,354 INFO: MODEL loaded. expected features (metadata): 168
2025-11-20 15:51:22,358 INFO: Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-11-20 15:51:22,360 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:51:22,361 INFO: Added job "run_pipeline" to job store "default"
2025-11-20 15:51:22,361 INFO: Scheduler started
2025-11-20 15:51:22,361 INFO: Scheduler เริ่มแล้ว → ทุกชั่วโมง นาทีที่ 5
2025-11-20 15:51:22,361 INFO: === PIPELINE START ===
2025-11-20 15:51:22,361 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 15:51:23,109 INFO: ดึง 2025-11-20 14:00:00+07:00 - 2025-11-20 15:00:00+07:00 → 2 แถว
2025-11-20 15:51:23,115 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:23,115 INFO: สำเร็จ: เพิ่ม 0 แถว (ปัจจุบัน)
2025-11-20 15:51:23,116 INFO: Fetch สำเร็จ
2025-11-20 15:51:23,123 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 15:51:23,796 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:23,796 INFO: เติม 2025-11-18 15:00 → +0
2025-11-20 15:51:25,521 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:25,522 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 15:51:27,251 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:27,251 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 15:51:28,954 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:28,954 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 15:51:30,650 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:30,651 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 15:51:32,328 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:32,328 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 15:51:34,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:34,081 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 15:51:35,799 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:35,800 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 15:51:35,906 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:51:35,906 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:51:37,493 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:37,494 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 15:51:39,225 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:39,225 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 15:51:40,932 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:40,932 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 15:51:42,714 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:42,715 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 15:51:44,410 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:44,411 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 15:51:46,070 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:46,071 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 15:51:47,817 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:47,817 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 15:51:49,466 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:49,466 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 15:51:51,160 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:51,160 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 15:51:52,865 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:52,865 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 15:51:54,561 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:54,562 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 15:51:56,299 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:56,300 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 15:51:58,033 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:58,034 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 15:51:59,726 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:51:59,727 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 15:52:01,408 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:01,409 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 15:52:03,118 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:03,119 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 15:52:04,858 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:04,859 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 15:52:06,628 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:06,629 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 15:52:08,322 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:08,323 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 15:52:10,027 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:10,027 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 15:52:11,700 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:11,700 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 15:52:13,437 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:13,438 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 15:52:15,122 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:15,122 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 15:52:16,880 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:16,881 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 15:52:18,595 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:18,595 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 15:52:20,740 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:20,740 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 15:52:22,438 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:22,439 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 15:52:24,114 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:24,114 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 15:52:25,815 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:25,816 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 15:52:27,529 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:27,530 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 15:52:29,233 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:29,233 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 15:52:30,925 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:30,926 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 15:52:32,619 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:32,619 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 15:52:34,354 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:34,355 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 15:52:36,078 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:36,078 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 15:52:37,789 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:37,790 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 15:52:39,509 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:39,510 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 15:52:41,225 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:41,226 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 15:52:42,984 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:42,986 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 15:52:44,713 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:44,714 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 15:52:46,422 INFO: ไม่มีข้อมูลใหม่
2025-11-20 15:52:46,423 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 15:52:47,437 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 15:52:47,437 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 15:52:47,438 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 124 แถว
2025-11-20 15:52:47,439 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 15:52:47,441 INFO: รวมเก่า 124 + ใหม่ 124 → 124 (เพิ่ม 0)
2025-11-20 15:52:47,442 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 15:52:47,443 INFO: ไม่มีข้อมูลใหม่ให้ format
2025-11-20 15:52:47,445 INFO: เริ่ม clean ข้อมูล: 124 แถว
2025-11-20 15:52:47,457 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (124 แถว)
2025-11-20 15:52:47,461 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 06:00:00          26.8           11.8       1.0 140.9       23.1    50.9     1014.5
2025-11-20 15:52:47,489 INFO: เตรียมโหลด 124 แถว
2025-11-20 15:52:47,642 INFO: โหลด DB สำเร็จ
2025-11-20 15:52:47,644 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 15:52:47,647 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 15:52:47,647 INFO: Load to DB + Backup สำเร็จ
2025-11-20 15:52:47,647 INFO: === PIPELINE END ===

2025-11-20 15:55:38,346 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:55:38,346 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 15:55:41,597 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 15:55:41,597 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 16:00:50,992 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 16:00:50,992 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 16:02:26,920 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 16:02:26,920 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
2025-11-20 16:05:00,003 INFO: Running job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 17:05:00 +07)" (scheduled at 2025-11-20 16:05:00+07:00)
2025-11-20 16:05:00,004 INFO: === PIPELINE START ===
2025-11-20 16:05:00,006 INFO: Event loop กำลังรัน → ข้ามการตั้ง signal handlers (ASGI/uvicorn mode).
2025-11-20 16:05:00,774 INFO: ดึง 2025-11-20 15:00:00+07:00 - 2025-11-20 16:00:00+07:00 → 2 แถว
2025-11-20 16:05:00,778 INFO: เพิ่ม 1 แถว → data\staging\raw_airbkk.csv
2025-11-20 16:05:00,780 INFO: สำเร็จ: เพิ่ม 1 แถว (ปัจจุบัน)
2025-11-20 16:05:00,780 INFO: Fetch สำเร็จ
2025-11-20 16:05:00,798 INFO: พบ 49 ชั่วโมงที่ขาด → ดึงใหม่
2025-11-20 16:05:01,484 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:01,484 INFO: เติม 2025-11-18 16:00 → +0
2025-11-20 16:05:03,207 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:03,208 INFO: เติม 2025-11-18 17:00 → +0
2025-11-20 16:05:04,925 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:04,926 INFO: เติม 2025-11-18 18:00 → +0
2025-11-20 16:05:06,645 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:06,646 INFO: เติม 2025-11-18 19:00 → +0
2025-11-20 16:05:08,409 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:08,410 INFO: เติม 2025-11-18 20:00 → +0
2025-11-20 16:05:10,042 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:10,042 INFO: เติม 2025-11-18 21:00 → +0
2025-11-20 16:05:11,850 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:11,851 INFO: เติม 2025-11-18 22:00 → +0
2025-11-20 16:05:13,626 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:13,626 INFO: เติม 2025-11-18 23:00 → +0
2025-11-20 16:05:15,377 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:15,378 INFO: เติม 2025-11-19 00:00 → +0
2025-11-20 16:05:17,132 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:17,132 INFO: เติม 2025-11-19 01:00 → +0
2025-11-20 16:05:18,821 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:18,822 INFO: เติม 2025-11-19 02:00 → +0
2025-11-20 16:05:20,568 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:20,569 INFO: เติม 2025-11-19 03:00 → +0
2025-11-20 16:05:22,309 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:22,310 INFO: เติม 2025-11-19 04:00 → +0
2025-11-20 16:05:24,004 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:24,004 INFO: เติม 2025-11-19 05:00 → +0
2025-11-20 16:05:25,693 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:25,694 INFO: เติม 2025-11-19 06:00 → +0
2025-11-20 16:05:27,346 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:27,346 INFO: เติม 2025-11-19 07:00 → +0
2025-11-20 16:05:29,080 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:29,080 INFO: เติม 2025-11-19 08:00 → +0
2025-11-20 16:05:30,806 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:30,807 INFO: เติม 2025-11-19 09:00 → +0
2025-11-20 16:05:32,571 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:32,571 INFO: เติม 2025-11-19 10:00 → +0
2025-11-20 16:05:34,279 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:34,280 INFO: เติม 2025-11-19 11:00 → +0
2025-11-20 16:05:35,956 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:35,957 INFO: เติม 2025-11-19 12:00 → +0
2025-11-20 16:05:37,684 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:37,685 INFO: เติม 2025-11-19 13:00 → +0
2025-11-20 16:05:39,338 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:39,339 INFO: เติม 2025-11-19 14:00 → +0
2025-11-20 16:05:40,993 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:40,993 INFO: เติม 2025-11-19 15:00 → +0
2025-11-20 16:05:42,735 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:42,736 INFO: เติม 2025-11-19 16:00 → +0
2025-11-20 16:05:44,370 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:44,371 INFO: เติม 2025-11-19 17:00 → +0
2025-11-20 16:05:46,059 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:46,060 INFO: เติม 2025-11-19 18:00 → +0
2025-11-20 16:05:47,779 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:47,780 INFO: เติม 2025-11-19 19:00 → +0
2025-11-20 16:05:49,466 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:49,467 INFO: เติม 2025-11-19 20:00 → +0
2025-11-20 16:05:51,164 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:51,164 INFO: เติม 2025-11-19 21:00 → +0
2025-11-20 16:05:52,823 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:52,823 INFO: เติม 2025-11-19 22:00 → +0
2025-11-20 16:05:54,508 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:54,509 INFO: เติม 2025-11-19 23:00 → +0
2025-11-20 16:05:56,252 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:56,252 INFO: เติม 2025-11-20 00:00 → +0
2025-11-20 16:05:57,980 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:57,982 INFO: เติม 2025-11-20 01:00 → +0
2025-11-20 16:05:59,651 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:05:59,652 INFO: เติม 2025-11-20 02:00 → +0
2025-11-20 16:06:01,314 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:01,314 INFO: เติม 2025-11-20 03:00 → +0
2025-11-20 16:06:02,976 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:02,977 INFO: เติม 2025-11-20 04:00 → +0
2025-11-20 16:06:04,652 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:04,653 INFO: เติม 2025-11-20 05:00 → +0
2025-11-20 16:06:06,304 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:06,304 INFO: เติม 2025-11-20 06:00 → +0
2025-11-20 16:06:08,011 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:08,012 INFO: เติม 2025-11-20 07:00 → +0
2025-11-20 16:06:09,687 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:09,688 INFO: เติม 2025-11-20 08:00 → +0
2025-11-20 16:06:11,316 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:11,316 INFO: เติม 2025-11-20 09:00 → +0
2025-11-20 16:06:12,979 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:12,980 INFO: เติม 2025-11-20 10:00 → +0
2025-11-20 16:06:14,766 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:14,766 INFO: เติม 2025-11-20 11:00 → +0
2025-11-20 16:06:16,474 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:16,474 INFO: เติม 2025-11-20 12:00 → +0
2025-11-20 16:06:18,220 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:18,220 INFO: เติม 2025-11-20 13:00 → +0
2025-11-20 16:06:19,887 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:19,888 INFO: เติม 2025-11-20 14:00 → +0
2025-11-20 16:06:21,652 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:21,653 INFO: เติม 2025-11-20 15:00 → +0
2025-11-20 16:06:23,343 INFO: ไม่มีข้อมูลใหม่
2025-11-20 16:06:23,344 INFO: เติม 2025-11-20 16:00 → +0
2025-11-20 16:06:24,355 INFO: เติมข้อมูลย้อนหลังเสร็จ: +0 แถว
2025-11-20 16:06:24,356 INFO: เติมข้อมูลย้อนหลัง: +0 แถว
2025-11-20 16:06:24,357 INFO: อ่านข้อมูลดิบ: data\staging\raw_airbkk.csv → 125 แถว
2025-11-20 16:06:24,358 INFO: เลือกคอลัมน์: 8 คอลัมน์
2025-11-20 16:06:24,359 INFO: รวมเก่า 124 + ใหม่ 125 → 125 (เพิ่ม 1)
2025-11-20 16:06:24,361 INFO: บันทึก: data\staging\formatted_air.csv
2025-11-20 16:06:24,361 INFO: Format สำเร็จ: +1 แถว
2025-11-20 16:06:24,372 INFO: เริ่ม clean ข้อมูล: 125 แถว
2025-11-20 16:06:24,382 INFO: บันทึกสำเร็จ: data\staging\cleaned_air.csv (125 แถว)
2025-11-20 16:06:24,385 INFO: 
ล่าสุด 10 แถว:
          Date_Time  PM10 (µg/m³)  PM2.5 (µg/m³)  WS (m/s)    WD  Temp (°C)  RH (%)  BP (mBar)
2025-11-20 16:00:00          47.7            7.4       1.0 142.2       26.3    45.2     1013.1
2025-11-20 15:00:00          43.4            7.4       0.9 129.4       26.6    43.9     1013.6
2025-11-20 14:00:00          35.1            7.4       0.9 143.5       26.9    42.8     1014.4
2025-11-20 13:00:00          37.2            7.4       1.0 139.6       26.3    43.9     1015.3
2025-11-20 12:00:00          39.6            8.0       0.8 142.5       25.9    45.5     1016.5
2025-11-20 11:00:00          34.1           10.2       0.7 158.4       25.2    47.1     1017.5
2025-11-20 10:00:00          35.9           10.3       0.5 155.2       24.5    47.9     1017.5
2025-11-20 09:00:00          33.8           13.5       0.9 177.3       23.9    48.0     1017.1
2025-11-20 08:00:00          30.8           12.7       0.8 141.9       23.1    51.6     1016.2
2025-11-20 07:00:00          27.9            8.8       1.0 138.9       22.9    51.6     1015.3
2025-11-20 16:06:24,387 INFO: เตรียมโหลด 125 แถว
2025-11-20 16:06:24,517 INFO: โหลด DB สำเร็จ
2025-11-20 16:06:24,519 INFO: Backup สำเร็จ: data\backups\2025-11-20.csv
2025-11-20 16:06:24,521 INFO: อัพเดท latest.csv สำเร็จ
2025-11-20 16:06:24,521 INFO: Load to DB + Backup สำเร็จ
2025-11-20 16:06:24,521 INFO: === PIPELINE END ===

2025-11-20 16:06:24,521 INFO: Job "run_pipeline (trigger: cron[hour='*', minute='5'], next run at: 2025-11-20 17:05:00 +07)" executed successfully
2025-11-20 16:10:25,552 INFO: feature built: actual_n=172, model_expected_n=168
2025-11-20 16:10:25,553 WARNING: ฟีเจอร์มากกว่าโมเดลต้องการ: ตัด 4 ค่า ท้ายรายการ
